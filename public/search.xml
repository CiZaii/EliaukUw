<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>在SpringCloud中如何获取用户真实IP(避免各种问题)</title>
      <link href="/posts/1f6ffb2c.html"/>
      <url>/posts/1f6ffb2c.html</url>
      
        <content type="html"><![CDATA[<blockquote><p>大家平时获取用户的真实IP的时候可能会遇到的一些问题 如果发生问题可以按照以下思路排查应该会帮到你</p></blockquote><h2 id="1、查看Nginx配置">1、查看Nginx配置</h2><blockquote><p>一般情况下，我们的项目都是通过Nginx进行代理的，所以我们需要查看Nginx的配置文件</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">location / &#123;</span><br><span class="line"></span><br><span class="line">proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">2. 使用X-Forwarded-For头字段：类似于X-Real-IP，可以使用X-Forwarded-For头字段来传递客户端的真实IP地址。在NGINX配置文件中，可以通过添加如下代码来设置X-Forwarded-For头字段的值：</span><br><span class="line"></span><br><span class="line">location / &#123;</span><br><span class="line"></span><br><span class="line">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>查看是否有以上配置进行了代理转发</p></blockquote><h2 id="2、查看GateWay配置-如果单体项目没有使用网关忽略">2、查看GateWay配置(如果单体项目没有使用网关忽略)</h2><blockquote><p>首先要查看网关中的过滤器链里边所有的自定义过滤器有没有对请求头进行了修改，如果有修改的话请根据当前业务进行适当的修改</p></blockquote><h2 id="3、查看是否调用了Fegin接口">3、查看是否调用了Fegin接口</h2><blockquote><p>如果调用了Fegin接口的话，他默认是不携带多余请求头的，所以我们要对齐进行配置</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FeignAuthRequestInterceptor</span> <span class="keyword">implements</span> <span class="title class_">RequestInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">apply</span><span class="params">(RequestTemplate requestTemplate)</span> &#123;</span><br><span class="line">        <span class="comment">// 获取当前的ServletRequestAttributes</span></span><br><span class="line">        <span class="type">ServletRequestAttributes</span> <span class="variable">attributes</span> <span class="operator">=</span> (ServletRequestAttributes) RequestContextHolder.getRequestAttributes();</span><br><span class="line">        <span class="keyword">if</span> (attributes != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="comment">// 获取原始的HttpServletRequest</span></span><br><span class="line">            <span class="type">HttpServletRequest</span> <span class="variable">request</span> <span class="operator">=</span> attributes.getRequest();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 遍历所有的请求头</span></span><br><span class="line">            Enumeration&lt;String&gt; headerNames = request.getHeaderNames();</span><br><span class="line">            <span class="keyword">while</span> (headerNames.hasMoreElements()) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">headerName</span> <span class="operator">=</span> headerNames.nextElement();</span><br><span class="line">                <span class="type">String</span> <span class="variable">headerValue</span> <span class="operator">=</span> request.getHeader(headerName);</span><br><span class="line">                <span class="comment">// 这个地方一定要加上，否则会出现一些问题</span></span><br><span class="line">                <span class="keyword">if</span> (headerName.equals(<span class="string">&quot;content-length&quot;</span>))&#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 将请求头添加到Feign的RequestTemplate</span></span><br><span class="line">                requestTemplate.header(headerName, headerValue);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 真实项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>项目如何适配国产海量数据库</title>
      <link href="/posts/29bb76eb.html"/>
      <url>/posts/29bb76eb.html</url>
      
        <content type="html"><![CDATA[<h2 id="1、当前使用ORM框架以及配置">1、当前使用ORM框架以及配置</h2><ol><li>当前我使用的ORM框架是：Mybatis-Plus，然后进行了多租户的配置</li><li>使用依赖如下：</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.gitee.sunchenbin.mybatis.actable<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-enhance-actable<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-annotation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.yulichang<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-join-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2、开始进行适配">2、开始进行适配</h2><h3 id="2-1、配置文件修改">2.1、配置文件修改</h3><p>当前配置文件</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mysql:</span></span><br><span class="line">  <span class="attr">default:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://xxxxxxx:33306/ai_boot?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=true&amp;autoReconnect=true</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">用户名</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">密码</span></span><br><span class="line">    <span class="attr">driverClassName:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">  <span class="attr">tenant:</span></span><br><span class="line">    <span class="attr">prefix:</span> <span class="string">ai_boot_</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">ip地址</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">33306</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">用户名</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">密码</span></span><br><span class="line">    <span class="attr">driverClassName:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure><blockquote><p>只需要将url中的mysql改为postgresql即可<br>注意：postgresql的驱动类是：org.postgresql.Driver<br>要注意的是：postgresql的url中需要指定currentSchema=xxxx 这是一个默认访问的数据库，在多租户配置下需要注意</p></blockquote><p>修改后的配置</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mysql:</span></span><br><span class="line">  <span class="attr">default:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:postgresql://ip:5432/ai?useUnicode=true&amp;characterEncoding=UTF-8&amp;useSSL=true&amp;autoReconnect=true&amp;currentSchema=ai_boot</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">用户名</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">密码</span></span><br><span class="line">    <span class="attr">driverClassName:</span> <span class="string">org.postgresql.Driver</span></span><br><span class="line">  <span class="attr">tenant:</span></span><br><span class="line">    <span class="attr">prefix:</span> <span class="string">ai_boot_</span></span><br><span class="line">    <span class="attr">host:</span> <span class="string">xxxxx</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">5432</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">用户名</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">密码</span></span><br><span class="line">    <span class="attr">driverClassName:</span> <span class="string">org.postgresql.Driver</span></span><br></pre></td></tr></table></figure><p>新引入依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 引入postgresql驱动 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.postgresql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>postgresql<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 引入vastbase-jdbc --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.com.vastdata<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>vastbase-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.8v<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Vastbase </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>合并excel并筛选指定表头数据</title>
      <link href="/posts/3a2a4cae.html"/>
      <url>/posts/3a2a4cae.html</url>
      
        <content type="html"><![CDATA[<h2 id="1、需求">1、需求</h2><blockquote><p>有多个excel文件，每个文件都有多个表头，现在需要将这些excel文件合并成一个excel文件，并且筛选出指定表头的数据。</p></blockquote><h2 id="2、代码">2、代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Value(&quot;$&#123;OriginalFile&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String originalDocument;</span><br><span class="line"><span class="meta">@Value(&quot;$&#123;finalDocument&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String finalDocument;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">int</span> <span class="title function_">findColumnIndex</span><span class="params">(Sheet sheet, String headerName)</span> &#123;</span><br><span class="line">    <span class="type">Row</span> <span class="variable">headerRow</span> <span class="operator">=</span> sheet.getRow(<span class="number">0</span>); <span class="comment">// 假设第一行是表头</span></span><br><span class="line">    <span class="keyword">if</span> (headerRow != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (Cell cell : headerRow) &#123;</span><br><span class="line">            <span class="keyword">if</span> (headerName.equals(cell.getStringCellValue())) &#123;</span><br><span class="line">                <span class="keyword">return</span> cell.getColumnIndex();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>; <span class="comment">// 如果未找到，返回-1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line">CommandLineRunner <span class="title function_">commandLineRunner</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> args -&gt; &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">folderPath</span> <span class="operator">=</span> originalDocument; <span class="comment">// Excel文件夹的路径</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">outputPath</span> <span class="operator">=</span> finalDocument; <span class="comment">// 输出文件的路径</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> (<span class="type">Workbook</span> <span class="variable">newWorkbook</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XSSFWorkbook</span>()) &#123;</span><br><span class="line">            <span class="type">Sheet</span> <span class="variable">newSheet</span> <span class="operator">=</span> newWorkbook.createSheet(<span class="string">&quot;Merged Data&quot;</span>);</span><br><span class="line">            AtomicReference&lt;Row&gt; newRow = <span class="keyword">new</span> <span class="title class_">AtomicReference</span>&lt;&gt;(newSheet.createRow(<span class="number">0</span>));</span><br><span class="line">            newRow.get().createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;题名&quot;</span>);</span><br><span class="line">            newRow.get().createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;文种&quot;</span>);</span><br><span class="line">            newRow.get().createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;内容&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">AtomicInteger</span> <span class="variable">newRowNum</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AtomicInteger</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            Files.walk(Paths.get(folderPath))</span><br><span class="line">                    .filter(Files::isRegularFile)</span><br><span class="line">                    .filter(path -&gt; path.toString().endsWith(<span class="string">&quot;.xlsx&quot;</span>))</span><br><span class="line">                    .forEach(path -&gt; &#123;</span><br><span class="line">                        <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(path.toFile());</span><br><span class="line">                             <span class="type">Workbook</span> <span class="variable">workbook</span> <span class="operator">=</span> WorkbookFactory.create(is)) &#123;</span><br><span class="line">                            <span class="type">Sheet</span> <span class="variable">sheet</span> <span class="operator">=</span> workbook.getSheetAt(<span class="number">0</span>); <span class="comment">// 假设数据在第一个Sheet</span></span><br><span class="line">                            <span class="type">int</span> <span class="variable">titleIndex</span> <span class="operator">=</span> findColumnIndex(sheet, <span class="string">&quot;题名&quot;</span>);</span><br><span class="line">                            <span class="type">int</span> <span class="variable">typeIndex</span> <span class="operator">=</span> findColumnIndex(sheet, <span class="string">&quot;文种&quot;</span>);</span><br><span class="line">                            <span class="type">int</span> <span class="variable">contentIndex</span> <span class="operator">=</span> findColumnIndex(sheet, <span class="string">&quot;内容&quot;</span>);</span><br><span class="line"></span><br><span class="line">                            <span class="comment">// 跳过表头，从第二行开始读取数据</span></span><br><span class="line">                            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= sheet.getLastRowNum(); i++) &#123;</span><br><span class="line">                                <span class="type">Row</span> <span class="variable">row</span> <span class="operator">=</span> sheet.getRow(i);</span><br><span class="line">                                <span class="keyword">if</span> (row != <span class="literal">null</span>) &#123;</span><br><span class="line">                                    newRow.set(newSheet.createRow(newRowNum.getAndIncrement()));</span><br><span class="line">                                    <span class="keyword">if</span> (titleIndex != -<span class="number">1</span>) &#123;</span><br><span class="line">                                        newRow.get().createCell(<span class="number">0</span>).setCellValue(row.getCell(titleIndex).getStringCellValue());</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    <span class="keyword">if</span> (typeIndex != -<span class="number">1</span>) &#123;</span><br><span class="line">                                        newRow.get().createCell(<span class="number">1</span>).setCellValue(row.getCell(typeIndex).getStringCellValue());</span><br><span class="line">                                    &#125;</span><br><span class="line">                                    <span class="keyword">if</span> (contentIndex != -<span class="number">1</span>) &#123;</span><br><span class="line">                                        newRow.get().createCell(<span class="number">2</span>).setCellValue(row.getCell(contentIndex).getStringCellValue());</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                            log.info(e);</span><br><span class="line"></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> (<span class="type">OutputStream</span> <span class="variable">fileOut</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(outputPath)) &#123;</span><br><span class="line">                newWorkbook.write(fileOut);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 开源 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> excel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Forest对接谷歌Gemini</title>
      <link href="/posts/c3461094.html"/>
      <url>/posts/c3461094.html</url>
      
        <content type="html"><![CDATA[<h2 id="1、前置需要">1、前置需要</h2><blockquote><p>申请Gemini账号，并获取API Key</p></blockquote><p>官网地址：<a href="https://makersuite.google.com/app/apikey">Gemini</a></p><h2 id="2、测试所引入依赖">2、测试所引入依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.dtflys.forest<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>forest-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.33<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.8.18<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span> <span class="comment">&lt;!-- 或更高版本 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span> <span class="comment">&lt;!-- 或更高版本 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-annotations<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.12.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span> <span class="comment">&lt;!-- 或更高版本 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="3、yml文件配置">3、yml文件配置</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">forest:</span></span><br><span class="line">  <span class="attr">variables:</span></span><br><span class="line">    <span class="attr">gemini:</span></span><br><span class="line">      <span class="comment">#proxies: https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent  这个是普通请求</span></span><br><span class="line">      <span class="attr">proxies:</span> <span class="string">https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:streamGenerateContent</span> <span class="comment"># 这个是流式请求</span></span><br><span class="line">      <span class="attr">key:</span> <span class="string">YOUR_API_KEY</span> <span class="comment"># 这里是你申请的apikey</span></span><br><span class="line">  <span class="attr">max-connections:</span> <span class="number">1000</span>        <span class="comment"># 连接池最大连接数</span></span><br><span class="line">  <span class="attr">connect-timeout:</span> <span class="number">300000</span>        <span class="comment"># 连接超时时间，单位为毫秒</span></span><br><span class="line">  <span class="attr">read-timeout:</span> <span class="number">300000</span>           <span class="comment"># 数据读取超时时间，单位为毫秒</span></span><br></pre></td></tr></table></figure><h2 id="4、创建接口">4、创建接口</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 构造AI中台请求接口</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk，微信：Cizai_，邮箱：zang.dromara.org &lt;br/&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2024/2/5 &lt;br/&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Copyright</span> 博客：https://eliauku.gitee.io/  ||  per aspera and astra &lt;br/&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AIMiddlePlatform</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostRequest(url =&quot;$&#123;gemini.proxies&#125;&quot; + &quot;?&quot; + &quot;key=&quot; + &quot;$&#123;gemini.key&#125;&quot;,</span></span><br><span class="line"><span class="meta">    headers = &#123;&quot;Accept: text/event-stream&quot;,&quot;User-Agent: fastchat Client&quot;&#125;)</span></span><br><span class="line">    InputStream <span class="title function_">intelligentQA</span><span class="params">(<span class="meta">@JSONBody</span> JSONObject params)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5、调用接口">5、调用接口</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk，微信：Cizai_，邮箱：zang.dromara.org &lt;br/&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2024/2/18 &lt;br/&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Copyright</span> 博客：https://eliauku.gitee.io/  ||  per aspera and astra &lt;br/&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AiController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AIMiddlePlatform aimiddlePlatform;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">ExecutorService</span> <span class="variable">nonBlockingService</span> <span class="operator">=</span> Executors.newCachedThreadPool();</span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/ai&quot;,produces = MediaType.TEXT_EVENT_STREAM_VALUE)</span></span><br><span class="line">    <span class="keyword">public</span> SseEmitter <span class="title function_">ai</span><span class="params">(<span class="meta">@RequestParam</span> String text)</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">SseEmitter</span> <span class="variable">sseEmitter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SseEmitter</span>();</span><br><span class="line"></span><br><span class="line">        nonBlockingService.execute(() -&gt; &#123;</span><br><span class="line">            <span class="comment">// 使用Jackson构建JSON对象</span></span><br><span class="line">            <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">            <span class="type">ObjectNode</span> <span class="variable">textPart</span> <span class="operator">=</span> mapper.createObjectNode().put(<span class="string">&quot;text&quot;</span>, text);</span><br><span class="line"></span><br><span class="line">            <span class="type">ArrayNode</span> <span class="variable">partsArray</span> <span class="operator">=</span> mapper.createArrayNode().add(textPart);</span><br><span class="line">            <span class="type">ObjectNode</span> <span class="variable">contentsObject</span> <span class="operator">=</span> mapper.createObjectNode().set(<span class="string">&quot;parts&quot;</span>, partsArray);</span><br><span class="line">            <span class="type">ArrayNode</span> <span class="variable">contentsArray</span> <span class="operator">=</span> mapper.createArrayNode().add(contentsObject);</span><br><span class="line">            <span class="type">ObjectNode</span> <span class="variable">requestBody</span> <span class="operator">=</span> mapper.createObjectNode().set(<span class="string">&quot;contents&quot;</span>, contentsArray);</span><br><span class="line"></span><br><span class="line">            <span class="type">InputStream</span> <span class="variable">result</span> <span class="operator">=</span> aimiddlePlatform.intelligentQA(requestBody);</span><br><span class="line"></span><br><span class="line">            <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">            <span class="keyword">try</span> (<span class="type">BufferedReader</span> <span class="variable">br</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(result, <span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">                 <span class="type">JsonParser</span> <span class="variable">parser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JsonFactory</span>(mapper).createParser(br)) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">while</span> (!parser.isClosed()) &#123;</span><br><span class="line">                    <span class="type">JsonToken</span> <span class="variable">jsonToken</span> <span class="operator">=</span> parser.nextToken();</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (jsonToken == <span class="literal">null</span>) &#123;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (JsonToken.FIELD_NAME.equals(jsonToken) &amp;&amp; <span class="string">&quot;text&quot;</span>.equals(parser.getCurrentName())) &#123;</span><br><span class="line">                        parser.nextToken(); <span class="comment">// 移动到字段值</span></span><br><span class="line">                        sb.append(parser.getValueAsString()).append(<span class="string">&quot;\n&quot;</span>); <span class="comment">// 收集&quot;text&quot;字段的值</span></span><br><span class="line">                        System.out.println(parser.getValueAsString());</span><br><span class="line">                        sseEmitter.send(parser.getValueAsString());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">finally</span> &#123;</span><br><span class="line">                sseEmitter.complete();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sseEmitter;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这样就可以得到流式相应的结果了。<br><img src="https://zang-1307996497.cos.ap-beijing.myqcloud.com/undefined20240218154111.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> chat </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解决缓存穿透、缓存雪崩和缓存击穿</title>
      <link href="/posts/c41f22e7.html"/>
      <url>/posts/c41f22e7.html</url>
      
        <content type="html"><![CDATA[<h2 id="1、实际场景">1、实际场景</h2><blockquote><p>有一个短链接跳转的sass系统，假设客户很多，在短链接进行跳转时肯定会用到redis这就涉及到了缓存穿透 缓存雪崩 缓存击穿等问题</p></blockquote><h3 id="1-1、有关短链接的解释如下">1.1、有关短链接的解释如下</h3><p>短链接平台是一种在线服务，它将长的网址（URL）转换为更短的链接。这些短链接更便于分享，特别是在字符数有限的环境中，比如社交媒体平台。使用短链接平台不仅可以节省空间，还可以提供额外的功能，如点击统计、自定义短链接、以及访问控制等。<br>短链接的典型格式是由平台的域名加上一串字符组成，这串字符代表了原始的长链接。当用户点击这个短链接时，短链接平台会自动将用户重定向到原始的长链接所指向的网页。这个过程对用户来说是透明的，他们可能根本意识不到链接已经被转换和重定向了。<br>短链接平台的一些常见应用包括但不限于：</p><ul><li>在社交媒体上分享链接，尤其是在Twitter这样字符限制的平台上。</li><li>在印刷材料上，如名片或广告，使用短链接可以节省空间，同时也便于记忆。</li><li>跟踪营销活动的效果，通过不同的短链接来跟踪点击率和用户行为。</li><li>为了美观或保密目的，隐藏原始链接的复杂性或长度。</li></ul><h3 id="1-2、有关缓存击穿、雪崩与穿透">1.2、有关缓存击穿、雪崩与穿透</h3><p>Redis作为一种常用的内存数据存储系统，经常被用作缓存来提高数据访问的速度和效率。然而，在使用Redis作为缓存时，可能会遇到几种典型的问题，包括缓存穿透、缓存雪崩和缓存击穿。这些问题都可能对系统的性能和稳定性产生负面影响。下面分别解释这三种情况：</p><h4 id="1-2-1、缓存穿透">1.2.1、缓存穿透</h4><p>缓存穿透是指查询一个数据库中不存在的数据。由于缓存是不命中的，每次查询都会穿过缓存去查询数据库。如果有大量这样的查询，数据库就会受到很大的压力。缓存穿透的一个典型场景是恶意用户故意查询不存在的数据，使得数据库压力增大。</p><p>解决办法:</p><ul><li>布隆过滤器: 使用布隆过滤器预先过滤掉可能不存在的数据请求。</li><li>缓存空对象: 当数据库中查询不到数据时，仍然将这个查询的结果（空对象）缓存起来，并设置一个较短的过期时间。</li></ul><h4 id="1-2-2、缓存雪崩">1.2.2、缓存雪崩</h4><p>缓存雪崩是指在某一个时间点，由于大量的缓存同时过期，导致原本应该命中缓存的请求都落到了数据库上，从而引发数据库瞬时压力过大。这种情况可能由缓存服务器重启或者大量缓存设置了相同的过期时间引起。</p><p>解决办法:</p><ul><li>设置不同的过期时间: 使缓存的过期时间分散开，避免同时大量缓存过期。</li><li>缓存预热: 在缓存到期前，提前对缓存进行更新。<br>使用高可用的缓存架构: 比如使用Redis集群来提高缓存系统的稳定性。</li></ul><h4 id="1-2-3、缓存击穿">1.2.3、缓存击穿</h4><p>缓存击穿与缓存穿透不同，它是指缓存中有这个数据，但是已经过期，此时有大量并发请求这个数据。因为缓存没有命中，所有的请求都去数据库查询数据，然后重新设置到缓存中，这可能会对数据库造成巨大压力。</p><p>解决办法:</p><ul><li>设置热点数据永不过期: 对于一些经常被大量访问的热点数据，可以设置其永不过期。</li><li>互斥锁: 当缓存失效时，不是所有的请求都去数据库加载数据，而是使用某种机制（如分布式锁）保证只有一个请求去数据库加载数据，其他请求等待。</li></ul><h2 id="2、如何解决">2、如何解决</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">restoreUrl</span><span class="params">(String shortUri, ServletRequest request, ServletResponse response)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取完整短链接</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">fullShortUrl</span> <span class="operator">=</span> request.getServerName() + <span class="string">&quot;/&quot;</span> + shortUri;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 从缓存中获取短链接所对应的完整链接</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">originalLink</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(String.format(RedisKeyConstant.GOTO_SHORT_LINK_KEY, fullShortUrl));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 缓存存在的话直接进行短链接跳转</span></span><br><span class="line">        <span class="keyword">if</span> (Opp.ofStr(originalLink).isPresent()) &#123;</span><br><span class="line"></span><br><span class="line">            ((HttpServletResponse) response).sendRedirect(originalLink);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 从布隆过滤器中查看有没有这个短链接</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">boolean</span> <span class="variable">contains</span> <span class="operator">=</span> shortUriCreateCachePenetrationBloomFilter.contains(fullShortUrl);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!contains)&#123;</span><br><span class="line">            <span class="comment">// 不存在的话直接跳转自定义404界面</span></span><br><span class="line">            ((HttpServletResponse) response).sendRedirect(<span class="string">&quot;/page/notfound&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果存在于布隆过滤器，可能存在误判。所以缓存中存放了一个数据库中短链接是否为null的</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">link</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(String.format(RedisKeyConstant.GOTO_NULL_SHORT_LINK_KEY, fullShortUrl));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果为null的话还是直接跳转自定义404界面</span></span><br><span class="line">        <span class="keyword">if</span> (Opp.ofStr(link).isPresent()) &#123;</span><br><span class="line">            ((HttpServletResponse) response).sendRedirect(<span class="string">&quot;/page/notfound&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 添加分布式锁</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">RLock</span> <span class="variable">lock</span> <span class="operator">=</span> redissonClient.getLock(String.format(RedisKeyConstant.LOCK_GOTO_SHORT_LINK_KEY, fullShortUrl));</span><br><span class="line"></span><br><span class="line">        lock.lock();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 加锁之后再去缓存中判断一次</span></span><br><span class="line">            originalLink = stringRedisTemplate.opsForValue().get(String.format(RedisKeyConstant.GOTO_SHORT_LINK_KEY, fullShortUrl));</span><br><span class="line">            <span class="keyword">if</span> (Opp.ofStr(originalLink).isPresent()) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 如果存在直接跳转</span></span><br><span class="line">                ((HttpServletResponse) response).sendRedirect(originalLink);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 如果不存在的话，去数据库中查询</span></span><br><span class="line">            <span class="keyword">final</span> <span class="type">ShortLinkGotoDO</span> <span class="variable">shortLinkGotoDO</span> <span class="operator">=</span> One.of(ShortLinkGotoDO::getFullShortUrl).eq(fullShortUrl).query();</span><br><span class="line">            <span class="keyword">if</span> (shortLinkGotoDO == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="comment">// 如果数据库不存在的话存放一个临时的空值，防止缓存穿透</span></span><br><span class="line">                stringRedisTemplate.opsForValue().set(String.format(RedisKeyConstant.GOTO_NULL_SHORT_LINK_KEY, fullShortUrl), <span class="string">&quot;-&quot;</span>,<span class="number">30</span> , TimeUnit.SECONDS);</span><br><span class="line">                ((HttpServletResponse) response).sendRedirect(<span class="string">&quot;/page/notfound&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 从数据库获取完整短链接</span></span><br><span class="line">            <span class="keyword">final</span> <span class="type">ShortLinkDO</span> <span class="variable">shortLinkDO</span> <span class="operator">=</span> One.of(ShortLinkDO::getGid).eq(shortLinkGotoDO.getGid()).condition(w -&gt; w.eq(ShortLinkDO::getFullShortUrl, fullShortUrl).eq(ShortLinkDO::getEnableStatus, <span class="number">0</span>)).query();</span><br><span class="line">            <span class="keyword">if</span> (Opp.of(shortLinkDO).isPresent()) &#123;</span><br><span class="line">                <span class="comment">// 判断短链接是否已经过期</span></span><br><span class="line">                <span class="keyword">if</span> (shortLinkDO.getValidDate() != <span class="literal">null</span> &amp;&amp; shortLinkDO.getValidDate().before(<span class="keyword">new</span> <span class="title class_">Date</span>())) &#123;</span><br><span class="line">                    <span class="comment">// 证明已经过期</span></span><br><span class="line">                    stringRedisTemplate.opsForValue().set(String.format(RedisKeyConstant.GOTO_NULL_SHORT_LINK_KEY, fullShortUrl), <span class="string">&quot;-&quot;</span>, <span class="number">30</span>, TimeUnit.MINUTES);</span><br><span class="line">                    ((HttpServletResponse) response).sendRedirect(<span class="string">&quot;/page/notfound&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 如果数据库存在的话设置缓存到redis，并进行跳转</span></span><br><span class="line">                stringRedisTemplate.opsForValue()</span><br><span class="line">                        .set(</span><br><span class="line">                                String.format(RedisKeyConstant.GOTO_SHORT_LINK_KEY,</span><br><span class="line">                                        fullShortUrl),</span><br><span class="line">                                shortLinkDO.getOriginUrl(),</span><br><span class="line">                                LinkUtil.getLinkCacheValidTime(shortLinkDO.getValidDate()));</span><br><span class="line">                ((HttpServletResponse) response).sendRedirect(shortLinkDO.getOriginUrl());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">            lock.unlock();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br></pre></td></tr></table></figure><p>对应的时序图<br><img src="https://zang-1307996497.cos.ap-beijing.myqcloud.com/undefined20240130110133.png" alt=""></p><h2 id="3、代码逐行解析">3、代码逐行解析</h2><h3 id="3-1、获取短链接">3.1、获取短链接</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">String</span> <span class="variable">fullShortUrl</span> <span class="operator">=</span> request.getServerName() + <span class="string">&quot;/&quot;</span> + shortUri;</span><br></pre></td></tr></table></figure><blockquote><p>这行代码拼接了服务器的名称和短链接的唯一标识符shortUri来构成完整的短链接fullShortUrl。</p></blockquote><h3 id="3-2、从缓存中获取原始链接">3.2、从缓存中获取原始链接</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">originalLink</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(String.format(RedisKeyConstant.GOTO_SHORT_LINK_KEY, fullShortUrl));</span><br></pre></td></tr></table></figure><blockquote><p>这行代码尝试从Redis缓存中获取短链接所对应的原始链接。这是为了减少对数据库的访问，提高响应速度。</p></blockquote><h3 id="3-3、缓存存在检查">3.3、缓存存在检查</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (Opp.ofStr(originalLink).isPresent()) &#123;</span><br><span class="line">    ((HttpServletResponse) response).sendRedirect(originalLink);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>如果缓存中存在原始链接，则直接重定向到原始链接，这一步骤帮助防止缓存击穿。</p></blockquote><h3 id="3-4、布隆过滤器检查">3.4、布隆过滤器检查</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">boolean</span> <span class="variable">contains</span> <span class="operator">=</span> shortUriCreateCachePenetrationBloomFilter.contains(fullShortUrl);</span><br></pre></td></tr></table></figure><blockquote><p>这行代码使用布隆过滤器检查短链接是否存在，这是为了防止缓存穿透，即防止恶意用户通过不断请求不存在的短链接来使得服务直接访问数据库。</p></blockquote><h3 id="3-5、布隆过滤器不存在处理">3.5、布隆过滤器不存在处理</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!contains) &#123;</span><br><span class="line">    ((HttpServletResponse) response).sendRedirect(<span class="string">&quot;/page/notfound&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>如果布隆过滤器判断短链接不存在，则直接重定向到404页面，避免了对数据库的无效访问。</p></blockquote><h3 id="3-6、缓存为空值检查">3.6、缓存为空值检查</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">String</span> <span class="variable">link</span> <span class="operator">=</span> stringRedisTemplate.opsForValue().get(String.format(RedisKeyConstant.GOTO_NULL_SHORT_LINK_KEY, fullShortUrl));</span><br></pre></td></tr></table></figure><blockquote><p>这行代码检查是否缓存了一个表示数据库中没有对应记录的空值，这是为了处理布隆过滤器的误判。</p></blockquote><h3 id="3-7、重定向到404页面">3.7、重定向到404页面</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (Opp.ofStr(link).isPresent()) &#123;</span><br><span class="line">    ((HttpServletResponse) response).sendRedirect(<span class="string">&quot;/page/notfound&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>如果缓存中存储了一个表示短链接在数据库中不存在的值，则直接重定向到404页面。</p></blockquote><h3 id="3-8、添加分布式锁">3.8、添加分布式锁</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">RLock</span> <span class="variable">lock</span> <span class="operator">=</span> redissonClient.getLock(String.format(RedisKeyConstant.LOCK_GOTO_SHORT_LINK_KEY, fullShortUrl));</span><br></pre></td></tr></table></figure><blockquote><p>这行代码为当前操作的短链接添加了一个分布式锁，这是为了防止缓存击穿，即在缓存失效的瞬间，大量的并发请求直接打到数据库。</p></blockquote><h3 id="3-9、锁定和再次检查缓存">3.9、锁定和再次检查缓存</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">lock.lock();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    originalLink = stringRedisTemplate.opsForValue().get(String.format(RedisKeyConstant.GOTO_SHORT_LINK_KEY, fullShortUrl));</span><br><span class="line">    <span class="keyword">if</span> (Opp.ofStr(originalLink).isPresent()) &#123;</span><br><span class="line">        ((HttpServletResponse) response).sendRedirect(originalLink);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p>这部分代码首先对短链接加锁，然后再次检查缓存，如果这时候缓存中存在原始链接，则直接重定向，这可以处理高并发下的缓存击穿问题。</p></blockquote><h3 id="3-10、数据库查询和缓存更新">3.10、数据库查询和缓存更新</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">ShortLinkGotoDO</span> <span class="variable">shortLinkGotoDO</span> <span class="operator">=</span> One.of(ShortLinkGotoDO::getFullShortUrl).eq(fullShortUrl).query();</span><br></pre></td></tr></table></figure><blockquote><p>如果缓存中没有找到原始链接，代码会继续从数据库查询。这里使用了某种ORM框架的查询语法来获取短链接对应的数据对象。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (shortLinkGotoDO == <span class="literal">null</span>) &#123;</span><br><span class="line">    stringRedisTemplate.opsForValue().set(String.format(RedisKeyConstant.GOTO_NULL_SHORT_LINK_KEY, fullShortUrl), <span class="string">&quot;-&quot;</span>,<span class="number">30</span> , TimeUnit.SECONDS);</span><br><span class="line">    ((HttpServletResponse) response).sendRedirect(<span class="string">&quot;/page/notfound&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>如果数据库中也不存在该短链接，则在缓存中设置一个短期的空值并重定向到404页面，这是为了防止缓存穿透。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">ShortLinkDO</span> <span class="variable">shortLinkDO</span> <span class="operator">=</span> One.of(ShortLinkDO::getGid).eq(shortLinkGotoDO.getGid()).condition(w -&gt; w.eq(ShortLinkDO::getFullShortUrl, fullShortUrl).eq(ShortLinkDO::getEnableStatus, <span class="number">0</span>)).query();</span><br></pre></td></tr></table></figure><blockquote><p>这行代码进一步查询获取短链接的详细信息。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (Opp.of(shortLinkDO).isPresent()) &#123;</span><br><span class="line">    <span class="keyword">if</span> (shortLinkDO.getValidDate() != <span class="literal">null</span> &amp;&amp; shortLinkDO.getValidDate().before(<span class="keyword">new</span> <span class="title class_">Date</span>())) &#123;</span><br><span class="line">        stringRedisTemplate.opsForValue().set(String.format(RedisKeyConstant.GOTO_NULL_SHORT_LINK_KEY, fullShortUrl), <span class="string">&quot;-&quot;</span>, <span class="number">30</span>, TimeUnit.MINUTES);</span><br><span class="line">        ((HttpServletResponse) response).sendRedirect(<span class="string">&quot;/page/notfound&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    stringRedisTemplate.opsForValue()</span><br><span class="line">            .set(</span><br><span class="line">                    String.format(RedisKeyConstant.GOTO_SHORT_LINK_KEY,</span><br><span class="line">                            fullShortUrl),</span><br><span class="line">                            shortLinkDO.getOriginUrl(),</span><br><span class="line">                            LinkUtil.getLinkCacheValidTime(shortLinkDO.getValidDate()));</span><br><span class="line">    ((HttpServletResponse) response).sendRedirect(shortLinkDO.getOriginUrl());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>如果查询到短链接且未过期，则更新缓存并重定向到原始链接，这样可以防止后续的缓存穿透和击穿问题。</p></blockquote><h3 id="3-11、释放分布式锁">3.11、释放分布式锁</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    lock.unlock();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>最后释放分布式锁，以允许其他线程处理其他短链接。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 缓存穿透 缓存雪崩 缓存击穿 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gitlab仓库代码迁移</title>
      <link href="/posts/683dabc3.html"/>
      <url>/posts/683dabc3.html</url>
      
        <content type="html"><![CDATA[<h2 id="1、导出仓库数据">1、导出仓库数据</h2><blockquote><ol><li>登录gitlab进入项目</li><li>点击左下角的settings</li><li>找到最下方的Advanced 点击右边的Expand 进行点击</li><li>点击之后找到Export project按钮</li></ol></blockquote><h2 id="2、导入仓库数据">2、导入仓库数据</h2><blockquote><ol><li>首先需要创建一个项目</li><li>然后点击New project</li><li>选择Import project</li><li>然后会选择想要从哪个git平台进行导入</li><li>选择之后会让你选择导入的项目名称，以及所在的组</li><li>最后选择文件点击Import project 然后稍等一会就导入完成啦</li></ol></blockquote>]]></content>
      
      
      <categories>
          
          <category> gitlab </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小技巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Ioc/Aop框架如何集成FolkMQ</title>
      <link href="/posts/9cac72b9.html"/>
      <url>/posts/9cac72b9.html</url>
      
        <content type="html"><![CDATA[<h2 id="1、部署FolkMQ">1、部署FolkMQ</h2><blockquote><p>这里我是使用的docker-compose部署的，如果是本地部署，请自行修改docker-compose.yml文件<br>现在我使用的版本是1.0.20</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">    <span class="attr">folkmq-server:</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">noearorg/folkmq-server:1.0.20</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">folkmq-server</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="number">8602</span><span class="string">:8602</span></span><br><span class="line">            <span class="bullet">-</span> <span class="number">18602</span><span class="string">:18602</span></span><br><span class="line">        <span class="attr">volumes:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./data/broker:/data</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">./logs/broker:/logs</span></span><br><span class="line">        <span class="attr">environment:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">folkmq.admin=zangzang</span>  <span class="comment">#管理后台密码</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">folkmq.access.folk=sk1</span> <span class="comment">#消息访问账号，可以配置多个</span></span><br><span class="line"><span class="comment">#      - folkmq.access.ak2=sk2</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">TZ=Asia/Shanghai</span>  </span><br></pre></td></tr></table></figure><blockquote><p>然后执行</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d folkmq-server</span><br></pre></td></tr></table></figure><h2 id="2、使用FolkMQ">2、使用FolkMQ</h2><h3 id="1、引入依赖">1、引入依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.noear<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>folkmq-transport-netty<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.20<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2、application-yml中配置">2、application.yml中配置</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="attr">folkmq:</span></span><br><span class="line">  <span class="attr">server:</span> <span class="string">&#x27;folkmq://127.0.0.1:18602?ak=folk&amp;sk=sk1&#x27;</span></span><br><span class="line">  <span class="attr">consumerGroup:</span> <span class="string">&#x27;Cizai&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="3、如何订阅配置">3、如何订阅配置</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023/12/6 15:42</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FolkMQConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MqClient <span class="title function_">initClient</span><span class="params">(<span class="meta">@Value(&quot;$&#123;folkmq.server&#125;&quot;)</span> String serverUrl,</span></span><br><span class="line"><span class="params">                               <span class="meta">@Value(&quot;$&#123;folkmq.consumerGroup&#125;&quot;)</span> String consumerGroup,</span></span><br><span class="line"><span class="params">                               <span class="meta">@Autowired</span> Map&lt;String, MqConsumeHandler&gt; subscriptionMap)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// 构建客户端</span></span><br><span class="line">        <span class="type">MqClient</span> <span class="variable">client</span> <span class="operator">=</span> FolkMQ.createClient(serverUrl).connect();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 订阅</span></span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, MqConsumeHandler&gt; subscription : subscriptionMap.entrySet()) &#123;</span><br><span class="line">            client.subscribe(subscription.getKey(), consumerGroup, subscription.getValue());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> client;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4、注册消费者">4、注册消费者</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023/12/14 10:32</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component(TestConsumer.TOPIC)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">EventTestConsume</span> <span class="keyword">implements</span> <span class="title class_">MqConsumeHandler</span>, TestConsumer &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(EventTestConsume.class);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">consume</span><span class="params">(MqMessageReceived message)</span> &#123;</span><br><span class="line"></span><br><span class="line">        logger.info(<span class="string">&quot;EventTestConsume.consume: &quot;</span> + message);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5、生产者发送消息">5、生产者发送消息</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> MqClient mqClient;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * test</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> message 消息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 发送结果</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> Exception 异常</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/api/folkMQ/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;String&gt; <span class="title function_">test</span><span class="params">(<span class="meta">@RequestParam</span> String message)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">    mqClient.publishAsync(TestConsumer.TOPIC, <span class="keyword">new</span> <span class="title class_">MqMessage</span>(message));</span><br><span class="line">    <span class="keyword">return</span> Results.success(<span class="string">&quot;成功发送消息&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> FolkMQ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 中间件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用SSE对接清华chatGLM模型</title>
      <link href="/posts/a0c3992a.html"/>
      <url>/posts/a0c3992a.html</url>
      
        <content type="html"><![CDATA[<h2 id="1、前端基本代码">1、前端基本代码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- 输入框，用于输入消息。当按下回车键时，触发 handleSendEvent 方法 --&gt;</span><br><span class="line">  &lt;input v-model=&quot;input&quot; @keydown.enter=&quot;handleSendEvent&quot; &gt;</span><br><span class="line">  &lt;!-- 发送按钮，点击时触发 handleSendEvent 方法 --&gt;</span><br><span class="line">  &lt;button @click=&quot;handleSendEvent&quot;&gt;发送信息&lt;/button&gt;</span><br><span class="line">  &lt;!-- 显示从服务器接收的消息 --&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &#123;&#123;message&#125;&#125;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup lang=&quot;ts&quot;&gt;</span><br><span class="line">import &#123;ref&#125; from &#x27;vue&#x27;</span><br><span class="line"></span><br><span class="line">// 使用 ref 创建一个响应式的变量 message 来存储从服务器接收的消息</span><br><span class="line">const message = ref(&#x27;&#x27;)</span><br><span class="line">// 使用 ref 创建一个响应式的变量 input 来存储用户输入的消息</span><br><span class="line">const input = ref(&#x27;&#x27;)</span><br><span class="line"></span><br><span class="line">// 处理发送事件的函数</span><br><span class="line">function handleSendEvent()&#123;</span><br><span class="line">  // 如果输入为空，则显示警告并返回</span><br><span class="line">  if(!input.value)&#123;</span><br><span class="line">    alert(&#x27;内容为空&#x27;);</span><br><span class="line">    return</span><br><span class="line">  &#125;</span><br><span class="line">  // 清空显示的消息</span><br><span class="line">  message.value = &#x27;&#x27;;</span><br><span class="line">  // 创建一个新的 EventSource 实例来监听服务器发送的事件</span><br><span class="line">  // `/api/chatgpt/test?message=$&#123;input.value&#125;` 是向服务器发送的请求，包含用户输入的消息</span><br><span class="line">  const evtSource = new EventSource(`/api/chatgpt/test?message=$&#123;input.value&#125;`);</span><br><span class="line">  // 清空输入框</span><br><span class="line">  input.value = &#x27;&#x27;;</span><br><span class="line">  // 当收到消息时的处理函数</span><br><span class="line">  evtSource.onmessage = (event) =&gt; &#123;</span><br><span class="line">    console.log(&#x27;onmessage&#x27;,event.data)</span><br><span class="line">    // 解析从服务器接收的数据，并更新 message 变量来显示消息</span><br><span class="line">    message.value += JSON.parse(event.data)?.choices[0].delta.content;</span><br><span class="line">  &#125;</span><br><span class="line">  // 如果连接出错，关闭 EventSource</span><br><span class="line">  evtSource.onerror = () =&gt; &#123;</span><br><span class="line">    console.log(&#x27;onerror&#x27;)</span><br><span class="line">    evtSource.close();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="2、后端代码">2、后端代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 处理与OpenAI API的实时交互，并通过Server-Sent Events (SSE) 返回数据。</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> message 用户发送的消息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> SseEmitter 用于发送实时事件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> Exception 如果在处理请求时发生异常</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/api/chatgpt/test&quot;, produces = MediaType.TEXT_EVENT_STREAM_VALUE)</span></span><br><span class="line"><span class="keyword">public</span> SseEmitter <span class="title function_">testChatGpt</span><span class="params">(<span class="meta">@RequestParam</span> String message)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建一个SseEmitter实例，超时时间设置为无限</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">SseEmitter</span> <span class="variable">emitter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SseEmitter</span>(Long.MAX_VALUE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用线程池执行任务</span></span><br><span class="line">    executorService.execute(() -&gt; &#123;</span><br><span class="line">        <span class="comment">// 构建与OpenAI API通信的请求</span></span><br><span class="line">        <span class="type">CompletionRequest</span> <span class="variable">request</span> <span class="operator">=</span> CompletionRequest.builder()</span><br><span class="line">                .stream(<span class="literal">true</span>)</span><br><span class="line">                .messages(Collections.singletonList(Message.builder().role(CompletionRequest.Role.USER).content(message).build()))</span><br><span class="line">                .model(CompletionRequest.Model.CHATGLM_TURBO.getCode())</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建一个CountDownLatch以等待异步操作完成</span></span><br><span class="line">        <span class="type">CountDownLatch</span> <span class="variable">countDownLatch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 尝试发送请求并处理响应</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            openAiSession.completions(request, <span class="keyword">new</span> <span class="title class_">EventSourceListener</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onEvent</span><span class="params">(EventSource eventSource, <span class="meta">@Nullable</span> String id, <span class="meta">@Nullable</span> String type, String data)</span> &#123;</span><br><span class="line">                    <span class="comment">// 检查是否收到完成标记</span></span><br><span class="line">                    <span class="keyword">if</span> (<span class="string">&quot;[DONE]&quot;</span>.equalsIgnoreCase(data)) &#123;</span><br><span class="line">                        log.info(<span class="string">&quot;OpenAI 应答完成&quot;</span>);</span><br><span class="line">                        <span class="keyword">return</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 解析OpenAI的响应</span></span><br><span class="line">                    <span class="type">CompletionResponse</span> <span class="variable">chatCompletionResponse</span> <span class="operator">=</span> JSON.parseObject(data, CompletionResponse.class);</span><br><span class="line">                    List&lt;ChatChoice&gt; choices = chatCompletionResponse.getChoices();</span><br><span class="line">                    <span class="keyword">for</span> (ChatChoice chatChoice : choices) &#123;</span><br><span class="line">                        <span class="type">Message</span> <span class="variable">delta</span> <span class="operator">=</span> chatChoice.getDelta();</span><br><span class="line">                        <span class="comment">// 忽略助理的角色消息</span></span><br><span class="line">                        <span class="keyword">if</span> (CompletionRequest.Role.ASSISTANT.getCode().equals(delta.getRole())) <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">                        <span class="comment">// 检查是否应该结束响应</span></span><br><span class="line">                        <span class="type">String</span> <span class="variable">finishReason</span> <span class="operator">=</span> chatChoice.getFinishReason();</span><br><span class="line">                        <span class="keyword">if</span> (StringUtils.isNoneBlank(finishReason) &amp;&amp; <span class="string">&quot;stop&quot;</span>.equalsIgnoreCase(finishReason)) &#123;</span><br><span class="line">                            <span class="keyword">return</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            <span class="comment">// 向客户端发送数据</span></span><br><span class="line">                            emitter.send(data);</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                        &#125;</span><br><span class="line">                        log.info(<span class="string">&quot;测试结果：&#123;&#125;&quot;</span>, delta.getContent());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClosed</span><span class="params">(EventSource eventSource)</span> &#123;</span><br><span class="line">                    log.info(<span class="string">&quot;对话完成&quot;</span>);</span><br><span class="line">                    emitter.complete(); <span class="comment">// 确保SSE流被正确关闭</span></span><br><span class="line">                    countDownLatch.countDown();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onFailure</span><span class="params">(EventSource eventSource, <span class="meta">@Nullable</span> Throwable t, <span class="meta">@Nullable</span> Response response)</span> &#123;</span><br><span class="line">                    <span class="comment">// 在发生错误时完成SSE流并记录错误</span></span><br><span class="line">                    emitter.completeWithError(t);</span><br><span class="line">                    log.info(<span class="string">&quot;对话异常&quot;</span>);</span><br><span class="line">                    countDownLatch.countDown();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 等待直到对话完成</span></span><br><span class="line">            countDownLatch.await();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> emitter;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> chat </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>有关mysql编码的奇怪小知识</title>
      <link href="/posts/30e1d389.html"/>
      <url>/posts/30e1d389.html</url>
      
        <content type="html"><![CDATA[<p>当我们数据库User表中有一条数据的name='Zang’时，我们执行查询语句</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> name <span class="operator">=</span> <span class="string">&#x27;zang&#x27;</span>;</span><br></pre></td></tr></table></figure><p>这样的话还是会查询到一条数据，这是因为当我们的数据库字段编码使用的是utf8mb4时他是忽略大小写的</p><p>如果我们要对某个字段严格区分大小写的查询，我们可以将其更改为utf8的编码格式</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> xxx.t_user MODIFY name <span class="type">VARCHAR</span>(<span class="number">8</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 数据库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>序列化中的循环引用</title>
      <link href="/posts/7f7e7cfd.html"/>
      <url>/posts/7f7e7cfd.html</url>
      
        <content type="html"><![CDATA[<h1>1、前言</h1><p>在使用Neo4j-ogm时，对于自定义的NodeEntity和NodeRelation存在循环引用的关系时，在jackson序列化时会导致序列化失败，使用一个注解用来解决循环引用。</p><h1>2、实体类</h1><ul><li>NodeEntity节点对象</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@org</span>.neo4j.ogm.annotation.NodeEntity(label = <span class="string">&quot;ENTITY&quot;</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NodeEntity</span> <span class="keyword">extends</span> <span class="title class_">Neo4jAbstractBaseEntity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...省略其他字段</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 指向当前实例的节点</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Relationship(type = &quot;RELATION&quot;, direction = Relationship.INCOMING)</span></span><br><span class="line">    <span class="keyword">private</span> Set&lt;NodeRelation&gt; fromEntity;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当前实例指向的节点</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Relationship(type = &quot;RELATION&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Set&lt;NodeRelation&gt; toEntity;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>NodeRelation关系对象</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RelationshipEntity(type = &quot;RELATION&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NodeRelation</span> <span class="keyword">extends</span> <span class="title class_">Neo4jAbstractBaseEntity</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...省略其他字段</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发出关系的实例</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@StartNode</span></span><br><span class="line">    <span class="keyword">private</span> NodeEntity start;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关系终止的实例</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@EndNode</span></span><br><span class="line">    <span class="keyword">private</span> NodeEntity end;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1>3、@JsonIdentityInfo注解</h1><p>@JsonIdentityInfo 是 Jackson 库中的一个注解，用于处理对象之间的循环引用问题，同时还可以在 JSON 序列化和反序列化过程中保留对象的身份信息。这对于处理复杂对象图（例如，存在相互引用的对象）</p><h2 id="3-1-基本使用">3.1 基本使用</h2><ol><li><p>指定注解：您需要在实体类上添加 @JsonIdentityInfo 注解。</p></li><li><p>选择生成器：该注解需要一个生成器（generator）来生成对象的唯一标识符。常用的生成器是 ObjectIdGenerators.PropertyGenerator，它允许您指定一个字段作为唯一标识符。</p></li><li><p>指定属性：使用 property 属性指定一个字段名，这个字段将在序列化时作为对象的唯一标识符。这个字段不必是实体的一部分，Jackson 会自动处理它。</p></li></ol><h2 id="3-2-使用示例">3.2 使用示例</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JsonIdentityInfo(</span></span><br><span class="line"><span class="meta">  generator = ObjectIdGenerators.PropertyGenerator.class, </span></span><br><span class="line"><span class="meta">  property = &quot;id&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NodeEntity</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="comment">// 其他字段和关系</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@JsonIdentityInfo(</span></span><br><span class="line"><span class="meta">  generator = ObjectIdGenerators.PropertyGenerator.class, </span></span><br><span class="line"><span class="meta">  property = &quot;id&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">NodeRelation</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> NodeEntity fromEntity;</span><br><span class="line">    <span class="keyword">private</span> NodeEntity toEntity;</span><br><span class="line">    <span class="comment">// 其他字段</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>在这个示例中，id 字段用作每个 NodeEntity 和 NodeRelation 对象的唯一标识符。当 Jackson 序列化这些对象时，它会自动处理它们之间的相互引用，避免了循环引用的问题。</p><h2 id="3-3-注意事项">3.3 注意事项</h2><ul><li><p><strong>唯一标识符：</strong> 确保您用于 property 的字段在所有实例中是唯一的。</p></li><li><p><strong>对象图的复杂性：</strong> 尽管 @JsonIdentityInfo 可以解决循环引用问题，但对于非常复杂的对象图，仍然可能需要其他的处理策略。</p></li><li><p><strong>一致性：</strong> 确保在所有相关的类上一致地应用此注解，以保证整个序列化/反序列化过程的一致性。</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> jackson </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 序列化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何防止缓存穿透</title>
      <link href="/posts/ce54e34f.html"/>
      <url>/posts/ce54e34f.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试!" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="6b15cd7f03a72f479ca2cd3fe42d2e7efb9b17568a27a7db5e824e91a74639be">2ddec83a87db3033ff4ab408c7ae30ff2eee36628ac8c932ee1030cdd143b94204c5fcd8d2cfe967a7227e27a68795b5991929eb85a28d95a165a354db53287508d42b9441211c37d8cf9d7bd9e93a9f1a1fe6a9e6fad971e97260aeec316c87e91d4a990f64a6f54b071724a1e99d6442f670c3481c1415563343c4d4d101cf54214282fc669caeebda5270bd9a0f569f61cac23093675277339c0875906dd648515545d7d57b65cac551912ad57150ebac240a7278ed0ea2a299342c467d84118fc75567f243ee8dfc655914e0deb7ad56bf252fb97997483e561f8cf2dbbf2a0abe3875d6b8d0bc96262f0fa4e0a681b5636d054b4a7aab51937b1502a0a6c99c516589b5472456f12a136d80a0bdb075f9b4797e3add9da40da8e418c936371b21cb81c18ab2e4eee2f8e35fb206d71f68054df96cf60af292a571dac3872e34322b2f264280be5d0314f000f41e10b76b6d698b77abbb51f82aee750bff6e0dc27edc8eb97537e8202e1feb37c79025715ef32c9639ff75b1f6bf3d5ef1cf1de7ac9eb16fd8eeed693c4cf7374ceaca1cd5da444b5fa0b13217a2ad2dd267cc691689e5d39fe157f178c89c242e7422ec5f0e61f224224d2b5c68fed0c0616ecffe7e3fce548d21f7333709d77432721cc6cfd312e41564adf5029ee4466614daf7c2c4b01d50b2c76f67baf9fb223c314e71ae5ade72c15980d464b9156d9336a85c14e312dc355e5589f9218f35b6f1339c685a05b6df5fa1297e5a87343d74d84dd148f4b4cf6b259db581629d9da61231e75e17a5a783e31efe63b77c5b47648e8da77deb88f29391788354f45eb95f836de200ae85ac405a14db372354e7907a0c87187dfd824cdce5d76c01441f99a3d44968a1fe6b981739b0dbeea6939fcc5d277e5901bd9252be39a72413d9279a52a0fe2b9c5f1774058847cf88ed87f39cc00ab78a9a2ff200de52c02e2c30efe4f3f5e94664bbb6e807352a00525ab317205c097acd388b5c9799771480702cf98cd14f6b45146dd29db3ba27b1ce71e5de9a2e59e0b6c6e56c1b87397d00e72710ac7518c9d82a5b889a3aaf542d974393be13b8d6c7b7e28c324bd8074e0db00d0f00b75d37ef0caf22756f2073da232a8de8b314185c52e8ddf638206553cde896fe6423664ceedc328a6c7e5dfe66842e49cebdfb096225d6dc11723ff5480152207ea904495b7baa0b73ee941fcb7952fe637ff63a52a29f482cac28884ce0f7826ad781c49eb883bbff731fdfc87a5cefa7adbca5ad8cef69bab03a43da46611b12b73619dbd85ca8e2be1e03cb7d3b3411eac65e5a04e86883b06446c1ebcefaacd992481f88d047e6c5f05a348a862a8178f5304c66ece27eb59070eb11b306fdf89e9df4c2ef03975d37d25ea285d4cec65f7a101d00ea24f0b9264035db833db724a147f558d47107fc4d6f598fe1995be00d6ff64b8d2d0f8dd9f15635d1c7dae538e5a7a6093ba82e1004af6a6224f1afb7e608f8413adcabe7e1e9f5146d074ea897c5a6236775b2ae3fafd2936bd203e7b857b9a7133f30a9886d8beb8fda7f868d706e8f2f840d8d974c01bf738672415a66529983b21369754f597394354e46942347d7ffa875d6006fc975eeef585a59becf549783db78f518ccd8e2570ab4443acdbef744a108d1d1daf70543b31c37e6b39f0c85f9f975440bde726b1740f6e455626c974c932d14b07c695b78c07b690c840b74f080008888c70e824ed13c2d398ce90fa390410c94fda2f2b7228ff312d5a445754420142f569486be9b85515e33ba528985639f1c2541bdc37100a0a462e2c5e3a78301e28d7375a76c9bbee434888377e2fdea70b6b34aa14be6033fb1b7a8399c80162500eb8895970d626b0793fbf2a76713eb6f58098da42dea8d7c6c9b9fbc78364745b3bceb39d9937768022911d73c02d387089130663a3693478be5b9561b5beb0bfd9e9e2e996f0374584364765a0a94a974acf67f314bade22cbe77e1a095eca4821e6940af99b7593650b403d943d57eddf1e2ab7bc7631333fe6142bc94877211b22b9a7018df48ebf1e6e1eeb34c1a028b5d63ad0179c20fb69ae73036bc59be81f3ec39db7581b2fc3e050ab180607f611c183be79978c2b8116b70b6b0fc5e56b8140b011642e06de38ba011dd5b29c0585d2745b2a0a6aa4095a51c86e07dedbfcefd708d0507c83ae0afbf3ee3bc26af52dbe02995d57b1b942fe45881ef4dee989a514ec5540c81075f0e49822aa7ec35b6f0e7f349681b1492a651cbdf3ae568244e1c0091e5a62ecf8a61a737afbd01ab80d35f215db0fbea478019cc38ceed8a4b7d05ff5a2167c8022f611d18032dfb67b6a5fe4d3faea9a8cdf05445e0a8265f895e5d045c2555d4a12614abbc686d556fbd1b065d072be755bd0bfccc1c7b0c2eeda46644104beefb1cf17375e1467adcf5e404fc34f6d9e316cc1a9c2d8031fc6bcc37410d00fa1c7cba4de144b9e3547a7ee8621afcd90461afbffccf9a7cfab49ef16437533db31ef69cc9f3bfa1b600d1b1aac305eafe9cab442d2b8809750c53903803e1aabdba80b212634550ee7e076923c681f60ffe35061497e1a726e7854b1834a49355833de3b310a7490c2f1f09b45df40e0f1dd43f8367d3457696714643ae0932005b0af99bb5f62d52391f9067591dba991064ec0af17e2e38beed4108686a8675ea03a9ff8d665e047797a58d67f47fa4f4a2f420b70521c2165db022f4eac35850a050e16e578000a08261b2325be72fa86e21d711dbe42b3a6d3051f38f63f991b493670610c2d9e0f4af878da4e84051540c550d9e50ca0909afc161fdd2e2af1ef1c44b5883d5395ff1e5be1143e6d67cdc2893cfa087ebaf0990c8a04cc2f2390177d3fce112c2caba1ac7e3e5e4553d8d3d003444c4d1c11a90ab09fc76c31dbcefdb735c233d0f2abea3a3d3509d3c8447833d8377b05f3a28d1c1cbe02e5a54292c1dc5bea0c91e3ac2e6209f709029e981f5dd9fa55bd170164aa1993903a58a7248f8bf2203f99a8a52ad0b875b0095e9372f66204603da80ab6f005d3def9a08189f63af2c57e6450a80bf65ff207493aaff7dbfb8e84b3e1c6edab6a0a372dbf6f6a687eb84b4e92c83bafa668b3f1ded62d6d869d68ea7872703e20c6185acc36944355b673c47cac4ae16688004434975d497fb220f0443fc90b8ebb486c8f3ea1cc4148034591f9841a9af4813311da4f9e2a933d18d56079f693ee23431f08bf404a98431a875956ba1dae4c7940fd70cee9db6b5b9fcf3329294248ffd8d28f72706c617f1d75e9f10b326a5df9c11463c03b139d5d18cf2004c3db6ae66064083cf4a0c0e96bf8ac0e38f187e287437c8d62f3da8b651b5b0374ab81c67db6b9098ffa7da9c1495448010d59e25d9903d880b63a4496f1b467ac726eb8357c80caeacf6872f3e976a2b9daa7efe4a1158f7224ee85058598f5660be66cbb050980e6edc97ffc40772f77c0f42f3ea5a855ed2cd5b4ac5ebf41e7807fff9dd8299fffb4671f8cc6aa44df3bc261a032a040d74041b9e5edc2450298575971e8ac1f8d82305908ed35d067ddb40d5888e2d45973ed728c7330a9853315ba05b43645533bb2e8c4c408fe856b8516255ac3e853aaaa273806c91d05159dc7e25fa0a36afbe7e07cc19688be391488d81d5de5669b8a532e9d60a1505095e8844513ee85cdf963d376a667ca24c5f8c28fbfc091682386f836ed57765acc28d0be828cb4efc9f2d86d0c68337bb8fd93921ea1c597f0772667e12e4bc32a7167e174c216f9738506738ee3a2f8ec6505daaccc1b907b2a480986d8bca66f6b6fe8e59715f2c734a82ef5557135c881fb303ee6a7be3bb6380a719bcfd3347a51560c6027525c6ebcead9c499392202a1b7543946866fad7385908157fec65d0822808959abcd5ccff82793f4c6c6f6cdaa43c2abd67fbd7b7eefbbc3ded5b413a8129c23431bcd0f1a1f90bed73f86be74738a8a3bd2bdf9c70471f5a06181e4f639da3c1705147872dac676e9572d01303ee0edfceba8d578ab4b34940d047b39435c8337d78a34e3ac6d551d55af4ea4d1a3583309122e55f7397d49be0d3dbd280f5a0bf9b1ed656441c6abd50aa7b0ccd0fe871ee88de0df0540209b9c9ecff939af7f087d11ea71135d5983c9e4553b67a3313ebabaf17c4c1f5a46faa819a29c75953d86d14709e6e61e1fd649d115d2777d21efe201bbb81dacef434eaadc5cdbb63ec4de96cb70cbd2365e9c1f61caab817ffa5e10c9e9c36b758e3964730991cad6bf03cfcdc93189688764eff2dd31d7fa5f42c9be05cf975ff267bdbcfed3dbdd2e66627b6baa873854332a5d43d0b4b1fdf786f5d79a6b54338f3904b5f2346c8eb8889490c35e3f9120796fbc06b58a3d6b2db2af36e09b1d1d10d30b91b9a2c1e2c8200129d43caba29cb91e8bbde61f443e79f1f198d3efdd96cc18be961424f3ad912d284c40d7b38dd5106ed1cd194acfe7cf434da22b71fb41f28daad0baae463524cd162387a09eb26c871d779da33b5891ae4c3fafcf6d4c76e052935033bf5b805d9336c135a9f0d8cfa1c8cccb8da3a1bed230ec05ba5858f278d3fd7d0bfe24742fb97e77e828bc8ef5a272eba6cd70f53025e948c276d49f1b3b202b63ea7b90ed8540ac3694cbf88e1def7e9a40e1c783ed08acc91ec280373aeb782c5791d296ed67d1087cae4c685ce99a4098cf3383c8afd8b387d3d8ac18a033f7f2ed43f4a9e614748451ff0e64341f214ff193deeab70073b223eb125f76da66b0c1b154c398af5d618810cd928ef1f7cc24848431e039bb8a85c4be299b81339cbcee0df6f74fdf7a72256cea4e960b9a20746c26a9e335ca31c34b31c26be7d93768067ba874a115fdd945f566edec0a587dad39277314896f12afdde0a4d3e12a456c7d97f62fa7594e2578620fd4b507d8814e4bbf9561dda7f0cadd8b4cb6fc5af3bc7a945175dac12ba93c70b89f0ce230a0c07f4a268071bd33e7f63fc5605b3aa73080629be2d836e6173e3a80f22e8c06768e6742062d12d45bbdfb0d8836914a4149daf54a4092a636611ebb54363e5adc1aa0ce5f082d650dda454f0d2620c78bc8adf79d537ef2532fb2d44603092f92ec519f7f5d75c20c27a449123c7fdc7f3712a0db9f1c3c6422d851ac1e2659c487865b26df48727498779e0854d8e1ae8b64374e6f2d82adc130bb89361e5f5888bf835b227a33ccfaecc966ba777c43fe4f1712168bf9fdab6a2711e33300545ec09b580416ebde9f6df913295f742e5ec6b21071b1d62429c04e16ecaa330243a37dd3a69a22773220d18e2069a9569c0459c4cda0cfa4fb8e44bd0f6375cdd2aedd12126135f31fa787513b54f8e582c2c328c8c1630395afa3315ade22369f449123b73abacc7ee0c9458597b57df20078f59f59f65ff4f1ed8925ef3addad0d8ba8a0b91022d09e60abd6970b1a020e231aa2459386a144eab58d0e25881d2705f8986a59d1d1d6aef5ecf1b3276f1729c68c9dccc29deaf242c0bde48710e0824a6512e7793667b85fe6188cd0504ec7b6273deaafb5ef9650b144144fb8fa15a9cb928626cc2974b4dc67f5e760e4795d6e12de809bde33ef39fd1b6bc1e0ab8d7cb25f410b033437074a3bb4b8f4c94093c1ee6cd9a8e3ed89c141d4801686fbc813e13f6d7a6e784214c5a59e33d5d727b98de3e33509f03271c8ff7bf6e03c3fd6336518f93fe035286383678a66d9c035342ca7e150896613c6ee6ba0789b251bd90cd487fb96957e220427b91386dff963eb469afbad663511bab9ceb89fe9ce8f7a62c32a506082b00f8161c6e2321299f868fceb8e4fac62b528947999536c63148dd9d5e54c80f69fe0ffafffbb75cebe3eb61927fdd9fc61ee8a88db012eab89b8ebf177db520cc521ac4e24b15dfbae816aa6c3fd265d681c0bce8b315688b829e844d72cac6598ed896872707b6f7e3852874afc67937bf3d3542be9c654d840fbce5e8bec08cc438235d5aaad2d48cde3326ae5aa00e02342cf67430d202030e984c44ea7e80bee95b20a507a82c712f58865b58be43467760fca3508acbdb984fbfd294d831bad69cd5ee4a528594c9f6356bc8e5df731d661607ac9b30fe47b35bea5d4a1769c5b70eb745d1767b3f8349055eee8e729f6244a12964336b6ff6305c040f606167839a87ebe279b4ad35d0a6afd9c87c34357630ec5e4a1ca22bb542da8db71edf20b99a031e3892305ade7e586a6c379582aa342996b6fa707f2d8da1cf109cb3b0f5bf9719ca5705ccf9c3633c57e1fdf5a5f316bb7589318d7ddcc4ed9d125015e5975340fc59703e6ee7fdc78b8c4ec74c37a2c3e626c7576ee7a60451bbef87c2288ec97a273f6d67a4fbaad49af53dd845094af759f06255528ba45197310febd0189931e1a8aa6389e74d97de608b14a9b77ff74144608dfd68db65e7d8b63a3b5bfe58ae8d2fb54226448836062a999e46ed97b0e40452f3e26a4b95cc4d8cb599e12ae6b71e947e7db99e33019c781329abedb33f08d5afed089ee88b1046f40758a5d54d767196fadd7143641f96a3c418f574164fe802f14276b2ab2dba14ef4206de7b4505885bb298d0cff03efa8cf47130d6288f6c61fa4395620636edf2728faa346d9b1e08f2a2e29800837ee8014910be1ab7ecf9c9d2b6c97923bc46403c5a2f1862dbd1a3d74f6518037a2b7db9213edd806020eabb92a43e3dcd463683a7eed96b82de6e0124205227a3e8009020c05a05adf928ebdcf2d752c7439798d1831ca8f3e80472274406e918a1b6873e53050380cb893223bc9ffd1f4ff0b8110c1e86238ea772854cfd1f2f53547b578f63d0656b31120619355aca96409a2a37263f94a99b775e6ff500a17bc50906a483280c23318b3c0a5db1ab6e82f82f5aeab9083bb969e74682149ea1afaeed12589457223315a70d55ce3f4e5e1ccbdfb433535d1dd0c93f619f2bc9b9591c6963020df2fcf9f4095c279bd3558d9acb84e524a74d33d9b0a02d1558d14cea77d05470119f261af5611375798fcee3b448f2b3b4e7d5ecfece2d71c801688bfb7e47e173882fc1bbe56e2156fb335a908884d6a0cffb7a001221c46bfae702206d25d467094b91f4df5aa65b15d1762ac47d5b29c9e4a2947459272a1fecf2d359f0383f0e8159a39a82939c6b9769c4770e5048c3a1cfcf488323ef4345427e614c2ec3540bf437a6a6a671469cff38a081c6f4985bef343536f01b51b417fb41aea529221f9287247a866b7d4ffe70bb46d29aed9ebb9ac798c86fb0dc07509c14346ed60f374671da4c673038d2036745b8ac2ac09a982c08073d1b37d07dc76782c9ebc41ed354965b53ef6897d88444a66e6717e282bbc369db208c21582281ef5cb8d375ff92231a1db3f7f34f71aad710916ba513b03ba1a0b1b2986dd83015df269a33d3b3b5ff1d6a0173490bd231d7feab9253aa0e31914a9a9f2146e30d33792380300e4f4ce98bbc90c27da8cf8d549b4f3273b083dc8381bb8803216648d891016aa2d59f6d8cacaf70f52ed711ee18d0d343e516218c8868cb5486b6bea877e0b67ba4a5eafdb310f50e54eb02340054b20bcea2f3ceeb89b07b516da86ebd00be1b86bac32854c0f12eeadbd552719252f425548ec5bca5e1412201e697474693e23a4c5c2f93a217212df17e53bda1762ec50c7b095e5eed9d0945b208ced66a0a4126630b2feeacbc504b6faa72a80aef524da6c32a6a3b535560306240c8935c5520a9d08664f2723302116a5141821e523f42dc74965103f3565ed5fb5a85589ce7d2d64089c01a04074a68a0c3942d9d2b9de82247de02b124ec967e8ea7afed18d2125d3690bbc315fe1bf53ce80f582b29a770f861cfc3c3305b9b3913ddad1a7816ca39d2605dc2a65041584958648331f0d6b4e785b4ceba4f567c9c2c03b4e02904be7657793b2c6913c4d151a10c84167021736b620210704d48b1411632fa845836bb955b577d8024ac2114b6aadce5b95a8dd6646139b15d1bdb2acc743e8dc95d61b4261dc9b3c8b4f87ea6c3d29a1d673b59dac1c3bbd60fc631c57af091677a7b08e120f0e2a130a64540fed0147a905cd73f74771d1e580cb7a5f26fde338450305250d08217fa54002388cf6070169f186433e7374c81f2012c85cf20977ca571daf403ca6e0e41a2d0d0c9ba476a02d5dc7f891a8db810980293a9a08d0b7980d82ccc6587dc8e75d8434b4a4e6fc7fa868f8c75f980dfb14ffa5510be8e77783ed6b919c194f484f934d500a5f097deb5921508d7dcc3917650a1e163219a41af3fe5c39ed1f7770eff5c3c36f5b473ee20998631dfcc1f6a20181791c363a671c19ca55b147250f86614664ef7cc9a678b844ff0641605e3b7c4c83cd8d8861abd02a5087c1444d9f6a742a30b3b2a29faf65ab1b74dc4235492f6fd3b7793c39a444b2e7489fb5ca410fd10c7545944e7937879858c46f48be894b9a7150c6668f81705e8863e08c58bfa451d2d027a0b75d72abb4829ff7e08ab7edeaf8a077efd09f6d606541ca21b69c19ec16ec2ed2bfae11de7b7c2e993620114167bb52392781c0730a715255f97509b5b0579eb418dda24cb07d3a79a86e96c25cbdd9e90de3ec63c857cdea54dc182fe6b099245f39cffe1ac9018afa4923110a4f2f7bb6d744f1dc4fa5123e0dcca48748b19296c1664c2b5d669ea959e0bed529d29eb441a8396be62ba3809228fa1d39c927255a7de22989de0a15af05b9ce8a9fb013459af4f109b86b61f68f848279353f7eb6c63676ed75e40e643ff13a4fed8fce2f466f94d5a26f2d0133c03e101cd8124e1a577c3db2351df733d02ed94a13f2525c98819f5a584199564b8cfb057bf46f7fd0f67a523c02527bcc2357aa3be6a13c8fb1f20a4d06cf798f5af79e3b1732c8d9b1d764632933c1f306132d89300616431521c16a3ec93b2a7a0bc840066cf06a7e529c10a7b9701b48bd0c405d7acd59c881ed8f17ad4bc53b77b37d0f817458146bc20a160dc3b59c12b23ac0e1bac353df8c16e9f93932558b55efe499149f419102f569da2ee4ba5181633155405cf508c459c7d6ee8136e0177d4f06a4eaf4e17fe54194bd2c3839dd54433ea3c560d13024352e526e8543a047610d764b03fe34ada0dd4e490da26861a750aa9fe0ee54b79c71b926bd78b63e5f8bc896a520d39492a54ebca97719e16943cb1b7d54028b6ef17dd00177f7850f2e94dee10f2e525de60af1dfc18c5bef576ad387e49ab8c63eb75ab310c03a2dea2aa52a5def9ab65d31d5ddca5222eb14e769b7fd43b91b490387d0061b1803047541923ed89129137d1bf188560bb3287ded4d3567ddea7d8be935b2b7ebf2f7c806335b01b5aff9576404034506de39a9216d0bdd177e41e9cfa38d70f96939bc3baa271868e835d1c3c113a64c02147545f41c861cf7007c60611991e0fcd03af1d238b087267da30ca6d73c2fc2133299e88a23dd696378818199d028e2711ba3ad78815842dcd5be507d99dd3c21389e68bfba94cb0b6aa0a8cb40aa650b7aebf2a003905cfeb3e5eac5b9f68ce250470504e221bc801a230f0002749571c6bbf30ecd0826855a1225fd8a0ffd335574ebdf98e384ad2a079bfc905b69d0c959feb36fb18a7beac086d6496078a6d809750e8ad7bed95fac413c13926fcf81e1cd291d538c8ab8e7a25caae0f77ffcab0b79052ef0d789618b5c76684ec11565eea5ae58603389826b73fac1c4d3382449dedc517b99f7576929e835d68ace281513cab006ea906d1d2f654bb07ad06a2e098acfef218ebdce5e910d7183fcaecd4535856b448774897a1506f1209c4ca88f0ccbe30e4fa42eb525ceace6ffc777a54e9ef67ede609c156a128b3d752d25db196f70b3593d8eadf8261862284d6bd3a43dd8d36262aa176fc9c91b101ab5fa1868e3062ff44a2c295b3fc7c5149743f14fc2a0de0e612c79518d3fcf3db6e139445b7e1af4d32059b811835e04137932632350b9940cbd166ad0e850f4efffe8eb90d0d36be649deb6b957a0fb824e16fa54e7f1f178acb806bca9b19ea871a871a48c0a404185b51250b8bc456ad8226c66f9008fce047c486995d35776d9ae6b3a6f0ed5a05cf5cfc91f05ccddd781b8db4d96cdbddd688e32f46ca1e00e0fd3995cbbfa5739bb2e5d9c401ecf7eb1506981678634bae75757bf336b965a936110363d1b0c3df8a608f50345e1d3914ae07942811ee71c03168af52a6ae65480a7b6a1a7782df635021be69dca4918fe4ccd7002d80efb8508e574d141f25571437abaeee3938cb3d2908cac13e94075683bb94296f8469414abfc4fa766abba78f0c4d0528fa087cce791de8416dd886d8ac39da9c72b0533b6f2b782b574b9a6144ee0c2258db7db956082c9e223b71ced09d32cb793832bf067c553aa6a8da66700a701067bbbe5520da6352fa1d57fab0c0e0b68e10f0dbe3d73f1ae62ded3c8791e55f428d031278b338514e9b29980083729d8e54e17967693da5181902ef55a898c2fcb4b2b65456d18c761cff7e71421dbf98bc552e717c6577939afbf03b7d80d6aa4b952975c6e450ed5767ef26c0c95f5fbdb56136b31049771cc591661b17f505487b48bff6f26d9b54cc03bd86e5358713855646d0f17199b12960ccc2fe18e3133c34b711319ef711c4f340b8c926cb01aad884b4f2a7c1a839f4edee33978412afb3bc7b3005a785152bb040c3049d241b0aabeee37b16d87d46e00c84bf0962df4c7c79cb948495970cc7265a66405b5e22ff478608fd5b05986e163de3c221f43966032c77bb5e10edd2efe7b525d70fb3b0acef5d439f348c35765e4e2988250b12f4d55f6722e241484ce044fdaaa20a21d08c39b90613ad239ee9bb03f15766c2720ad46f2544cbcae7d8ddf0c770fb82f5c18fb5aac8ab23e98e9fd188d76f425f94518a6ca7b245aae82dbcc1cacb06bbe1147a16280c7a931b15cc018dd8f44c3b2b8df79be45e7a2a307494fed920fc57ed78003eb8dd4659f217bd8dee3fdae6e13ce241b7731bbb5f64c4bea118eb7c36b5b3fe2c87fb627da26a599a829bbfe138cfaa2203e9c3e1363fbbf520b9456840ff903b72d1931f5efc8017e084332761220319b277b59475f276deeec7d14742edc8f138dc6158375c703cd705c05e13c1f5b0bd6c775d06723d54ce5aadaabf75287bb1c77bccf6d5e37b130b1c4f1779a4587ce95193e6220ee912f098e106edba5d2e3ab2f95b77eb52cadf8f76d09a0b8b159b6131b20676a22d5f518296de62e97008756973593986fafc9966cd0ddb1229c4ce06d844b52eaa8ce1342d56a0baf6e6bc9d133691d2afb5abfd5f8b60387e13effad59712afefe30ca7c318e7abb8ca09cc03cf723c3340e95baa02044bd99dde848e119ac87fdb35052cb0ee1139c3846f988ecc10dbe3275e3a7daed41e8de89e140d6f0b07547046597d08af68452d090c2d59244d9b7d1419b877033ff41a157bc7176bbe97303ef95d2d9ffe26d3951da0f830bd2f609f2da846f36575b3c05bd0aae0b9df1847f5b8e5b070df976f6e98d008a6d6c89d7a8da572032ba4f35299a475004190186190dff80cb5aaaacdf74cbc6cf53a42f99c162a1a4b1ec80fc795e232760f2542771acba0e02c6806b3ec628f56914bfc1b7de37123f81bb7f3bccf6b215ac2fb59bad983f813b59466512763f046fc53100b88d89eea4c8bcd52c44d34055dd9bb3130ffbb504bfbdc7d2d29724db90496ca940500ffb3abe4f88a6b9960a1b6f1f85f4c33cf314352984d8adb19150786d8c9223087487b050368501f907c82b88a7de1870a921de7f3bd70876ad293b15d9edbb189aa43e2f0b39ca66f2e6d309dd6543eaa990097b664b2dd3bb6ced8f0916488b22f2805172eedb708177a56b871a94cdaf2824c9c56c62f1161510fdc5412a5fdae2b1ae67c49fa69b14f50497c05e3ffcfb9adcbeae7aed0617da7c3359373d5ea1bb7320b180b0ae935b977700e35e7011ebb8ae0b1aaf9ae2cd5b4232b52845f02318c7c46569c402406b35bd070fa6be4f2e79806c5538dacb2f5262310d73cc8adc7c3aa50fb91db9df6ea0bc6968d4c69d498f88c5a09d4b198b6389c31c47921c1c496589a9a71179543cd02bd0a528239f7bf3d87c2dc7163ba94cf1f076d8b0fec13c30d3b048220e63d8464a0810c464f1bd695abf6c1d02937fda7ef365e9236b7e5ab411668409e8b898329a1784793b2fd02ffeaceed2f6716eaa0c910caab63b99b66f4239cf2dfde004e0226fa410d99552e9a777bc9a4c6e00f43e13783e7357e7f0f625d05963772175a3e7dad002e232b2588e5d394c5e7513f2688c3c1ac9385193e19206a632082e2285c8659ad61a71daf8718daa7ca5f532bb6d9295e88b10da7b017c82d1621bcbd2998931dbf2f595ea4aa5583fb2f42bb0a48e3f4519dd7d077f30ce7d6a4b5a8b789b5e1fe7c38e5c5b2409b071e905e735d9b8611ba4d8c7a030b014e41c151657f9b2a8c7bae47abc54958f99fdd8258046b63f1654f6361615c0ab9366f084e4bcfd1fcf70fdc5e623289ecc307be37b22250f2edb8b1bcdc7f2f9dad086b27c22d7ad3bc7c5372b904c0b0ce55131805427d18bc29ce67286894ff634860140b3bea40050dbf4dbf62a02095005d0f29e9422768f77b581a5a5b9164d0450cc1ea2a48aaeb274196fc2d18d7911b0c45dcbcb9bfbc2e9c4b16b268f90da140fde318c264040d61b7378eacca164959599757df6ad34401c40ff128607ea61dad6d62b8ba95d623e7af6e5fdca6e3ae1b3a2d7e7f58b89b81d11c5e69dd6f136d1274d4c4a158319ef6272434f6c17eba567beb299389866a549ac64ae5a701c8c91b7793275deaf526018c3dab44516633f29f1d4a8b382cdf2b6b3c2bccce618128ce93769a04782a9219742fa7f36f71906b0b8bc165dd54ffdf27aa76fbfe398699b35e9a33f5f678d02db92a2f02e81d5cebd8fc70c01ebe4a30eede1b1606bae640e6128b82b7ab266be285aca31f04cee202faa4335dc932bbfc9bbeb78f8dd9ef9b80ef61e036a3d8117684f33835b83443bc5e5b6928d94aeaf1bc7cb72814c8a002d0f7bff4245e67920a4ed7970cec1c4f2af2d9ea36a0f3d8b64bce9c093470473f48475497cb34c655417590af5c6827380cbe3295ed2b991f260efb8b49d339ca2ef318e1def06321d36113075fdfa34f8cca5b2e8929ad9c7310b085e1da05e031d904fa2129f6d17ac6b81d7de5bdc9272c332badcbc855365af1d5c58c6e721250bdf88badc2daf1dd9a4211bb10bdb8fb87b416e3ad9dff4979443ad0223f2c3af7f536e108a167639694fb1746466d6055d88f10078f63647e81b64e264c8b3bc5d3323c2c7cfe26da0444941c97833c46bad7a1771d0500273b38b61c34d006dc8b8e65095f2cae31b11a587e05d3e4bc3d5b2493a2a41e1350e38c61efc7188ca90b388f79537ffebe14b27aba7506f6e58e7c854158cea0e4f7131d396be255e104492be8c310610fd98dbd1d3bda7966a4cc183d5c6875ba66f2d566c3813973e36e9e030193d8d40ea47456119ed18247335263e210e75bcbf9acfe5df8ce44a59fffcfb453d081d2cca3e2ffe2840a52b0cded5dac252023820832b700c09869fa7e496c42cc70a35c9fc82a889e4af3eee569e36c76e30a05fe331c747fd16a26bd579f481ff32d9d5c5b171bee996c7b55b2c857df4e47a65c64c2df9ebf309e5fb8cefb39f5d6a29168770a567a05eb7e1ed08c080b09bf4559f06a62c98ab2df074e59df478f6833543d410aff0cb6be7a55f9fd7030643e0ef1bcebfaf587fe9d692fce8a2fec53fc523ee3792bba91671c45bfd284517ab2e009215af3ea50e743ff309d77ba0ec323ac1607c7f09de83a27d5c4fd96a86ad9e5f85d472484222883b5cb98399822b7a830e12600e133b21c43513cc52385c470229c73c3c44c61b6df3aee74641a587233513ef6b5fd16baea21cc035d78f167dcd51d7db0b3872b27680cb0b87efebad14a5cf30dc6c36a3adaf7b569d42140fd2ede0be0109bcd07f00379131073025769ac7a82fffd2529ba5d91131a9b128f07a67da16522970be96e3f670028a29e08ec956132d91e6bd51c84e3af26f23068c95fd529e97945f31fce98495507cf755bee4f8abc7400c561522f9c76b488883243b010f1036a6e0342851a654ca0c2442eb54a997b6342dd0e742248314c337674d49c67e12c65168a054c4d575eb6dcb0bf917ab0ed31c22a054b08156e0b00a92fdbdbc170e5c0b96cda27759fd7be311681a2edeb3b5729b886f4dd6f65fe5643e0f93fccd0caac03f1edbd18043320d60486694a2bc73c6347fc9141d4f9ffb8f26c57e940c9e51d14886b12c494a4bc5e8763cbf083</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">私有文章，仅供自己学习使用。</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 缓存穿透 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 布隆过滤器 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Stream-Query兼容JDK17</title>
      <link href="/posts/ce54e34d.html"/>
      <url>/posts/ce54e34d.html</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> 开源 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dromara </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Stream-Query兼容JDK17</title>
      <link href="/posts/ce54e34d.html"/>
      <url>/posts/ce54e34d.html</url>
      
        <content type="html"><![CDATA[<h2 id="swig￼6"><div class="tip warning faa-horizontal animated"><p>1、升级之后的问题</p></div></h2><blockquote><p>在升级到JDK17的过程中遇到了一些问题<br>1、比如在设置属性可修改时碰到了一些问题</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * return accessible accessibleObject</span></span><br><span class="line"><span class="comment">   *</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> accessibleObject accessibleObject method</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@param</span> &lt;$ACCESSIBLE_OBJECT&gt; a $ACCESSIBLE_OBJECT class</span></span><br><span class="line"><span class="comment">   * <span class="doctag">@return</span> accessibleObject</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> &lt;$ACCESSIBLE_OBJECT <span class="keyword">extends</span> <span class="title class_">AccessibleObject</span>&gt; $ACCESSIBLE_OBJECT <span class="title function_">accessible</span><span class="params">(</span></span><br><span class="line"><span class="params">      $ACCESSIBLE_OBJECT accessibleObject)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (accessibleObject.isAccessible()) &#123;</span><br><span class="line">      <span class="keyword">return</span> accessibleObject;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> AccessController.doPrivileged(</span><br><span class="line">        (PrivilegedAction&lt;$ACCESSIBLE_OBJECT&gt;)</span><br><span class="line">            () -&gt; &#123;</span><br><span class="line">              accessibleObject.setAccessible(<span class="literal">true</span>);</span><br><span class="line">              <span class="keyword">return</span> accessibleObject;</span><br><span class="line">            &#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><blockquote><p>上述是源代码，然后产生的问题是</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.lang.reflect.InaccessibleObjectException: Unable to make field private static final long java.lang.invoke.MethodType.serialVersionUID accessible: module java.base does not &quot;opens java.lang.invoke&quot; to unnamed module @6cc4c815</span><br></pre></td></tr></table></figure><blockquote><p>在网上查阅资料得知是因为在jkd9版本及以上版本中，Java平台模块化系统（JPMS）引入了更严格的访问控制。即使通过反射API调用setAccessible(true)试图强制访问某个类的私有成员，<br>如果包含该成员的模块没有显式地向调用者模块开放(opens)相应的包，那么尝试访问该成员时将会抛出IllegalAccessException。</p></blockquote><h2 id="2、解决">2、解决</h2><h3 id="1、来自-CSDN">1、来自(CSDN)</h3><blockquote><p>在网上(CSDN)看到了好多说什么把JDK版本降到8就解决了（好像在脱了裤子放屁一样）</p></blockquote><h3 id="2、一些正确的可用的解决方法">2、一些正确的可用的解决方法</h3><p>网上有一种临时解决办法就是在项目启动的jvm参数中设置以下参数</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--add-opens java.base/java.util=ALL-UNNAMED --add-opens java.base/java.lang=ALL-UNNAMED --add-opens java.base/java.lang.invoke=ALL-UNNAMED</span><br></pre></td></tr></table></figure><blockquote><p>但是作为一个开源项目不能让使用的用户每次启动项目都去手动设置JVM参数，如果这样的化那这个开源项目基本就没人使用了</p></blockquote><h3 id="3、最终解决办法-全自动，可靠，兼容多版本">3、最终解决办法(全自动，可靠，兼容多版本)</h3><h4 id="1、添加属性">1、添加属性</h4><p>为了适配多版本需要使用properties属性</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">surefire.argLine</span>&gt;</span><span class="tag">&lt;/<span class="name">surefire.argLine</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>添加属性，然后根据JDK的版本去添加对应的数据</p></blockquote><h4 id="2、使用属性">2、使用属性</h4><p>引入maven插件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;maven-surefire-plugin.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">testFailureIgnore</span>&gt;</span>true<span class="tag">&lt;/<span class="name">testFailureIgnore</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 使用属性值来配置argLine --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">argLine</span>&gt;</span>$&#123;surefire.argLine&#125;<span class="tag">&lt;/<span class="name">argLine</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3、动态修改启动参数">3、动态修改启动参数</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 这个profile在Java 8或更高版本时激活 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>java8+<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdk</span>&gt;</span>[8,)<span class="tag">&lt;/<span class="name">jdk</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 重写argLine属性为Java 8+的配置 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">surefire.argLine</span>&gt;</span>--add-opens java.base/java.util=ALL-UNNAMED --add-opens java.base/java.lang=ALL-UNNAMED --add-opens java.base/java.lang.invoke=ALL-UNNAMED<span class="tag">&lt;/<span class="name">surefire.argLine</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 开源 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dromara </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>手写幂等性组件库</title>
      <link href="/posts/5858758b.html"/>
      <url>/posts/5858758b.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试!" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="047330c70145f7a14058fbe4d518900d9a8bddc7a3fdafb6427b202162d15677">2ddec83a87db3033ff4ab408c7ae30ff2eee36628ac8c932ee1030cdd143b9428ab18fd6b8347f603dddabf0a33c773dd195438e5b1429c99caa7c2242f65d8fb35fcdc595dd2b3737a4e43fcb7fcf367a0dad5946a6809becc28b93313ba5bc0c08b1356536f676cb1da8d722c37b0fa31175a1c09bf26f7708f6ab7d0a63806a7068b67f5a48dea7a07e3ee575eb8f688b983e895d434f689ca080ca0fb70b30aa883d8bc479b01caa6c1ee60490f56227de1a9d72656ec0e7a1eded337a7b1da43cca16d1da4ddbc9fc982cf11de19d2639228c647edc66618462b0e2eeb10e106ac98e64bbb89d1d5b7ca3f738e796e2a4f3a1748ab33ec62f7daeff4c5f929f31cfc6e0b5f1f125fc435e664b93a3fe090f22df1fc66de60e1bcdef676adf8bf2093ff65f90c7a6e900b36fed23cd321219632f216db2737a78e9640a37718ef5db9ba4af24fe93e51fc7f48c32e9bf28b2a134f63aaa75ceab357a6b0218dd410e2f1d8c5d8169ef338f8605280e8bb282dbf6858a258a41eb22d8c931634dee639dafb9786bdd0e6654b7e1b4e99dc754c2104a37b71a769467904147e82a17ecd78cd1344e41e0a52082a7ea96ab42aba1aaf2f3cadee1cdc68fca9b434f33a7b2c5cfec5e13e9b1912c286153d012aeb3791fc7a7971f4a93ab65ccb13f32fa505e6a24238177bf3ebaee6faebca58cfe26fab9232823dfb0153ce45de5e90df861c50aa8e36fd3fb08450b2c08ae75ada942c07c21d8281133242ee9df8cd970abb418559385b3a2ea8856aadd0233ac1044f22778ffd85bad1cbe51e7107a50316953c1098f1dbd4df02d61fb0e821d377007686d32286c380ec346d6275d093ac0c91165f9399892433613bcab4723bc1466aeb77a8745cb414a3ba419f8c8d0d0196bd2be16a0c8ad72f05ce6a2b55bf8d0dc5e1bf9c4a7cb3d921a31dfd2119cbd1ba637ca8f53e72d0287295a7e637decd9b0bf9ee345bfb87ed8bd96dae23e2f25eedc01233885ae03f064808f8ed219ace16b99dce6f66d4178b94cdc2afa5a4738562f1a6c31701eb9a0d2c433bd8985d20add39f7703bec39dffcd9c817ba42c204fba73aad952ce65f6d55eba6b0ad427098c656f4e97c71a8a9390e44d306427b930ae914cd88ba833c0b17ab1c6fb85b39b87c39017f5c0e5372995c8bdc6911b087b8842a05738d5c9299fa79d9b306adfe419a8067b85112522b36ab2a3b3c569c12d72e7d53217883b08c20e14eebb3c184ddb0e05470ab3b3a9a49380e0f2d846faba0e2c404134367dcb30271d0d2c2d21ab37acf2bc64d6cc30027f3e79f1dc197536bc7cbd05590a7937f0ff2bfdc19f8f358ed965ed69a9649cc7dafca9b1aa9a5cb6022c2eda12f6e9b1f3bb136cc5573257d5861f47f6bedffa7e574184eb4581ca73a4adc0fd9cdb4932003fef2a65b2ebcb2478c976d2989a9dc5137e6616a647e194dfcc500daa125f9d980bf0e5d6f2a9c743d3fc03532feee0b333d9480ae3b13c680eff101bf4f1124c5971cd7eb681d7eae7c8aae9b389d6dbf7c186128821b3a7842efce6f768465a5e561106ae39da429509e365d05b07d6a01aec988b5c4c6031cca296702d978791d71fbe11f11cbeb81349143fac3710bb800541d959b2d3a985134afa4933faff4f47a6e6b6173e1d2d7557231554f573e26e899be6489f32e5cc4a99cf992679fc12fac76f1e78f852de83c721d17a8c4a93622d8189e1983dff21d34b41ceec561193e3562a3766b037318037d24d6aeac4eea35467e9cec220d700e16ba8b904d04f1e25fc5509fe4aa73849d814066eaf6f3a9d1dcf0dd58623a23592f0585ad518d735a0aa340aba64c61b4254ce74e25508735b656eb0805114341fef67aea26165c390142bc17872fa26f71885bde0843af4a3abde03d40c36c3b9ed10c382f4bbbfb66fd27a9cffe03b3003140bddd9b3777cd23ed274cf1bec432ab018e5597953301ecda474b755d941bb9311fcfd08a893e1fdafcce091fa20369b7a0c88938dfb671f8da025136680195dd0084e3b902e2922a1b0834c22eae72e2156ba56abfbc070d187901410cfab3a648733d0c61fc78b93602bceb40984516583ecae45edb6d29a6d8c654a505e91d2ab5bc31aff1e681415b2b537d9192b3478d31c4ea9f3077b3e7826fbd9b9d4c50ab818b342f5a80813ec1215a6b4a01adf7c23c1d971bbbd012af849cca6f26916243bf14f178097dc83634c2c336ceaa788aaeb214c3d54a3d234927a8266bf3f8371485a51907064aa7affa13b35d1b4d55e67f77624cd46c5b0991215dd8233d16fef1d458b432fe2c63d71414ac4610fd0335f238932a299369af704e81beb746f3fc144533a1f7b53593cb78d969ff0606544e3373305e9d1bcce26e2fbc985537c70499349abbc424eb5148cabe5c1d226d173747f97340612b26df5af196a07ea26c589cad1c52c121fdc4443903fa8bc5a0f6a40d37c3c0dec3dd64485966e58374c16f1c57107998965c80df24c108215f04f0fb98d868948e33ea68770ed6b7c37350a2e68db6b0441886d858773959140c8c9e7f431aec76a3a366482c33338660304e6f6d7a72be540e748afc62b5cdd0145cfb093d36ebf9378fe93a9faebec7837aaeab3c8e58c9592790a51fa5fd9275ad24d4db6b60d5d565994615627c11f1d28cee05f58005e98e52bead438f99ff92094b263f2277dbb940581bfd174cd8f72eb6aaa9d4ef5118303aaa221a6cb48642d5d05bb3af943d36907302ad2d88e801e4eca874a481549913bd5da6a8a84520a28a46a4722a4af345a45562a2f25f2b64a3a93fcaf8fdbda11b76eca56fa246ed4603883325e6046fe9959f493f7f1cb3eaf021b9274a2ff9571b87bed62f1f8aafe0c755773bb6baae434530c210b6290ecc24933f162216d0383c69c22fe5e3d8e2ee0a38511ead0c724511802b6de1b4e5952811220cc9a9564f539e309c523ed937a0901e275127a23661b4b94ddd34d4a3f392e271e9d855837712a7c2ec81709473b38279bdeb4d8dbf2033d2f98a81c85de9d6d5effd78ee7ed5ad5bbbc6b6c7d7086afab3ce0fa1d17b1991f6f580b7f8895c695806c5654bf53a5291a5df1453f682f09772af35f6357de62e4b1a551e9e7f2ea8dfb5eb44b808c8301c2489e734a1624505f7bdaaea2a5bf3df54de89a50fbc6c3deae0305f04fe67c8fa6760efd3eb28af015fdc9e772d00301891677d608af5e70607e2df282567f6480af829fca740fa76bca7608a96cb99a6c285f3baad1bdbbe309ec148a21ec4c7c220e4400c304e1c38a73b140c466d33586a1f537bcb648f483c61b4576ad028f367df14250aa719586203b6b65ca55897778a2e67161078b63b1c550db08f2df1b29093df98a5c627072d9e28d7743594e1cdf2e7fd8d52260c9152be8c17d6217d8255cc05cf60a8d7da6a224b8f55acf8062c8ca6bbc7f547b6e373e814e2d37a501bd6b77f6ad80c9557e08c29fedf65865ce47b648dfda9194cfe1323a2064414a5f4de159bc0f33b605d1da91427c781eb0d86f7c4a2fc80df4960327c284e3021a76053a7af1371c6213d716af7f41ed01bb76928bc131963c8204d7163c8f6a28dc9de0f976e8f062179552e143eff143470da9880f39f2f136a36184be8a475fee177e3d9bbf9314be21cdc27d8203b4d844bc65d87fe0dc4761f0ed96b7cc835ff869fd76eddfd0a282ce20b38501b4fcfebe76470337b23ba4caa131bfff157896cf0fa6eba2427c932880aa676424c81321b5085ac49905439fd180d10e12e67dfc69cd9ecde5581d56eda1bd1f4f256ad71afddcdc85e743285bfed64e2c601c70883792ca1abeca195e5be752e99fde041ca20b6685898e8c126db7630c53dcfff2bdee5f01193772e4a4e919949ab4fca512db076ba82bccd8bcb81794596f438c4ba298fbc9405884d169be9ae0d5b789c4a9a31e45c7b63413772a009be7eaef0e55f68ac20fe617e702c36d05c0d92f1d74a988a924948a98b47c2220608466ff86be324be1c0c77f9645107fc5c01141e3d24708ee42359d7e5c0dac2db5d70f2508d34a617e7a1d90ac7a08980f850b1cd575f53bb82c8872e7bc9f402e0761c6e3b24abf77b6dc506699cab3f776a84a07c28a92cdf51c43136a7c81fe7b7407452a5a6dbdda90fd927b35b00c9ba5ee3be6c04bd05bb44f7fa3dbc42a51bd11469f46a7f1a0fd30da05f6e30e9dfda473e5ea07ca2b3dba6b5e6709dadcdcecde16e715aca63d3dc74ecf0d9840474e571c68284f6c537693c0e3bd5d552519bd56887fd14152f2e4d3fec506aedf40facb46fd65d9ea6d34f0e54893e8eeeb580b5346377129268715148b6b906c8f44791da5fd9a9aa5f03d52382db32cc63592763bd898e9937668a7e818709e620dec06a77b6ce62f68ac2614226edf11527eb15405c6c6850f0e41044c71483f50454c8067bc2fba0d8bceb8a990a381429f5db2fa05cf6490e4113fb58f9421392da5415e2906c953d0a96b4a5a031a0d7d1b1ccab09612e0f0315dd84c922d0783ec91454f503496ff67bac8fe79de65919b22ce4bf7a0f07afd29e43b500b1a6e7272af50b4d7c882d0e1294fe3639433213a717bf4f327f37a280417702b0ace8e3b3084f0be1d79b33f4aa1c307be748788c6b91f2370ef693ad7061ac4f5e7b9610c33b92b4406a889ff62e2f58b8a622c128fd2e137f4659d3863956ca28742a15d0cf96f3831fd7c13edeffcf4acc533ecee57774d0efcb19f5ed1d552c7fe274013a193836e79031438f668af2030b29efef1b2afdfdeb1ebc65c2c1def244c8ffdd86d1df7686f9fb9034c962324064d9062993e1e5a0a41d8797499c42d1a771cc73d9055151b3f5731425f3259834c4c3abcc18c14beb21a4b334842a75ebde7c464b30ec857b1e6adcc50d757c10d92cbd10a11ccb4f2c16afd4505e800fdf804b623cf527632186e7c016fcb180c933a958957ace6998c5863faed5d40028d0631776b872369aaedcd249625f3ee86454352bdd271de340ed2e7d2982e4e880e21779f59d9957754cdfa03f5267cdf73be718f5e86e70ebde9d490b653b9aff858acc774588e66ebecd04261586016c853f2e8f4765bd252c6442a4bf223a0a770c3a037ab4ddd51e72805947ab87a12c621ae690240831d7d253319c934f8c53a73d2550554991984c02b34057d5b7db1a62b158bcaad9f0af2eeb2518a8438a5676407b28af4db4432571e5d5211f056a30e1fc4cf4a43a845369670249ab5feba0268e07230d1c1fe8858216424256cd608a6a4bcb291bcc57c95d652159686d3c7fe382cb431525feeb8ed4ed2283d2645647b3e01938006627fccb76425bd35b27610f54a728f2484ec3e5284a9d08c67ef709690127104ba9205435235f64675dfbc1f8f5ba42efc770168bf5eae5d95b3653c13bacf607ef00867031ffe3ecdebd970322173541dc33209332252e58273960e03ea53dca0c245a2edce083ef24bac4ba614a3aa6f0b3049fae46e2f71421c204d67be60fc7c02b4d28f345d42da9368bb73dbaffbba0644b39d61321978236ab9fcb51d10acf76614e8510e87e6a1d11267766d267e7c83caa1dde6bda94db7c8537824c18e3a9e5f71453fb7a715b6592c7e7df5ab42900a7e20a0d75bfb0d84227b0e44c634d023831047ba1b3af3db89f8aa2b5c3437f4c9df5896895e6e322eda81c29eab40c3616fceca043a61557fc94633e122bf9c72b8e4fd8dee6369e1dae06bb4af719a0692806db2f2a96ea0e5e2986c1fdee41d7e306c9f077f9e7932db439c0df7b9f6ed6626ef371314de6419ffe835228150bf62c018901a97087d76659c3076a55d3ef6baf0cea05153ed4dfb899ef9de3141ef5a5a98b9b7566d9f28ee082279f2680ff3c73241e9dd1389ae3bd0af4055ea936902ccfda90aab8eea3068a1c353e97bfffd50589c397970de27a4f1b01930e1df632e7c3172d66636e6b600a1c7174c58f2a88d98c9bc115034afd6b267801ccf1e763c94e2ef034b856374d70afeb8683adb43ad236d5eb838bbc3858fd6f8869faccb42eeb35596e1b3b5dafa8aed00f152b984e4970ff81135355bd5649a2a981247d4739aa482107959bc9467714a8b25d6d777900a19df3c699c8c74e3a94fddceb37e614b8d6d253aaf7c16a219b6c7aceafd3c62a6d8fab817c00ce6ac8e4f6c98670f748562a1cebc64d2784407b25967e22b7368154b7b91f396b154436b673443361c5e0b01612a41c70e43706905b2ac96044444884260d5b8076c40a1a799b6cdf7d8e4408a62552ac5ea63c1a349a3fd8fcd5c0ccda4b5c00068e5509b5753d7fa3b3abe00426aa9af1105228b95632785e6fed53db8f8d0654f970a68f4b107e24224b00a3427872787916f3794095a5077295e128d14b8c4366527ab985a4820094c729821e6a50d6fc812b72db8310b6652f919d3aa96844343dfa51757127aea87c73b4b293847e0a2554173e979a247030880afeb5eda9c06ed144ea53ba66de9d2b98e321a3894e4a6cdb69c82ecc9a34f2c7c87d091b5b8d5670b9af368541d247a440d0d7e4d76c629e5037fee7de94997a5d0a40f6c42f08c694e3fd4cea41849a5249f475e96ca5a017fd41e21396ed11d26926caab55659d5cb9bb84e12caf7fba2fafbe17d367af8f51d2192004a7b232c5401fad50b7ab4d7ee855b887e671a97d7c64a3687cefd74d60ccb22d731cb0caa735af20cc1b6bfe02ebcac15a02b8a041b16889f18020f921792525a7d3be4f851fed57b53f36414e090f307fee0edbe977a28979826740066465b52569b6a88c30e8b9f35d2c429a7871a1a1fa24d9d3bcb6c44842917ed0d2cdf5589e45a882c8678e37867ca77f3de60d48b2c753f049489a29acd159ad9b83c033144f87e437ecd006d9de0cf4e2f1a74b2a5c1cf9a0377176ecdb0caf86b61e7002b667f0e3c96540d120ef443b142182a915d9642700e9225a4e2117a4281f00c5adf1dad24871178f0a1443bb6d2391daed344de3fbd98ae9763562b38d46464f9da7cdd657c7f3f06f372e98a1acf882a9ba28897c15d123b046193f279ab5bb2ba8467d9474a8c8f75e1f014d2c31c3250f07f75466c09c296b701c0830b806b42c059daed8c911f32fdfa12344bf2c4dbb6de67d190e759e42e9774ea17da1598f584481edaabae444030ac462c54b4c7665c8da60d93dff7de3dfe98edebcb0fcddbb38479f704f1ce937ba50a81962e25b543f1623a2ae970e0fec2d08e16bfd4c798ee4427780b782d3b83a74176bb548e94e93f33e7feb59703f62f57d92e0a4aad3a97ccc75e6553ade7c66116191d64d5ce69c2252c645a80b100706cd39bcba3cea474759ed84a21d568ae2067fad142dd79b0e2ebce5ecdff120bad9679c474a37a9394c8a4b772597888ea51c132da517ca19adfc7359edc4beb01b15d212ae17d4be5b22c1d1e257f9115253754921b9ef5260cb214c5a69549dbfae387dd91541c01e6a7ded87c0ac33faee24da29c1f16835c87c66067d813f1c5b4bb325c45ff220c530159fbce0b54ab8d4a25eef9301c2a3932e2034139392cdbe65c8df07f59dcb5e23150e16115c0d50e57a757b86d1de340d460102cbffb844c078a9a98a625cf0ce2d164d219ea0257e7d6cb180ae4cc7cb08b71c045dddb746e515c7788bf999b072e518d35287d331abde13db46181e54d361e3a332fe32d27a23be788f553f4460081317b6739eb0961e5048b085914d2dfa16685576501d59ed5c70fc1b16232f3f7f34b1791f8a4a205f4172cd9364a57f6938cfb7bdbae0a90c11550d0c3e1f8582fe82467467a5c3938409d7bab195511de775fad9638d68dfd50d24a80e38121cda12ac5df4227dae522d7f392b5498b0de3edc452f7359322e204f35fb403ddc67cd1c5da41236c0b4afd3cb7646ef852ab3edd5b6c3b2bc57d80a8fd6bfd705907b34e296fa1361af3ca987106ded64860b432a41d1ac16069e7ba1d4fa1243e326efc5aebb5945ae0623fe877569fca4bd3a95d5486f37754654d8342d0179a7756b8b5b99a5110833222bd726f939e1643fb7b000a1112c9bdfe8e9901d2084a762970175d2ac268aadec36681b7b8d03d6c4ab75a00c2c873ff5f573ac9550e5de7b08e0a2ab7c1bb76643c0b8a2d445bab5826a9e34310e94300b1662f51f032ad15891c7694ba37782fa26f26be29504e29aa1b823bfc699a9ffd8d08aadfd8e703d7f9ef795f69b5dc18e4d0b0dfc29bddcfb4299a92d4b4caccf266c2fc1e9fc80d03a990179e75aed7ace38a5b3119365e2d10953d07358cf21cf6073ebb1708220c3e62c72cfa48bd149de4c1f731884975fb31c29b04da055207b84c9b3ddd0bd328e987da3ff9038f496b25dc21eaf383d30e4d31fff86ade078a48658f06bbe406ee399a05609fa75ef0d573b457d6bf2cefc0e644cdd7291646c6083cb9bf9ba55bf9f766b824fbcc74fa0c4d7a830381617659099c054b33f3c13d14149c0361146cac0bd320485b8b1596b8d3ff7282e82e8af64def23a06f37d018a246cef7c4675a0925ee4046c5f8a2ec3301cf7cc9edfe4ff6e4d964d218f9fa7f9d92fa976f3bef9c5fc4eed9686a978e861dde24da53bdc1038232a016c7f03a426a0b8b8fb4fd1f7eaf6f547f5adbb208b7f3a12a38d45230ee70d1c214cd4aa131caef3f41b2a19867ff009c29ca64ee18aadb91b56780b8e8184f9453da332dca86e2382389937316d9f7d21b8a39e357bc05ff4a9c1c44aeb08d0e5bf3983b438cbe52c6939ac56375b414a2e65ff5f55e5746cec135446687b35fd2821b8dea9b9c459abb9f2f0617b0bc5a606983770cafb10ae31bf1dd5c4b7bd818b1a6711dd407388cbca880ab8d6e0090f3851de8aae8715d5e6e64da1996630d4245616f7bf8fb3f97335194eb64ed0f86a77c9d9ff00a021f9e95eec01847191403493586162fb85c49495e6a43cdf1e3b0a7d04e85e8ad682ae1bbb57d96721c5523263adaa7caa56bdc076fb07f9dfc895c148e42b6a303852a7bebd0525b55f81e734e6373a128f77b93f00078c44b5beb334f61360cd517a2968d4d2b32232ce4cf5246b64bcc049b39dc47a4b01c0bf53a843082b6f64b1f62b053d80dd31053b18d074ac01e6efaca7f8e23cbb5b7c2e135ee60aa5e1a6f8e3e609ccef2ecbc4cdb6bab27b9cbb1262c1554518ff8ad78b91b55e48d41dd096720f551288d19219759ad32502fa138342bce4053c40b415a16df257ac99c43eff3f58bf6b0667df26ad1407efb73c7b1ad4efd4764e7bdaf74a2e091c7f7c730985988b72031d493083059aa5a574fd956296784f1997e82fb39d62eef8b769b5addc04d86a892f964401ac59fa0f94480f3bf35e49bf954ea4d76c617c4d4ec4309b278643ccd5ea01341562531dcc6e0d4d44117166c09feafa01071b77b35f13f192097a63039b3d1a03b7fec52b59381db69ebfa35245ac922d95053413159a1b29896ce0baa423f956d42b7cda98e060093d11551d381e75683be1313c3ad55f9afb0dc6a7b21de19059e4dc48cb399e81b1b4b7d66e8d692d4e5538366b8fba464901af427a6ab02362f4d17edd68bf52085efa38ee9619dbe3e94494134d40d1dfa660ce6a74a0c434d0985c5355060ccd19456a394c07a02af029ad937e14441a2fa8bfccdd4dc15b4da2939f84a37f102bf714bec47c68656f33967e54c0236b9ff241041e5d09c52f533b18611c5c09a9f7d64ced1add131e3e8eea3b6f67f7091abcea05b26162cd37d4ca21b0bfe53ebf79fcf5e458d08cd8c2ea9390b64f1fc047f5380047ab342cfd46f781a230c1efdaa430b33bce65f46d5d2d77e930a12591c51518fce476d5bf12f8316f83942c4fda6348effa8aeabd323ee2cd0b255b88fb08747b96941f6db5976ba4197e751c3135a8877cdae33f6b453f498dbcfb02508c04c1e9850953e8045799a34ac3500b20e6acd51e514f59f075a7be1604660e67310d74a1365646179aafe9b61904b477c3ac774c87904edf3ee12f59e5f11ae95ec85295c35b525482327c2061c91dd8e0650b235f9375d63481cd7b330a5b5c2e90cdbfac73481658033cfee86e647f18c2bc334ec7c4b04cac50816e8542fc8b69c079c02e698293924d9c5ae50acb23803aef4a54c6a70ee51629adcf727afcd80dc4a27da85fe964771e95f3912d89f592bc6bf5e4ac175ae99ac4fb88e1fe93524e3caf83b975d8c04807ba041577e066c57b5b82f05e483c4326eec22d42212d57f9652b854b7d50f4e0e88783405085dfd02d712d86f2cffb47d24df2f5d8b71d81d3b5a6e4c1be1bc4692d6ed0d64efe469d353f9e81a224d65bc2b280360d53c414c62138edde2f14ab1a0666649ad012f86b894a3715984c2517c274ca4f2f2013b8a3bfd700e04207c3740b29786d34d087e8d85c357da86d64fd5191c6ea60979fc7bfcf853b9db22e01fbf397d47aceac2b54f51610779d381ab9cc8b77b945fc41278601edc04906daff85a51f1941bd52bb0b5be7ec316948e419b4a0a5fde0caec5a5a076f289f41af7327febfe757ff71ba4051981a320d4a70ef39c131b600eb7f0d01fa76df5c05760584cad1b7682371ffbefcd4ae3a4484fac5cc232ddefd7222d13bac1a3aabdca73a1687b1b06430229afb237251ba553fd5d536d41e5d88f050fbd09ffb510e259044d665723cb3b8bdadf0cbfbbe2b1c41a57a3d087961ef709ebf83d801fb6d9f1d837a1d9d530989aa0cfe4678804bbeab7d0b1581bd27767103bbf44c205b948f967964a030a4def0c9e86f038ddb0a5736d1b8e687ed5ae7f75ce0393630a7dc3ed1593a45bf22259026d71240b20e8a3df851713448860bb8e1df9a61b0755ece0f96fd24c64df386198c94052000e05764200df27129aecb63319af7dfb670ee952e1f6ef7c7b0a86a97d078db281b2b64cfdb48cb10019cffb30b32f52af35b599f8bbda785e58c57a5642182127300c939c8b0b7de8d4e0810c7fbc2621f14722bc80a83bdd50b992c7d7be243c1401da9c4e62db2bf5bb358459325cd5e3b08729e26e9e67d365c4e8019f239193ea3631afd33741753b4f8591d46e58bb967c254bc113c9940c77b3538937d7927beee99102afcd512f563090e5c34076b4458a6af1cc6bf9739ceb8fd1bbc0219ea26d6c4b6874461dccd5e7a8bb8707a9e489acfd3575477c293d1c41929807058ae5bde15ee4ffa1016e0ed65b289d05eb11804fa1b51c517109fe78187451218fb05cc78b84d9c968cdb90715e6c22ffd7c6b9b6d9b077d076f156dd52b00846de6725695b2ccefce120e29ffa6406326c0726e1d58f2eceb4ffebaf44ded828907d90c711c65790b4250fcc68b8cbe3e182eddace5f82cd8ee8282e4026db5b17bdde83523442cc2a8fef3c3ff71cf4ed2efe2df49505517b1418722fb3276997a314c4e5bf7c53ea0b292fd6ccfe9a3d32aadb2a4dcf4e0965b7b6e0d49b22a92486c069ea1dc73da265ec7fa006d0dcd0865c11a92f6473bf4d39514780effb033d13d3b259d0aab7819d20a7fc4998630acdfa35925b7fd787565c042589fe3d9898df6350f980375c0fd8fc63e3927b1932efb16224775422bed9da0603c909e37da33763821bdc24933407106c0684f684b560d7a827edf281c6d5f74023d28f1d00286f4328ac6b82fb5fe95758005b5bf7e8fdfca619b3fbb180773850b76162b55387379f7ba85bb646ece4658a94dfc568740d8c9c66c46f416fe225d4abb2143f90923123332caa6aba171d860d5c9b2cbd1ac6057b10e272a28ebd0aeb34a3dad91fa241225984775d16dd9e825b47c49fe3df897a10197bd9f7188bb5b99ff2359c7cbad6eb1b65b64408eab038bc9b11c7abd74a044057b7abb3540b5444c18d30fbcac329a596a47107615f414deb231e7cfa5b5cea694dfda54777fc1a6265257695e287b4fb5bbb759c3bc88302802b69cef28e1fe5bd65088770cefb7afcac06613dc0165bf7a1283828b9557464829d984b939f12a0a815f6c05faf626f2e8ae681e62fafa5ad9fe57f3ea529f34f4c259971fd64f450140d8c24a8dae14ba5cbfc1e4d1c2f8dba276169485538a459817e2ed92a3fbec84619eb1564db81aff7556bb936e63e24a9e49c6ba7c88c7ec16cba9723f1318039903c39f5d2faf8a1dba14e1b0606be702d744e11c3e85b54b1e99e0f24f79e213adce8d32951e0a9c0c54a9d0456d0a449846fe85b1b0ed967c0a58bd52478d8242a09031171364c35884efe0c32d55a1e4ad7263a2d40fcdcb49a9b86cbd1805d29eb556316cf691cebbf14418098ee58f48fd00d1b91f115edfc68e851534c31a2eea332cc559e15e367baf287fd039c76637a0f13bdfb1acc9df7de619f58687ecd7ff92ab5d50cb30dfe184f9a2376371812001742235c16b95791243dbba17cc6112b3f5255b32efad987951378b307c46be71d6b9fa9bb38732d5491115fb666187c6d2f1d6595868db840d450063859b4895ae9bff1520b5affe50cb16410bab745cc31fd1d035a058477824ac5869a20e7c34d990676c6cc93214433dd83c369acabf4acee4916fca6e9aa88a04c0c3a85dce3406bf0b656d71617b2919176b4c5d8ad49b3b323f1c69eb65bb4322a7f77f0b7d7347672e92e51209658c2b1afeede2104e68c596b9fa7d83593fd4040d17ac36a2027ddafe06bc766c76b334756db2bfcf6eddc1fe68821b35a0aab387b3f627314ab81fb2bd7c2d41051af3c630caddbfbd1646b7c19361146c95010f5f3440ce957b9f691461c9a7f4350f02317bb755e5f4324613635ca2d1c923bb2e77a738661fd79070a2386a29efc5e2b80b766ea9cd954c975e8af75ec49261580663ce002f013deea22c8931850d8a0ee43eee443ac4a0b2a55108c938c34f33c2b080627f8f548f2f2faa336bf7268ffcc20351cc057da94b8ff98b377435c77f0db000f7a74d0e658c661978ee6a8710a771892dac7a03b8b58dfcdb2b6dcd8f3e4bcaa9b0e925546fb447d28e4904de6cc4a314e4665ae706d4750b4a5d45f3300f28062778eaefbe7b46e8f47cdf60fc5ad84eb6f40a55896097ec3ca26c27ca27cf65ce59e4ab36149c15c60327f04ac13da67b19abb591d5902aa3efd7406549fbf73fabd018df816b2b321cc499b7d6904584f49a7bb8669767d767cd1c41759c368bfb6558c453ac7010bf3bbab1bfd7590c99d20987627571b164c39fd3641621b66c7d4f51676bce87c2652e49ea39011d0bc2080b1e0b7521492cd434f009c6488a8e8431225032bd3e40ac9af969cdb56dc7be095dcd91ea62a53d35bcb078d665bfaf7cdcecfebac02dffadb5b5ce5fc290f3a673cba0491c58e156f7a3878b4b4f1cdd14d5aef64ab2c60b1f2f8e79abf3a0e23bf489c109381cbb51f12d9bd3f5af1b472d9cbd8b355546796ca31733e960fb47ea8ab1d427b523ca5ff100d5d9e202c45fef18e0e5b4a5e4b673971d9a92846bdfabad46fcca2c28c9be2c2b5c9b32d2f34f8a5596421182d285b387df2e6ac47b7daa34d32e63bd72bfc354d171c25ac0027c7889d032f0f4746b98565143cd6f34d93abcd46392b7ed953750bfc791e15d32ed86613ec31a96280d9338e0dcf8dfdc424c50dc308ad44c3259f016edfcbe558066357678d892571a34cda11bda6e20d446e610a7d252eab0bbec7e4a41af120a92142b57bf10152bf0f21e67cd100318eb0f1463f88a44a56bd6bc84da60405eb20aa2c203b6ba650ea75cee02507e3c55f232ce256fbd1fb9fd07d2a0d91c71115ee81fda21724e1729c405f0f52780d439d658b7d42e559b702c9d5348bb05015d1635151eb3fbd6c809796bcf3b79eeefffc4c816b0b393cf7c9a308a2e7a9e15038dae15f32c120f454209125358c07132e77d010a3f19b05037411900dd7822ea371711025d10fd2f2dead38b74038bdbc1d0e8e99c4f4b21cff008985bf2e005558c6b8d807140b7b059d2e61b0840caaa55a61f8699ed738c3230711e02d3d22d6b0d0854f2ed2b2a2e571f4378c53177c83145c044c364a6a77fb405ab67a38884c756cdac63a870cdc39d3cc488f010dc95a975d8c9f1ebf858304aac2a2dcca83704bf4292856a2756e300dde4a199bfdb54144844774e334ad5373b5d80e82bdeca4a8d5cbf770e8bd5da95bc23acbbe822b9c7028615315ec8d4d48ec8249595479dc97e27cd2b9a8d184f3631104f593d453ebc8eafda67de0dc1c3dcbc1bb48da18513ca97cfc599aba2235dfeead5e5dcbfd87ac58f03c4f88fc9d87bda33680e6d77d0b6d142c2d2a8f15292b06ce8697f7ac22562cd5ae51cbd3817fd6af789e7dc69fe642b8c60e541dfa4a9576e521a7ddfc545138550a88c79c459a32fa5e77331688b0a22cf64ed4c5ff7525408b7df9b68d03aaba0fbe15f28622e39b64424e2704bad05389dc5cb3314c0cc4f4b6f7d983e7f7cda15343607df492c8e07bc51ebe804404a20b7ad17d345a352869d382bd3b187e40c5190de7fb7c5c43bd0d9bf47138365613895d4ba34214edf5e2ab855f3165ee08461417ec99e074a260ae48d8b13604959232aa5fbdbb3651e7077b0ce50658521e852a0bd05b1a5fbf393567ed57a83d754fc6efa1d67eb58b77ed5ae90688a0cbc8592b93b60c48d6eaebb4d731cb19616b043bddad367b1eba79b45fa43c97f63771c2a41c8f823322819a14a3301ad4cade472d88704cefa1f1310a97eaa401ef70c80eb9399e565ef467a484c537091a881ccd3900fcaf2b56c3ee8e7ac88f92b92d057ff693a2eafd7a7550fffb3e28252be84cb13e3f7dd94d8ca5ac0b926cf94d3ab905dfc01aa5d88629a56fabbade87875acce4f63999c91d9cc41964e4c2c6f01da04580d750c7f1727f993a727b1c4310ac505935eb38a15e072132a827350fc1815c728afd63503a034c7a86bd4c7bffac127b5d4b132186fa4f593db0e16a4ca586ac0011c3958c3370ad1467b90ca13bab04dc572891475b45c3d8d76503a42aab0fe7a4ae29464c2704f4fb50a01eb3a7343793afbb32c56e15b00761e461fdc45fbe2cebe0f783c4b69b3ddbbd3d7bc254b7275617b7629b44d1221d5774a7683e25134b41debbcef6267d856662c951e716f4c446e2cfb989b0e28920c6fc8571c85b7eb6c75bbe647c50fa66c9e0bc77fb1414a710eb8929b4b31dd30b79fe1580b48fa0010aff2062ddfc57df6e5df9a450d51386c4fd267b38ecbb5a1933854c22ad783e5e505d6a42e8049b0cdce635cd417db169b8962cef9d998931b7ac8229518512a75aef811b3a638f0800730bdcc39a5af5b6ffb4489411b7966b80cb795040dc0af61c2550f789f5176e8f228ba50b5678bcd737071f01c1135b480d093152bd8b905a5a4a06efc04a60a0fce547119f7e5a1e717afa395640138a7dc2bef916e614a968222aba359a1dcc845b39c231d33f453aadb5e556797a115eed3d3739dbeb29faca13ce26bb33dcd90470e0ef13d2bfa0a65ba5ba1d8db59eb73efec7446fef8e1a1045645cde417939d6b204797603f21f3313896db14490ffed0da031f508bf2154f6b79d5f52f61fba1f2182892b47eb98ab5e7b492f7e6b3eeaea56000633a29b3330de8b9897829bf546ece928dba1af6edb2c0d67de83818eec0c0ba340ee52072d4400b991c5c713d8f948ada35e02754c5850ece75893c2375b884d46764b90d6fee3f9b20812885efb2ee58a0af5a66f3b19ec0dc67bf0946ee251bcc028e5d16fc8b3b60d7e4a120cfbe1052326efed65376fff7957626cb5e3c29a414fd72d6f3e48d62d631d92004d77de16fa1a3fa6fbc2bb5f93074d33ad87bd878eccb433f548b4ee957eaa50e6b9b7cec55bb9bb303658e68fab93d23cb1a600e9ba4768a3a7f813a75d9d0fc7534fba198aaa74c8091a2e94d39b0d620d84f2de8bfa5aad9cb95d422d8c691da7d928c80d578b2fa7bde8f8d1ba9b015019189ccd4615fb9d64af3993d2de1af80534b3cc4f2eaa2e929c7419fe589986b0f2c74da9f7994e00d046531671ffef48fac379f70460f823108b5adc1996dc218d5d76e9ef7b04295ae804393a8ee7d2c64e4ce7d380ec12d07b7188c7a0e4c0e2e7a4b20a9196796c8d97fd331b925c1a73f4fbf3006dfe0c6d4fcfb5cd4eecd3bfb8123990135daaeb1651ab5386575c9a91718f1ff8582e71a261a5f6ca3bbcc89565ceda611fe81b9b0195bf26efd0727e05032050a8d43d55ada07d951d4d761ad7f1554a5d2daa26829799ebef381cba20590f0309393d7b9072ea8fbb20ca505b1ccef2ddc40c953e29a1bafc737ebbabc205d87072ad5881a56977ff31be6fe1bbe59051eb13f38d8a2a653d3e1bc5b27664821acb660f05e286fd716ba65142974b4bedffbf9f5ebe52fd1310eda697f4d7c374b27fb1d7b4844eb272b3144ef5602d74f1e4aa4531ec3b1baf415d92dd0ead887b99e4c81a2974502467e2ebe4c7d8f8bf7aba44ac6e2aeb28466ccce21f444d5ff129f31551b327452fd0658eaa92dda2a1d58e7e654d19d5f78b1c7962860a1964a8896ceb7cb56f4cca09f8f7294d703f80f3b9ed34d3cfc4b8db70979db6ea164224cf38d9238705fe505c31d31ad364dbeb75750beabb26345010fda7ba955ba6aec6be16e90c679dc3f23e2cf91f6587fb63cb29a6ae7994080cbbd8086ddc568544bae3f69ae649da41957da9fd1fb8e40eca6c7889a4ef908095ed6c862b68c7d583e513565899f2698ee668de06ba0d992f63954951c95e5df9f56dd5d6f619ff340bb586f3c97c68e9da370b64f4e7164e8db985ead4b1503ba984f03c32a24a8c3d1e8dbf381e73cace750f48cec4341a427615e23cac0d9108697b3d826147a66af7af6f75e540a84d23671fcddc58213bc2489f899192c48b09849bde69c4c571b3165a9520803c32b034fdbcb09f5b07a35a435305571a249e63ed074297d62826e301ff8f87c491dbb11f9bc5699a63f6a50fa092af8e8dc6130ff31922a3457d18200b0e2a05e04e658d187b8f21622a7cc837f52627320e36c4c501b0df3919b1f09dd0f26e46bc8b3f924c1fbc260adc79d7ca2af0c8b413dd2fbb002c1ad118b1cf3eabb75be3aa98b8146f01fe143a086b6a43ebad725ab8ad4d4d90a2c004f8719ae0110ed879f3a35e01f11c6a6f7a908140fd7d08b1ea1f648364af0a7f1450d471df6bb32fa3d4ba06a05d7c2174767d8153c192b9f2203268d1823d5342c831ce0c68e9bff617604ce15e6c9a4c01c815ca54132775b5ee70acd92be122d249bf267f2dc04463262402b02747f8f5179e3f184e1287da7838aedddb3d232701ba89057e83b9e98ba44854a5f347884bc55a0ace20fbb61a98343273cfa38203e25bce89aabd1b6e2dfc0ca286b595dd8d82fe455c82befb8800655e0fc19d7d09d7bdeb5596a6605e899453939b1f670df064e209de1f4b10470c3b7e39efd9ac36d2bc6e14db929a0a6968be67690556692940feff8b67fd9d35c63a19d5e30e2c58b9f8c82bc10d566cb2be8435405635565b283d305e0d0c184409fd81c7cf3039e03fdf7a3dc9eca907649e12da8bb19144474c36393ff8bfb74f2fdba027186a46e3921eb060645599ebb21ed8b258795ad5e952a68cc7bee48864ff567b0cbc4ddec24d2ae3c1e95b848f6923d4e638bf331aaf82ffdc15b6dafa991397ced6d789008ee19cbc94feabb52bbae5411b9bd4f6d66a2a6ea62d73e7712722ef402d1f8906ca21aa56ece044afdba949bad2792e5be3795bd519c9dc817ff4ddeaa052e007ebc903afd3ffab608cdbb7f34ee9bf18ef5c19f6747ce714cbbe16598ac8804e1c27e5c9a9503af3a709748a5b7b7aad148a0bb328d6420820e2b1d4b939c909c1bd8aaa5faa6c144a28ad4f1f1efdc58bd52819a63959a6e7ba7cc798b6cef8495f137a5ac25128ddbf7df313aa67ace6a96da3f3568d64bf1dd552ea92b76b699df35c89dad435594a75431cfd0292ff22c4d6e7ae3b9bf908a8f6f40b1306e628fcd26e8b59e302546e42d84176697dc786e4ff9d0386f21bc206d22ba4397793b95240ca196c5a5a957ea56fe0465f9c63d81f0f8f450d7258e3dfd8220754681b496d979822cabc7930be404a2c2cb1075a09f999d80f95a0ed6c083a51a187bb54be7511695cb2659e44adf782694806801f5d22681c4b3c75a3d54b6a5be76b9a9537ee84e92d7ad3524d15b4756df549114036ffa73b7c3a630a342655a0e63752ad6a052fad478c661ae6c6236a56ce7de48f777f745e3f18657f5818f0bed76d965cdec7d533141b374d6fa2850e10545e1e5fb37286d0a664663a5ed1a2f5fa08ba7d0bc1f02e99bc413436cbc03fabb2d39873a123591ff03501be67b4575aecf2cbd775fe2a8e28cc9d423a1e5e6162b034bb499b9b565634ca2f32d9b238b18fcb9acc5161222ba0746a01255b6daaae35647d057064246910eacdbc95da3a3478ab0bd5a5165c1ea152e2406575dda3a687e7bdd479076b25001e94490f3d132ff624e2006c009088a7c4ad435b31f5abd8a741f454a5761029f91b21ace043184b2f30b211489cafd3d92237ed317bf6e37360482fb233800f25920270a9a9c67b93e18f5d14a06d72d8eee4bf5d359b5bce1612fab9d4c0033f708b4c7607f35880d5a56611e773eff8b3320c8f6ac67b10338a0ae3fea2098351ed7699e6403be904511d2436d789eadc88064e2dc89c7de5ed868c5145423a6f00e097cb1bc7fe2ab23c4bddb00c462f1e13ef13fa1436f2e09566baf84e157792664b864fd520ce1f8d51f28407e70a3b60ab6648a6374c2e0e91edadc8e8aaea5c0203e6a8ae5ddb4bb57bc1a43a635a7240c04957054bc145e4f68a5c1885f81357891ed6fc4dd7ae7f40057370c5d3cfb4be34c6a6c56d3b87cf11f72f28661e0deb1cba196d1f2418453b151789ebededf32673ed223819936f6a7b1760663ee91c075abad9956c52612ae9ada769f8add6864352fda6c2cab3c7ca2e5b2bef098992037067ea0f46d2201d8144de4e150547b2b9205d5104d581112d8aba2a7b4da05b7d120da081e4c9414c8df11ca85ca80b683d8c111c641b8fc6a6c00240b600c5f20e5af0bc6e6307acf30a2f65f5849a2579b55d87d0c85569d5595f4cf7af8418c0c476721b9e74e67a032059530fa292b59778823ae9e9fd987c4e963f1fe057ee4b1128d4485f5c9a2a9a7d43d4caf83b76d3c2176995a53dbf98de960b74e8c43dbe33509d4e6a8cc43811b85d40bc0f477de8448b1e7c5c1dde5ed6c76a449a91d72ab7662717c373001b4a78555f0eff697134b0887055839e5c2dc3f88fb5d8394a3f611987c40ba776364fcee621808eba7097bd3cc0da1daf3b3c6d9820968a8d81ecdd79c241d9cc8b90d993bc7be6985480c248e7d2696d51ca73c6b407458477642b61583b4a08b4c5658da17c6dae2c5990a63296af3be3ca8458dd6fc59ba476e12f9128364e1ec3597657cec17714a3583112ffd404f44625d8e0ced429a21006256ae5cba3013e8dfbe50424cca92c5910416866fd0cca3ec61dca89c9d0a93209178579614c0fca158b92f1a4ed1f89c7bcf54ab9522e08c76b980c25386b7b156e829321ba1ca5de1e315257b868602a300b3c3eb89fc5d06d4d145a7d49890c63ac3ee2a453c56bd3feb7917fcdeb8b3de6e8d61f542e7ad334112eb591100a31d0613c45a03a6f5234e5d114018feba3e0bb2a284379278f53ca2dcbe849ec7191060a56d83b5b25b9ea25c83de9b94bdb81759cad71fdaa2bbf00c5ead1662b68b3db1a31eefdf0bb344d104fcf00b77e76284a432303889eba7afc3ee57bee44e361be1907313a65206986be20414da8391eb31e99f048630c415ef8c4698070db6900d9e2680ec23ad9f8a60276b48acc89b8c057a537f9d3711386b3a296a03074f8199a03f408cbe8440044d2f2f51b9390fd2416486c19d3f72389e13b3138d24ce0abb88fae674810711a2bac110e6d61a86d122baeb56ad7d9a8480f87611f677d5cee5daf1cf1db73bcfbfe867d4e8a16ad5ff7774c649b56dd3243e0eb61952f09914314f17a422915541292b01444ae8f272f543a4436bae39fc333a06d6e37cd4a9bf63fa5c1d04fb90b5afddd2164fbe10a321e387cca9b27913afb949db1ba37bff8356e3cfce89e1ef5f369b1b818084ea54d77d0cea82ed1ee9bcf868e27163262fb35c40aa169664463f2b066d3e34878efe08f0afaa83a784504a6f3a3072f512f8d96d5400717f8fb130bdb6c6123f3142854f26b470ddc724db1a65591e0729ae3bb8925c9973c24d0776c7e05e6b7c46d61f0ae9795dfcc96a38d15a904dbbdface600f5d3b6f6e90dcdd37aed417c2852d9e599862482660ed39e7aca023e848a516e265e64725ff99d0d54529ac99bdccc4f05f9b3f3816a231d39d7a9a4153765d111c0ca1a0ec2fe1c76247e73ebf1b0d729288db6e827ff6b3f7a8da88027a5c7e706f5cd9467e0da707fc4406427ef307c7da88d2a1bc5a9a6d3d570c4ce48831c6a8b35834ecaa7ac875a1c57ae507820bcb55c8cc1755fa96afc5c9754d148482d812f8a5beb6c5313a2ce63539bbf7d2515f9c2936475ef1dffa0a55bfff5b9d4016c9aa7dbdbbb3c1bf839f5e0c848891f7da9e512b2fc511d7c6d12a02e5add364c76b22fdc18a85d34710207c3dbfd44638dbac411665e5953f2a1b2f1c7c2053aaae961cee7efba2d7f469970aaf741d7895111976a8f9c676918d68b5df5c2d3fe7e7934d5b1517323056647ccabf08f68a32545905fcd93864aa50156ad969531c7a715752f5a1bd9136e04776e739801afba5e308b6e2dc8719548d1877a0595f18408e9fb454104a1736502294ba1b137e5a21ba7045df22ffa96297ff4ee8f84ff3bfcf3051d4f318ec94ef92eaf7fb76793ceaaa1147c8b0b0423f40aaabd795e481eb32fe23ec90016645414151c2f0e420449f67d47c634f529aa03baf4197514371c913392dbe4cb66b6c0e8e297e335e51b56f2a67e9ac7838bb756642b9373365c28d640f83a4498055c129f95cfda4e25e10fccb994fac30000f225fd49422d8c7fefb45c359ee3d441a9870440d20734285dc29763c8ee8a581a4d1f251915b2ccadcb0fe66575d1d7410fc83938186940e5cca988d1de816d7e637cfa3fb6dadcea48b4dbfb304af965516760f70d0506c8dc6fd338171f45215efee78852591adf9d66fe37860cd9c8ac83d7ef1d75ba525006f99fc1074616c876770024f15276d60b0a9190b46679972c718499373bc7eeb5bb5cdb5e356c89bce0d510167dce457733a07c303abf838df4459fb800546a8368d63c3a3a9d20af9af024e6fd1763b67c9835b8517afd7dad60015e69cb88685c9be78c60e3fffc7baa1a3ba8870f25bdf1e803b48d3264bafcb1ce6a6582da56c64b62ee6b047b9dca9bf9afe9a9efa696e88bfdac61e3c871d18119691e24b682fb4c2b5eb5ba1da479eb9496ecee17d5e625e3d64ddf4871c2807ba62bb3b90b5aa90e5075767af8ccedfd0e030ef38ad894edcaae8052488ea91eb16fe6aa355d818ead26098a569e8ef7c198fdbe8daba555f1370718128938489f7985c0877298145cfd507af00cccee7e53a5620a02b844483952750a6c44e2217a7e9ba59cb54cd5d3d458d992c93c5fdf989aaf65d1c5414bc16b24d43c169952ad4704e971bd66d09ac9342c30795368a91fad36ee2b053caa920e1e9faa15829c40527fba8319e143a2e79a607b078f747bed8620117eaf08bd3f544e766d5817f44e8313296caa9bf3dfb469c90ebfc0f3136f4eab53b562a17a18dc3fcdf1fb8d7bbdc18615d0b7e15717cd2ec1d66924858f02dc14824a23bda202c31e46e59e55d5b97bb49b211d402aab662990271c8ed68801bf5d6b27edddb2ff450eecd085ab5c17ba1fa9b5367a05923a085038c76dd35f739efd9f34314e086d6972364412569d1bdf5080c8778030c8143f718f140e456dbeb0e71b539d54ad3c9aa4757753de9058bb217eb2d2e40169103d09ed5f0d043cf27d9a62d576df9f9411c9d707a7c83405d5e9bc2a539f585680a088f0dc574bd8f150f72cd63f825a97bf14c10d984672ed123e4da4d3eb0f02df94846c5af074b3c959dff01f22d1d3e09027eabecc17b822676e5703621d1e5868c9d50af6808437ce33237b7f6fe31622dd6c061b26b0cf3e06d3d86e27f74cf9f4755089d501d0013b5abc5e5c2ddd6bd6f5ddd5b75b5f4eaba4e00bad92b3d820e534ff8f22aa0ca36de002a568246d56da37bca51625d6354344f3d38c6e166e909d0e0e5f9ccbe83a8eae4864e15cf9307c821c856990a8cfee8c896e3889ab4893f96bfd7259bd49bdf63f015ecd89a61ff47e5561b85f86809581b44e4c90ad8cd468f4333dded3aa83431d8a4aa1a43964fac3ab1183ad1874765137fc66a5273063b424420954a485bfb0f3cd4b5813da0614064ed14fa85fa05b3049cbe10ce35f356c82ce5091cfb3b0071eef43e8c04c9adb1aa179196b19315eb1a8379ef097c298c5c4f5109a1c2f47160c21ea9d3b038a5bc30b15ad1831413786dd96a4eace89a7b95ea37c46de5d1e0eba03c0471b47dfdacc48792abba1a3b8ed1565e103694cd3838768811fdf66bd257d85c5b3c398a46503d863a2d2bf7e19f6618180d21de9a3b7d650db0cdd959152cb064fd6958cf46e30ab70b8f90b687d0d21ebe18caca274d714511ab27ba332892c2735cedccda8b62c014c81166117e5a701c3bf680d5472d7d6b9d4695f794318635726da7f4208294a691f128be3d263e8488cd5186fa37899396b1913e2f5fca382566853069f0100fac1df42db09ffc61bc6169ad7bb7bf477ef0bdb7983f2ee9303568a7f6c8b3536fcfae002f560e466aba49e01cf790f09ca6f05e5d8acc1ecf245bbf21ae0d1faadb7113195f0e948070a852a3dfbd1349b464abc1a2723608915a2b0eedc9bd02293f1775927c5ac5fbcf2f88e9953fbe670a1240e1d4d555fadef5af6ebb9f36c3b558c7e45634a0dfdfc3087a082eaf73d5922b89845aa09acf78d65845e4c9c4bd764718b5ab2713052ac00a44f6b7451e6628a8cfc02687420d95571bb1478f21a9b56e0d06049287b9943228b3d3e19fe810e984c71333ff4f9e9e62803a501592ca867a33f441cd761fedadb20c423be8e45bc9637e496ce2cac96f024f03e3f37d229c0637c80876bd317dbeb534f8686139d341cbd150a31371de799db3adb0aec8a2452a7e58826b8d0dac819598daf7c3c5ca5557ae3f9b1e3a7dbc3893df9616921cf58567d239a9cbfe3dcd46c41d5925313f348ba315c1ddb58046501ff37f2377c04638dbe0a4775a611d230ce4a9ce582bf50eedb53784d77c2e8d7199d3ca56d8d9077ef4735c826c93196ecae8da2d1ae37a442e3901105a161d7c13fcdbf77b3fb38d8560fee54e653b55d7bfb5f86f267dd209533b683fdc09369925738a4934db108db7869e7594502c4bb31240ef444bc920c635f3ded1a0fc3b46132967fb082b07e3fbba44ad0a8d161b769031ca9758076ea2a69c7cc526d5e5d75cd2e2f2cafbe8ca27f571a872e1915f9390d01e4c2000b3cf5d1156890661dc10b5797c111a5d2557dee71c2d16383eb653c93c06955945e6aca1297a469e580bce6d9dee1e9511961d545071da90f23a92640172cb5c101fd40ce132b8b03d040f9a9c7a6a91cd967e9f118c71e51261011c1f32fcc547c185b86e3a483bdb1be3e748a25d7f3d02dda5b7e63a4dc7c3b1cdbaba2476399f16ecbdc2c3ec02d2b69a3c52e5b21845a17a5b659ab73c46b91b60b5a1faa7b7233bad9cb7bc60328c6ca5b8f81773fa3d6d581fb9f7209e9654da5b0abce20ecf5b1039936bad72c9498471a3a459ead9f2a56d3ea082bcf12908855aa4f4d5f8538382424c681652b6884d530020c49e0ec7c93cbec7d1cf2b9b6f095a8ab3908f9b6f896ab61dc2fa5e7790f1e43922b0106b5558c1776a9dfdd3672530a50c6a18427fa4340a7e5c19b355fbfedbf5c017569d84830f7d9a78826dca3a7110cee4a76919d07976b7d06a9dcff08f9ab5852119a7c2a8b3cf2189439c49a917b4fa3fb645329b2893dd0ae72253b43ce55001c8127aff3076882b77ef6d3ff54c5a3b4b805f189e58132b7a6b95bd33f026532da3209942a3d531bfc920e2cf1705884b5ffb442f9cd1e2dc8f97c576aeb6b05a8df784962072991823550dac4b53983ab8bae12fb1d2caa690b635a3176dfd3a75d1957f1af825199a8e63c176ab7de3c6d4599141c251267dc2d22a08d1be00ffedcff081a1f7c769bdf5464e3a141bca0485c370b1dbc95d728697db7fb534afbca5e0ff67b880b6ae296ab8c10c61ce8ba658e54d41e59023cdc1100f2a3988daa69e544a1de65bd76a8a8adcf706bb83f146e9fd5dc126fd0b0ceb933bf7305043903d9382244ca49936ff913464b69e5ec98bfda3ffa6c86c0a40701e27d7474d51a3767951c8a45fe87c7a2c7c6321c9996de0a8f1a6c19fa87337aef041c498b4bd6426c0ab34951aabb1c38eebe1c0439c4b1175ea28b786d980998d1508fb0d4a66df0dcba3200035a1a1f656e009f8efcf8bc0cf64ea441c88feda56177296ae485c03c8fc145e8ca71c1cfe4dda8ee1056045c2d67aac7a7d28f7a0419d80b8867a2e199f65ca1dc2c4d4d1e4c46ed3a3efd50181ce6a7a40be942cedfad96408d6d22655b9557d03c201d0e6f87d3857e6e4b78135ff18abb8447de7cee612e08376e33cc962394ac6f429c5573b6c3030284f8ff6322556b7d533993a15a2bca7e96752f74834a593e18da17c5ed3ad15bbe54e3e10b97d9495acfa55780349b79b3dc8d27e0ed9c7e0863437eaff7686b4c0f960bc52184ce8e8ef94238c9aada6f0d04a38ebf3a78367ee8db121c733a037fa8f9e4d5e520151343b1332040c31fd3c7a36cc5e657b2d507502d11a95947152a0557136da03d5ae06a36d2b96df5d23aad20814119df39a0083b48e351bdf25003b5316e3b33ac55cf8b8b24e22d73a80f41dca905a9244f3fb384c856a129f5a9914b0e4922fd9bfda6e98d06e68a56fb4a657c1c672f971a87f657fa43a34e75a712135c642395ffbc18d9787a67d74583c493b8e904f0c058430fdf920ad18348ab980d64077767192be8003271b38f4dbd3f29e8acb3544b039e17b9d4c41a762a2502f52746b40653dfe3d7f2d6b7d44e058eda9df6ea091e10e950d3a267dcfb81dceaa62416e234f3903336c68865137c0da722fa4b13327b6221ecfae4379f688339cc99bae9fcfb1b5531cd2d505f81af246b9280b7f44fff60a4ecf952a51712cbb8b41ac7ea94a868fa1b2dcd8a5d75aefecf0a9c47501761fc00866895bdd1cda8256275004c178b6fff0467b72b34f444d186e0c701310f83f2de8d012e4cead91b5ae6b7f52d702551335107d2260edb8a1224adae731f89a1a54b92a8f3f580b26d95db23d44727906cb8e90f8f63c8ad23f1507d31b9d2cc4d6b5b9dd8a02b3ac53495c87228d96ada99002095834e0c326569612642109c148b3656512a1901a77197f55dc5f46ac54323853970cf18920041c04b0bbc3092833f8d1011abc8f160ffaa6eb3136715ad343924b4fe4a721811e4701d7aa46370f531998b0dfdb588db3aa762fd52654991cf81cc7a99e1ed22c979a5979e44bddbcba7bcf43d6d4a8800d5d2fb3de58cc30efa20e612e7ba1ffca8c27715602f3862dab45465c41b0b118eb438d5a86746986c94efdccb93cb72b2beadbd3aadc26ac1e911f69a9beb7ff559e882e3bfb09c5f603b51e894b95562f30bb834bb2f460f0ec21386d6bfd7574c8d6b669292f3e768ba8d5cddf2993d6bda4c3eca2a3be3b8d2de1709b1165cc66f2a8a39d2b982ccf1ad2fa80ffab43487430658349534cea46047b240fd91d6bab63e45d8dacad230a778b4969c64dbb900406e97ecd5eb94ffd24bad790f6b91e9d691937eef1c7cfc49c56e8cfa690cbb6f06833f7329b8ebdd59eee17c00019251435ef02ffe47de988a4bc1797ac5924c86e33a13e95504dec2f7245c18cedb2f973fb94c6daacbc5cab687886502ad1eb14dccd1f9e1290b86ab2d80047cecce0a44b6f2626df75bb7a10fd88b75e9864fed30165eae4033602db37e0a3a7fa0ad9215b4a9c4a83f92dcf8a729f21489d660d0cf182feeb51bf8ca5b47a4aa85c00d01434c7391c84a25f04fc66362552b7a6a97cec09541e6d87d111eb0570a898dc38d5692623e0580c56156a1bb674dae7d2f0c1c618e3b61374abc51c6c03e41e6f3fa3dbb8d7ce78d9d7d0eaccab6bee0845eb9d7c8954bc92705b2ffdccbd92bdac1a95195d97c63bd5e66db35fbc26de293d0eb273694789b365dcde4380c1e67524d80360627f56d9147b563fc405217de1c01f99e44b90e8f090bc020362aabb4aefa50f373656ebac97ead1a80c93bf1684c8babb7551edb1d1f819aa58349e598b95398c270e40f486cae2baf3aeb194277fc8aa55bd5552437fa3d6965f0435b3cefa33eaef1a0d7db3a8fa243e687e2f4f5ec62febdb74d1779e8cc084ef5365346ff9c6dc88fa9faa4cdc565b2cf618831f2d8ed6d337caf41f2c7bbdd44fe7a70b926892278521d9034cb8e2da70d04e3c79ef2b3ab5250d928ae7a4cf95ec3a691e43498ca91aa61da7a4774762d62f7aa126f7cf9159b069214f5188a8cfc3f1f65da51edc3903386a664f35a4a6015181c0b610e58330162142c2fdb9a2db864d27d1bce8e9452ff3969e230a0747464b5c2a69f8bcb0b1b0541d4bad1238345ad19e6f906b14169b077b0a1d2f65d37d098e47cd4fd403935186d0e48357ccb2ee129888a4afa1eb028b1708394b83559405346aef98cb82cc4c262e16d8b4a5ce953a83df9b816bd5b9d73ab3652c654244234f1786dcfe529ccd8a47907a80202716aa457fd9722463afb4f5b9242eb01b33492bba15e917ebc8a94bc53805a8d3c54afe4b53a40888f0f7ccb4644017307449ef6e4379816ddeeddb6ea8244b14e1d2dc4af3c810364f229ab8452e4482215f673c58ef6ae64d06ada5c8f3a5b5d9cab16a4f319edbdb44c888aa092e648f52fa013003c1abba64e82b8050caf350f5bc8bc0579eec0f52ce3a5b19d156024ba5d5eec285a0945e98a5c799dc11825504bbdaf578df40c75cd12a80f02c550293d449ae994714055df492c3a12c414ea65ad313c4a6a3cc9a5441b422d4031240b70c88344476ddc4260cc8c7cd3bee89f7e55b2abe697294d331ecf88e8957f150533196056b308c592dc6acfec53156b75491936925dd7ad1285ebc3f565db426c7b7160ab87a26925f4cb9d4e07bef6d6623173ae818f79578395d7e326bfce41b7b483a58d38dea4f54550405993dcc0c0e33db4cd9bbd56909d29ffeec5a973ffd9d8693fb9a384b8f39cf24740063186cfe6209f1ac2555d0a766cb1c8684f0fcfa95d4214eb4de4161a1fcc5e07b45b9289c93c6781c7d41a1bfe02ed5f21671e1df78960038c7ae283654a2911aa1dea994d05f346ee76319344a38efbd11bdc07e98fd3b94120ddb50297041f537babda98be2acee26c2ce5077502c5415531cf2c1be6f49bdb1b29b7193b15463b21ed1ab015cc30f0c73cdf0e3b0ab18fad634b767aa30014fa6daf34b8a4aaca2fdb0617bebfeadb717808fca9474f9330514cc8a9312748e4f10418601577b9eb007bb877693028dcb99503cc122e54d536bb9a83749666fbd4f394079d439169b86c88dbfe7dbccbf634b2ccc34dde15efb83c79a148b6796be984671b10bf0a77a01a9056dc243e7ab7ad6484a4067cae15cb409f8ea1d15983e2765ffc12f0ab3eafb59e99844ca6c5c9b5596ca047fe209306787a551d83c370eb367bab71fb1202888adb396fdf9d9e46279b9aa983a70ab95a0b23db724e1a6728a5a3e4291389c6feae7e1cbc910d42eb2dbd54fd6aabaa08446d2192e476bc583bd93a6de97658fb8447380e2ad7b2a191494f7c35beb271f20e35fcd98a6b0acca1e84b1886415f3d8447c008c62d6bdfda8662972ec398479fba16ebd6e5b51501377f3d154726a82753be233510ee0d437f98060f54d3ad9c8c71612da57168921e0b0804e1ec9bb7944bd12d1e22d5816d804cb019448a5d6c1342365488e36204f04ea8a2a1b5f348eb2c918eaec585b0478908df8594fc39d350f185accdfef9d85ba574ddd0e9c6146e04f531e31560cce487756babfdd743526aff453c793feff52b51533dd9058c253b5bb279914391490ae6189ce0172009bbfd33daf3160259a3812a3af3548085897188190fb5397c77fab48a7fe2197c7ea2d8ecb383edd575e567d8758eb6601841bb5574ede0801185447d82a231d9f7c32a2b3ef64baf34fa049dad435884f4a37e7fb1e69ec4357b8ed579e13dfe0e408f7c4947f2b183c13e060ca76a0c0bfb8687874bd000278c1a625ceae79bba66fdf8f6e6580c25da0c5640a66b085849a02b24c7643da7169f3914ffb894ee3cf5fd6170aa08d0271742a527c551f7bba84969cfbf70f81be52a8154a23d312a26a54ff5de15c11ade5d99ba0202b5d59fc2bfebf15684dbf64910dd91515a921560aa2401bbd6bc09851c55716e0f3f21f8d652dbdaa7ffafbd58586e156b7b75290bc3778e224b45d7bfc97b8edcb097fc129bec0844e8f3822b5f0719ddf1edc556d0cbddd229e17d4309f9b5895ed51de250b9db6d9cd33faf4e84213021ec5c1ba5de33166f3f6df22abc81a93f24e01ff28f162e9de5d068bad5c22adc15e80711db6f3c9f22ba22bf576ca3ec7a1ef6a0450c9e24aa32eb4e1d37a33c75be2a8987a48c6741952400f6424975aabf6df4f2a171abbc7221d83a014130d0d5c78da8cdf961ff09d1dd2ac7c6c008ad43744f1efb168454cfb7a081eb204e0aef935c74fd8f5b548c0d6a35ca741e6a208172a74f5a5294db5c51f5ecbe260a1b4298468e8a0cf00c9176a3c39c7dafc663f162ab8014bec1592b633953e009982919a43e3bf531d0d35d8344ec183c05d0b8e3907ed2baf3bfa555fcb828db64c80a91648b1f2084eb062b300125f35ef74ed259174d030c4de196c7e6d172a07de702c0758166c4390c31aaa1cf0e60fe96d1933c828c736f13fa737750a2d64fa77447be5d03ed0468d4e56e8524a21ce2aad36a4b482719a850e1b95afca8e5daa6a4c7fec93821eefd3347080c324b9634f7772684b8a7862935f4b833ca46b773f4438502bb7ed2a253b511719616bdd39c4e7dfe1c0d98a04e5d730cbe3f52ee783b283f43b6d4f5b026ec992e7d60bc778273836f027c1cd0eb8a4cda1fede470994009cd9ceb082fb0a4e36fd8fc36d717b47eb039580de2a634004be53d678043ca7c6fd47100c454049070dbdef2146bfc6a8d19aad49b0fd8968ebcb9ac8f8b03e92f70eeb0681b443d57e0bc1809e0d9735e585b1396dc8cac6b25df2f6cfe5dbd9aa8be7f4afeb10d5446e1116d2869b738d7ee81690af3646e11c7abf29cf3a092f969ecfff67b97fa570969bb29a39000db42ef38c97659e3cb2cccbf32a743f2b06441a00ab74f893d225da5d823c46c77765d7987f39f7147e999c80f48a2ab1192f750ffb02298c4cd28a9e3df545211358d9a4349f1086adcaf773cd35296210805e187047a870b794505e8ac5f9c80653d0f9465276af66c079bb6b3f3aeb8d41c10328c75793b86076ccc42d2bc82ef48c66e563c977c5dea0d2d0c9873d2be1d36a37406584b577262796e6044e15158af5c0b3f1507de15b8a8dcf842ce65d95b185713ad0823772eed29dd819293e64e3b35d73addcdc1f0b301b3279a5871412bd737a9b2cea027813850a397a2865ffe72384f47536b90592b621090ed1a2c3b34921de608c94584bf40c70c90012d44999f063a3e52b4d33507ea3f5e1754106a6b1245a9577481af967085dcf51ae9694862b36f89c75c8e1b5e72c6f1d9fd2c4fdc178751cca6e6d538a938c6046af4b59d1ba45675c756065cbe6158611e3e386c376202e4f36ca90f137cc5fc8dc2f6ba669b53ca8f4a211111f20f92b24ac2f47a930229b537c99b672a7488b7abebac519a5a5e6e88885902b3c622e7815c2d88c44eaf1ce2764a37010724921e69cc94a17c2e6f78d4cc5bb10a197ef30668310e2e885ddf88edd0455b02e732bfbfb953460d94580f0f7d407578456d5e577d1c33513c6c1bd1cea6dc6f16b44b1ab80fb6b2b42923dc1ea860399a6402f9913d0821525d17612510bb042c79ec1e59d820c5e4a0d4ef932bc473db54ac8d652909bab3f896fbb0dc0da32b43d474c8e573324be1d4c234b6a06554914060bca57a403839157cf4e491d2ffe0a8b460f786b2b2f76438ea7bef13544405cf34a21b4b77fc6a83c84e82b2eac09a18af0357efc91ce8ade5505be57fc120738c2aeaa0cf2b23a26644f2899e2deeadd0e59c4ed1aa230f817ab6a2a4353712f76e3efcff7adffca7b1b463ad1e1bd6385842f47264a0bed50a66aa86b13f4f8b0cbf12a1e2c3655b9aa782aad3befcdd6320ab787f043b093cd1cb856e2810d1c6a53652775499782843987d262156040b7e8449e0da7ad3a0d3f90a3dcc0a77d671bd5a632772d4f80ce7af510b35c828f1195f3311689a0395c71ba34b92f62837a4d16704814620898140abdbba67841d36707b596994237e2f7f473313a4bbd6280cc67888098ff4c440faf7fb130cbda8fe2246e0fb4b6bcc0d5ebd42e1ecd0f3ad27200770e87faca94e990b5f017ab05dc74e2e360cbb8861b7ccaed40cb3e001bfcd83b5558de55c7279bcdc673ad4906093a9b73812c6f51ab99a6b41a98f0e86d14aaf4744e762271f4eb07bfb2d5b47c6f9e60a38f1a2e590c19c8d3af16be44c798fb340a2b4d75f33db76013f333212c348808ec8c5cc0ca1dd3a120e712db84fcf2f8ca9edef09f014367f8a8cd5825f5573a3538dad97ccf9cf3cb67f2846aa5dcf6e8c9b0b56e13a547b0293b8d3234f9c94229362f5c703b56a4bdc83e8b362076be1161ae2659a69da425b8f47d1eeb1f6bb50ccbe5449d413eda1641189216e0bcb0634da7d3a56779a833ee8929160176e7ed7428c0b108b47731d932b274e5c6eb585c4a2e41b1463ef560f7d33b6c53aec8d55f23f5fc5ece09f0e4495e4a0a62a5035f318af12cd5cc2b8623f21eb4e02b97b21dcb2c9cc05ada31e19488b814206eb99cf1d7c859abb28c482e22a0a85e5b22a99de63e7f035b8dcf11fa378958623d72168606dff1f784c99ad774bf17d266a1abc2ca10d2f16420e5d55a51b22a52959b45a1dfa5d77eac1ebd6921b7f1a7945394e2e5c3c7101d7749766995283c1000f02a4a4ccc277606c7c6d6eb0e31746ffbe7c91a50548a8c237decd175c00819b50028a9e491885e21b8c7c4e82c38dd9c347ce9e25f519a510a40600da0d82dc57c94f2f61e8f35c3a7c29070be37119e9edf8f654326a223bcd379b84547cf65e2070671ebb7a8acca8026e11e9ac5d93394afe7cc8cb27bdbfef261c8f09341f58d259cb289fadf810a053a668169d0002993006805a3b88d14ec59677430f1c238b911c8755bfa4d270701f53f0550e442722e43b84ec6baa67c4555ddac25dd3bc5e486f914c4567e3cdb9b9b01b43985ee6a5eeb9f213ec8cf90357a2229f25c679836d59ed680aaed9c2e24f3ef3d108b374ce6660ee755a23d875ecccdbf6437f3ca70db0dc5f53e3b22ab9cb14946a170f2a431b53e646a32d00620fdfb5e14b3c009e05c839383113823df39ccd5726a01782aec5ce514c5ae8f9588f1f8c4dc821f8e804c48eb5d0921c78fc7650182d9666f2ce5883f7b770f4dfa77e560f860365889a585979e4120dd59c59fe035234d5890434fc124827ab6d667098310bc1e48cdcd3e634b8851e95e6c0ddf592a590b225b31d5859ad7ba19b0f5481634ea04c3359450aad219976ee703bc70121b372aae02a051b06108713678edf64fcf55ad6866ffda56e3322babc021f958883f2fed37f782b1efdcd68e97c827a6e048d59dac50cbb67c9f81e3af649d95d9a2838d3dee54c8c83d72c978f51368d5a671cecfeae8403ffc17c9e9913df645bd6077783535dc1f9315f44b3295cf14c7e3f6267e048f8556c28d1392a4a7a65653d2c7ad4a44a3b27b0c4f031bef1dc43fe81d11f4853448dc7cf19052925cca5e856daa6d898176faacfae2864252c884f29b4bde4ce75b3f89705d7a5952a2ef64913899463aa67ed47407497b57b70d62a4c17e98018de10624f25e9c7d394b2f71b39e364a62b51770cdf8a02e4f22e57ae21397d5cf411f8430af5a0042e784dbe6330ff4594a5395e6ffdfc2fd086551862e4da92d45d01777da0fd8cb09bd938cf504bea651af8895d8cd6debd55f4a83d3acadd393beee0b88e3a65b279941a519aca9876d683651cb75d1b213045889c9cfc0b9a8cbb39a36341e979cdb649fc6c505564eb89b8b0d20adf5042a6b1e161520491ed98d4862bbf8cf3c032ffc452740328a9db88cdbd41a561ad145b0e30c9b6f8b16c7fad05394672c71c62aacc6a352a265fca854b39c38257126aa48cc83b439c9aaeb28db20858178a31cf0c840b52ce542a4b6ed011e813b2260da38c098c70cc0579a3371b55a331155e5313df770eb2cae48eb7631d9e9e33e85680651f25b011483a5620af4cd76681e204613aadad565a27a4696eb9a24804d17835315cf432c423d88f597dcf8af540678883ddc3b0a209818cdbfa3029b7f17bf4ae6c030a5498b750457761d315c3e00f840043f5207039e4679f857f946a57dcaaee3bb3d890637c1e49f598bd37eebb1135c185d1acc24097933bbf7c7e0e681c0f8976308598705d0f20eda01b04594d61811c77d6d7d9d861de86b2a8973430c27ebb3a9b295a32b18c6e8cf7d8034bccb2629aca00e1f3e9995ba3e29adb9f2cfd3233196b45a32bdc0f89dbf57afa99eacbaf107dbc31fb0d4823db01ec380600cc0feb3e62fbaa39c79b72a08afc751b86e46b59876c71fca16e681ce5cf7130a4fe73bbf02ec1afe515c56d2ed84f6f0d7470bea5fe851058a59f8d800716bb26a1818d78897346172f6676198fbe5a424407c07abb7d49b9ae3cf62b2ca3dc13df43db5d0978f1e8324ce773dfd3401102ba74cfd2e55668696b563bec7381ddd931579d97c9c0e09d78ab1ff5718ce578b227017913e6197c6386e39ca3337795c2b53e551595a7d5850e78110c228990153d68febcfb1acaf316ca359db39f16dc115920613e0347847e4e95a7c091f604ff95ed72ece66074776fe194c0cea9d7cefdb1c900124450ac1e7c0c86494bd3ab581ec6435e0179a2f271ad42a7e30bb705ecd4841bd4d606494f55a7df77aab5acc95c967fcc5396e9264e51cef8ab181ced0a5107973a894799b8c4d846b5931c1c82be3c6d085e3e1ff6bb706aa74940d3dc68851c389d0eb774b6e30e4392ddd97af4a8094e42dce172d031c2442779030f2d2cc568ab39e66c12e55cdd87e993b66dadf5914a996d55c568c0983b7f04b73714242ae1ca8d3a2e1ab166d2d09fc2d65a0253b69056cef73219282392c79f4b762b4511ee42ced481b898dd90c5ca4c7a4156bc27b820355b7f30b08dee11214b07c5e9daf90afa3937242974ccfc5c703b134cc6224775e9822a325457bf2d216e4b3fb7f797b0533ba4318d26343117ea2adb861e0861e50ff3d661f2feda641af27dfb4f1b3d16d26f7e249a7648178046a3ac1bacdc2d2faf4a2468b8d6e1a5c92d270a246b5459394343e0b6fbdfd63842c51da8c4034671380696b6c10470bf6d731008f80958f713911c4451f7bc0ff5d7c2818ee0634a10d767a67369435f463d0e06a05b0462ed4d12b05998d72ce1d9857cdda4cfdcd313ccd4b80db12bba678699c94fc473255f0b5d64653f74728b865ddbfa952916c007103a39f04790768c405aedba4a543b9b4b34d9873f9f3734b12852993667d773fc6a4ba70b2007948e4dfd40c5b7e91624e825490beb48fac423bcda822b27fa5b2553e7a87b3d1fe1e7beca862fb43759ef21f34586355b8cf7ab8bbbcb3946dbc2fcc03c17ff75369e233413a97e6a19d9bf8063c7a58ee3ee76cc37dc5c70a6ea3d1ca366809ed12a2cf70b1497af109c59360a45bcce22465d4449cbda492d5a32c0829260dcf732f3d3fef05d7e7a4b819cbb2103914b368eb8e2b5fe6e2a3280239af96e82df144262e380d0e5f200067cde906f001fa776506e701466bf1790f5846c889c0a0300e354ae238c5df6791a35d890285ba8bfec1bacc7cbb7b30044b023a9479364d039e6dbcdbfdd984b1002f99bd64c099f68280064842a14b03526b970d54314e1cec34e24793d8ca8bd1c310ab1e10ce0b6bac9de30b2f4d547ad7e8f5cba807631ab1f892ebc1ea95632ca90d8032981a5de874525fb61a255e1d9603f5612e7d50dbdcd237a06680e5ed1b7f1d2da94a30f499b00d158b74d0080702719b49855ad2a29a5a8870551e2f229506f89433df92b71d3d9057c7a5ef45199c4e40789e8b9ff3120f520266e541d78417e7711875ae412469fd1ccda96de930820e8c3a09ecdc2a1ab16704f05a7db9b664942209b8087f0ae32c3fd8ad9537e90ab8f1ff9102c8abc9aadadd89c1ee4fdf6acd226271d5f1fd92650f7072d47f0538cafc9f19247acad7c74555fd08f1fe7d2c8d4b98734a60cb6bdf2d07784210e7f46103674d0457ad9d6d23879f1b7c47a7f4a5aa966449d590ec0a39c1e911a9df372e038eb5ba6b32e94ca5bdb82486e8fb8c34a3ccb4470ae383091c72b35aa9452bede56d77098870bb0e74d115e9c6ecc27ea8ad5ea4003666f9b94659128bc8a1e988c5b3996f5a63ecdae53e42e3cac6eee5441151664b2897b61fd44e8825f0d480b5d80e229ab78eb24efc57d3ebf5c0b207433f67caa757732c1e245017b8c5d259405de2cddf08563a3004ee93fe4eb29e5244ef646327285b2758b371c0fae45f0f8f475065dd0b16082923dcd55ced597e810f87d940076a5f208d1d915db0ef3c8637a1954eff00532bc8d063d623279db7cafad24415ca96888b52093cf399b04ffd8d7cb8aae7681e13976e7bcfb38c07530700f1fb5dcd4da2edf5fac197fd22247bd3ab3a027ddc64af8f364a1267bffe2698da4e26c73cdcb4b6d689d77c07395ea8768e0834936d57fc161b7226eae8b3c344e83ef367d9393e27ded29f9e5040c28e3dbbe8c4830a4babe1c2da8d05d2a13e364848f1f456b227fc8d3c4ba7526ccfd6a53d30a0742f6240d12df675825fbfe4fc4ccb12be8ddc08412a9d5f6b5ea5a6205c71fcd6b5fed18c35d7ad7f7cb938b6148efa32d1a95971c3c02c6dfbb1a98efdf5b7bbc50e88a3678aabcd421d15291cb4a74273535ee3390ac6938ff1dffed85f0ea1195d117c863c58a4cefab559f9dab398bd1cda37355e3d00ec6693edae93d4f3bf50c5c96967c2b865e75d392c7fd91d7147290af14eb528bea61ff61bd5a966d87b7a888d8268569b8c680e0c5b7f6b8044f6c1805ef5650b2b595da3597ed8d543c43a95bbe6815409ef0c22c8a273d64420b9e98a0291c236ed17e3004ab2189018965cb46180768a9dad2e28b2e6531cbb4023262a6d28738550e2c8350b8d898e32177187ca1be20bc121db2c86522cf653244aca06f1950e9ead35b1ea22ba49050069caa7c6e2c56296ad37f59fbbcbbef1e3d9ff26da0de0c18d3c0ec7ea4c6e82d3a6ea927c19cfdc54f8bba821ace3b9032c94882ec907541ba46acdd2a183a98bb511de43e3a575694645e497e84dfbaa15aefc34bb3714553fd1bfd571b6663253624c5616a93585da6cefacf848ab1e40c53e712e0bc58394c9404ae8b7055b20be311f7110e30de6ff1c65205966b147cd294b8143ec4399817d66a57c45a8c1553347e8adf56c4080fac7b98f123afb94d5f9f69037c6d5272881a480dcec108d5ae19f0a72be431ee983e32ee8f50f6d4fede567ede51bd4757f7e6e1513fd9abbb1cb893b88e75792688a497ff63bdef6331604512421e44516f290726f77afed3aac0a198da64210c0852bb770d5c8c2305c621017f6a047c718ce40a289b14a2b32a020f6e3514ab35209eb716937eba9b340beb2120a5eb5f651f5a375c98772c8c72b030adbf4e53a41b7d933d485a818b9dbe07cdd07133158d39c1fd9c56388ce5ab092c2fd0601cb427d2459f809bc2126de9c429e6bd3a7624e256004efdfdb83823fa5d86425162ab5b71df73a7c862119b23c1a3b270fe746eabec97498c72d3a272d1cc1def931e6d64ddd770018a5ca426c58d16bf28fa85142c6c0f15e5e41ca01ad704efa679770da44918d55449d7c13c765a90c2278a8055f13b7871307d6412afb2ccacfe4fa4ac351cbfc4bf7679208e2b5dbdc7c507bc029391be7fcb494b3715efda8bca4db1ccf438eee8e3c6c251657b9b2bc24b08e69f1274e5abb2f484de4b2ac8b601b1671575c175475192348d360685a2a9cc358cf9e9f9a2de8f679ee143fbb571121bab4b149312ad53665f18041c0bda67906565e8e866aba2a16f025a94fc6cbc74bb1b6499151a2e9b87e46f25e8ca411c1a6987cb7c4fb86e02ccf309af25e612ceecd74f523a1aa2fa7f4efef8b5e5a0836f533140fdd9e2121622f7f502335156ec96d13d7e527d5951c37ff8c6944c21addcb829e8fb86ba65ab4200068d2fd89315e3108bc11bc71d3d58cb2286a4fdb74cab1a8e72e0bc8eb8ae7129d142dac62c34d9bb14eef6459df289234a62087cc33e054d70067e9dd231fbcec9385391305370fe79ac520b43f4335c10b668a7be8a1aed214e55c71c2b65c94a0a3def966b315afbd6839f0a7f9a3d70ddb29490caacae5bc159387099b0633c278c91ae3c7d9177717af2f078c7d458fb42fddafba11ef342a61e3e1d69f5938c3cd588e4be83106a371db342cb13c5bec54cfd9e70f560c212eeb884e667c6edcfbab559655f31b55d81fd350f444505ec658c98fe11e3812bad1f954e68bc8963486beee9c812d079d6a4c62ee21bcc8d31465eaf8d427ecd2b9a99fd71fb28f4cfb8353171de059b5ae01feae1b59ce8d87552afc9c920a019abd14d6d31c30c28dd6b73ce2f162dc11874e88ff703dfe6ba6b9d03e3e506b58f42b933f9c5a2e4622c2f4ee9edc0f1387c5feb9ddd74b6ec3614d9badd005a966375c1105af8f1ed57dddddf4957135e08e45832c4adfb4afa8b57ecca1327e01036284c7b0ea9a5afec6b8514b0faa21786b58639ef19890a35838569511362417828fe04d04ad1ff2fe1ead5f0b6c9e4573c1d7809782576b2ecef0790ed5f4c8f95a7a172a13529a9b75df2a6a0ef9bbdd407e7943d119c8ff9f5702cdacb9f595f320824ed39fd663f6db775fedbad94590caeb707f895a0da38ff86048f67728cb28abb6675b8dd76dd007cdccc7c27c1cb25c4e6b524957bd8d66f8b09deba0c6935de9089103aa24b6c39acb3edb9c314f59fb9c6d61fbddccd701bd776a92936e82e01d45d0ac4043a1aabf7ff1986d0faf1bddd2611223a3697f3975b2eb5a3c144c394dbcd421f451113c3ff8d82b1adb47f9a4e9460a07f87a55038d0edd77bdb31aa264ab5e28e9cfd64e0f947d137d876be0c6f1ee12984a8c27f9740d6adfb085952c940eff21bb81a01420ad83025fa1b68cdcf4797b9af0d0413f7afc46a81fbe6aacc3aacd8a54dd2abf6f3f2dea060d4bae08c0a68aed82a8f911e6e05298fbe0899b383b55825cf479b44017b0bc4c981a6d9e3420bc8b2752dc2038cc22ef3cf957b7868c3b06d2ea3d5a80f6ce0378e99fb05555aaf5f2316442b7235628882c5296f6ccb4356466a264fcda09818a2da8b895b694728f3bbe4333519a269ffc055345e0d1d03a4b9d6e7ead2871e3d668386a32e09e3dc7aab279cba09e0b3ef3a9baa2f32078dc744f462c0f27fb7a11c35db9f81087054617039c6c32f40df0d0502adb04f2ded2ec2997cb4e6b8b906f68c33722650462875cfb596ba9569c0491266d1e3a425557fc6c255a36eac9e9f1387c053679f933de505056025cd59ddba3eb73090689ef5722dcca164da0c735ea8343223a91fdd593fb9473af9670a6570e6a02fb8f77fe79fe8c14421a9fbf6fbc3842cf6a5fb5751ba875e12f0d660ddc2b90359eee857ab8d06a13b36eb5e35e551a135c82c08ca0645576df9b3cee4044e27eb510cdf3bebfb77feba1a2bffc4c101f3e5b2ced94f657423f657325429b037a2d77c80caa9c59ee6d6708fbbe33f401273c888551e81e1c2ed616f3233991409caa4bb104d1586bdbbdb82a21663d927f6b77c59795aa4dabd4caba89cc7a325706c2f6cd0e2411eeb9a54521e5b774d93b407a6de1e43dc510a3e26ab9e3fcbaec80d3ea032d6d7898dc8d3c52465cc381a2b6e194b9ce14d05cab92f104dec076b018b76ce0933afa1de05de71caf79dcea15b233cdbef10959935857b23da81ad6cd6c7af9e816832157d30d2e83885bbec53bde5319b79186b30804ccb5a302305266b6d6436f0086d2f8a263ebe27d792cf85c2522135312dced573922ef0871933be81320e3baf4515c7f9c339103a2d8f90f5d1091b14f9e170994af719c984cb193ec2ced82653c6a384cbcaf6f691af67cf0cd7c4b9a3d4ee6aa029b9eae04918d6cd22b460b313faa568fe9b9b4b64b2a280913d311aa0f184f65cda520aaacba5044010d627b53f0c233099657ca9ea99ef1b3de13c67f08642b73b417e21b3404ce430193599c98ce8aa400971590fe423341a8131d22350b6a7687158bf9b8cafc2beef06b39deb50ec876039698a7f1a07fdfa7e9b71eb333126d6000d5e13744c1b6911cac1f16d05c6ffd7186390dc8511f616dd6de047d926f4bad1e3598901330e7e987eed098e2b594603126bd7fb79b6ffc99396b0ecd28728379c15b6f0b9dc94b1b2ac7a93902aa2c2ae84f3d7280a2131f4a134c7f4cef3a8bfaba704e887e3e7c50efdb7e8fc15673e5c846065b563c9edf9c4c3196649765058fe2e58ad893350f910874e7e46302e0078d23cd347b383a085d1bdd3f6a1174bcf262d3458c8b1482fa92190a6b544feaca4fe941a99a1c852f3172b6585ec670896cbbc64608a957939145da54980539a5bac34fa911e1562ee88c1ef8cc9fa48a9bfe70e54381db28d209b693c0ec9b94b23553bdf7923635205b8c90520f6a7a6fc648592ed46522f009a9bcdfcc6e0e77bfe4441ed9b1f3d83ef71c9083e9dfded2b45185adf6f0da5ec92ee9ddc076fca18ccb89dd42bf4bd717e959b0f232329799fd3321f1434fe62885cd998f6d14faadf31a5d1b22f087d39b69bb2720cbbc648dffbc4158125132746c338b120a7d1974252a1b4af0e14910adcd51f8d337869c46d06726b7d9175dd82a53926b584c54f7252592844b27e783ab27fe3ecbf8831fad6d5e7fb4e4e6e25537d27ac190aff19d58d3abb3eccfad7dd5a675f7be7b60732247439a6176efaf24d0a373337477516b89a0ab80d37682d567d64a329affe9c472613ca99ccb3a3eb4c7c989477d928690143ba3c7c27f900bc4f085a3df8f7dc0c982f5803638be0e684a88c2746d8476c566cc843844b921cecf035ffdda987ca3a8ad693a0a19c66b9636467ffaff107bcc584808b97f1cfbbd3a27af4127880b3df9e591a1d5e732b096cca4f6a551d9aaa186f690c01a86c18575224a24dd9cccd028c28ea9214274813eb1176a924341faa6bfe7412d3dce8cb0ada4614f1a518e680c5b8923a51cd26daab3ababc895cfca6c4e5e98c02f210cfd6b878b749017f38f7370bedc98844a297c07906bf52d9b2ddd3823d0721dc6f839d6042511bbaf97693766593bcc63c5518ee2d8c6fbfd98b7dc9543f035592a2f7c294ab433c72583ad5ed8375581271b6495a4b48ff1f3f4668c0c821e6c426f0604ecbd95ab73a5be0451b4a2045ed00ee0f35583f64fa3d0f6c127e21c55f4ec59d8986e23ea0666b154de9a5885663e8a4f05c5bb542bdeede97a288f32641bb1d1dc7c8aeca6e74603b19aa63e914fac524993c4033adadf391b2c7a1e3fc423c822123bab0301b4384bc8e29184da9dd412d1fa2659731239fef9153666bac80c42c5b1b8ccad22806314d84898a55aa4bc0998697fd8946af9be6ee2fcb751a7b548ec68b76972b584cc8949bf574991261680397d3c98f929704b562308c3f6bbf9c6f1135046f00e141e867408328ace240dc3639c56885ffb23918c35fa398af3e19e800bd612e51c2b4c6614faee39c2d3fa42bfd4f21c38a00523c8d14cd66dd3cf601e7d96a3f0394c0b47a5c62a607af67589781fa3b9f410ce42e092709fb766d931bbf866ce1e393c055967e94b2d83678915e6230b84be8de12b4dfdef714780771566d23c00ac5132e2c9122029ec26209c7a50f5dfbc9b8c78c56d019633dba80bb711b06226601b89e4ade7d73075f29ab78ff578e73d6d0021cfdfb3f25b325943272de55d1d91d3c7635b32f65764ab5d1d4b0a60d2becb7cb639e985853d19c6cd2e195fe034fe3bf9f13b64f3de984a7f53093e7b1fd76523285a82aadf9c65024e7fa16a0e219a57df04dab3853b0097db4f077d1a3f0717f44085c48a7c7eb731fca50dacb7f601f3fadc65431da4af8711488c60846f133b42d2778e932b76efd77d445671e20fff0e9661efedd0edf7281029183196f633f5d8886b3c6ec2e4dc7f43aecd11891597ed03e9b4c72d04bade83bca106dd50370acf96b9d98b86a818f9df49831555bde1b06090c0972488d32a1fe7e6f938886eba0aee51b76755f812ca8efa88e07af6f5b91fd827405ae6e8f6099a3f6608446d038f6c1bc0ff588306e258b7a47e653b171a32fc46160519e2e0c410a655349966964e06bb73e5ca001877e9fa04130ad9836b326e2d154d542dd420e0c1101133e798ab3ba043910cb29b24fe4278863829661de1189d5b03ae5ed75207801724af9e37dc168996f407c85e67e0c3898cb79e6f1009f4386e5f7550eaf972199fba001ce5b806e78a6501b1f2e66d63b714c3dfbe41d79d5b829e09351df4ad7e482f89536365a7e0470b47628eed7805e40532596878162ae2e6f1d0d2dae8f46aeefea4332a571a62ff96f7d3a0e5976b4add074ae1bfcb92e7551ab3b8b3ad06d94eac1f15cad85ef4d3bdb03b6f857dcd36feb7709d00d6b0226ea649db4560077f0180534a4f9d4f736157fe12768232c59252d156f29b475520241b7acab64f6a78ab9b55f11d82168591290de2468679e4b2500f86261f7e24e659de73d215d0c4e24c3e8f56d4355ee91921ed31cb1ccdab133457ecbab11a5482250e459115d270490629d2ef348ae6262cf16163d41615f275da737c4c1854424bbef3dab4b40b174470d789cbec9e8e6d728ad17408f0cc54bafd88350a54c43f6f2ef626513e4f101d8231c3be1bb0a643a46c9061b9ebf02ac9ebfd52f9081e68e3921303fc12e6fe849781e8c0176b8c0dffc761f410653daa15ec66b6e0ae86a8bd8241036508a1c3c4b995f10f9727b841c20164302c966810339f8ecb0b28c728598a4de69040b81edd73ac28a3da0c317378f0babc37b57025111c79f75217fd2335b03fb79d28070dec86df9906ccad995411845ea0d254fa2041a7a8edd9c66f1d6fcea35db82496e73cbcc5e30c4d1de49e83a1959209e3a618f058ac582aebe6939ae39dfd4ed9b7642f4e69a5a80c775a511be1a97ac8fd26adcb12b03f35080da92282b4fbfe2ad8b3118d2272077bf6558ac698b862d7e2a171afd970eefba670f7160c472e95f9ed81ca3fd1973b7e9908193f81f41cdd09046acafaee4b3b0353c3ee6557367b6ea3aa031c73e460fa685193710884571e461228f6b13f227fd2a70e4d60540479c6f41581b69aa2d12c81a65228ad942fced75d292bd87fa5e4b43d3ca13ff4da82001c172071a7b3cb6d377025c4453a1c37c308d20ffa11080f96150b18df68a299ca23a3737f69e305533f6842a1865876becf4f6cf70f1df9bad19ae860e94f209af9c13d0cb3ea42a45504c4418016cbcaac33a922f2ac0a2ea1878d7c17424dd97d9fa19c3547ea7010c240cb38cfb8c558aea3e80bceeafc841ad289ddc793e378d5d6aeeae591cf5804469c0fa51aa1285b0f9dd8220edcf6ba38beecd8cfdbef6ec7da5cec353d12d4541b30ab585eb844f031de8b8f2c49af0afa66522f032f3bd1110c8dc28c0087520d42d6c10071c0afaefc98132dfc23f814c7fa67712f8f7b034cb52dfc305afd64c10246e89054775b430b145e219fa55b10e62c0e4dc331fba9d114897ff8e2fe4f005a02c40a6448e9b56cb4b14947d7064209f93ad9f5404256850c0d48d00aefa163c8297e3f8e3cc19dbc6da6491c1ff5d8de539cc57853559faef52363bae74f1959c96d033a2ff403d05ddc035437234fdfb7c8f122a2d036fbea23b3bc3b7dcc9070aac74ea2ba5eefef49653deab677913ac3cc35228537734fe1a6b0c51ae3a194fa09e04ac1a8bd875971416040d205aac3efc40697284b9a36003525dc06608c10c5ae9b55602e90f50cf866533e85148f4383d25907e9d028c9640666d9fd4a2204675521a20171613aa1b1eac38d21c6aa17dafb7304ee92b2ceb768dd341190c07d1109b204442824b29cec6b4c859c4b48c980a65cbda1c4adc6d85fd99113298a71d51aae46c126142582370a2b88ce24ccd5b0687791b60577bb7a63d7d2fd282a73999332db7cc7b381f9f70da410a41f9d1976b924905aea1c8bbabe07fad2a84bed4a3eaaf0465bbb72c14cdd84ad6ad656543a438e94d9d2ecb2dc636a93cb5deaac93c4d610a3872858d5bd613d736d4d8acd25e74d6078d122d36b0692218d5d02e4be53357e244895ffff50cca2e261a7528f6aa3ab2c30693e948362aeec12ce654bafff3313619adff611ba9fe298f4a75b14e224f053cbc1830e82dd0ded15ca10ab28983da79bdfbb8dce06ea9f6845385ce904237c4c36e0f89045ac70e4cedef8c6aa1a2b828500e9bb93b8412ad69ad112074268f012be4317cf04941c5627c9a1d2de97926878c84e0c55b5976d4d28c56b07df98f1a0f438fd7952c42af8419c5bc516c61e42f3a6536fa58baf1ff37acfbb00d8d088b0e554a68999e74880106c7fb2f4a393db19f280a38176e212dd8330b3fb8f56285398ebd0e70369c85d0411b263627f974976401ef1f50874015f87c3a67acf612527101ca678d79dfa92d258b7f211380a2ff69d285379da00458c17c992caf38d6946a2b5ac7f852a8a42b59797ec589e34be4dd248a9b43b90735d527a5154f701f19d0e7f7f4a4fa57eeb8ce4abd72ddcb3e0864ab3e5c7c8085be2d5fa6c1edecb903bd99cc1200e2981beba6178b6ada3264f39f11c649d71d99769e458c5a4c570669dc084bdf7b7154bcc401d78c119dc81f512425f7f496350a0c332c036349f58a7678078f3f840bd2293dc5cbdb06a628617be4f3ebd212f04279917f10ceb2d83d7fa04bb47c12d6ed52098edc69662670e71c392c15bd725c884a1eec7a9670b6def5eca9d88a5cb9abe38c82ace9ecb0a3c25be5c37f5150119986c400522f60dbdbbe8caba80b5be871ec1517a88686a99409a55c7632f2321e9869fd1c405a869298a57e668b01727177c8a66293a1f36bebb03984b0f70fba04d79599eb98c6645a5f257503cfe94d17bd430226480ba17a51a5f02c04273f2d0dd03556fc988d86d1102e4e6cd8179cbab2769ea6fcdc59188ed9f8ad626e8953b96e6e0a961e2feff0320290ec6f8ae74c286d3dc3cd7dfc3dc003370c8369f260f7900e1bf77b8168ce092c0a36a9ccdf942c363d76aa6ba466b7c183d7f6b090642cf79279574e42fd0280729444b760ae7da3dc17cebc7f7b3fbde6355f751cb644543d441d65622216d4c8e96ed0360ef33b24ab7224124e68671b7ecf22fa9e447a4215b07328e8432df868a499b8532025718aee828e6154fa58f0d05f028ccae02481dd5cc79a35ade322e4abed539f0a54bb15150238da08e2570f8cd68d80a695bee39a5d252e1f81236b558d46df5f3fd5d77caabb417389bda0cf42f01b14b6d72bddd2c90b8f84a680284839ed61ea58e3459cd72a26b67ec8631c8f6f0bf43979a133f24cd2c2c355571de7831f9db8bb5be9f07ebcf6d89e6b82d039fa8c3713305159d7658aed146edadb23816d5eb90d22f252770e3fb3d6fd202b58f48e4a7e75191b2a7c2fa7dafb00c8f0134ba73f07b8133990a0f2b32bb446d73f5bd7992ff194470dd7a22087a53a643b8f22ad878212526ccb497528669f9984051468d3dcb6b2ba8873d3110c13607af413580db7530532b92b61f55f20f32a75b139126507f5f47aa3927cc2c1de90efed94ad8991bb4e9f3529ff46fa92a4bddbf782eb7736fb04ddfec679277613618929dee84779879ccc6533d09f3845dde582cb97cbaad0785f6d121e84163334697fc573de1f4d11cf230955aac1aa613cc04c84d5a52921da958711f495a3d3332b3bc8b58c2ab57a58a5e5559095066bcee36968b35e74433ea476c55cd91a1d8a422e740574eb8d66e082c6544224cfa3885f8933341b3b89ffbef8e4c0012646abd4cfc1a4cd63c0d6278d210704a1814fd3c3f020c46d2c0f30dfcd9a83e2a4c553838237692fb79edfa71b9f002b1e1fdad7ace66b4ee2abd5079799b14e634f8ae2de1624571d59fc1377abdb0097a3e20ab613f146689ee0197649e27b405d852047bad47cbc562f629b3aaaf520a73951a4fcf56cbaaf94a6fcbf023536dc9d0d0ca1a8aefc6778a940eeaebe7563b5bd2ca492aa4e266c14ae7d21b21c8cc67e3f9bb666d9342ef393f7223d53f8c07639698d7a7363cbb0e2394eeff24efeaa21debdf882961e2107001f37a6276ffacb91232eafbd74f854dfa002bbf9a8b6fbc0dca058bd8a68f98b146a9d9dca17b1509e150f04448687f338df961a784d109ff438e165e2fde3285761a8373bf9a2ca260b2324dbe1bd03156a272c194c69f4414fd570cda21d9ef3fccb79f941e3664f41263e13f2dd965041eab485061e5b06d879115c29d0de8de2d13902d53094d7d408739a380bbd02c05f2967a1eb2955f98938c8945ede1131a3ea7c4f4f2b378dd9fad7425b0d4cfc9c41a9373b92939ac230a7b9bd63b38a21444a97ef3068195e789c12e6f9a12f11ebecc22f97125a7f47beb756dee43bebac1c419c1914e69cd94771504f06135eb18881b6020b1fa109e0f9d0136307047a4f26f2a3e409254e465d0a38dde309ddf09d19cbcae3f5c7325fddaa3fef189e1693e52513da8d334facfebbd013d1e13745caee08afa61e4fef6e823d9149c3291a5c1639eb21969abc1bbb8ffa95d4729320d016e406ee4015874e7e7ea5bcba1a1a3ed6ef4c100e5fa8de95f3260d264d6e96c3eebaf7fa222d2d409c69b2e811024a607a0c3ae78bf5b7fd65e6d7985b6f6aadcb19a2491f1c4b279fcf7853e9ffafb8d65c752e052a4d3ae216188ed55588cb3f22ac862c2ed9676f98b40e80d9a827d39e1d90d3d1317f850907eb6944aed0dea00ab465cc8a0314081afafbfd213a57c49f488fc7b022a149924e652877f3fa9389f61165f3e30cb07ce83561edd628a7f027fd3efb3c44b26435176bbd426d508a0f06513a1f96d69f17d86ec60dc9288aa87e45daeb85d3d09b962bb319f0919a8bb5b873af7019c009d95488cb4011c767bbdf2c130bd98f798e0a83f9535e549390d3a3e595cd214e63fe0faf808157a4ab6d7aa4fb73c0e9f8f129cf1de25af5bdad61c23e6fcf0b3c703192e1115a3a28337de6ee9d104d9deb37fd6b13d3a2dd1c44c84012b9364bf72fab2578c18af573aedc8d1b65a52027ff43ca6b42b7ed82261399ed5b9361cd58477f6f0f9b9af01317ffa30cb996af8929739b0b951c338c810b94fc42c2b66ab542a945c40398dad23456183b804a0442a7f5a21d453e024afac51a95c40a971dc841c62624e4fda30126e4dbd61482e1aa24ec4be7169b1400e93a205702236f294c037a1f634f1922ff74950419910ae0eed0c6ed73a4a25f8aa979ae67551d37f0da93a2481a27afac2701aa01257f4769a6160e04316a544630f71ccd55c90d1f5a2bd504c545e684ad0b34fbab54cfee23e4e7d6b64a7cbb217e4be0f14b2684a731acff8607f8d1efef6f96cfa2a001c056d487c159c2c7ceaa2aeed47a547e5157b4a77eb6cc4eb7fcebedfe125ccc83180c365e036a74554dc716f6ebefa851f2eb6b279e3e2b1f1b577a7382abf36118e208b0e3fd640104da5120c6b98d7f2f2a7c9bc00bf0e4d8d46e9a1405206d1f0ccf500be5e03d93363e735e44ecaca61851ca2f5fde688072ac9b443f7d6abfecc9446237c09e3b7ba6b24e4464e041a4b249b0a89c4ed88c3555886023c66671004b4bad9705f546b8e21d38bd65239ff7060c3dfacbba1ba8f9d8871d132cb2dc464a730081317a045a41b6eaefaf8fba288629a26c9df57c929d2623441b795cdd5a065bf57c1ad52ff0844f712a23720e1d6d31eeec3465d0c4c0cb8a8d5612a38e2021a4fdd2f2bb900ff3a6712a16f27918b64ddc4f3579f9cdd89da0526df5ae9a1eb108e27961121ad18768ece79b1e8e3a1c7d5832316faa7045bfa1887f5c50602d32898502dcd7842dea93761508f4a663b251821b78e1ad451637dbd733c8822877ead25fb3f5e795f1b057b215855595de4954eeef59b8e191f43106478144fceba9e4458a2f778fadf1fcfa46df446e38586cb38ab09f1e23e09265e2b4a22f754c1f6e34f13aa788df6d9ba5d14fdd87312178c6e4a657d86d235cc78657d0a5a744eab5c10eae9a50e5c525707fad9d45b110a4be908cbaa2944a8541f440f240618df27e46ba9b1f9782156b32150a50ae6d48c41b4ec23486ad99510e5a787461e89e759eee1a6e5441156f39df45490b4706aa25d36eb7708cca5e9f5a2acaa775d82eaf0273ce56dd87c9646bfa9acfe61e4da63b9e61b1e2adc6337ec7771eb84bbe6da42484df582a3a85d090c97cb28ffd9f46724e0c5c08200f157499d825ede000179abdff7f29d839564e774f510972fbe35d7e5cb6d7954a32f68753400238a90daaa47216b811e452254d759fe95d6e809d2afbd6a2e5c2e28ad09ba73fdec881eaba566973ad7d7311ee0ea75bcfc7c38c25442150f2bf1744fdbb2ae348df421f3a7cc404264661df13f00746c14957aaa76075f9a90859edfdeac6523d365f2a48cee8784f2cf41f8524e363fbe7b8921a501b16dd1b174160bf51c5c10249733d9ee89c9b40e9f083caf5e55019880b360d50592337cceb1fc65b0ca072db301a15a879b28c6d1cf683fae4a56adbe351a816d4ec113c5aa3c86e1d9d69085b7645a915b37442998712a7104b76e9c06c353dadf2b058a8f1a8845a02a2e6b38d4c7d4d96d77df14e6efa5c8b0e92be21361a347bc3a9f39beb92187a7cad3ae1f1e93bc4b715dbc24262a7cdb5d66e5d52b7fea14f3db83dd9f3809616213af00f912e57b033dde4b5691adbee232de3d34477c4cf168c271e3acd7659d772e3eda0267bae4d98a7e2fd3dfe950384e24c7726e1e22690adbe0cf6e5407372fc0228d8e5299337f929d8cda37a3f3cb73bf64372dd4afdab3c5f98e7dc0cfb871ccb820f4e8486ade2b4de7d91266b851d46ea14fb0484b662282609d4a9feddf3d56de735a38f2be2d7a896e2f4d60e8b80738cab97bb2c607ffae7f4c043aa70f32fe4f356bfc91e56f06c5b3966c68e74fc418592bf6f6d1315f96c384dcc44993dc3f517c65605fde097d282798bec4e7ce3e05e75985284467566036e4540453e2d4e1e9cd70f4a684607018f035745349ba14286ec0f0e937b6dd95171d1e2504637d4b0f31d1c7b0c4f0ae539bce50ec467433ec262751a8d7a0ef1d83fca3e18c79adffbb287037cb120f376469d89d7a32c3f3559a9d88850bf8c69ad851c8f1eb68fe8bf767283d0d369f22d867ac016aec43974444acc5092b2a9ceb7b4c9149a8081680117715d04526d6c20998178c7244bdfdb289bebd6d12ff1528777a5f64cd6bf7b6028eea8172d5ebc6728a010afc43f85f46a752b50b1b580cee1efce8cd4ab5df9fad4946a20586b8878c54d09489c452353c12fad2cd95bdb68dd305f7355c244947981683dcdea100f6b196d1a76a940fd32828ffef51115a39e7bd290f282bb093b3fc7fcf9dbf1beabe0b8d630e69a0a3eed0ce1cb99a94625019d826f2a9f147c0be93aad07839e3d4dffef3b14720180976f0fdf589f9511a24d5c9d59b99298997bb1f1c0ac3f2b107d0738ce9838c4b5a57deb3aaa967751beaf83dc45f502edc3874b965bea2bd3eb9d3a07c0b9955de847c0d36e3190ce6880c589b92293224a3e478560200c20d660637207502d2584a02121d3d4e2e26848fcf74e397754ed140cc82199d2cede5f6916fef150cbfb5660a590ac7d666f9eb4f5482c7a6fda4d03260450fe9332d3000bd94062642e3d35adbed31d64b0386a32df57a60c4e4525e887d64739d703d311030ea3c62ec00ba99422cae954e68599b08d17e4f05ee7d95bddeb06d01d0ff07d2210195163d93a910b0756cc6d5c687c79f327338cddfe809891ed829d3304ccb5d5be934603f431431f3ac9bb8bec32a6274ae646f9f2b387278b39458b49205996715adb3479a9ebea44045a29d75dc3d9769756f5f4d2ad211c2872f01ac01c7c73b3c35656a033f380f5212056e703a67f925119d6102e8cda364825898ca7b672aff9abe318f922fbc8d36d44465a7db3901714294f68ce3d2801e5d5ad3626b2ab3e0553120d12037e3afd6d44f3beb32d0090498eed9e4c141a61c856799447621444c7e1a8bc83014cba3e794ddb927282a6f2c4d4dad4168c4bd20cf3697dbf3be73a5ad2ff9a5ad22700b30b285f2d5b41c689ba65fc30a171cf295c6e7d8752a54d9d808759c90f9403a5c73547dc88a3ba99505a859b5a80ad5801dc51f0b9a7a4b79fb65d8616ca89f8ee5f162e6ab66beb398648f8549b803787d5586d5fbcf5da40090cefdd9e6634e26fc21b0cad1f9e0c4779da3d5ca8dadf1f955f63770052136fb2282668536cc464c8f4784230c3acb251bff47a7a355f9098d13c5d2bb81fe6c6f380dc6d1a068e6278a30828460f1ba72e5f87b33d046eb70788ef897aa4f9e8e9400fda602e53f7871d8528f4c7cf48de6b499532b016a3ebf87971adbc55a3bf692fe890d30b5b4ee57a23d9b0e119cd0b18a9d9da217afea4241f40f8e3d7f54313412b4fdf411c52b1af8923538cd91e30f0b6be210fc4c44b46b1a13f1de0b11f806886de2c469f625e5e8e1a75ce39d117f414df1a2c27180a2a006ae59f0a17a86c202f3e6df22023cca18ad978e782ca7562d6963f256f2b8aa869e340bd08815fde7548b1398b39598b12d93d97c08db4cdb7ea8d0c07d6a01166daf7d73aea1ec09c28b3ce1b01b4d22caf67d58ccfd705e881e6923baafd194e5e25af83cf53bfb067d83ef7087812fcc61165fdc04b288da138fdeda9d045e3a4c6fb7065356529a62c50874b32f9435a911641765e59708b254c1e6703fff26e575edb670c359241753fd70560c33c52b09b117875397be0ebc2c0194bb8404d8bac1bed90b1c9a227fbbfd9000bb71589f2a689527b3c55b423c02f627e8a2084ff77d61a1b335a402f34efe512722a699860e119d21b878c7d6752e09fe824ab4641606d173518f36a7b3f7058d770b590b57b4a5b80fe8ed411496a9c3f830c489dc1057a8fe4c8062b23998c06990a73b9023421d7025982c6eb5e63699e4ff43524455076a5d8683177877617d2d4d14ebeb2acaa287f28255c61810a1f401440197023035d269992db4a3e2703f0f941a717cacb6aca1ca1fffa4313a70cb49335ae85387a1d29588097c2dfe7c9b7f17298cbbf94d8e6a21bbcd3ffa5f087a466db309899528c84099ddd36c937856a1a7b862645bb70b12c1f8a5fac918fa5b47560d54a99658858b5bc36c7466fb6c60afb0a653acf7e3ce4e11fb163738637465c86fe3a57f345d3571bc252b3d6d5f59fd597c4bfce997e2212dbdaf8323bf4c1dcd11b1b2097bfef6c864ede19514ff7af41878dd21aaf0d78a6904e8043ebb99cbd095405affddfb920037042da99678ced90aad50d24591863c3b701c38f42a3c6298611a31adb0b379440660811cc92d7a8bba70e4e3ba91642424e93bc39d8a402d348efeac32a3083ee9ef1e5da5948a95924753a0c90be9468a6ce7b1a9f5436f33f738abde92b39ea382e57c75e075469c1d93690aa2c8de6aab61bd87b9843f1830f42d05031d447ecfa8d59bf97b5e76d09e751b8f1c4a4d2c6c983d509f94d58138c7a2b39a0067379bca4e4a5d754d141dff49e73193b0cd6fe3b0bc78da9767c5cdf407053a6c6f7a3680e3338ed373a0b0afa2459b7a1fb61b4fdde63223cf3b7ffc572bcb609c9584cd89eae3de449e3e34e8a60790bd2e1c9897d2218c71710989827a1d8b030ebb8205b80e0236a227cc56dfa98876c92cb3de6bd04dfb7d7c5fa5007e7a7fb3602ac8cc62689150933318c31b94ac508de1d8e44337c4afa24dcba5d3eccc609cdf647280f8abf7dde977a0479d4756bb2dbc4a1345639836a21a4e4bd1a0d2525ff30ab068be636bd7b85e09dc8a535cca04b9b1a14efe55cebe2295289defc92b953616ddeb0a533b6aa125d6e5ac95d1017b4d38f719b0d0901b3b84db061b88832ca1616c3c112835f93d35c3c982096b2113a369d28c2bbb8261c6e71d89d2f1b74996a292f88bbbc660a4dd71addf921854180dbd9e9c91f23c545a017a8c88ad3e9682d01a162f3f3d06fbbe8afb9e88a399849c036c108e5469b6714d3eda1865c328bf2ede598a350709020f46f71a21f947bd9f5627b6f1d7bf134123eccf449a47d3cd2bff14253dc3d51aaa9d15d743e8b8951348ad335d684df16c1222d9476dd5c4832f12ff21d2b253c44d4d506f2129c6fc79f3063465bb9722703e2ebe7aa0f43b270c295724781f08bb3d50fbd449c3d528f20d8f9b5725b3f9a23983512f877a57ebc6ffa21d02c377067f1a74531a16e458f588237f77afd4cf87ac115aa3d5943bdf90e575bf086ba9c9076c9969a13d146c3cbc9840131b87bbd3eb1877d990f73217ba9bea6db31724993d0cd487df5b3b07031b9f138724419f7240afdda2ce56e3e738ef662c358b08464a5f98b96a8f8d47a8d3dca6f9125cf6008a80c52853139b65dd9b5ba2f77a1b17b7bbc60cff12c11d6a500d1ad2560dd37ac5beef6d4e623a7092161494f88fe58c57cc358aacc18f235b90cd37c0d6b7a5589f6b7192f103e9cea106a24b4afd1d162d00defa3abe9a06d54b34da7ed247900ddca25a9fdbd6fcb7f045d5162bea4ce2f985298545609e5e94be25554ee8a17b73ef8d141dbd122101a5f7b191600c8ee548a17c808761eefa08f38d37ead4d1c5c3b8cf01a37558c04b80624ee1cde49477e71e03b04ff6e893a5d55c80da28934bd51f1e5c992be2bc7534d7949677123fa02e6611a6488c0c7c3be6b48ac304355d3046f37c14049265bb3ef22381b08e4d74fee0ed782d082705650604f5a3560466ed0c5c77e006f5409f38d0136e545dd2280d621ce0e680a504ddb6be98eabaaf516980759be34a4cbe103677e858f21fa2575ae50f2665ecc2410bf1d54deb3a245b9314ae5e09ff856b85d1380895a6b2cd83eb6686c52408832360430353bc39753b86a011dffe4d1928fb7b67709af92b1a84281ce2e6087c10b8e589cc3feafa338d48bd897835450a02fd584dac63bd5c3005e464b76f8c14756ab70c0ea5a42e19a8cccfdfa9501ff1f9acb057e4ee0a4f7d63edb330bcdf5ceabdc31ec85b5c56ba87351cc414a2a8483385f1ad9ebcc339ed53fbbbf71d998d11c9fb3c7815de7159cbc0ae68aa51d0bb38044fd45a236392c6dfd45323309ddafd34df8f3db2e3d06391573f68acc22d34ff86c0eea2b863572d1b3e25a9838d0e730e419d35dc2229d227e1c40de5f30c201e405f8629151ee8b1755d3a448e3837ceb576c3d23224b82547e3a5a73ba53960bb1e3fb3b2a4528855821244d82f3932549d1613ea65ebd85c5e4b86e597be824dd2ba38bea023b94ac16e05f8ff3ffbf247752b399a1779e561de5375f340290200fd82ff8d53bae023daef23d3f366878250a7632f66ca58b9dee0add2493555e1f414b5c6114e1d3a08c1e406c3ad9862a21d5dda8430b70d7e9610bc50d63ddc85d9ec158afe779be1f6dfa4d9bfc9e41e55eeb8d1858675486b21cc0583085e4e9d29d715e0ef5e2a2098650c9bdc81d2e0429f6e3c6fd2084cbbf778a043d4564c76a45d51805ce223c6e6d5d9917e3e247c71e3dad041916003bdb3d1c160f74f24dc23be05cef8bcf8529459a554122e979d714102d542940eb1817f0c9350695642f5ea620c67c58f1523bd2a77e60acb5dd33da2cb07903cba7d0c9ad48b1bee2a3099129f5ecb6b5b494bd8a739ba8cde7d670c278ca869cc064e01049e3d0ad7db14a9dc3485746dc5e7a9d705fb14611b217292ee23f1f34d4680d5a851628fc5550585c737105c532482911c24f03e13bb9d608fd76adbd494d1d6ed143d10649e88b1dff82057fba7407db988ba608b3995af47129f2293798b343bf864056beccb15131f810be1c014d958e582304f0c5e9d250e41878dadcfdf68c5f9ccfc910a4be1a805aea5770287888ced96f516b16de50ab13dce3a2fa0ff07c9a1568ee9ee4d77afc0ed50f760cc21ae240936a776e794c4aed0afe8e698c682d184a8a8d32f75d85395df71e5dad213b59014cab86bfc68c4e771b39f401bb62cd2e5c41f51ec7f5acb519c971f70e4a524795b9ec12e4de359ca8d7e069d4c6099ff93430c6c726293fa704c4e041c567ef42bddf2582b5ce12fb7ea87f8b97074b5e8f4416095f880e296c10bcca581ca6174501cb745e1e34bee4c646de792b6197edf8e3906d8859da10413e454544d86c7de46f5a8c3c46c8066a73e11baea816bb061d41520bc2296f8600cd16d0a608ed1183eddf97f4c2ffb7619e72ec888fc4e47726e4ab6eab74f469a0fec61cedd35c137511b2d645a576a387668011ef7275999854cf6b9e418ce2bbb3355ae9b11222c7315abf6e1b004863b3efb70521d870479a4f8cdb0be62f59107cd135e838fced4d7a84f3db16aafa13cf876b181f211559bd94ea62ced773fd0267dd40fc2ad1d2eed835073434a30135c7f592e7794b002651250a20f7906b4ae63c26d5505d486c2f2abaca10c1a6b8acffa0bca6ee5caf49905a1432340c22d231181e6a6230204f6372eddcd66a6a402336732d773c0f8aee70db2ce04f690695e2575748024cf09bdae0da3598e6627e2c0a0de670ebdb99e3dd0ecfadca76d1faeeedc12e28c6575162cfa0360c9602ce9f35cfe454e5f0126d5b06e11efc631fe33455a0f3495d91b580a1e85702e68686539f023c0c8d0d7f7652617a483e94a7ca8be7b34d693b34e7209cc131443e38a740773b854073fae4ab024d100f49926a21b743ae6c2c97a5729e3dd098f71f2454c86c940a8cacda7950953147ead8f889beba97cae1fdb79777f35cc18c01261fc60e58a0bdf560259a3de155844f2a3d0fe1bc5d483007d1d896a8a69155b2372ed25df2330586d0a3027fae7346fe9c3b84d37951f54cf3823cddf97d1606a2accbc7e5f2c0ab4675f7f200f5527c47fffac62ef3c9853874a41a74a6eb1b47d29a080a9e532279602e7be268b6c021bbc3f8654a8b0a02b5f0f0bb5bd25a61eb6295c14b10f896d07410c257d8365301f9ed5361b1fb142fa36e279caa97594500c19553e7266fc6b93a3d62dadcd1e05bdd540a8197271f3a9371286673842265cc3f19d78a267ac2034526a26481d67653067ed6bb734cfdc21d9fea4c263544317e06c24e3d1953319fbb91dd0f3496c4cd14b18f7f470bede9be6c3ef1a4b1c8ff37ac89db219458cd8c9c3120c64013c658f50181b58c466965d6e9fd5ea1fb5617e647cbf9e4c40c01da54cf92befcc12aff1e695a18887398a9e0e9441405302feb470300e9fdbe3ccca9aa28df1d964111003765158659239431228734dff71743e94c2ad17be56f54ee43d274935001e3026df9f613c4be666eb69ddc3d92519d9e811a1e425273cc1c3d3b684c1d44510b1682b3d57db307977dd692d4df53e4f1e38144bb2e44612ac07ca0ebc06918707ac6c45383f7589753ba45eae7c330381467331d03d94cccd1e4b739f983eb42ccb5d36750c1cc8bb6b2f7eca1d590143c1cf8a23d4bf316e0fec4bbb8575f154dd1c3f6d73cfed50f89910baa80ee6dcd14e130824a612775ee6ed56d253454acfd88fe5bd0ddcd1d6cf94ea3d3644bb1aebe9d7593791451eb22e54112576ae3b8cac10eb1be513856fc2778fabc11dec84eb97950d3ef2302cb22961e76d1e7d35bba26f67394bd2d69fc1cec6c4065da051d0d74e46765f1c23ab9d89c5c562c4e18195b761a5f26d66d7f29abbfb75ca57b507719623998d52dc8ab028a3794ef0b6bf0d9ff7076e2cece651b0bcb73eb71318a43cb74c1ef8ab26164547fdd778e0ea918f1167fb2d3cc502a1c56fff1dbf0e30cbbe361c2f2f7e49f9a6626f5e6da9e123bffaa997ebe91c11a2757384a5f4b0e6bdc470e88b20bf9f1a4536f031a7658e2fd4b7a7bfadfff88e1b4220146dde1256a7fc4cefa58f516e2f62d7e8f8a68ac1daa0ff3ce2ebbe95ee83845885e81589ccd12e49e1608661d5e9bef85a4dc85e3a4a8bc85d7eec10219ef52975bfbac6d91248246f6956fa28388ed2e3ffbdb8a1fa4d82d3d236aec2fc68f781c3a71da02b0a23d639d9cec3016053f3b2fdd7fccb85dfdda34de9744f5e3d84e728b6c57b8acb5d446d846331af7cbc7b7f3c9206ea36a7b4f27bdcc8b186a0590697e6955c933c730d84b8c9a9e683c93851764d9c88c65196e1d5b53b636450413ae7bb52ab0d9716b3ce5fd653873f2dc0ac04a53fc6b97f7d0c64380ed76ea71523f7f78e7a9e686d8fd979f10d3944eff9a29e1c0c48e7f95c5872d3c932948904e3c3d18b152e743d33b3aca631c35776cf9fde1dc06b9849a705c4baa57979387163368134bbd61c609a41e639f34daaa689cbf60cf4a2fcb36845b44aa3d270319e1b3382c504806b4fca57ca4bc1a630de9fe853510e3e8601a42463e4938b3a72831116c686f436ebc5427b18ce8364abcb64dc99874f7cc9b9eaf1e53bb76b5e18edb5d65a48009a7329701f4add6b2e1e8de7f6bc314e1f4d7c944eb0bb0e89d2f0cfea975133d368db4bc0f81fc309a46dd8395ca3bbe338a6a411d73581076c53b8d8c6d7986015ff48215e9de8039a14009c1ba242ea46299b33775cb90a2cd1cfc2a9cd9d03f86b1b57dec1bf52ffd8437b9cd2a368067ee6dea113803afa1fb835afb1c8fdcfaa8474b0c532ff64f3e86a1c4c30f165c9bfabc61b39c8b5d4848001a4975ab30212bc9c15d94bb55c99d22d8c3edca6fada8c73599dc59253e2b484ce38dfd46eea8c48d31d3701ceaa96488281cd118c741343c1b1dff75a493afed55e6ef2795398149bde739c7a73364ccc355c949f758f5a2fb3b5e8e01c61f8713f3314ddcc94d0d4e66f1b8b87a2c9008da710d7a15818bbdd76e7e89201451e63132889e4610c9fda575895946f39c7e7c3c8f70dad2f49eb3b69eaf567aeb80b84fa9af528e152d574d46e1321c0bc209cba3ce910615b8124a5874e40b90103d8259cb22ec19a8fb4df507121579ef78d9d201d4a6aae823932a846c136a8cc7c759040d2c28b73aaaa88484faad6edcc28fdbbbd169cc658f20b4cec00131fdabca882bc802de1ffb7dc69b2113e788b11621f4cd56d957844a8dc9e4ba51b50aeb42f0a852cfcec1f40c12f3bde17dd2e10937650277f3ceb05e5325d1ba115370ed34601c7ba2fc503effcf78545b4f6dc58d0639535b941a567cca3bed45327cfcc70ca033e29cc95b929970b7481859b125df35e37c3d5feae283247e2e6fccb96cc58fe0e8140be18dde7687bb20ea40c31afd0f51d5dc0d93062ae1420a9e124d23977dcdaee2428b0a5cd7a2687db01be96eda4d2fd3a06d26ceae5510e6a13e4506250637f453d2d5168045a2099150ca0d2e47f0b3b6051cc1b6f7fdf7ffc762dbfce1c56eb851b86dbde6ad5e8ef802254b76c9aef33ad90ff27dd7cc4d690a0a04655137d09ce951071d2655b21001471da3c383cbfd587d9472522079054f1bdc62dd656e570d70adb614963d2d3ef3d2fdab4f8ca94779738c630cc0d4457ed7fe183bb7aff02c455b2fb4394908820535929d12ff622e0bce378a25d85128ceb79f3d39a66a9073611a79d8048fc5e2ee9f30e087659f201d5d866d385c939cebf9911090a0de14af7a3d83c1958347350ad6a23aa3e8e3871fac6be76e92b132667f242071562668be7fdbba8ccbb9a1820afecccd66c786bfbf300e7296c1c5ae7bb2b2d04a50b4d6b4174dc3de50919a7227f6d7768678ceb8bf971322e83b27b56378bd3237d527f9fd8b5fb5fa7b5bab2ac9e36aebab6a7b209bffb4b022341595a290aec7beae33df96c25838508a60e1dd783485d76032f00d614b7bf3e87e21128056f70e01ebfd9a0166ed65a1ef6382d12fb3a2fef378c28bb431876bde8409a600eaec06509b786b534d50022641752d0605aaae6a992f58dd3f12f4c1a388cf242d1aad78f7099d7aed87bbe9771c2ce8890b85f1da9eab1d1e8d0f4f79349de1617dfa926cdfcdb14267500387874598412dc2a033709aee7b44cdae29edf7248835258602f6c24a8d23e7c41516fe427ba001f83b03fea4513914eb3e01292bf52e8b884674d854f6c9db57b7f36d268eb87349c474d743c878dfee7ea5959f5158f5e7c093bca5c5903aa79a4d8a7163ee8b5bb4ddb81c6e70cacd825305c7f4e0c54d1645726eb1666414e95d5c26bddc616403c9e83f244210693c34b0caf50d0d62b112ab5d7f5d47f7fe0d63c698add3f3f79e4d0c85402cb5cc9e05bb6e5ae0bf8df58b0f473374fe7b8cc5fbc4fa21f243a0e7ea9dc834b6e11d94d5ba591b82d4cbfcbf18a87df80b2de0227bfd7319e27d1a043e96c47d81263aa45f817a1dfdf9e3a8fb57b48123cf1972a660bc86706e81c03a498f3afb45b71e5174866b3f7d480b4fcbd77c267f4e6dc40b7f17970d0ce1e222bf6c53a1653d7fec3648fa29f74645b147446dbeca6ee0e51118f36add14932fa7219cfb76b2b2502309f8a4f8bda5415b5e784a37eecbc29f6a5fbdc8c7d954430988329588b4acd2cb6491238c42ac8bdfeedb52e7e0743667e7ef41661b4809279aadda80995d90db4c1fc0802215359895b5e068d09d14def79a8cf0bc3fde45e73a09e5f484d04ef18c7955657f1ef94db756c4daf69d61c2bdc527c26631e1d12c921b1e257a92e04aa18757be67c87a114941478208eb8352b7dbb2e4ab7be4ca452ab44025d0e1c9d260fc0c399c3395981fd54c6b50c67369c3183a694b7acf9c22827fc8533f09b3073e06a35ba64a49c2d05ef8801c6668473b53d7e91d1470e452c4d5262bfdb9bef24cbfaff24f82b23458634c69ccb98ac936cc574ec44255ac6aca4a414c92a3c9d4facac4824c01661a8d36c979fa672442bca29c1a4bc60ac69f50bbe9701f253e53cdfe44fefa62b67776a324f3d2ff9ec196ceb1d4422a172d5d5f891797ebb55b344d84690b37ac59ff100cc18e7767485b57c981e3951bbd63ee37ee8b6fd5c87849b1893c4c9ae8d92427242b8ea504547bd979e5e985a5d9781406216873641f7fcc9d1e03f7f5fc11c9fc5380d64bff4976c5dcab3ed57ac68dd885713f195c8829e32952a2745a69d06894ee3aa41913c6ceb984fbe1f2545a6df22f128879211b8a549e1711c4e7041ccce4a4d028ecba01f99e7d9aef186eac672a04e5dd5c9e9f1055291d6903010f38a0bf4f8d89fa5fcba7ed50fe7ee6a0740bca014ed2352239ee818505c7e2575a19696afdf42b520d88c300d60706b6ddb62a782597657bba1e9858640305e28211ae00b5f4cbbd21f21a6d8a5f95846e3e312baa3fa5807aee92410eb686d5890c90fc5c99fa19d3c67b6b8d8bcf654f2ea33057fcf49682e1c24690ac16b676598a1d12d5342d8661ceb8c86345d44cafaf0871d001069a26e98f08ed65055cbf63feeb2f0f4f28f14b2821b93ac4ec924a4714a85af6c00973da28c2c2c2aa02ca2aa993fa193f24fa2d5e438df56cb241b7793670437c28291cc22cd8d8bd17221c1a46d4024bf0c4c2376c5bcc9a494004c7348f8d5c88ff79ece00abe9388cb9b38a54bd577218b3ed83598f0a8a409520628862771d5dffd1874fe9be66a56110ca0be643104e23039ffafe04020bd3597f10cfc7895c06fd9e20db2a3c2073f12b801735e1900ed35ce55d430c6e0d5665f292b51471d6945c77f4272f124fb70cdac87c65b6d2ec7511d2decd3a368b265e37692e8bfc842687b469805e438744060cf48539351f8395aa579abbb594a223a259fbc5b0d82b8d1502c594ad136cc40804f7a6946883a4c63be6ecd33c0ae4137eafeeaa1422d3f3b4bcb5d0bca222fa9959c0287fd10c32a886d885f48921482195c6e7bc199923ab8e9bd408d2b9e149b1928d9c24185eee32ba6097bb4a40bff76026f0d901464cdeb9e969b504e9fa61bb1523f5134ffb3034d328bdc6d803bbda70b38904771251b48bb6ba5bc7d53910a3190f38ca0a1182c07a62a610f488708d4884a1a4e36adc9ad9217f0428a85b270343c25ca22869f7e7706b3b9f58ead065d354b64ec176ed54a4ada6f05f7d17d23c0c946bbcdb9c3c17c5cb0190c49619d0f2286af4288f040486858c157e54522cc44b07d0fa49b4e907ec6ffd584c2aa5da99ee0095cef86ce20a7b1a44557e1f4f6a21d41c2a5a5919fb152e0ecf5450baac94a43cc88d9ef1f789f7ebecdbfc00ffb50109ce8211d986a1c7219a9378d78a6376efbfa9e2c15713dfa01868e15c47af1d439ff562af44e8c2ac38044caf96740b0c451f08cf59e28e49b23dc4fc72f335fffee94498114abf668e86b9ccda73e1898d49b16289500f3725d7d64df782f6c5ea3bdda0cf364fd2187adb2257b05de74ab59a91aa24e47e9b09d8b66300dd68de5097e59f94adc50c95cf60f706329d1d96bebd44dc744c95cec29f70642fe5f636f5af5d87a903d2991355616a95fee603324c0a2937722b357f85eddad819df06c00cc2d5cb66c8dd9e531a7530bac0f5f6610328361f86316033129df6e9683098ce79d754fd02ed2475dd1bfdd9e85b8389deff78b19194cf812560759ec7c07d8e5f808aa9e8f9e5c95b18200a7e5a82a665d1335d07d4bea775513b58b59f4f2bff14bb8087316a5a492b586ddf05777ebbcaa8b8dcc1aeda075635d0c2461603afae0d7a063959f93308b965efac41e84690b8ed00dadb70c134f667dc8001cc71ecb9befc148190d248324f1c695c8cda9a8321f2b508832a008317c0a326af1c8d0a12c99c3c61e01994b2e0797887984240ad8198fdb83a29e81d86582f2d53baa327c6345b295299d3b15b3341be41168875cb8f0b4079b36106ea64c61bc0d7e29e3e21fe9ce2ea03dd6c694103074ed33c0ee7c0cbf29dc26ca16ff6eb3ef19de66bb943aeb58c6edeecb085f10c0b268d3832481bf7e3df1ab09da7e2e8bfedfd5dafbc297d43393872cdb3e7dbff579452634f59e3317bd0f7d6f53dac550323b7725e7df579b7eaca683280729ffbbd2b4110c4ccdbe6f96d1127f121c4e7472670d15cfc1a71b78ae6e559702f45b2c0e37ed5ac13f62ad409ca585f642af707b071aca9d51197a6ca1023bbdaf57e881c864cc2f9b6c179d253e775d215defb455140d3c647deb65c6a39e495259764c3a596945e1e3420a0d275e2eb5d270a2a8b9d1272e31e35e83845c569b932dfc64dbf22cb9fbae43db8dda5f3a78e86249d3854b50a5fcb9b78624148fe22a87754fdeba136e63c7904dbda2d157a91b78eff3b06c132cdef56f4d918d1eba69d99375f932e0eddecd71c85d3ab51f8284fc309236eaa70588bd32b6ea7240d165feaa8c55f502fbc88aa6dfbeb61e14bd40aec098471daf52b23032c071537097a9b13bf6276c4b43f498f41d0fdcf68b9107a858644c695aac6f1b2f8d34ec01a0dedf713ab31efa7836688f9047de44ad7be3ebb5ccc4a4992369a27f1deba9210d9a0c85cf9c257bc7933ec0bbf93e3076efb0b008224d935458fdc24c6b55d9dbc4462c613523297a427966e192fc844f2e59ca4ebe9f0676706c9e012e01cba95f305cd66b7dbf2678a8f3fd85f8ca8fba0f46e64651e50f7bfe7f01e209a6e23504a00d7c4dba557061915bc8520eb6501d4d96ec928a7211158cf0df38ca0632e04d31efb7d03131ead47ab67892afe388afe10d187affdb9441fa46d2cb9da0081ac2b2e4b328d97d9eccad111108b98d25e19b2fdf33f9ef9d164941133143000b3059d978481f870bd9ac11c3a8a166e5ebcb6bcfd3988b6973da6a1907cdec39c32c3b658abff94012ff7acfe264f3673fb8f6158397a446155a7c8bcb422a30230135d5ad8dddd0ffea72bb7fa3af5dbe72774180f98341ef82cda64ead7502cc1422721002b39cb738d2e57d390fcb2ce816fd14b81d6a6a0eaab6e96f14fb601eb748624ff8dd5298570231fecfeae5476613bffb12efb815cd1c826d3edde215b0338addb1d83d325bb4feb388e7c460fd5b77c0d970d4b866bb8d1bae6043b16a361909c4bb7aa69245085b8fa70c0d69b93aaa99a8e7a3d9ed9a07e566295a4d0685541f9d729041586193c0fb72f722dda8852db4a2bfc9c9758ca88e8e40b2e5d462b99619dd93d2c703ef4fd28327cc9fa17610fe6e7747dd06ace20a13fa5775858716c044951a6c0d5bed64dc04a764f39992c2f337b4fae2de6b7a78c99bfd56523761471d5f85754c333613a764fc46da074aed5cdf4cce54ccead729c63d70455fc228bd9b87183a7a7828c0682392bbe6db6691f913259ce0c972b2041741d27cec0e7ea659ded3d38607635ed82857e94e9b93d2aace846494e83de884d74938a77813024304c633b522234d8594d39d5f7967106e755212f292c32527da07082004e53f62e348ec00630ea13885d63e13ee4bd5812ff304c3a93f4f1f4490189b24bb73980184beb0c7f8353f6204ec34dc21ce35b7c90dcf396cd4a6d0a672839401ef2de510c2bbeb3d87a4053b3e509e90748c74b2ed50b67d6b405d98267a743a0bb61cbf251af07312ecbdc99b624f526655084cd59823779d725358ec914314e3ff618b9c7061199ac6d3e83baeef9c658cad53a0a4b672e71f44ae69e5301edd27707b4bf0cb706af5bb0ee91faf603ec7fca0ab81bd1245fa4c8c8742625a84396ac934bb6f772651e378fc3e4057dda399220c88f7f3523f40d184f65879870e50dd9bd2ab3c4dbab43e55eb386d52d7ffc42b9a35708c4997b240a0748fe02ddec525e9bb987e687ff68e86a15a9518c931f2c5a84496f50baa1cd9b0f4dda2fe1ab7d1bbb914cc7d2260427acbf5b8fc8e2f6b929572dabd8834712b2f9be5186674c96f7c5b4999378ebf5bffdf1bd3812a2f13371e80456f40d6623a3c6c98e3acf7059ac29160e4ad4c017822ee27e075d812a54fba1ae8d14182ef42ade7a5980a498ae8c879c9224278249e4ab82abdf2eb7e6d341b3e72dc67542807a51578ebaa9e6c12f98ab3c6762db77a50c8bec40038bb1a7321142d418e7f14c1e27598410e0a588c89ebf9343108b8d583db2d662b500f2f043b709414ea05de5881ba5e45a59a4e339875dbf5aa8bfe224b165d2e9ec88767d41a0915e161642bb593f531e6ac4fd93d2db6df630a8e835fd6d3ee7b86fe3ff4e6e0890c760f661d83b32b4f06c279e23952c8f96703242700c3d4fb7ad495ef4deedb22bddcb71de8ac3035b9c40f581284f088ae6cecf935af741aaf909b3725b143bf11a1e8ca0307feece0602e9d59d88054566a04b218ecb5db76bb428604164a6215b331724c31a01f71aa5724eed07851b82055815ccd8cdfd2e321ebdef766c86d7cd487910730138f0fc8ec9f2fa2d40e3c6897ce9900d568d680f01182adc302d6fd1f053d3ef2106ff2644441564afb802da876eca7e3fc187425e022e4a4b4abf408730b3156d69fdd553edf39dc392610dd7174a0dc21d915f7a7df13491c4f102b6f1e841863b2e90a86610f46c76efaf807bb588ba29c35db87f3caae669ffc372c2c5f9c24cbfb2b10e9e2d9d3e01a0dbceff266c4790727aa304cca35f201e506f81ae528d561fb9f5c389a8d90a75088762f8736c8cf9b00ad5a8471f34e618dee406b3f51ea8cc6e4199f48414a8763963f6eee6bc34b8ad2863f3333bdbe59577734df171456989f16fae1c63ad3f4ad80923f8ef4020892affefc5025776be31883981467bab421cefb282a402d10a3f40eee3de9ea836ae7d48ac32412e3cab4dd3f281cc739c0a3422846b2e7717c3a6e107448edcb5e7fe05f3b0e47cc3df589fc6e7c34cf8d654e86bd7d8b0e36fd2ebaee203bacb273f90211ba9e51721ecb93a118db185a224791348d8804b69be5433639400fb39eead7a70598e69e683c388eedab403e6f6f13a154798cd25d80b6a45ca68d69aa3ed3c9dd82ec2020e8527ff37313ab4e57d07fb2e6809361b3717dda319057a956066d397170ee0be9c68e3a57e1fe93ee991e43c8c557496ad9cd583d8f8b8805682906879e104cb22bb59a63cb841f8fe8e4e095cb2d8c55d78be7e1189ef271fa8c2f91e913cb6b3e8439ec7596c7ce56dc656aa2e9756bb689352c92331b5a8083d68e7d27ba374b19fddb6a71518ab0703e3d42133f9116f23007d90b25b0ea501fb43a2e721ad4b82b39b91662bc6ed85ecbc9057b0fc83d8b63e22e53db3d8908efee5d588942bfd0d09167a572f0fd18812f49171fadef4db0d59730c9dbabac0a6a3f28e5a189fe25a67608859907c772154ee2082bec96e6b8ab60e3e23d309279055294e73af6bc76a15e47aa99334f48febc5f70573969bcdb9a3fb6f4ec9343b9764fe3f60153e91ccf7ce7d860f322d9a3db654b93f4aed206a63179ca7c34766b24f454b29048eb14ef9413072e36fc7326e329f8958c26a96b06173d503db5362bdd9da45b00eb79546e662a3f1b2714d8872d03987096352a1f6058128ab659a2c7a83ca83d7e6f9415e6044ebd08c6ec769a7c9d3112e076ada047fd67c2f6eb8601f92109e1657ea560622c38a62138a8cb8ebc2af48790622481ebdf67d27c0d0ad91823b9fe4c07dad0d5465b6016af55558bfc79f1d61c8e93e82d4acfe86e30845939973a6f0940d8a713e8be0709df75785dcb4fbdbc4731021e40232424a020a54a7342210a5ccad805a907e9e62a3f17b2a9c0f3e25e090bf42b109f7b4a00ef5ec078e08ab8b9c8fa3e4f9b5a61796f1e80f97c016596b882097dc9a9f5786c409d62876b730fbd2d339d719e3899b8ebfe72fc695411b278ebc0a4331cd8e36cfbab0b7df86f7bdd6c9b83b4ae3fde17624ec87e09f3997c5d6be5d278eb01d51f6a2f748b599095cc3851950d666ddbcd91a5a939a2861a610cce619e040db2ba92f6a251e57a246ba46a150ae5a1facfad150288b26c1eb120dd27034c893e33f29d74a6237bd5a262a9d43d335c0e977463ca78b9af560889bada7fece1ba9a09cd4d878cf930c04399a5e4db3e5ac3702579203467f0fdbdf35504579a2713dccf7e6fac3f361175cb4bed56f5465a71945445694bccc157dcf18437935b64c64eaade2d17798b2e99cb651da5d005868174863b2faf841378212f425d60ff5d6c55a10b236c0a0944db484222298c61e08dccb077a654876310d26b2dd6db3ad7c467481f2a8ceb834034951f480652c854afdea3130f3fdda4f8c2b8bc6515f25778c1dc9760a8c516f2860c8be99ea667e34c3d6e5c65b152ec2ce60e986e2d9194a5818c11a107731673c8b9bd64c2405d500cf804e544199b67125f76f5677af454d6f430d8858fbd69e986dbc3acdc4ab089d915753411818f48bc18d1b6841a90aec951c72c90d1545b5560353abb50492fab873b4169f387287c2dd97a5c3aa0785ea79b188ba8c51bf6812a36a798eb0fcad57cfc698665a20a5b491e308d667dda2d58d84540164eb153e01726621e24dccf8c7f1b24ad057839a01000e0913df94f7d38dcd04b5c1be7889c6155cda04bd4aba4aa15951ae0f8f284a128cfe4fc6e6555e45fd9a45ef1143e7aef977db8958931fe370e57af07f76af3b1d86e0590001c14564b9d6e418e6e64465296ae6465b3c6af858abea72b769e7cab34a7418f41fe4aaafa74357212dc71f6764a2893bb1f47502cba02eae7b6fccfdb87d42e6a66fcdb40be527a43a30e3740f8497a5b12ed8ffc0199e2fcd9c0737f04c5450d81eea55d8af32a00eccc8c13945e7c8417eac59c4ffaa4c5d985c7f51bf920bd1936913e8956ab6e524dc38c5a664bc873186cc265f5ca01e1c48460e5e69ee144e2212e68924b32b10ff3eac1de6883906344ea5db9550c8146efb9db77f8a7e8adf4d76cf1a18bafbcd05556c3f908551466efcca7eab73c53efe9cb500bceb91e45328e771e2e3336d6e444a570be6695b025e3532ec9fa12f077b3f3bc7dc8d16e5fd9b57bfeb6180ac1ac3a3ffaba5e6625d0f7deaa8597cf3c5248e6fddf27b9fb626a25824a570ea7e935d36445e9c1ea2646d2f3c67bc9d3bb22893ac12f412db2761911b238ffe1484053bee55996943c311f116a26ae5b3779fa86ff554069d6f4cb209e37c4137f11e016f4d453de7c2c8f77497d487ebfd142ec20738c1e6825bd062cfc22841c85b561221fba3ea5d52b38295212b3776c68ee8d8f11cafdf2116a3edbbefc82ae85a8b15e5963a252bdc7d1dcbd5a3b2241010915a69ce6491edf180302efb30cb3cc2412f881a528db5354fc9c03935a83145ad4a5544392a4952f1fee0699ce353716ff0b8bd14821562d468c7437e2a8015e32d394c5fca88c6489d51406c9b3bf8f8b159eb2504c67e2363158232a59a6ff8f95bdcf8ada970d967114d4e131a86c9f75202b9489ed2ebe247dd290cda442192d97f04ae2ed3af4bf8abdaa55b0e0950bfa929262c51f1a17ada32f3cb85c6836b1b4dc94b915dd7de255a39021c5e42e26f92e4ccda5f6a9c3eda0ce583f98c7745d814c5a3b1443ace66689b02e59eedcc8154565968efa8cf5b4c8961f2d0381c3f85f0fa7e265d92f09a06757d6ef573dbb5498475ab32cce8d8d0d3074bcfc3ebce0e47183689fc13c603323b29e362c2c4f9d6d0d0d1e5b460b343d1c6954be5fa1a506e01df739e9a4cd03cffe40590af340447ef24794f1233c23a16342ae57c4f1f4535fe741290a759699985f35eb189bd1d2c62d69138303c941a401deec8c49ee42a62ba0b1f0475cd6f35b743aa1fae8a0d5cebe2b2f8095c2e47d0f653fcc98c0bbfb4a0fff8276b484a41959742e29b9f4ace555a31b3e0b481522b5ae102634261a66348c67e942565834640d2fc013c33a7e4de2f6fa792d30111475b5c0e77ffab749204c1363104a2b499e7e9e0b699ec77dbf17101dbf754966a8b4031347f33a28ba6c94563364c2866f4cdca6d488bdff17bb509aac9f608a5c440c7dfd211c5deec6de280aa11504422a6fb97da913d803e4b325343cb220c897c44f13f2a07ed4fa275dc647e731e5951a3eded4f9143b868860d5605ae61f461bacf343e08bec61a94b3a346f8f8fec4ae36c7ca16e3c17668db93157068296fc4158e440cc8ba56cc8f8a6a239f171337361f52e1f4e31701c147296fb9fe87c0e271013db9e7cb4ea103e43d94bb21dc93f8c62739e90693fd84c14454e99da384b65cec663d7831d33cd05b8a94e77dfbd415a8b63ab533d655cd4f5c8c12c1e49b1b3ad68928947207ced4f9cc323511e09e598a4c64e0e6bb7b6c9e55dc5d9d1810ede84dcb0793fe8c23d6b8342121cf8bfc33ce3da8e6bc9088db31a8219e86fd0fbba35bf1b0af2de0e30a46c8b9187de86b02b430c09501c930245c5698a174bcbd397f4bb94a3f2f9feaedc36760610cd8a40da514a6bb93815478263fee9ddf43f8fe1900da5c5483ff056f73c2dc623b02f76214965d39c541310dbcc0b16cc2c3e1d81920599c171436b2a4e6c9e5fae513c83540e57df8afb767ee97491219d24fbc1a3c7a5e26c0198f36bc8e8ab6f2a6b80850191b52e4517f94c8c45e705e60b89d4251a3908b7817863222d431883d925e3c9b3c8dee9156dbda376b903ec93f414da7f9b757a4a7f05bc7d370d06309dbcaa87da8e63502b4b271f338a97e79baf46be31b59b65182e909b05b0a855b302cbae771e47ddaa28c9a990c2f3798e5716f3a297a2e4c745c6a307497d904d74a62740d7f3ccc36ac4f373dd0d2c160cedc2accd276e53b886ef8704f6671ff18629b1dbc352022681de3da123bb71641b54afb6e6e23bd6b7b973193b57ccfb5cd3acb06139a15f3f248935d43f236c8f49b0ca0e654313c64c1f9f284faa8a35cb32b4da45c13e492fc6d9578ea45940b48917a4299701af3b483bfa4f3d9c5af439a70e4e9bd43af6993e4a22f10dde9bc89e0d59f8e7d95768ca7603a151090feb545c3b3a8fd2b9c088be481782a2c4e6e17202982c9a80ec9cb66905fc64d56831433f88fa9f30274a134beef23a695ae1d6e04b65fd036aead2ca2efe4654cbc710759cc7986053a0d0f4911eb511c268bd23a90fe5e02382319b94c722570d8a832e5ee7d697b010b7b2a5ac753802ebb8e5b383fb4168f6491cc6a9c57caa75638469be7f1906dc957611b156b3c3c8aa5466ed16eb0e501c523b2ffd6dba4dc256676ea0075a28eb9c850b082ce8fa2423a4f57af237bb9e4f72db5b3016d10149b9e5fcc4ebd185110da6cde4c3438708de36609b5cab9248c0d163cbff613b4d69dbb68cd7f2d8800e88a014e3f687f976ad6821fa897574209e8893d4d17b8c73225939c864b1f9d5f91619175e6d035ebe23945262db16265cea98dd1387c8ee50d05859eb94c9e030565adc6b98925870f0ce5b7dc91195c5fce83e625f9ed2517ff60e4194ad6083eeff6232cb24abe6e78c75dc24eb037804a592c6972036e2cfbf7f9fd85850391fd16a2180c6f00be49df3e82568f435f2d3b5e3b034346055753c4beafb06e29a572e5cc9399112bd92c595d42a2f193a0d76f093df10105e3ab21cf96579d306011ac34d1306f4e703e09980fc172ca01e408a42ea1ca873b3ad6c73cd2a22ee35b4dc3b83b6ba44c794e2d16876115f62cbab61cbc0650078217b36262c114e3456d304b1fa1f9add922b68f7e1c5a0cd3941bbf069aca149c6a8199fabd2d4c2c9363c532ef91b777ac84d16d9abcc30690ff8caa14c0cb8dc4147db7d8fc4544b313337c66574cbc46050fe0963012b8346c8ed86d2ac6696377b43d506a47eea2b8bf433b77a5c2833f76fb7d05e2f31337a4cfe8d47834ca909ceef72a8f3604d86cf3d13216c13092bcfc5550fc186050b1e80d0781db3cd9a747e28b33a9b2efd3f73ff4c3a35c7e96896e913b94c8df626a182032fe0f3eceb7b90c764f9b9924abe15aaef1d95f4f227a541f06d049fb34e22465c74564032b977bfbe40156eb82d9de2a58d6fe988e6865cc7f56f7c5d4592407507085a3430e4f343608e3d4aa62ee510798cf93cf00db8afd24d0ab3e60f1856b04cb3a762745794c97143f4e1a32ebb6d9801294e11549fe20ed87fe8102ebb44ad161a34d20ed067eeb3c591738d2ac0f80eea093176ebe637ba0affadffd9123a91167a822872ab222622e13ba30777afe826ab2ab62afff17936038b8f685a952a21555d38eaad9293c4eba13f864cd7ccf0410d8e5549fc9925a91069c3f4aedd6e7d4ca8341d6ad891cbc47f78a4a060e822946de847f11b5793c2f71454b2d81e9efd6eb983e1dc239efc0a8e1043dad6f92012ccd9a3ce1d89a77fb368fb53a829aefb43273b0cd95a928ad415e654a745741bda84f2f908b2c031d48193e0d92161b7214f417515d1349baade258fd2ac21f0fdfe61fb76a0c6f5fd0516dd78b322db010421f838fb9d418300437512167987bf04e36dd0554b2190d7434464a1124d8229307c2dccc729ea91f115e2b1b4f974f0b5c81b80708effcb56830c2e120bb51f97ddc85b6bc777a7c4e3ce75269a58ae661fc93c2f186870299b227cd95be3665c50ba592df7e6b6b2ac7bdb0cdfc1771e48448ae02b118ce75da2d1b06d2b658fb90955c6568a8e8469f44d3a57069798451ef430b83ee8106566ad4abed22144682c20ecc98dc6464ff771acdd74d872bed0d939f16b2f98fd582193b3498901498d6adc2d369472dae5bfaf65b0cef30432d35cc9f9efe42c8136e35badc880c258d7d8a2d78abe53bf82118bf5a983b4aff0604b4a37ac1251d0cfa2b4e966b88618dede6b4c6160c8a3cb57b5770e93d2e213fa7b48f83f9dc2a0c8ddfb675bd016bddf075cef7a5fe83eef2b10ef26d54ab5cc58bce8ad3d7dbdc0ca8a65b44da40782217506cdfb56bfb2f09fceba4dd2bcc1465a89ce08a4cd850cdbf0a1ca5efc90db16c46de5e9de8dfd97a3ac9b117f33f0491d887c9123916c74821f22be19f6150f2ce7246ebe49a4a6e2bab3d7dd267b2e0ba452307dde998042a3b5c6aac38bbc91c76203d92c62fcc7e081addfa97a72cf4be2c384caab132777100e2612acb2e4a33b2bc76e41782a340bc4c9f0b768ca8a6526d326c054001705e46faca4f8f95b1622967a9ff1272e4f63422cf4c93f755ef197de25e3e6dc9bab9546b9aeb6c2c319c3f0fd253b86458867085362e4eb81c1455b0c6c01f3eb272b904f1e7b361517d618453ab43383196601d50b62665934acc18f173dedda21f760869cdc01e81e679d29aa0f50ecdb2cd086cdcd1f3d10e4404748155ca8efb02783ba292ca1d75649dc00fbfae2342d7ba98ab85d9761321455bcb7c52d9d1ab665757e710108a5e9b13d2f934b46fe3d9e50876ac9da77c505c8e0434f7c5eb19469c8c22e525fe4bec94e2dbbebba9b54b97a5a57c2935deadec1ccec8131b144d12b57828d2b623c68cd3de4fab7ca2475a6825736d1e8064eef502473c7b9b587b1b578860528f62599ababbe36f958d05fac5e32eca54638ec20018ccebe78cbaef4eb866631be461ad0ef6148743a0368e0da0910a29a0db8936212ca93c00f2fe2f3081e8f42ecd1386e64909aa13a290cc0e84c33e4ea5b1e10c44ff5dc5dfa05eafe83622b47f11cb4e0e85e814e51718d30f230d83e7a0b989bafff82a58ec6b5d8d4111398c52624446267d2936bce7f9d5fa62fe54575a42d53e3793a954f48711f36bb97566bea8ca636c1ccb7bd020d7abcf6c9a1ca4e14e89816a067fef150dd25b600701fdf4a966e58784ea178d8039ce9641c2599793aa4fe7713c7773a56cbe9d19702af96aa0ddaceaf0e532e09cab0829e1542fd3e07b65934def6d7b87d67cd1c0e02640dd2eb1f605e8caa0fef87c4e9ab5ad11c71ea1f829fc81e3c2341b1317c8d4d310a80a9bb05bd4595ae5d16f08f99a21f2270b0d810c055d2d2a1a401bf0bc229ccb93928affa24671127ca9a6cc0e3efb24f1a1c7d994da91de1630b83b4e93399f237ac755605eea6a36cb2975a327a70e573d7a178e5cce243fbd4f9d158f5ed5ef716071d8d7b07e4c7e845be4c00be0cc4c5a2c1a6d5a174477769acfaaa67d93711f899fa6abe477d9541bf10aa3da5c389caaa6dcb405b0223601df97c624663229708535bb8b9c2f02f78612c71c5561d4ff29105237110a5466e8e05bc2dca193079e5bde5ecbf7d64e10ba01f57cc4b09f2da0c879c546240d73f2c9d07bc531d7c0631e12134a0678ddf871e930ab842ae9b3199fc2fe2082721caaba301b9fc2b4cfc2ea6b4ab0a1461c1b12d9adcbdfba0913e03cf9fde608c72743b9a92a7ff0e288c7abdc0d36fca537fb2ae44596ec7e132d4d5e9b019450b4269a401c89a150b912f545072a66879a162c1e79bc08d93e5b60a20148d2109a65867d304c3672615b4d3585460d871c55d903c17534df641ac51b51c2acb58b4f6109cad54f63e609775644a176478a8cf7f99401b6bc1ac5523c527012a3b9f24353550fb96abbbecad565ac3dddd6c03f19a7dc839ae5e004805d9ea957d6b458b06cef07f9f7854953677b8e23245fb0b94473aac83a6b2f7102b74e091ca286d1d17a60a98f90d4c758eb251d71d4a54f21568e2bac7551e754ab5a8258ddc6e04678772ab2e114e4afe9a5c2c852dcde3a54baf2c119643dc4274384a52b3ca7772998ddabf78722c61c68f2dd148bd273b5bd4816bf06d1eda50d97a7d6617a5219729155ebb4940d8d83d933d75731e6e8ed944e66de8f2d2797a1898175f562b0d5df08a4957c09fe2ad79d3306d481e6dfc167b928930c8051343a64f2f997ad75b961811865ef59e78d7aded73dd917e8f9452be9027982b2188539b7684e4feff0e2462990de665657b2d2e5f238182d33ad88974583fb3acf8008a199f698e6df336fc7b8f5faa87d5cad9975fa9da943fbbefc9a3e81d774c0c75edde6eb3604dce1d0a8bddefae9c778742203fd814e11e91af6e6cfa98f2e0c8502a45ec0236541664b5e256d960fbee4a2f871b906a4fa02e7acbaf6603a273f18aa4ef6c337b9005350356b6bd1daba68b56fa8a03d460085bfe61d06649e68874059f25950d38a30bbc33de9c12e0df118531251a17be4ec8abf5b80662bd7afec16154448a4bd2411dad9b9c07c320bc045bcdf791d67443a3e1aa228baf975f08d064dae349175d8545543cb1c4a2c26c2b714795db83a0df71998885a91500a3c015b59cab1f0643fe742a51e95137d10ffcb8210bbdbcb9b17d021eb470b67c241fbd4a83351471ac126695a9ae1a99232e6511f9489a4d852bb0b0c4cc02175ba310b8f41a31888890f5bd3019c9c4c1195cfa9b6c23ad857ef2ce88f5604b8ab9996cf415406974421647a17e4b3ec8fcec73948016045b3fcd320892b55f5ab379798c3edbfa1d698eac1917382632f835284f2b8c6f84c8d447a4dff64284769e3b4f964261f8b4e486160e3f8369b3107752d92d88643f30330aabb0b0a5b8474b5d06bda8fe72ab312997623d848dc753173b2f770537e6e59eddd353aeb404b591d73f74b3702bc5c4af7d93dd55ace9acaa54b80ea106f4c736334e6bcbce162270107ac8c797da09d366731ab9f7cd1d940be0da99a3573ceb47530f395ae264fa2876dc27454221f63ab095116ab9bce276b668dbccabfb1c0ebfab6b17ba99a926c478b00bf383a3ff46563e306ceee1568ecb6dc7ffd7cea543f449a1b3beb3af8a4a1532a870dc96d3036a6fa0473de55f99deeef65e207681068ad75d223da9cca53a06633225a6783f6865477b24194ab6cc35f84068f6e3fc400b88a1f9e88cb7862d89ecc89b6e2d3eb57d441700e2e687e7e55b3c8c343cb451b73c89a884fda32e74f5fd770c709d1dfc12a8230e75c600b174c7211ef10bd6ef3957e5ed963d06c4f83692515369e5c585d5bfc7fb3164b9956888f928583920ef7d5c0d1b17d3f5a6a6efb278719d135bf21cd46cb02b59a4c8bcabd0eb9622a28095ae43a1efc731ef36276dd49b0ab6e3a4ee9ad20e68f58545df9f28378172a9dfb58d1a296a1bb6fae16482d84306a07041952296e30ac638aef94b5584451ee13c7a7739d22338641a627f78525eaddfa632b1d1aa9800d999507ab62b83764f4598b3954d82c5513c7e4620853f37fe9f11fb31c5c6b0183b254dddd154ff5851a111df5bacf0cf85e23708b9ff69088f2ded2d22f289b0493e99d2c8cb7fd0ba0947f21d785da3929583bfd662b466ab2d1002ca2604343f636074f96562eff2c8511bda3075a67ac4e69e79cc62fc81ffbd85d7ad879983c25679621ae98fae596c901908acf7418a34f450d11aa3c942292c43d5b3071192d1a92fcf304bce9a720c5714e6bb6d00ca437699d7598c1f31ac463c86f86748ed9db40164fdefea9d2ee82e66bff3a2304496ca7a145020ef03a015a664cf053b83488ea5c8dc76f34c4aca8cc1af4a761b9e1129723ae9bc3bfc07cd1d119821819145659d091596a4898beec78efa3fe99d6916ca6d89b32f8eb1d7de9e8791eb1517329c0cf19252043e052480d9ab5a5dd85ea29ca3e23cd9b203ed493cecda8be4cbabee42c1ca35c2812ab93eadb285168f53bed487278237d4e32982c263a55a446128a802859db2dce8055f355050e194e1c81dfd9e0bad295fc0f70bf71f232e0edd0d2d49ca63ce2242605fe7c2495e44d6a63a943c4a61d772728a8b6b45a8f82c11da0db4099e1b8fc396ed645523f6dc41b035d9034771948f9fbb6d1ef09324364a4cdb8776959a0323167b2532b0bac0266a474b9e38d4743acca571e92f895578e0bde2290f6f388a309e1f68c99785126888949179887eed667350ad1ceb6cb908b28837959bba373452c5748ef2b4e39a3e44a0554d367c24fd34574a8632a033b123d9ffcadaebb64c3a333897107be8d5cf7a35e03762094f214aecf9e57aef8876ad15e0fd4a88f73a10f16bebca1a0920181ad4af9e3bd1c43b70ec20457e9ae4bf8769a4c450d65ee595166fcffc60cfea7695c938a4b3837e0a447be441f81e847c76b95745ce19f577f1b2acca64280bf26ebe10804c5a9df700491af5712dc2901a9708598a70297fdc1a7c3d1aea5ac22575f3bdf9896fd0cd4afc0123cd439d47af174639f970fefd5e9635ad4c33cdd44931233873305fd3b8820214fff7c57588ddbb68008d195335cab056ec975d3cbf28e8a92b9df71afc16880d089f054684ab5231b73c2ec20c79ef5705bac0bb1bc771853b1c3ae1d3cd4d60b1389609c8a1dfe83ebe7386a472262a49397ea38b8e9d0c24f5792af67819754b052b1f06b9b5f9ec9527c9ffc78ab3931b42af3fe39a9f4892a929d78ed6cef479ee9ba6520e312d88b075818e351b11fa7fdb3071839df152809c3c19943f406a770fa527c18fea1a0bdc67c6bcfa7cd1875580a43b3d6183c691a2c2174991394a290c7a26c93f38f9693f2d22e7f60d6909e60da338dcc74c3b2b0ad642f3c7066b150fcb9234eb3f351cc9f3c3bdae58bb01cf3944c3ba1f0db800ae6bc469b40640bbd41b683dfac173dcf2c1bd158c1691d8a789c28ebc9ba2b824be6834c7888b4791bd859ba638287fffa9b787dbceb207565680b8032ec0267b4803f4325b039b021f838504504a24b23c96c6939cd8bc8ed78d428886db0abc2d92097dd1aaf9264dfa3e09767841d43b93db10dda3d285b2f42e712aa6605d191f141aa2f765f7f2669c2c8fa6de962d43aec21e0d90190a00840179057180f4124f9dd4a76d426fc1c45a5ea1a6021bd24287e98434e74717defae72df067ad30b7619ade42af6dabd95303bdf959af88d801ce58fc631f49c5521d4fccd0f0abaed9f4648d23e777cf9c3ebef9cafeaeb97436526d578fb24809412ed63f4325c2ed2f5565d42610ca3bd9ffdfa1becbe14360c9f45196db2d2c490671648ca7df1be3027a5e55f27bfb9e8cc3222bc6de176e6368d0c6cd77ac28c91fa68a16a978fc8d81ed0b27f223141f8454a07fa3e769a67c7cc410168b54b6f75b1619bf0f2197cc9d266d65123c3d7c3ae4cafeeac2298779c935972a07ef259a88de75f25db22c470b03f95ddb331a87feb77f54eb8bdd6df37c3cb98091e8c61c4ed89eda0c2dd8d6bc3b0c60dc6f6e5755d29c5cdf9cc5ebb43b32213be25294ab76fbbcdbe00eecb6cc272190790f6d299d2d83d93705c5482e905bbc0839a49d1fbc4f221f8a3a5817ee4682a94722490a5c1fa6a4aef612bb4e467ac24f7a20151759890435054cc84f4f6a8d055e140f70a2d78ea38b62bad116467503d1d1208213cf7484850943a47495dcd3f5088acba80e1f53958ef7a6219cc361795fcd0f422617970723f4b8ea75589f97aed9f283a5608d89cb29c88fed792799c4fe3c7d191db535f54e93d079c7e442d31e787cbcac004a4eceb072b0bd02a88477e9caae857b4ab1d4a960b838166e6819f57e9924d16dc16515fcb98029f0aac2140f5bffefd06f732de8d24a43dd057a69e17a96e166f5b6c6aba20eed059f3181187b7999b95f55196f66252b175a1151661be17258a08dc743ab4945baa1f4c7ad76b79279d2e2e1f94522dca1fa66c6dade1a7064c351acd91bdeea7baa6f02e1027d30f8ee7bc24e2d8c49ae03ec58d3272e454427185c08f9d182562dc00261c28a7ef0938ff83718621a8e6153e14f63e101e414d49878dae3923e69368e8c92b0213eb4619059e31606f0a579cf8d5a8c9f8e0d5e111eeb9ed93a30c2a1ceec7b1c7ce161a17bd3066f5dc4b7bc0ceed03df0f47c1e7065004b81b2e137c43cca2feb5d573370f56742a02d46dbbcbaa5f064c4052b01348d285eb88d24fdb8d3f712a3a996ff45f6126103bbd8b4383c103c2194c023bc394e67fa24e0899652df7038649705729ec217c1999085a613287e42ab375898d7dced133fe4807e1907c915ae85119b54d17a05fb6de3f4102f597d4cd5087d4d3b99b18346539b3b7da83b20eebe4a952c11d692ab789c328ab6e14cb93e1b61fe7a67f4154f08c1f546576f0accb5b48b0fb77044e300237aad3cb63a0e98ec6642821225ebc785133dabb0e1a50f4a15a2d3ea9f9e65793602b92038256f73956f0dffea216d2cb36ac957c11d4e781e64f9fc30a07156279857557c5fe58b029f01896e267712698b7e68ba3b8fcfcbbb6ad892285a5c314b23ca06a23f356a70533fa04b19ad5dbd8e97b262491133df688a2bb73f1207fd51c01b5c8a0f5be07cab694e2de30278689463792a9a928974a2a10ac523992d11807390acd9ffe05bc8b62db049d08e1436f7ac6e890fce073f15c4e5fe8dfe44b0a9d530ebb4dfdff43dac4f86476a8336ad2c92387834659377c1466ec2b4e6ba34b43f2f7c19d33e4c986947d92ccbb9864f045c41a6cfca0ea456a5b3d1c0c6c82ef7b2a524f4be29b3f7dc03c1f93be3f096331223111f276b135cbf9d737db250a92ae45506897ac4694943c2eae35a76d655bb7788097803093d565a2834e85a9bdad3363fb3101edd73f536807421c710377c32db484a515d928bb543ab319038a548e9dc0af2b5df5fb1d6eb8fd014ff2d952f8ef9da00df9fdafdd9d8e07d832aa4643abcdf18bde1ef465440ccf948dc51d0492fd67c5269d24db7ede66d2952382799edde76265b867aaa9c993b87756f2448131743d3dda44fab2e7e33ef28d00cc3a6b06c2be759f00d688fec75bc8c9a2b847b80f53c15355c000430b77d8dd14b6005d2018b4f50f8ac061c4b250a4ac307bae3391d6c8f7e791cccdf2470ea2fe0977d721715f51e5f0015e057db919ca62e8f088766036e4e4e1a815c3e9aa2d4c505999c9fe8a2234367cb205f3b9de5033c0a10c64973c9c1e42120c7e242ee2d6cc3b95909ce9932dc7e4ae83719b9233547f7c3d9fa59769b4c383312b6fa04563a28f54dd8503a35685824aaeebcf3e177087b652c19b3b486cd6accdfa3ef6ff49f71507283fdf4eac427af734942d32b636a07b00022fdfbfcf29af5358b04f9080365d81b80d2ddedf5855e8b60c5d4faa795c24992cb71b583e6ba84801064553f8596d1bf6bb9aebc8881fc6a6dbee74e002dcb0e619b6d99b574c88f2e21a3cf306be153cf9b6fa4fe9355e447b36a6124f450d8d8b9d9499fd35a605916d2103c29d592d825dd623843691fda4e7865abcb95216cc21bb30a311078e2f2e32a73e8564fa6dec41f18dbcd34f7ee120ab8a9ab3c407af733de0fd981eb287ff0ca054ab5d0052a8386062538c96f7cff2107faaea2c934a95eaada4520909c1ac8f96c790e8cdeb161d075c018f7f25a6484d02271b5e4a6df27627b1cfe936ae154160e6237da9e6b8e4587d529fb6f25fd1314db4791e5c2b30ed88dfff1a8152b81b999855bc117e1b124faa9ff4b80de054ac9034a59fc55efc213cab087a638e3321c07cfe293a1ebca6f015d4a1fd69aed7aa9effc0c8064ef26300f1f1d7d9882d63c0e39c7632082f9fd55fbe76f6128666f5de85d01cdbbd7b9946e42bd6cd164ce4e7091bdcc7ad8d15288a24db753b0dead44a3e71d6d72c1be9e72b60d2baf927ce6691d6dd4774a5c79036282d1573d3599010783a8fe89ae16921ce31d350b2cd6913718e8c2206224bffba9e1304f47ed25820830b30cc260ccf10115d3149d86b236c6e30b473dc99231cfd7b24143536c1b1bb32f35c0bcf3e13924b8a9dc71c86793732adec8fec6ff7b1de667d1a4851fa2b3acf8e30bb029c34e77ab4dd7bdac8750eca175056d98c7aff13d5fbf30b1dab0a7a2396ef88f282d5faf58c61f7a282cd1df85f9518be82df65a0e7a034405b90cf092ca0ed38bfa33d03bad2cb92c2df5b3e5b94fa0ac46d0fb5db956fe4ef36659e018a88853b207b469652929f34d1f6b44f97824a6f80336b3f774cbf9dad26d3ddbd36bf2ed4b2fa8eae76a3f4bca1f4cf4c00ef472467cea3b8164d88a6ca3b7ed70afd9bfbbf1c6624eb09515bf1eb41bb6022c6bff1ed682296cd7bf92b6c87e578e58583c13ec8862e9421a145f3563804a770cdbc3ffe22d537a64dacbe42b7f87a97eaee1ede8bbd8313ba4181560730d3ebadbfbbd433eb16d4ba6b1e8fc45d55c961fdbb5c7cd2a21cc6b85dc1b71106c3e490e1ce85eb481becfcac864b241d6bdd2ba99444e0e59c87de9e8d3fb89d9b48a453be32b9b8f82576ea8c12a1d29c35ce22de4412f30d687b48ff1caa95cbd3db94dbed4387cef9582c34e52d4a797965a556dd462a25b35028b5e1f5a576e2296f0d1f983ffdfddef29f7c5a304128ab78a0e6c4955a67ff15a810c25a3a2a27daefc17e4d6afb6d27e8199ab851ed6515cf6ac66dd432e55b4378d46dc4beba9b7c5f8d84f153a8dcd06c9431f5dde4f7e786eb016d1c5d6c4a500b0f63025479b31e174bdceaa2847a129b6c6cb8286632ee6ad3b8ff1ace64e2650c3b297a2b742e70e812b0b2918f153865bc55a1852124e7fcf1b9cab7d1e10a4d9ead137409bd1c4afa2851874b7ba78428b5334544cfd97de002e537b2559b78113e9895b05845b1346a6bb72dba8a03b53be3329a6eaea56849dd5ebb173ead7599e254f4a414ff7bbebebcad15ac1955212fe6bef2ad8bce3eb9b28f13e9e8ddae959104d418b80a861a3fc33f4bd96cc32d333915a7061d328672908ab8b303ace6f16a4ee5023116e885e417902e3ef8d8a406b1c0e1462b88cd2c823d67046dddb17865d9198024598499a72a521a2eabdb6d35b095ab0c014742acaf4accd50cc088cc5aee6446c97d4ae34e375bed3d73a8bcc64de9fe263744c25e9e07bf810ddc5943f8e0748ac2c0d1badf7b83d94246afbe543466898edcaceec3f67d6f4310f2e64b3f315ec53c40d871600e2197c8fbcd952f0f2b4092a473038d3443c1358d7be546d258505d623789388914650ca9c320a6dd229a345b489e8f1a1de4e62e1258178fc414724601db3d86fb6d4f2b94d3f2de71e131b9d0eaf06190021a499a430f531c8bcd12f51cedc5c0bd9c53cf812ffa4eb112e23e192655e85b7a575f3b10aedc19c2421a44c010282d3087b61057b5ceea450104a193f35781c403318ffff4b890fbbef9b02b9c9d812ac95e868c1d89f4e86f0e42e6e55f09bc38fe18fafeb8cd8dc31c334826f8b1dca193c0f23aa568e0c105ef0f0e27801936dae65f34a10717f355ad5d995e3118920c1854f4b156c8eb3517dea57bca607c189e29d690a97531204fa779f95b6ec54f5128b9dcdc82d168001e7cfbcbc32fb7b757a6702a81856dd2d951e3589dc30256c04597eeb996d56c1e7bd6d36d7a063df6e8f9e3dfc2d22bf1c18bf4a365efe5b594c689e63bfd615d910b5b3e1bafc856cb7b36625b9d50659303c148909254e3a6720ed09eda5f1ff8aa13a09dd36ed594a4455c2595684e244012ae766df3a4fd3bf1e238b48b902f14ad6814c97e2bbda14b5350dfae91e637089699cacb21f5b97b265480e0f66054129c4a07963f9ecfb32977fcc24b06bb08657aeaeadc696318668f1716374c7614e73b40df23cddc25414d416914f977d5485aac76fe24b8aee8ce2192400ba61d0ae4f27c45a6ee34ba8c7bdf7e915e983dc8719bdcbf6d267aaaf252a8730bedb64e63836d238e76ee7c98c3b8c16eb80a29bcaa604c2ec7df7a71130f52c203178ab4a9522cac8675e6d06745f2f8ce54bf55b2aed11f0dbfe32b300ea53f262e461a0917a017518e0ac92d4acb9eea62a5b993f5f1816e02c8e34ec359f2f789debe92978318c897235ae7914a09df38f5fba9662c96787ed294ee3b0379d25a8e2fa67b90f2481b82f02532f1af7f78082f3908b91c3818f1b53a54983451fe691044d443d0c1320e6ce09fed0c7c9b440be5b9d73bf5aea1a6e76ae1c8859040b26e29c7bc9ad1ba36aef91a9efb854efe18bc5beae8c7e0bf41b98c51c179c92dc6823da724b761ac02849b8a0d481370db72550bcb307603e8fe7b22f726826c4d5d9ef0756187edfdc124918ec0953d00652b16f98ab3c8301a986c61de5cc7554ed6ef1591181c60039ab40b7b2f035a5c31b338c46526c046cd494c6791f3766d012766a5e594dface611c791462325785a72c9e73628a1b30dcd8758d11955c658443fa46952a112e1380ef5b6d36174d14802f8ff70b4e0d086006d70ef0b4fbc3757685532941428232ca6632beea4f7b3ae5b5a4ac5f032d2e80e82a7db19c232af3017ed13ede2526a4d21a1d1a044653c417f705f54760796b0d26c76274ce6000c3925c36eb369e6c99beabadf1dbaa9e97b064dfdad35469117bc480b8d9f4883c0d7bd6855e41df9f966b821c655bbf02480c6295a59558131073217754e5d5c753efb90eb9b3ef4830523e99ebd700141eaf06d4e944944a4a7bdfc78235f1e086a804bc671cae5edab246f287bc57d89987bdc977de91f52a151dcaa17c38e9845116a381829e6e185d6c04d5727a5854438bb011852a5524626b48f6fb7663e29ba3204d86927ddddf1ac332212acdd7583a66727f3b5d3e635b1abc7a3f8631c2c9be6bebd583e2b99d3dea77e7cd458203085fa6df5180575a4b4d11f5cd41de2b63eed7f01131773a32ea3f1decd76314ffa5d5232d90427da2c1eac4812ca83aa437bb3774680360bb85e89a531df35281641bd3166f4c751f34abe98a4694047d81f5612027871bc9069a183652effec5c57c91a860dd415939ffe8ed872f5e608a26851a13aa987bd224cb80dee6bd17521dd898bc7f3aa9e4a4ba4be8bcd5a34b2fa211508aeb0f5c18fe5757b276d0c41edcf510bd608b98bd73ddf56b97424d6182c0ef0173ebb9696146755f7843d87dea5278c87f7324004740c0aaf4c0627c6cd9a8e555f1275478982024f2edbdf7cb83f3b9f8f9fed642e3ce9cfd5a0148941e29d4f7ca9712858a3c0cb071cf20c783ad45bd1bd9591e5fb31fb331d8618bd5242ca60986316c7c40dd795f2913fd1fe8ec81261a5964b93b9575a21d6ec0bec2667ee42e3fcd85927a43fac001252c4936bcbc38629beb2ff4931537514c68ecba60b34a64aedf3b6453922f6ae21b41f58c2eaea97fce786b1b915dd41819a34302f7726816b1cc91c48e5e5fc2d2098f5f0856ecf3b91a8c1e391cf66801a5960fdf3f4dca219246c69406cb3d9ce05c5543ad02dec626296a6e66d5da232ff72c5a3ec853b4ee9579fca950b4a9875b51617a78ec0c7d440f1be8c9d14b186e37cb15dc55ad6fba521f50e0cdfd69436fd60aae0c1c2e3556b942f801308c1101f26215189806ce8b2c4706ca7354b6a1452506da8aaa7701d0b558377b80a9574dc344c9445233581f0e34db5c3410c70697d41a675c4aa3bff9f32e89150080bae33e6d04e47148ae086b5dd1d89d229b1ad75a8393cceef6c39c8f50c61fa64c094859f3a8e2808527d9012f89b57180d690fba067a9efed3d8fd3647a0439d3a5d81893b05cd030f9aaa8916e476cc24aee467d12fb831b0aec1efae73377b5eff315b2ef8e86441ed6aa4684dd0e66571a48d51f2c4f40f06848de745173d3f98bff783b726257696e8b241972575635520fce950f015eaa2884bcee656a0984083719f8bae15ff14ac6322221dcb97fee0d6a6920109886bf681e3f97a5a5806fcd13bcd4d013b5ef38565aed0d0dee001996b1a2c33f6a54fb1e76fbf877989855fbf03eb2e2a3dda31cbe9dbf036f9114e2198b8803a1356be05f70df9a5510e65362ad59a0644331399c6e8f7c24a810f868d2c072250abfac075f30784ff73fafd4d24133d1368603e3d00fa52684bacd3569826b90d6c3d9832d91f5253f60de9457abcfb39d0ec1bc11c65f1029f4dab10be5a95f5be344a52c9ec9afbdccd0ad710d32a3959a47eedca518b0912322a9677a68e04723c69dbbdd800c93204a6200b730ea5e0d275e1d9d3c1e27e2376780d3e21d32a914b150bc262333f7d395c2c580440f551073e334dba480c10b2c16d06e973c18e94cfccad8b5e7c1870acad244e848d2d78f5c25227d3e1812ec9d70d9e3af088eabc7c19e1fa4f84969481407b8092b17e4dd34eeaf2e01c4c60a496e617facddcc7c64d22700e1ec5d553a24830f45725a97e21737d8f45d2f36d6edd188ad5bf1834aeeda68bf8669d95e129c2de78896bccde054205688bec75fdb7383ee1afd55686399ffaba487409e56cd73544260e9c467519f94c8fe8d3c61dccd73a34c2dcb682c98211f48fa2ac5efc9de20f7c75888a6194a87e18d2f66dbb7f3c15c1d7073e24fa2dfa7460a83af707a1a15c7c31e0fb14483d96e1ab7f98ab5b8ef6c75dfe7c2724a15d56ce97bec282c56fffac0e5a32ce43e5704eb1a88a449919fa78bc0a672cc663d6ca0696cf7fa3e7c0592f8080890ad23b6e6381479a9bfc747c50415a5479d2a426262d28a31776e0ae28301d5f19ed12b6a94580d3265355b7288df39c62172499ce488d7cb3f50701f4b4b13d7114ebfc6f8249b8283687f489d38bb99181779ec50dad09cfaf328a63e4a8904efc7d08d5a4020a7b13e88ae271b4e06347b6d1c6e097f2c7c4e6c2e1f6726b662d2de38b03baf8cff7f32c7bf1750f90e9bc2f0eedeb4c68522570323507ac6a7d1a9d4f39db0c2ec938632fcd32548e57aa1681f1c3ebf171fef7f3db98bb31ec1d366f93fdef2fe97cd9be7aa6ce8bc561188a9cf208fe8addc28a0deb4cb8b846f5d24eccf893d6407a83b7d8df2dad74adcde3fa08861b13c25602cf67c4db2f6a1c54a5ba7e0ced18de9778d8402a37c49f941f51715cef555ca95f46b0486b1d060968d8126673b3cc381656d57b57271d845d73e58a1e28fe61fbd93f1d466120c43c786600fefa5e8206a8cd7369a350611154d6c7cbe5b8454515a6e185bd0ef51729b6945b374a017edba5d762c43f4c21bd97b5572bdd944d1e743bebf0e8766eabee42d8520359adedddafa982d194674dd0939f59aa997d1d78a3c5ecfc4deb3053fff6df5a79826a463fbe1d91a6c0c486028fb20ad8bae29b8c041116eaeca487e415ea7a464be8a0862f601a1c73c72acab34ae166a99333d4bc181b4757e3b08b6df39b61f9f934bd6efadc96ea0bcb3340c5b49ad3e04c8a48519668eaf1feaa0ad11efb74656e77a51cd1c18085f62f6eff573d218104c316335d9ee40daa49b06b09270bc8523cc5df0e1cb31bae41a680be9193056ce675b4f2595fc5786bf2ab4f9588837372f0b652d88444d80e508f92733a18af38ca054516daf3988187efaa91d473235927270fb9cf14fbb252941f98035e9001caf2410f0eadf5654b935ed92671ff04949d83fcd4a801481b605f07c07f470625bb8e2f9a854d494785c5616cb81f41059cbc5337457f80398f8721088e2e017e274d5b5c7dbf088738e6f97d0daa7c387c82a204c1cd644b04426b22af13438ff0361e69c0965c579c4b7ce84412dc7a31321228c74f80b9b84cee094b3616ea2b16bc77bd4d4f7d69fbcdf70378c5d1d75415d83570d3053cfd07dacd0f37b35263e8ff003389b6cb61c273e051c761e4901111237926e99dfb1f5951e869edacff24e38214b7ba70ad60002d5d971920a43961e1c0f0a473f5f5efd1065a554a62e5540402f40fd0b4c5e545f56385b4592890cf37a45b5513667fdb96dda471fefe3c747475dc29102e5ce9fbe6c72056397a0f361d3f322cd5b08cc699ed32e4f58f48866d4ce7b996575ef7b4af16e4c2f5474e8b681b09f2900417bb3924121e7ecd6b7322b0d97a861e20c263e98f975b73ba93f0db6a9638f9c92f3263668d435d8f177e05ca4fced93db04942858df39fc323b7af2c1f3b1fa0db0b2778efcddd44c1a011cd0ace5569735525a3dca1f833ad04b33549c34cfde1b5dace8a62cb4c1f25f1aa856ec84767925a77c1c54ce932907ec4f864b15629f7a966ffb885ed4ded410b557eed45dfc53be829553d69c91d9cbe64a8670712aa4affa1dadbb92eeda4f3a2b6e111ce96208bbf8c1d212a2b4325fb71e378d0a8355a204e4c87dc457f7e7ec09e89c9a7874efc5a5f52f91bc27a9532479b21c38ebb357935021a7ba8d619ffb5430b26e1ea2364566c0bf8bd6430ec6e10012bebbfb2f2b1132f1606e92f7e3c727f2758b0004346ea8b80507f30ea6b148b29ed19f1563574eb3a3cafeedf716c70051ab10634530f2d02f645f7e35492160679f59fd0cf5d28463bd42c15be7ea96482b14094053ef264aa391d830db56a8b81c1e0eff455525da43579a3ec00af8647554beccacacb2fcb6593928f4aab4f883713b7e8af72e85f2223c47acf4b6d4fefc1184866be51f305650ad95e929fbf548bf2898f12831b43112acab85b8ddfe8cbe66171c27b190ee1e77fee89178bfd5745105f414652b8ec9975fd205266a3060c142cd48378f30498d86de31864e8e1da0193947b634ad7ffcea351b3cc08060cb8f2fbc7d178ff8ef1fc1f8ff7aa7f3330eb55a70c072c471e50a8721f702da570409c2a30ea61ac3d3dfc6c60f430c0453477040ae3849e11540d2114cfe0492d3c975d6ca0ba4d4cb954f5e7f72b532f407d0cd1a4a2f3abf10a32e86bedd6977c057eff7edcb2ddc47d80359191df857d260a517b108f60d23b34156c479c48913c98b963bf4e5807a90e80e028b3886887f96c2531a277d467dce30ba6d5e33df56d2b2406b001b63f4ab5fecd5008af1c7697818854a01e30eea4ef73c1f0153364b78aac35525b39b69ea24226e1a27ad176f3de00445587476ce76be8d17047ca58f98ac58b220ee10e392d5dbfb9f05986ea34e934006ab65846756318c0de65853b2c8113958edaf2e4f1489570e0c21d4fc38efd71d4cbd6352d69dca087936455953217dafef522b81aabf76b2f782be53d31e56a963a41c8e39253ba53c9e874519c0dece788d456ec7f4ad99a72a0676e917d0510901a40ffc95b4b54dc2a08506b6fcdcbedf8dafde0267ae2534f731a6cfed5e45ed5931c219048f0896d02c2c7b95fa7547a5b9d17980ade94238c202f2174362849de714f5639df3557818e45acaf82064154ff65fbb36b6d42ea3a9b431325864d08872a774bae4c5f0e9dd30afd8ee3a16e1ac42056769d2648991f25eadf622032e16e6cef75edd399f18726d69fe02c961ed2b18a88a3794759af004e0b294cd6eb796d2469e3e208f60f89610f11c7de9b05411a1882561e427ef7a49ac4bb81e901086dcb81943dacb9e1247c9f826f7ad54c4a44047f3b232affe025208568e97465f8680f9d6536a10c933ec2ee9870578707ce1f887f6a8c4aba3e11e9638951aa3118b2eee0642dcc8b7cdf4402e26f12af3d0d8ee7991ab535ed65f40f2cfb2a7b718b10ec5dab819a1bb86f8a6015bb7691d9d913afbcf692637df43c4a181c57517c7af576e89d10c4036046a6170f903b63d30ae1defce9250d57fdea4c6934cf4184c9e81255805611262aa1d93ba58bce5b59b806386add2b10a27dab7199bb49014e212a019ce7ebb32eb85828a31d17b25b4ffb867f419feb75c856cc645755ebbc4b1f540b804ba7908389b450d8ebbf1d39b0cfad6d92b18b6c0e9bcd9f6885768c7b0f475ee788327e4bb0b2c1c689ec511b2fda983c5cc3946ec2901292495ae6fc53a72f563f36b04b5c05de6e436f6944ed3461f88597e6b0ec7f2ccb44bc17545e2eef233c9449d06be1c6202b5a6c4f5edbd78d10686d7e5839739363179e044ff7b8d3d816afe9d3bc22746faf185737819d65d83873b818f4b8a6033b56aa2e6796ec0ad54e041599e509d029bef0e673089ead45cfcf3a5559cfa83bdcde98f91fbc07f5955d45715d0fd9eebe548bbfc67004549aa97959f088fcc16f1323e504f6920c56a5a5794d7efaf04d87b048f00f1c71e874aa5d2f300a188f07c6849330331d5174c0f3abb39397eab99a1accef02594dbfc75ccd14288cc1013ba385373487bc5930b0fb4501ad3acf2de1a999b3bf408da84a5f85f7c2e63b4399f44aa21b3d0175c68206f33457e166f73613ae11563e4562754d5fc304f8e1a19b586b92b8d57d52dd2a32500ff1b55eddcd68f566b2ed0b15439e59e63c2b1374672b98557d2bcc2e8c35e75fc13b55bc9e0f5edbc334defe8e9caf7e52d9bd63013db7ac1cd14adaf863b277174afd75fc76f151846d267a4b73f455e97f2fe81402767432d1da0eb99f2be6603db744085ec21016b728959ca9dee83deba0f99cd42fbe571ad4426b39e71b4b01deca75866d1a89848977476dcf0799f560ef0db79293ce93cf8cb979484e3217cfab7a64589a347f737a78e69fa73d8f05750442491a6063c5fab6269032b8e3b5ee23532f54e6ba5e6f58d8ba7bdb1c4dd390d5376cf47a40e06e5cbdb126f814ca0e90cf80a1daebaa4523f792dbcdc7a8d3381687eac3902932103ba32f58c58258e586640449fb704c33dff5c7b42e7908a79bc3565faa9505dcdf7e28cde5eab2843e84942da78d303d700bfb67f63fbbf81792b2b45db419cf1c2d64c40a189acdad5b797a8e0e9ec82ae063534f5892ca150e99994fac0f4c50c4fe9ff0d9815e790d084f9a52827c13fb7e224a4af4f54322585077e6d6870a8147554b797a3597cf7e076c2ae9ce340b02f9ee07d54db6ab1321388d3f6c0b37db5d6f2f4fa042e11cb1922467fbfa090e2badb24f7f6108c17f3e0aa9e5f536d5caccde18fa1a3edbf016806b9fdfaae33c51a75dcd540d811123ee7561c62f3b843e66a450b95898954bd0344494eb105113db475b71847d38c2b61d0c4b5b25b4cfa32d448574bfac62500e5043e382526c0f37ec4c2442446e469fd2decc1c8a9be80b0dbe1896da515570babf6bf90b1c19b4bd0b27e253afc03f124f8f9105ef44353df98f174019ec8d242d33216d47b41f5fb37f63245a846e82058b595e47b7a2b758970d19648868d6b372b68f315082209b7423529053d6150cbd8f4da784d2167992ba888aff13c5d2127901d348adec1fdf61a4f7e771ea08146c69d18f1f66d2f1702a6d60248f58beac7e8ce0562da987c419855be84904fd769669d3a232c6eeaa24c764ee80a8ba34cf7f4f24aa70db5637c325212c011b699cbf09323bab0bd6d256280d871ecb0c62126a7db3a53ce3103ca77b5173a170466d783776d1328c8810c9a7077dc9045a5ace64f39329dd5efb04a5b3f28ca4d32ad7cd950c8f3ce13a82dc25e5b1796fa6edbea7b4c19c9f1b249a28884a8eee3f76d98de681b747b160d6f3b5d88261f645fe8c7221b38a4d4034d02dc624745a2fec4e35c1f62d04fa519d9f396c2b2c41edb90aa0c76052c70a16dc6225551a3179a2b3b138b72385077f0f15c82da929aa3e36e13bdf4a65ec03bbb3199b74824bb9b96d344d1aebea3463ca98f8cf9171c413a88ece15f6e506c0bd4b88ad83209341a667fb5a6ab97fd07758356b2278fe4e38ff6fd37aa744e358daf4b7c830cd495c81ce1318a89641c66be6849adeb6f6752b79b1ba1f6fce1ca264155549a2e32af1b98d521f05103822b8c49203e9a2bea197f5ebd2194e3a4f5d17bb7d985a44998e9073f00020c3d4c200e5192c4e479739397794d074a7411c46535d2aee5b833c6dd3c19d9f4785781cb02493358688f8c7a06e20ac55c43f07dfabf1206ddf290be652ad110c4907aab4e40f1d14ab6a6c8b16bbba256dff216fdcd1976b781ef11c7a73801b6028314a1fffc0742298d334abbd8b501c8a4966fda180cb349e799472154dde3ab92be016e30859840f08c7b07b1b28a1329775052bb7d1ab65d4e6afa9b931d5b9d7011e759a3154007297319215e73ad22e3bdd3246881580995f9af31034d59b73f409bbf4639cd70419e962133b33162915b268ee72adc3db9c933b70eb057565ed31b3895d03802d8f00e697195bb470abc3a8b071fa713429d823902bc1dadfe89dc3a8c860733635990629b57fe13d4c298d376808efe0d76699964d59702529c436e8fa1018dfcec6e07c0e5cc27f1df04af5c2ddd9c5dbd9d54d0c79760ab08b8c0737e88e432db47d98dcd66b0158113e9c9a9716d4f2d3349aa124ceb8e813d1b44b9b8d7c3811a9b3158590160b486727fcc32cd9addb4a8c5a8fd477e073869bf3b9879c05aef18ad03e926200d154fd39664e8fbdc51d45428fc5238e66e47521200b15ab98ca590eefc1c0803c59d47c2dcbc8523ef3619490673332349e67af3465e4ee9a685e04d5c09a14ffdf7b81e7afae450cef94e7d5fa5ccd1d33965134e493b6779cfe681bdc80b01b899e90ee5a36f86fc863fa85c9598e19e02c16eb6cdb0d639bbc3d55ddba24cc42f95ec6fb7afca1166295c10bc2a1798ea1c69c83b2135d679caaf8788e3e05d531ff0d125b69c3e843ee1e606eeed770218e3ea1a72d5bd9eff364cc0b5c694b978826f92f171286369fc15cd2c2c881df93734653396c51431d340a2e981336cd318afe0cc36ee3dc3278e7268597d05ea4bbb4ce324db5217990b55167dcde6547524d7b9f3087b18c59085e42c25d26484c424816103637a4dc7c35da7dd765f0152c4d069586d35c9d9e69f46f2628e2dd808e903c55f6d0b727ff8e443da6875d5009d5f65bf84b39d580abc77af63ed63bbb08390deca4ed702d4ccda4403875491234c03ed2c6a8528555a6a031150d3d0b56cee8c4dc6820a906ac85742c6d6fe88b98d3a85d7910c6eb9e7f4bf777444d2e7899aef67b94530dd4ef536677e141107e79006947d49dc3ea224403aff8915d6b3edd637d0aaa07b091846092a43bc19a78e3c50681179781e5f0a67ca641cfe3741e058594bc5b42960c906303f1d503f1f775ef4cf3a23b084887a4ba601aef160c9394d08e2d416ccef1e267189fec128693e1a7d96e1b2f98cb68c914a0b19b7198e334b540681671badd1fd8b4a06e63d8a52ff07f59f67a751ad38d04d3d083bbf61b86d496ee10fd4c4044eb47c6ec7570b2b86c0536b6a38ead75bb9ba16437c9720822e2f5da2b89d928a99ba9916888c2ad3ca4883b314e2d43fcbf30ead617dec93172386dd8bc2dd6943f860c2967f8b8e5b1ec96703ea9174485e1d5e477d797ab5570a5380d9a620102cca7a32fa3ca021386bdf99a3b2c990b53ca0759574a7eaa60578aa5010fb2610823e3af33dc24558739cb76bfec1a0ec993a07c1e61ef4f17cd621225b075789f4500a918083c0815282017df91bf0c565a45ad98758eec6873389539ccecac00fdae15b6e05d4b3d408a9ca07019cd034c7f87a82ff7778a87cd731531690332268de4a5843669e189a06ab05e10c3166196db8b6d60b6d4d4381d20691f2e303f16fc421d4e897256c2276afa29dfe1a4597eee6f021e3cc230390513c433bf7bdcb5dca99118adb04b8d49fcdc9e2c484eabcd39bfd32362c9bbb489311e2f8031b1a6078f28654f67fc722dfc2934bbf9bf0c904d3681f94a9bbe65d533ec9bcd839ca4c8a881c57aa9960e5db45e67de5529d226c92880ea7c86ff727a9cc58abb5907a200f82c764e74eb9074fb5bdabf3d46e9e273e45af0bc42f79ca38aa5da2df68f57c4be4711e0038bee32ff40b7c06e4ff0defd8e69eb7c5827d94dc0f13432723fc48e21c1dc4bd8ee41a7708ab7e05067af116febfb47a45781161d055d274da450e6ba4e4b05680ee58e8f72ff8cd290cb745ffdc56d52c569ba278b85f17591fec85f2dab1392b0bba7dec5b4efc0dc3eece576092790a16d62329c4d58e2c19c114015cefc923815e0380616edc33c4c10de93a9d249d06d05130d5b509624cc9e28b9a53bc97b4bed1c86a4403ca1b15bbeea3203f720e44d6ff0bcd9b674f3679cbc6a95952883f9109745d478de62e3551dfdd1950b0937aa80bce4ab55d3877983c47718496bd11b46ba2e8d11ab997623d34580a5fa3e9885ef96735f73d1c87454d83311f8200bd43d79b15f2bd00453976e9e5471f491a6d11400fd329933723c148314f6621af27e454d965b5c06b35c6fd1072710e115a474527c7fd32141b091b104218b14edf18071dd5f9ede6ebbdb9b4f2563ac6fdab3d7503f8363b1eaf2025e1329264afcbb9c715d8b9fde0e4e9ca93e875793c1ca9b19245343c1e131fc1b7c87396b33b075d8bdffe02f5a9940e9b536486de537315a5529c8d2b6908678dc5efe75e9fe24a10a0942a55aab35d69a092e6fffd1f1d4de85f0fff9182dcc6a2ac74f28d385933778e9a5cab2e1f8fb94dc79bd76aa668d4382ede4347cc8f96d96bc0d96eec987ec3c80cf565d54fc401f33e7f4286e11e3bb3c7305eae171a955bb291d0d208f33ccea1b92e4a20639b8227fa9f776de37a18bff403e14e2d3f6c34f59d1559a53c57a92fd98409cc001575e1820258c5757688c01e172ef46c05eed4f3dcc0a41e26ef255b9455b5afc8bab69c07fa8ac92a31881da636f3105214785ac2bd1ad33b1e8ae4874df14d9f3894c23772e91cb947a861e17afcd167a2927f83f11184c3ca484433a1f8cee040f1fc43b9cf2a223d13d906c66dc4326de5983ceb5d9f5f991de46df269c6abe65bb0b4334ada91a3caa161f99cfdf8ee3b7e6fc68908660b13780b9786dd67d7af0692c1e7a44d31a1aaba78622ad9332f7c947f4c2ad263d5617ddd58965c4bd79743b37c66cf75eb4b750a1ab059711784f8eabbd7e105368e1721b45f6d9098debf5ee17d365ac282c21e7ac0b38b933320720ed913752212dbb99079ea7c69775808a1d0e6b10de6a297e17388c6f39188ee06e193331d495f0399fb67b99e6e6d81aad3b52277011b9f35c566c520ce8b1dccacb5db815efe2b7830a77342232af318be7e495a3bdbea05aa325e69c920663341fbc04334f0684bff38bb70441c71d475bd41b9165d219aefa1193c04baf8fd95879484f46f7748eaadfa2c9a60d86632d9f70cc417450872276ab815227586f924b54a47b47f13880a4d41ea903d5e834e26330217cd16d622cf567ce1f0c44c4e57caa163bf2b450659e89337e5d33f2f5474eb97de4719015cd7f2bf841043f9657677990e75e5d8859da8c091b5a4d2653ae00388ea2ad559ec479c0e433f89e3424dab7f30f1875e6e16cea5f3484d6bf599788eb2b7ee2feed4162c05fb90ab2233771a843057fc71bddefaf49c178d93285b9ab3ac6942eb68826d984b5a4caae99cae7363aed720e1a4d1955195a72a545ebbacd03159f5c7806e527908772434e6207a6b0992ec4ff01d2263d34c62f154c32db589f19c200d0eedd6ead156007caafe32400fe9ff188372e5bf1cb6eb7a372f7a2ae49b1048624bd991f9a578a8d4ae69a409f29d9d9251f7b40212c45a586da47b6031543b9dbbb0e0b94594cdf8663bf2e551fd6862b37bb1d4749a5dfd2472cc512c4d3abefbe63afe2c345d185aac999cc5c2fcbabe41f4fb56e15868408dc180d9236e455ac9692850a676ce9d6b94b00a50440db7835cdc53486cb996ecba667a9c5a7ff208e46dd60f64c645c185a12c69d2bd854b9a01220b3c309d4b39d8447344150f67db97c22b9f56b9491981eb6934175965fc426607ea2fc310eade066f6080ee60485d48f01907a5de1cf0023523535d55e536c121514cfc6c0f7906f7b83ea00de3414b57e7ae466773d12c6358fa169a1eaf9727aca6ddb5d36c6ff5d7e2df74305d46a61dbf48415bfa2e85c72cbc0afa7e2c20c89acbe2a3a7ffd2b1ed3cfdcca141e05ae41eb30ff7ddda9ec8e0cd1eadbddb1b92385bf99ce2bdd4981737d0ccd0056990154e738bf04505e58223411749115671464da1df0d39bea82e76db262e655d55bb1bb92196dc54ad4505adf469d0155b70ba0c8fa222f1a082abf57912e9647350f8389e349e7f94983ca894d0536252ebb053d1cc002e20a81c70fbee7160158dbb165ff997db90b6ab693782146cdb8acf42dbf2901f406893317db17b5b798044f00b1f80c8b182e9c7906be61c75c12eb498d60490ad5f712cc9712eeb8631f9c51891a4f05d8ba8d712c681f54e32a2b2396f163dd91e3e53f4c8f5c32fd81b5520d65083bcc1f52e11fe6f26684c113358b6199649718095d6bc508868a79fb560e9f109674053ed36cf87555d547de9b3de3c596bb88b055bd9ec2cd18910953738fbda65530d87b2e804836b4d8fe6bd2cb04781a7037a26600c25db5426b0bd54f44af62ec5c85925f91c620296cb2512838b228d773d8f1128d3e769e669649bc94b684d9e067e0b42a30c92d3a45ee650438aec1af3d6647227ad0caabb936e295a3e6a4a821e2c00a5810c30a0eacd3bf1292f4da4203c9e40ef109f644556a976915cd33590b3cdeed5b6e9b1c475ff4830f9d2a2ca23a53b764e4e232fc8494140dde6fdd69267625753a9b34cb848ce961a378012bf4fae327a133d57a6fd72b09a1a935f74d8aad9bcbb8994330612d297bfcfda6b0fd337e7684b0707186b66739ede81952327a38ef4adee0c47cedba23cf25f1f6ad42929fa1f1d5612e195c85ca21a92a95c4d4025b8addce43636a8324c359d60dc70d8b82ab978b3381eb700d62904d4469625170310062d34fb5bc9c54c9f04bf8f5adb0e092e6194510250cf11fb5742ee77f43b1f20181a29031580e38abd8c705fa9d04e08afe344594bb729ccb4b7c65b01883c7f47f1e5ec9434152026526826b1faae7b51d973077b884f9b029bdbe55d2d1eb555477ffc185e73eeaf46d1416ad560d6e25e4a89ea4d04322b6f6c3e8b37e3c2f1925fa4876277dbc040b26c3e32fdf7d92338acf9123c374d650b2c4dc57f86c6e06d856b14644cd8841ea16c1d789e4bb88dee70fec2aa6c75229c986b8cd1e8f769786498d05c8a38ecdff9e17ebc9cd6c47622f63eff7dd583a66ef095e85e7e3819334841915e7231c5a2297143084806cb17ec5bde235224698a326d4ab4fd89602886c3423cee60d469982374adcfc071d8af55776de4dd5eabca6da4f233ca5a65b46bbce01f3735f8dca416aa7ffa3085c3995ac5824ab901f529068fd42a115f10b6f8106683daea67293d37302ea6abda339704fc0bd7ba3b4ec930ff3c807d57214a06cb679c682681f144f02f717c68b79125f798c2562fc8e54d078dd0d2b58e5fc85ba06e8534a68d1a7991bbe69085600205e1cb8e11660a6d13eb8bfdd1784d450ece2fcaede0cf9622ae6890feb91cca1831ac32abc9ae471dcef7ebf97a0682f63de08bae34090255160f49155c5e2465f2f5f506c536914da0186afd4d1287211fe6d3217f3c6bf5f4e01531cb275bc5b5ca49d806f7edd51580b0ed70f45255339a72541edc7199575c46906e1abb0001ef88b86d4d94c9f0b10273dc49d7711fd6b61804f785b09563970a0178b19ddba7b533f55f1c9682c96309674b3be9127b019812a55128bcc72f6de3f70334115970e9c4cb80c405b9cc4de895fbe3c81c5f05a2d3b4338e29f5cb2eb391a0cb244c96e0b42cc835f6b11f711775dd3c50b45cf6dede495b7b9055bbe64cfcb870a9e48a712fa77088d545ccdbe960fdea72cdb7d08c7c27edee7aca5fe61a4e32ace9775c5795b032f65c0fc7c51614f7ac9bb7e579ae2e0150a95aa1943d2bd42514f443d9e85afcfb266be4914dc5c3220fb3da1adff73dbac722a5f37aec4401628d1b35ed3f98958297f3d79f7d687b70e95946eea511d56be5342cd9627ea1d2005443cbcc50701bd90a2da356e5574906747113fd2d286c21d9b337e20f96b458b0d80393bdb817816ebc7a6984857a4c4d647d2872293642b7925c3cab74fb15bdaf3624fa5a07df708c9566aaab3b4fb131fdde438fbf0c222222e87c93922d795fa03c8a3378e1f64786d1a80355471b7869cb6d5427c4b1c646d5421fc39659fbbd381869780c1eff9329c050f8d33197c20df5e6a994283047ae30775711b72277a015fe25f01e8ff076ac20abba11dbf5129f22667d71c514a8a2805beaac4a863a975e720b84fc560577b718a99f0b1e1e7ad31fd7c902b0f7d04b44cb2f7acc672848acdecaa18c47dd3d110ec31495bf51384c224ae32a470b0501a444a91a4c9eb93cdcdac319eff321e2a5497214ce10ac6c9e6547c6746a5b9e2c5f523521c39d1362a56f0555371e6c4c8ac5ad31a1bfa86477865ec10d3ddcc20931384bd9ee5bcf36154fc77373a4c0cfa0e8edd20511e491c43acd9ca00c1ed9e45b16fc04ccfdb7fd2577039c7ab5c2e491eb380d8d1a6dba8228a0e29fa0c1bd3bed18d966c2c9abe664101f256bfc2556768db5dcf3f12162da7891b941759784fe4a683e735010ab7cac9c81f73f2e36ec0d4e1163c7aa0cfef6aec2d9eed69318ad2f5b3477c57178538bd74578eb48ba41b3fd2c1b4a0c727183fc91af3f7abacd0831af2dba470e319309b5fc031acb8dd5c76f2d8fafec40f3bd25d8d110c7e0442dea56b3c1eed4d282176593e8bb40af3de2cac1829068d6482d0588eb1c75bdfde9cf11c86c8f35e7ad77837ce28b2fc4e2064959b88ce5875f85703f3a0c43075f6ed59454a349ea6b6fab2c08f31c9c8c17931414063badc50b72e48f4015597950c29f92337723c1d4425a83ab55a098f07c4ca0689058651351c1250dfb8804dfca8e6ee3cb45c1bc916c688bd23a51fdc0fe82f102b1bbd0e04cffb0c08879919437f0a2dd699bce4a91595ff048032e8210229e4c5ada50b150e1105426bbb40620ca41fa792a3c79e7f4311ad45d4ea89f9bf960d7a37c666881abe94b7612e799044a10ed094e8febfce9125f1dfb4d8d063ecdc835c7378bc63a4151af701c0c27a433abb53ea49a381301d19cd4eda91b67bf49edc564be49164983b02230477a58882b53f25c375f3c98caecffe91ff90f2122a56508ed2e5023ce51f41eaf41b4290ecafeb9ffad5b88947c5f2f63da86dab64d7f95d59f922d57dffce69524b52c2a9200c3341d1c6012b99d6cdbbb779e8fcf39417f618ea45c179c4201c570444286beeedc94ab76abb5825e6e97dfdf4c6444f825ec190f47e01126acf9be75f20bddf29d03ccbd0299bef5ae2cfa5f81e70df80d4df38eca8db2727f334782adb5bc4331c2607889310ee22ebdde72ff841c3b9fa2633b3a25eb8732dd055168bf3f1c9d828cd9995d546f378e0ea5bcc7648e0027d4e64b619768d1e72b79c77b3027ed9a1eebdd3c5aee82005599a304c3a828fdb6dd91942a8b5c7567c01be7a9e2dedf928c6e938014a5d4203c496df9afa3593574513de2c6cca37d4067557de07ad781aa43726b75d6a157327df2504d33d438f39a2e9ae7cd4e19bfdda05874f9d00d6b7e56369e956e6106b81f113a65805bba602d87f76947b57b7180ad5c9447ee5cb5746282c23a335c019f6ae6f18adbfa7eb044670629cf2316eb66044de61f9f736ee51002c3a0137ce8a717748fac4d92742b3fb091c1cbdfd391a99fe54bbc62e19832973154d9a62f4840872f646ada715a7716047f6bab5e7175626da88fbd9a7ff6c640f7029d7b94dd33524c5f1534266a4b4aa98187199785508b9e0d7ae9f81a8cac70893216d86329aa2273fb5fd9f2ca0d64cf1fb3871a8677c7d0a42198092a4299610a523bb712dc90b0c84bb850039bbb0e7b7e770e36766608b7a25839f39951711352d245bc61c7da2a11e1d2240f6cece6d779fbe9a211102e544b539fc23c037adf6a624d7a24f4026b9d02d9ceb55f1dc90571db821646aaa923ecc41e5005e9e516f314e44533b9cf280e44a85f9d899915633b851dd5451f4f6dbf2517a9a5e88e57e1838c657f4ab448b2e56bf605b4837b54746517ec26d5b0f485a35b9b9ad22e525065aa50cd811d440509b6d606c559df1b5fb0ebbe15ff952f1be8f06eb3680b8f5ab0a5523ccde801f27a208fd96c0e56e32ccee686c35f692be8ee53131d65a7a9611bf8095ab0d7face38d5c817267d53a42aa88f51aa5fcae33d1e23a3b3d2428a44792896e691d5db97808236b5150c51ad61040e3f5a2ba9059db85d10bf09cee92e794c928e82208697e2e20c987246b81379a34a6b0cecbd97ec27436f1d8af513250564f8ebc78164ae00dbade86fd29858ca3fc2822b0256cfcf09dcdeeac9200c616d44cef19f33c9d276fb7e230a5d61589283971a5a0b5ae4470928d9f08d67cd2c7a10b0bc138401c382448e94c08873bfcead03f7ce500419b95848fe39f1962b61f6b7a8e9beb734147b567200926b06082ac4db79c02b97d7657fe93fa7132ca3e6220ade294aefab28ede8a1a422b2acdd7c87df513cf015b8531f705e27d77ee686825a2bc9fac3fcfd4e1b3f2c952f5e1249476c015fbb94ddc0efdda407a49ef4ca799721a1b33b2f65ad3d277860e65e7821a211799965d084bb23b04ec503cce0588ab2e143fa4dd279e451ebb5b965ba5b678c2c29d3f67218386e69eeac059e448a1a3d9a4a16d554a5052fcde3c27ed2bf480cd4945547c8deac0dab9332f3d898d2abcbee2ca79bb45cbf3a97ca5666460535b80d40f71ad6c6b3171b4b4413b55d426a9d1855a2a7b2e012465aa0e09ba60ac0a476ad870a26ab611fdd8e8c4523f838b9ab46273577902e68bc10c74a41abaa66e3a677497b31474e532fbc6be5c1d0a04cd75aabb2250e19ba28dc250436d2421fbc17b3b58bfc1a8e93137711dbf5fad89e407502be7e9c0a731c64cd0f59214a14c7ec1eaa4404e349e17c895575e340dbf9d353df5537374935040a68f392fca5ce23f65e93537dbb8701e3a41a983acdc7a27627ad81737570a5f0284721f85578d639c25f5a3b3b0cc2866bc6b9430be4b5e5bf3156e48503d63fc6c380c32a53b0260eec5cc5f257934cfe675abc27c90b6d6ec363862a1f7470ec73c69105673935dad5fb32eb0b57cc922a46bb2c0a8ef16fedbaffc7e7c3e8781f7dafc66eaf9e815be434e18742edec18306311e7616b11aa55970ade63cb23de182b4a2b62868d1769bbc670d8bbb8631fe051dfc6ad1f1a0c7a33df934505c3a226a2004b8dd9e6b94cf00312eca8fd46e930b7e4562ecd038c94c49c4788c9ad741f7e4e3df821c02a0b1db6256bcc00cdaee036f448478fcd6df70d90e5b3df8f6849769a26d661d58c4d0891665390e4d29689ce8d836fa942cde975e9cab6f5da16a168827e77ba1d45aa8e39a026239013aecf41b69950ad5e4fc5e7ce7fc8aab17e51d20bfd0f4c3b2bdb4745272e9099f0df53c7efdfb3bee960e1ff9d8be950710b0b02170465bf39b6f93d095849a8b4a76a7682e8afd7a3d84bf3b410b055f3108b2411a4f933bd3df038548a35c1ee6c91c0cef5fc7e8f4ae371cb32d62cf65fb711f2cef9ae894fca872599a5bba36b1a6d4fc16419dee2a1a305d7a81163318bc4ff1bcc11c6d6764b29edb586f32ec9ca12cb8d1c901d9416b71eef94be52a72fd7e08fca6219be9eddd10ae374ec36b403c4a5bdc7a73256764c8350adfa8917d95da5b207e68ada56ee82250ec7200c9a41ed4cdbd7c5742aebe44b195a85313ee0d636c49206583d8daf3ac012a182e28cf5badb2f6af196f68d9a56d1b581bc6db105b69380d5c9350bef2cbb118c655ca1541f893bc184dc7b1db37e29bcd1ad1bfad348cde1c686fb00d0cd3f9ba1ec01256861ba0e0a223396b2654c481330dfd8fb7885af1a7c8ee9a68c6ecd08a42940d60708c297a7f07cddd33fd3fb466ea0980fedd3f9fb5d88f8971d8bdf8f9cb361fc98048600d1ffdcadd823a3651a75164f2a6db956b5e50e42b9a0e177ce64a708ea10b4a832cb34a8dbdffc32e1e45178f1a157407036b4909c67face1a877ef974905f768043a38de0e2cf3a381486fca79980b329264eff4afeff1e3b0f9ce4fe530c479476b0af7798d763e1e4293fbcde4fe2b3b8b5b181eaac931626a8b5072349023922427adf7a8e2468a0ddda12359a91f6d33c43ec1e8f9f68924dba17dd65cca18b2ca7d12d00cdc831e97a8cfa6d2837ce851052d4882d8de63b37d97817edd54387432f7fa0314ece2292f205a9705e398b90564a20ca992b0e6228872bb220f6bfcfeed473a30c0cc5fba8b01dcff1e71454064ab078805dae146b77939556533cb7aaf1ab29571fde7e7baf519cfb4c18a763e28e48bebd88c55e38a5bffbb87c15e27d47c0547799b8519d4f5a74f692c9146f73501216e7045986cc8fe56cd81ac18c41f0a2b9cca3ce5140ac86a4c390e4dc124e9a9aca2e99b511c6266e7eaa27d7a8539f8eb388a4329dacee8d0869824d724553410b82535336fd32374316cd087f36a950435e239194e0e9e14090780af03b3b7423673a2e390b0a97d0f94993b20f43d484439d528fb17f3592fecdd17bca20bd734ddc84e6d498a42cedda1760ccd292e56541192fc17c21b00cfa6448383723d3bcda986eb374486360d4989f5db5d150b53199411643fc7552f64da72d5958bdb6c6dddd4a310ad352d717266ce7b7767fd43a127875422730c90e27dda86ae22b0c1ac532f0d7507aaa05a38d2b4adb710b48f601ab4b38542757851220e58b777dec5a99dcd3b3ffff757baa56cc7743bf32f5c2e25f0f9f8ab235470755a261955971c02b663fc09e60a07902cd4c9084fc1132b9c8b0e0345675deb5dd1b4b80c915d86a8828f30d3d140d22646915f3923a8a531ac8fcaff2ad1c20dcfd1c5e397f26da9e97993c7237b1bc8005bd79eabe1e2c453416163530a95db45f50a89ad22714868453dfcdaae4a7921430946e2b4a73fdd98c7ba969f8eb8ab88ae3bf6157a70f798e0f5f80966624c27e7cab79d3a1466b4dd434b9a991bed0c1724bd66acd1d5fe8b8f93e06accd4d838b090b8d898d330c4cdb350b5fbd276dbb7c27c6e148e20cd31515eb437ae697efe0fc85287b9289c3ab7c8fbf8f355c0a3670122f8f144684deb3fc824867795374838acefc8ec8aa692b756648089627ffcafd3567a7740bde1211f4c2ceb9d44b17b4a59884ccf19f6055fadc05d60d7d2ff3a4125ac1e3a979ff64656696835192a611dad73612f5e1af3d87142be65f88076c9314983390d84f25f628c3b51e19649ffde2c1cf1e6e412af13aa5ac9c4950ea69ac4e95295a955a91b85d5db3f2702d984978785957867daacb8ba4bce5e7b3863cf7ba6dc874f0f3fc8fb8587f837c0b39e5d44625a337731aa98716f25bbdea1b179eef3074ea2608d24e5e4ebdf6d6d95458d5cfdb2bfda85ef5bd96b3bea81edb02a476412a591d68bd9b6542fd0a7fd4d3c4ea7d26f671df2f3a562d0d45410a4fc62f6423c04ef61ab833177117e857e1b9c81937db5d4c81db5e2dcde386fc301d91636c2d7c857cd48be33d9f319f2d3b3769dc580eb0b9b8caf28e170ec60968c14b9e05c879ace8447a1b089b52ff030beface28ce84e62bef412b5e67077552bc2a5d295d65b7b610f5f4ca5ea7ab9d5a00a2d849187c2e3ff730abd9d063cce27ea80f2c4eca4c27ea3daaa026a9dffa4114ab2302f5cecc3d241d7e5e4b2fed4e2ba0e5a00cf757a21b6a10e4d2c0eeda0ac587dbf0cbf1f746e4cadc4c3f8c672f343ffc8928f0b854374c352de20278b68f8a761055128dccb79a1aacbaae60031cecfb34c89d83d66c6823f591173295124a3add2cf244ca008591e1b809597f77700885d5e3c5c6020de24f99e29e4204fbe161a6a7620cc1122f0753077843f458b5d12ec213832264a1194d5cfce31dac31daa9593594bc52e48d20f74ea8d425802fd690cae255c09994b055abbf4ec877d3626d01a04ba84ea7e47ebe3b10d1108bd3cd7f60ff1672eaf532b1ace3b932caae07aaa8e2230018556e48ca18825614fe01e276f104ab1b9344f6b3cc2ada3b7f1a81a404d8807161412a9c14a9d28a3f78fa779fd81f18f133d967b14174e46ce483435c75a1d026b7fdbca8442c8904b5ebff2f5536e7f767ab22b3800754ef1b1fd3075035a238aeee340a3381f9d12fe39792381bb89a34e83ec670ec52f5d95d2445d5161e1f224236eb1844294f131e57949cf15b2af8db30653874bb011f338e7bcc579cfb13be2dcaaacec8fdb974eea1867bf597e3e65a7fdaac4ba9cd2764f7859cb2ad224c5806e99cf20dd8eb694d4524f824d524e423ab2e98bc667f276ee04de0345562898e45923391b8fba1029eb6ad7cfad1aae80b9ba8eb9e9d5a6f783d285593fee2ca7fd95bda33f85cbb14b197fce014fad3806ee5087d2b7345083dd12d7e6a00d1519540038cfbad36b975397137945412471f83a6cc120649404d7a48096a9bb376cebcba3f4b5698a362bea4f37950581a3695a5ca821598cd6874fa2862bbf86f9cbd3f396995e13d007c7c615a1fffb3ea79f6f8a7bb5e17aaa607662c0b30767ca21b9665166c43d932d0a2f5b677f210ece7cb451ee4e019f081a00ddd76cb85f6927d5a13c1743ffa38b7c85416b5148a532e45cfe8adbc7e312fd2f97cbf3a45ebe4118764789e86c2d205829dc2c452bd2142370a6a3b0ea621c597033e808f674c7918c5e784696faf10a0b491cf3ec3d471ec0a41d97128911072d19656fbf7219eabd62e36cbaafc50be7d42fedea19d727cd6fb627a7c2cb7a6cc5af21db1c7598f1931abbffda5e58b7c0b0c7166868ac0c687e0cc4c06883d9a1f58be4a080b9ad14a3d813db137d80fda8070b67abb9302d36b375b09ab37caec5984e5a7f88b3577f4418b1aeeebd4f328fd83c8b81a157c7abba01bc25d5e42d8e0540b4fd3ffc5f390d3628b741ef31a1d8f78cbe3a7369605105de166e20dca9420063ff61ec2bb0a6c3897a24e7bc6d0f30c41baf277fd60912de66a2706976c2c895e9b90fdd9c47aeb2a067c5298f21d04a1b51999de24e8500fd172fbb00166374ab4e49fcd1377ea7629ce8aebe3d353155733958b84710a71640b2e8f28d084884dcdd709a88a179b41f1973e606e0c2bc6fe1a71c9f28497102708aed90a274fea38d6a88efc5964afc8deecef05ef921b74d80aec4c6fcae0049c62009854953ab0af63d144bdeca73f172774942318bfb91c6f223f957bfc1c9bf32203b6a886958dd9bcacb823f4fd014b2d43e4fee1e84e7c337174a86ad254005967037e19a0f712093475375719a914739d8e21b3c1e8e2b22e7ebef9b6bea4d0d3fa41cfcacd3a72e2915633443df25fc1156cd28639531f194ed4aaf90bbd1ef8e3be59a7996087ea727476278ccee1fd7323872d6f663978820809443464fce7d6a1fd563e21fc611f9bf0a7c377519fb5997e8d6930f5de7b53f89dc069f232e9deaec556cc2a10909c214291d641bef5e96ade83c26207abfa9e177d3f3d9180330433f6aa8aa34a2515d66a5fce9d504b68452eb786d01692f47e943b64d6d69c9f1752cd9ef6db2cb03d7bdb35c84b5a8f1867e7a4a7effb1297b4b7acf3bca62ca31145b18cef0c3c003afe0bfbb01f812fa0a0b4f199f3af04db94a56b0592671ea23510f3a4cab5a2eef093930c69abe2043462eab8fb3b33a878b7eca91cf42ed78c24419860b60f2aa2341dabd3ccf8e83fa36c0a86a3945a766447e569be5d3827aac3e54764950cebe7779aadc3f6f5dbb7ce562e835ac4bdecba44e822b4df0625a5882d76d847a468c472bebc49e7deb3b56e16ca7043e6489372e4b2848fd7ec286e6cc9354e4f00c5973c95430c3f9d136575ba8b7f47ea9c2833c08e80ff893a05fcf79223497a0cc58764f77f15d1d216e36ad7246688da650b03ae4ad6a7d56e361d723ddbd03fe655839e56418ff015edba40f8245260d92a905f6d3505bdde023dc6866593edcf4f45a318454c65c32e11fbce82d528be61793311b8aa67f142a11a24f754a0f8fa0a801f3d133464ffbebea202ef9e92ba9555ebfc8d0f4dea5fb074bf1af7ba11e4ea25c830d0da0d8da91665d9f600bcabb86776767caf86d8eeb7b5672bd2e305318cfc052c296263a4e97b8a127978186e7c3c156532407e6ded46fd309764e0b002fbd2eea09fe8a961e53943bccf2dde5b18678201be41d7b03b25d58754c1ac8f86c9646f92ee7286ad1fed700f0fbba514e40312cdc345c7f4ae9fcb06984dbedf66f8f21d7b954e5f9a57d2b44233184c24f5140c0f8d6015d9cdc81f9417ab9d3efa8ddfbd059f06d7a8e78f65bfe8d1530269625156bf31697686238c0d7acd2f378f45d6b952ab4a1356402ea5d2e8fd0458dc613180d6bc24b09ff652eefcbad97435820d9b51392fcff07f18632b5975bc5610e6ba2c86be9502b4a147d496b7f985d17a14fc4ce18512bece6b13fa1cbb96bc2f174c5f5de0582188a173d3ded05c873c48b48467bcc283168361634e3b608a295dc82fcc2e242856daaff24f8af6853a355cb5fab7851ea66ae7edd11f207cd76880ef549600feb2dbd9d9a36141bdb0e01bdfe803ec49b40849fc708f5ef86b53cff4f5fd746af0a5430521288a5622bb6fed6da0938b7e2d9b6b02696b4ceadf5e5d59c3fe6eac78bebfcd9d6a2eb67fb8616c08484e43ba386cd89ed02dd5922ea0e83ee1f0a10703d482a0ad3cf4696ec2bf086a80465bcb5615f76dbfd0c696d830ecd4fb056349a4dc3cda448408a5e949fdb4df642abefc8d3554f437dca9f55201e4c0177834b58ee4d2c30d9b48c7b516bda2f0c69065cebfecc526482124b9013863fc1c32172df4b2137998b36155322f9045e2618cea45a4427f707876587e3dc0a5dfd8b6017e9e60c33515e874a5a629c37aa65152f489eccd0defed365c601a455231c530e9f6cad722c3d907f24d12fefc25488f23df9b77548c951d7e5d3595db32d7e7795cbb047b96aa5cb59bd9803eb642ebfe36ca9afaa49d5a715c0ca419a3351a2fa2557b9d6d0f011f5fb86fae3a4d2b7b0f6d5c227cf5c6b59bd98fff8c2199164174ab830e5a86177af463fb25338c8b9aa0f8aa291682b794f11f9ab602c6bd959b82418e742f93b91af2db69f8622fef815725c6d76c9e227cc7e4b98135babecbc2028229aca6eff2a9611d70edaef3d1d8eb02a76e89e422efa1de4b1e14db9c98518434d0ea1e773a734c6e40ed763564ae8891c932b7b58890f9c03258e11618063b34ff52a5846e506e711e8044278ab629e9820f2638dafede0d420202a050c8dd0bf882880e0ff4e5a560ec6f94532036ffe9b48f424d27fea1f960952bb1034f372751d408d3dc6e8bb50ce7661191063874e7b95762cfa51941599729ba6d077b3209625a432e8a075950cc00373f6ea44cf46d0acc768707f6ebb17b03d72007f2f473f9f664dac816e965c6b4babac3cb7976c364f1b7e5a45df21bf6d326b602cd8369dc9bc627039c41193689588a8cd1a9dca1537687a04fb33991984bf6b6a538fedf42d2b58f674b42999c3321924e3650a9463b6be9cbc201ba06e21faad8acf0471baeb3cbee8e84f34d6c3a48618e83f43b25b639b854c066d87297c098a62a33e97022d5b3c5131b2ce2a1c5177206bcdcf23e052086eef5746f804c66f3a2eb7d587af47aae45b474efc465aff068f83ac76ee147e87a466f63f8f3b4f5d8fe38bbe3b5c2c76b472c01c6f627fd52bb68d1ff0cbdd71127a1d3c827da05254f3634f1c27b5e80a46cffa1f79b44d6dbf5e635ea294d124e68396db12913f7a21ad4910c31f9508403b4e90d66fab502d5ce8affe735b59364534e15199f5e018d80af36cc3bf733c27bf7fa26da953de3843865b17711ceea235a31e6b328a6a0ee5560a7ca6ad507cf5b0dbf7eb27bc908c23f7ecb5da07ae6b0eeb94ff44c7f7375a2a58551b6b7b970128634d3a57cdedda41743e9b71b2e4e22bc93a7c726290177ea02867f14a4f631fba0e532da0f56e9ac72cc4dc60e4a7f736027ebde895c06bba5a2189201db5e882fb7a195271e6bb780778f5d926c7bc6dea9f6f551a9994aca7e09506a66a95fdb6d0fd93866e241ae9df12a23027f3734746d3195689310bb6f5618e0fea074db160c856cf9f3c6c956ec5de6b48db075321e3db5ea9194daf0841ce163df563b421cddacd363b7ad1413854129137d886741fd95e2fa0a4e7445666f8d897cb3b099cd74d11c17f138602dd7a7247ae0c0529875d3b127b14c0b82ac84d99855e14c6986431ae564568cd75ecb520bad6c029ddd0fbe8479bac4f435e22a063c15a43b7e7b56cdce1d9c923797080feab7bd61773d4bbdcb4fa41c165634095c360d04e151f60bb6eaf0a3922858f157230058109847d058e1d25aef782db611d55dcd457611bdbe557f55ca596d404476d4ded0dc936ec2693addbb26ec1bf67745f353678fe2afa2cf486ed6e1d6b6ffe66680fe236b2142aef3d389c4aa97b51df2afe25cfb8a107347f712aff3d7299e62e3e52210ab92a4078846c829d58db93f60c28a4e47e841c00ff3dfe3cd8e62bc356ba194dbe328038a3305a90c305aace7e557cd6567e36325d08df294139dca8c5291c4f8cbd5b6ab2d6014f6085f973b391f1346abfe2bb2bc56f113bc8d78e771cc1623ccd691d03748234c5b659e69bcee0f28692b9b2d1e4b25cca0d91c4e21a0e7b04568b8ce879f1e896a5bf0671790ed6a95579664a4c49490d013b07e4d2f94ed85a64cfc06a04b22b28cb9a59dbb49ba9d6ee07729ba0c10486656a8e6826ccf3d6afbad78f90c380820d2964aa1188f3206e3b8b8be70ea5fe8f2aba8e7d0463b2c7c76d310929e595211f4b225226a47d455bff9b9cc27cf3479701ac14b614bf26806848ccde23dd9aa040ea022cd2cac1070600cbde7943238a4a9385f795da217ec2832777923042690116049a85be827220581c01b72139c44030bec3f18def0f0953d553d1cf80c0aaf2a56d813a9db5df2c92ab5ae2cda7af6c8b32141b2019476e114120fb70052baa735bf77d2952be430d498886961ea1fbec77b049207182146b0ba76e3a7bebb6717e06d579c25dd69d5adba354b7cab427cecb932c1069c320cc465f4569c5de9dbee842503f092c5d8633b10dd74b7f8a0751d82d610feb765dada1558a36b4da4217ed3fe0a9cb8e438321b91d2a23a9c1ea36d3f873a6c28ab347f47202a3b6c6f76b579cb2dbcf6974ef845d748f412157434fcf93aecb1849bb8be4e379ad83b4010033e64cd7b45ea2ee340fbe74918fe841ad989ff1add59058098a316be8440dc8a28d8888addf86f376d1ca62678b4ac293618ccbfe33767c2fc499c780eab8853bd898991bad77a4958f4c201179db2091e6e7e3b4bb24997504a2bff178d3d4fd022ad3ca6fdc2bfddf3d2eb52960d340b8a77aa159938fc46ea4e7b76dc1fd81ae0fdd24369390e4588d11661e7470aadd53c5272bd31bd85ff887e57f6678bda6c545f993377e56c3b838b65e9e5f72adb49922e20cf031e8da47cf1cbbe6afd96ce0ffcc231216197fd829bfbeb40107fd30a4ef7fc4452c042ba74e02d1955566568c2cdb877b878333a096d3bcb02d2dbb3f64fdcced6768429a706ee35f43ce3e8c163e3108a6494cefc7d379a827e43ffdcaad99eed8dbe8772129bbe1420ea70d9110ad38f2fe5cd5f2e408cf6b91cae526e5ce8394ba90b056b49cefaaeb963f0ca2e546490ecca30dfb36cbc30b743f8ca563c61027c520f585ee4cce1302cf6ed4775479b095ed0d8a95db85f007929353ce8b39e5f9d5739b6de90ecbb658740dc0be5c42f0d078fe9835260637b1462207e3832acccef0d33199cd01e75a9782af00ad77803ab88fdbc95479735a462713401ba36cb0019d4813cf7c979ba6f83eaa30ede4b0bd2d26a3fa2d8e5b87ff6c61d23ff116f566711c6234cb107c90cd7853fd56b0bc42cf075d45a4c185638a128b8bd1ac7589d92e78b30aa726c49e926f8370bdd613fc7666b949da51abd59ec4d5004978077a29d80ca9589d0640d6778133a41c6ccb599f689386c69ef9ea07b2c4dd8cf74a6ee28dc574a022332a4f5d0cb8a0c5815613457ff01e8d955a9d9948a9c9a68d9975ba995328c25c163eb23492ae068fd3df0b38577777a04b2066a05fa2f089dc460055d16c05582c5f05337669ffba43016d7e42600bca5f4534aa8838ab56e645012313318fade2b52d1e143ca981a7efb0b0ca0ba0dfe57581bd38a0ecdaede3851ec595f82fcd5978bf7e01c9c8c088456ccecbb0685ce1e958cb3d405bed10d66c4c630b93335d6569c97d352d7dbc4402088be6a7bbf41d8ac3b9b90b088c618603e22c9d6b58753a7c131aced0c22842eba4512ebedc4ca420cb7e97c3ff0869e7d1b6b198347c6c29432000e9e044aa259165658aa4f40ffb366eaf86e2845f753ba6c6b3808d7893e2f876e2b9c8e0be6b2be95ddd4533eacccddbdef263ddd6eb13aaeec62326e80fa684021aed1300b2bf18762c1f7175e39bc0d099a2d2365f9bc2ee8b6054cd62f3cd45650eae98bb35d4861f5f668d104c9d07bb9ddd9575c0dd524e8d14a4dc7e13c75c96b3fdebd6f837800f9fa88f9deb7a79a02ec4dcde8d7108e3555dca00b042847cdc1ab67fc4df29a2d9430d825d2c9eb62a6d1e54d1cd2d210f8dd864ff57eeb3f71ec1092170df27b3db6b06dcc4b24af2b55649d168129fc4f6beb3d2d8e9c18af9724f08260f080790cd8cd43018734fac51123d96718d1b9c65c6423321db2bdc679e2922f5dd8f66148bbfa83a662fd4c72b516da41af8872f9795467c45c7807679dea8b80806499f45b1e6835fef4cb996ff61eb42dc163ee0bdfa854115565a5461d11c4ce432e860f7a9b643ee15569ac575bb9be6e1c197dae549415a882d4e947630ae5d61e7ba246ae099581b6a2ac606960ab5a9cd6c5e929c897b2d43daa15a0523857b58fb93d49c2b78d024b57e231754f7d5a74c96f86ce465c6ed6ef4df766ebee7c39631f1244c1723cd41ce75a853049df9f40c8aebd72a4e9065d79e7303815197517ca37b4d3dddd601bffc57142a67d5a3fa0f8990f92839d25fc7f164e3576a7a08bb2352e585c81af9cdd661ac87bcd3d3f3f004c99bf50c0fe22ba52f03447fa4b5c05ed30d3cfe3e72388820ecf83a72b05059497eca3456bed03acf501423f8bb51911560d81e0ee9404be44423ef5c3e9995e172a4eb37fbafc41d28c0e888b80c363e21f8470cf7db033a5cd04a75779028398f3a151caa54f8bfd3c45e650edf90ff6a482834883696b48d0ff77d5025b4f633fa2e148235e0a13259605bafc18079b7cd26462d19aacfb8fc52bc464306de82f0e38d7691a2c38919569600dddc09fcd83c2440bc0c6d6cce9127565640aae6d6e9a0221f3b411ebedccd7b9f5fe7a61fa654f728fafb9cfe8db0c8152c1cd7ac28320448c35b7d11851264e09171ee7ee92374044384c76950c79f45faa177284ab04c21bb570ce16db4aff6fc95c622e2e49d1b28eb137b93220291158651613fd05d9424158af137f5680978061e6bc113f10d00bfe9e2220ed4381547ad9e90a5fa99eb44657bc8f453f676dcc0cc482af1f1e926be4a8622a7cf4ed692bdb6cf3a08f82e95fd4431ca72e9515621aec3bddd0a46a76dd76cf5bce0efde3747a2bf89e4b1df60d9bfbda6b143186b3421e1e0b018f447ab65d30660981c0b3f2b7dd71c0d2663b84bbfed9c7b92790b7e09e419acb88f018e99b545a19111ce8ef04b0a78a41a7082342ddb5262a47bbd90d99dce5c8bfdc88ff761a041ec6589ea8175bcab822191acfb2912944a079d74f956bd4541585808aab5321463ae63c4081edf52060d4f960be7217657d1817e994ba8a7036d570f7eae5e7148abc9d912ce3456da40015864539e51b4a6fb9bb4fde0085f39073a6d9ab9d76945c9d1f1c95693292578b49c83fa8cf5f7ae12414afac13eb6e664c2dcf845f75002e47c10511821a00c2c3853a25585058537ff82d5d1e31573c8a3c50a78866f80eec041f1fa7cedd612d7b36217bba03d9a797caafed5ce1a7c1dc12dbe51c08da83cd7bdcd71da59fa7f4a7cbe3e826336222b690820b3882b00d4d755c9a486cc70e21ee37dbda74ba5549e505128d79573aca9168f238d3205d7dd604e1ae4f13779bdf9ef3b32dabcfebbf770bbe667fec2fef2f77aa4d2cf653f129e77bdca1deb626501a1b5a3cc5088a585400ffb4a21426d68fd4c19fcc798151ccca00f5cc6e03fcdce393e0cbb0b676dce6c63dcb6c8cb6a04fd949b717a967dbeeeb028396e5c86eb51db90abbc3e5a1872930fce58bb3e87dbfc58e28a7a8a0ebfc5fdd82cf4700785e2b4cc52fb2285d090c066d7134822cffba0fd993f67fee3916793e2542549d8dfa56184a950e399b2f0d49c222821fd3d93ed28d357fcccedb56f4aa2332bf02bf6c25b1a8d299585ea7645a678e87d49133c19efb7fc457ee2b956231444c6215c2f2beca5ae86f57ce776eca3b7c2cf735a33446811712c5f35971c43d76ecf625ee7a1fcb83bb117702c7790599b482cf5faf199630da463ce6fe4f46b51d64cc08b3b7b832e3447a7342991d98b9245de0ae8cacdc0eb2497c1227cc8f42714729e7f81087ebf35415ac7cc22b6b4d9de9a2e7add14de4a42f70c0ad6d04d3a4b0c66a8aaf4193b692b62180e8e1c7a43a3513ba60e08982fe245354a1ce2c63da880e77b094e83373bb58455ad1ec6e3e1ea20bc5a626543773b8c37876d5176b160ea1a122783292deba751886697afc024d3bb25984c3fc143e08126f6b59a3b2a91fd27c0266a357502ab2919e1c3aa746e0e60922439ca8d949c1da5fd545a09cb30b0c6dd62049063be476550c1cf53ea0547648fda53945d230d4d1e9d648dd7540d70791ceaec1761cae731a8ee12643295f29dd521089a25e5f7e71a8778d3b94344a859dedc90b624edac9649a40cd54534101dadc115b54d8bb440c331f5a83dfe78e8efb4aaec839ef3d308795f01ca2f3cc440740e51242d5d344e67d75c758b38495d14863cb0d24dd01d71c2f076905ab7d3b9bd3ada33c34325c7a8c00ae5bf79d4c37c1ab3e5605483e303c75b7e8b262ad39e6363ba36929c8baeb43c3678054e64eca2ddb1f93dee4b4a5a535dc70e5fd512ab093ff13a8c9628b1ab4bf0984760a12786fa53b47613756b6c67c873ba617c657317a2f59c182dd0fbf9c3c1087b7a04b921f150aecdc16af457e5d42f5439d5b5a8014a17a31b53a41b3e56f14d63f452eed37cc45130c11079af9491f4b58640091056187f62b78eeb241984c656ba5fdca726b059f69be0f2d15fdbb1adbadfa470e5c73c2f9346cafc5f670aae4ce46a147d69e584e491d37c6b3f8f70e9acc63d70b34f0398e61c3f04b492631b44ac59dd442b9eeb9043abc1ffc70d713821f654f90f56718399adcfee0461edbad926b9fb776f78d64ada358ccd4fb680628f92bf0785b8fabf73ce6413e66a7621837307f04a520a88903a7b8a26be59ec3a6a48711147faa9b4bb6832648d3d76e124d8091d044c53ae8babb6c091061bd08fdc531c2152a5b12e42d17c4656c3e6cece238e5052807a611259bd71bf7ea72bb128f840749b305cddbda6c73d1904dd38c4df398853b6c91ab9e49e5fce6f6e714d6ecfcac99a9a866b05c2b83c31171bb9c90963d937805f8e72cd16525448aa46267729ceee770446541d66aa294721e3a731338358f97dbc89045826c72da0f81f27428c974271acd639a6cb258c68befbdda7b2018ca14cb4204616791eb310fbb0b1b394c131ca27ab41218c712b9548a469c4d3f60c26ac40764f37beb6dc98d2d83ada7986c76e6c716a31aaf6830547e7a5aad20608d2ee4484feef140995d5b785eb6da59258083c3ebf30f79e03d8ec495a22dad2309dc4fcd11ca2143872c46b5bb2468bf2de0b3fac3084bd0769d61439fabb4bf3167ddfa786ebc3e47ac2fee6848a007a311d1db339a31d72a22f383a286fd9c6e04be145703df66c45311077b1197519decd7f4a5dde892393467d2c750f2f30d26c7818c48136c076c5761d66811fb54768b5db2cc4a0a911134b21756de28a53bf511026d49108b69f0686c9b95fbdc4790073769d5081af5dcfc2dd5c26aae90e6a1ddd3b65302f349c87f27b914adacb1f599a942ed4259c04ed0c3cf71d0999c361bd04b615b9b38240c0ccc41735b8ee3fccd6b8b95f7e8c202e4b5b76d07cad9cffad9315ed51612ebf212df7bc6304391fc051586faee591fbd8964076b188ce4c7e5a630341fc80da1a4822de04eab42a537b1fd15d4b92ad027121158be5555ba9640a512e3e2897724ae0cb955574ff61e494b1c7d9767ac1b0f1143a7209fcf8b3921240d6c5089a1a22e9cf3743216cb315e594566f081f3f1ddca6e0c74a7e94074d9341a37340ca57a29ab54559ff608127fed9c3e26f8b0e7c0cb661b3f44c2de5fdbb719434a9fea43b649b098e212e66dbaebd7c5b5f8a9a3f8d162adb9da77aa6c4c61e03fea67f4f3fdc5046b4aac19329a2bd5fc93cc67c7e7ec03f4373f574a12960543670a5dd4b48bc678ef66f16f22f8bc770f2bb6b5ad33231f21d0e0e84c2daceda563b6d8e642f44a5338dfbd13852777011b3cea0e4e57bf81748d054a4fc64533edaaabf188628c9913c88775a0cc367826e847c6c49dd495bdb9b463a2b780a0a2b87c4dfc5ad61f39a4b8c1869d5d9f82ae0f067d25a3207bcec8c848e3799d10cf4d28ea0071efd512d2b704390fb8bbe1012ac170afb3d9bd410c3e8f30d51865933bf7fbb0a35fd256b06f5bf816192c2260f066595a36b4b3bfa61e7c2cd2be2f3eb311f13c8daed2e40282ca4382805612ef617d3e20c89fa031dc8b64bdc42259c29bffa497a94c6f3b846d83b47d40025eb756f761aece83fa8934d7c7e31a3024ca153e1d8d78a14a89e32e0fda0471da20aeb09ec51d18cd4e17cf177ad9db7402ed24674fb72380052343f73e1fe6e41bc09868dbb3c23563229822d65d160bb7238c95fea4848f3ebc4f6b2a07557471316866fd4e6559af7cd6b0b6912e13259546d031714abe7254d1dd59077ef97a90e82b92171fe42b7c24c1568395ed0967d23312e904c5cf9295f45c36f95b79ec9949bd24d3857512d3a6cb88c96c82adf9222a2ab69e679e9f115ce4048828d13b962f44ba7d920af54ceded332c5f61a030575557da72d30ccfd17f8e24ad4b80f7645bbc5e4e6a0b8bd356275029817a472ac08f9b300a712e1a2b2a6052c8db4f1e118de22bcaf8f8d9dace88af27b03991061d87a8bac7bd329b4a373d1d8e084387d6d13618d0f31dc6a6eb97f66187a57d6eb60a14342a4e1180a4586cf3e31203fde8df7192799cf7443aed12418dbe6e76eb980cb29e9e14b5b7501597660f4aadc6df1639979acc624df8e5b010e631b5bb528971c0f1474903d74f578a77833d58f3625cf299862dc21b35afa189ee8ad0745e2cfe43b0adb63a8848253b34ed1d79793a2af9a5c18904d94d0a0528ea084ec77a58d6899ab5036dda1d20610333329b2e86e37ee170bbc417d1c6f0f18da19312c0577f334218ee749cfa33f0a2f93f376047c07863826ffd10cab49a160c074974bfce1358c8e2d64191845fa8eda405ccb3d5e59da259d6582535f34d87bed0aab6ce09eda5d19cbb0565d56419ac62a42e4c67e5afe473d68463726588efb8b10b35da7d07d3422315ede8ccf92a27f85adc2691c82e23d560aa6871cdba76db9233c3082c523a67f8cfaadb4f8a409005e9b2cdeb4c1a0a11fb0494b53d6b1e1d8f2a52b477e83572e9ca5f70f8f89091480ab3e78b83315c97050d0e1c7dea4aa26249d4861db201962c87d9ae60aaf6ba40c1eb67537326b076c903d0ddfc6d8b082be29f1a7dc8abba8692615e0e6299ca144e6e3ca1663818053dd43b0e1113fdf8548c6b8b8944d9ea7a0cadd70fd2b77414025074f686a90105bc8a9850f256d6125fd568f4c6579e317f344daa86e27025a1ec04022137061bee4b71a410db2f57006cf6e88f46e62ee469128c49104b583a38739b7221428595c522828e36ff81ec4c9d3d6a10ca9a88b115df392d0fc76ba72443719885bcbd019ad309e511652fa2f982c10e0f54821814d651fd85c0a8d3eb249be157f0bc145b438a209561be84f576cd0b0db3a709d3eb1490e044e590581bac7f4212d2a0ab3f2580a5fc877aeee6aaa0cea933b2d8909b2543a93307f0d25d0c99b56bd1f6cc172393827b83f655bd582ae30ba3f5f99e938b8f050c62ad43003685ba27fd6bb257bfef6dd3231536d6bbd48839a71259a41385728f183ea1dc64b8f9e862848c8751e198f97fc92f76dcf8e45894fe30e8fea1ca56b61cfbde14560023fab13f484e97d960f7cd15ea6b288574038cd77e2e90c38b1cfcb9d92d52f6634ced066eaa2ed85a8157c9d1f97b41a8b57ba9442b5b94728d5afdd0026b4db1be560d4f3a81d15380d7d14dd4192e2c6c6c8aa0b1aa6430e28190a01da2d066670739b4def2478fbf3cf81718d647726ecd6656b9ab0001e0a36af811020790803e84cbc2d128d6de4dcfc4dd06f6538addf2d44f3e60d928c6b0699734698772dcd4cc48989e8e2feb7d33db3fcd54765282422e3dfd60da6218ea279723671aed5c73ce0ee1ae9613fac5fc497d6c84c8bbbfb34894c6fc91d56c9cf4fdfff8bf08789489ff1e81d5f50d2d6d452ac999347959a7b9087ae0b5094a90ba8efecdccf3eec331e0b58578693eb79a6b01a4754e139f3b23ff857232477cf1c4e62821aa65436a8a13e7159cd0102e6d4af9fc46aff06ada34e0181dd6d15a3782518fb2f5c3da7d8ed5bcf1bb35023eccc2249d21cd033865adc9164696fc654a5c38cde1aa745700d2a5aa062b4e15d6bd1a249e375e5d74e3287a0bf37ff3c73daf3a9fc138d37ce07343735dc2469ca8c3d3aa3875817caa7ac547ed099ea2dc6e9d06b6a60e481535395267961197344cf6335e9a9c24b2e93c14fce562ecc10b8ffcc1b99667c606dbbc7afbb579ab8ba511c3660018e17d4f68165c61bb44bd0f91297fc083155008af902a322de29e644b367869e2ba1b4e668b644d1e0b9b8e53a743545e49b8cc00f97a8796e9a939a2d582683c57985c07edf61059b51d5398b6c0b8ee62f03a7a5bf9f7c59f27ab85881da852f186da381dc95413ea6ee637e76a9d7094903bfc2d5a396062dc1a7fb32f2627b33414ef354da42fed55a6ee361c3c8461b5e97120f312c118921e3e7c3afd5ef51d0de23fda862321496b55384ce28f524f5a3c9a889e2af5c01e3bf85bffbdccc4a92a06ee0c81297008662e75229fd3781d2f17cd79ca8eeeb5011e59723bf2dcd3f589dc788e613d9c885caec5f914ae205ae066d1289d5cf92c3cdaee83ef6c90a5f04441a585d9fef59cbe6cb2b4f1764d3cebc7a2d4c1f255fe0c21b6db9a3289145db30149902c5f185059c0ff0c75d57c60259896a87dfcbe95cc83b2add31d12b52d8a744255c390a1e9ae3b7f692c19435f32aef8c33cf55327db40a205ed97972f7782d8d648b64ad48db9966d6527fdfd7dba01730e74a992a17512ea04ccaad8d3961d720cfbe7cae52e34f960b9f8f5b56d24e2031c9ec339ac998b7269b52d5274e4017e1f6d01c09851f36952bb468256af50d59deeb0e46ea2d5b7fbe6007249ee04ebe283360a3e2843a3f47e0f38a15b5ccca53ea170bbc93181c778a9a2d28db9b5d273668764d796a5eb5d1b0f1d9ea67ea87ad5000ffa740a26b70b26f8a3389a3dd2722f31a9e711d7a95807366e8cadecc673737e8645b534c066b137a09ff813cdc7fcac8cf5b0f5455a751f02095b6a74ad42d181b7bdddcf71e932634d0bb3280315a1014561c5f7f8d063b52fb299ce008f816c36c90db95ccf1a86737b97c5ef417c681c07ad55343e31daa1e1aaa4c8ba4f95d715600cfa269fdd89e47873eb66c7a79af1e7b1c996a09c55123f2a5dc736745e251037d784106e8b8d61942c2e383db209a89b2830ef33c459adb9e02962dd16c07fd7bdcdb88e9b9760b8b73fcc3616b596417c5734ffc11f1b4159c755a4ae43ae3d90f3ca1c55c943d3ceeb18cedc01b79fc0e16f98a27f691f200d53720af9ea60a9afbd47b5e7bae2a1a5aab451764f78146daf7e48f21a03753a1d802f325a260daa80a5344cd0c13dec463c5350dd832cf136d522327c38fccb6d5239ca9579c2a92c365b5fc39d1d70efc0370c66fb02fe8f70bf8d72266e8f133f66dc00a651e8053ffd97c903548f4ec1532aaf095698baa69888d76e7191fdf8d4eb2d31c81357d171ced25a27faf5f2daa8fd61f13a859ac22dfc0856599bc05c3d95b65aa88105c6d9bc4b2a17862eaedb2303cc39f20f9b4fccb7b1f3a2a7f2eab7fa7d3b01b44f24337c0d639c5d717b719746c4138e8181b85ab6cfa080332d6b3b285801e8423e69689e4425af08359d4468f7128b1d60cabc0dbe235e818588eb378e663a29ac0c6b103d307d42942cd34231512756554fe90c8d8be30cdaad9233da5c8d66a46cf6b7d4a6c52b5c432f8217907fa16f7e0f7cca56b50915c20dd7f636207e2f90bf27e95cbce21ef996aa8320239e22de6b34a15e7c3f38437c41baf102f3e061f38ea43f7174bf08f02abf0f901d8cb70b9f4d8d229212b04466eec4ec5fd0b779d6c793dec93a6841dede45774639f268804227d9e8205065c2434ccb0f084c9a06b67b7b94aa60c3318cc56a90e6ad0228cf2cec090337a8a892ea334ab6eaea208d7136984af1529a31bda4abb7458475262fc09bca077f5413768e0e8f09a0d8122ef0d29f2094ef93789345f783308b69f452fbfb19aa87387f0fdfdb81a6f88ffbd09c5024e790c44d37e35312e7e8b34fcb7c5b13151d92033b6e1eff1fc5bb809a19e78fdd1f445548039b4fd9d43ab66f218c69efd33653016bdc7f0de468249aa469ab51e2889c81fab6a90275fdbb0983371b53c2f69e49bbdcaa5eda6f5d42fa5e95a3fbd5860549ef8f923ecb1e6757d2230e1e50194c5a0675e05f16d7c5c3f25ffb62fc537df5cb5bb9b9d7581ce6a39f24c8a2db164f2cff2e42faaad695a2054ccb66fd31d3ec59b372e08cc5dbe87e35878c4a11e5788bc9466151578235b2785647574ac4580aded5bbf91ff98a80701bc8a2c9a8d6d4c28b2aef2008305ad27acd5f896fa32489cbc5fc72a9216bc7a0f2510a56cebe629cff69e844c9c04395873a67881e82f1f88cfff65450ea91219be8f34b2ea53b68eeed9d4b9629d5022a936a06eeb705b7d11bedf41c5a513a2b210b0156654ab9a115b7b625185b17d330aaaa0153b115f4aa8dea0b6e29bfd1fbdf4d84dd6b85c2dc09f2140ace9ee737c1325f4d43c12d7b368f5f6bf3b3e8a165e1ce2047a6abf0fd23563ec6a1646678fd7d67242f16dc8dde6049a9cb27cdc0d4e02c122f0e247707c1a1ad2e55b8c85b92e67e8b0359f32747f19681db49f81cb1511ef8b793f0fe5896f7f342b60f4818580636d2ba764a80913fbec8f8e0feb5b821bdc351c17bdba309b73b295d1c35b16ab436786db86a767d4b1a7dc565e7fe6d5a44c08003e62ed476291cb3af5e361223b938be1ed1273211e49e597bbc055a88e2c6f6bf86504469e21606ee80a30b563648a0eb7c65d9cf27d81822f4032d505bcea2b6c8f08f8aa5c1085172b6ef95e798de912733f5cc71bbf76bebc232b7443a8571ff67b06cd7158bfe8da5927f4b81245ba64c361558fbbeb59d5beb200ac906563984e9d126ce8c10372c6e55d26208c81a8f064ac0b395a4a2531b2024db306d27a833ac758a069cf5071df5fbb0041112a47f732cbb466958b3ecff67a8cbfd08894f9d7046822bee4ffa704615f73f4434182c05f9a243f3f6a5791087957b845614b249b69575025eb64e9166469e9adff4729690296df38029714b258e7f436a75212095645a05d1f84721c781d4fafba82c665a404232cc136af4089038688563c71ad0701a9c223f9e206ce94cb02b733d74d83436c25d1a65921439d96f1ca6edcabe1f53cc5421317ae82c980fb77a78cb9ff87edc10d5d58451822a786fb60dbad815922bf790d8bbb7a3c1c8462deb5c54d5386166d72b86110c66d95438a856811c5bb44b3c06bdde902de5f3ca63b4ccf55acc19d9d03a985631d722f89dbf15c50c99292eaf196e39737e071d54ee6ab26a90dfba99ac038c55c887b2988eda3c9b468f55d4402fb7d7a9d05efd67d55b0500b202469a0b3c24a0375c76c16d0280a74b87781f49eb7d263256d768fcb620da074e9c92a5cf14536ecaa62d6913426fe73b694a107d3baa3774af8fb30599213109f717968697feebd39c5309fd78e6d844655ab5ea6227aeed3517f48073dbbf3f423707eb31eca90d297c55ad9d026eeb2f42ffeb91762f5cddc7a3604958d96bcd883c20f8058878e904a64bdd2cbb7ee1f7b5b6981236954cc579d939ef956a82de6c79b5e11a49f1b35fbb8b07fe927e4a73f1d34dd1c2e9aa82bf5e6f327e4f5e34b9933bee9d6e5107aacb1b9685d61bcc5eccb0f3c93c97d2bd1f56f5763fa01949d680e745043b0a672b82cab04ff59aceb03581ba2dc8b999daa495612155e3fd8420076c83ed29f3def2457c6118b18127fc35f6f3cd5ec136c15b936a93aeaf481a4d8d63f7054e641c786e255d3bacd92b5654b1bbf871f19d2768ddbe5418a7f45a460146c152593f7b8775d0b8fa6bf8ca995e6a30f015817322f2f05939988c25ed968bebc3faa86e2cf92ac7e0a8b4e5815801a09780d26d126bc01589ccc2c35e6416157d7bf8f1db75e590959b381461f515b699c8c1cf11f8cb5533425358b42d2849400d0bba35c1dd18788ab5c6aa20edd8070913b7bb42c566eb54d8575e8c0bc42572a2cb823a6ff4421b09704e2bbab96f959bcfc4c8d881796a6638122df31f6d4388d5e489bfd0e7fa2eec65031705445b2273e5f9aef3fec1b14619f18261a9c9aded345512725e444b61d218e37fd9d17295ab68f0c592845bdbd9475cb7a88a514d57cc23039aff6f396975101752f70c8728a535230dfb1212078dc1798d9295b0a684b4eb56590e8949a53c63baa3970c4e1d801e819dc42cd5c45bae428be4c12e90ea920bc75c1a10907d63d57c176b6d416c48546a833b9b838f0509e8ee0638af9a6eb6790cf0b1ad8a8ca91f536bafb850247a8ef7535fb853bb35e3afd95ad50bc4b5f7bd35b1cb0dbad1e80bca08aa7821004fe20badf4aee9a64affa63137cb2cf75f8de3634faefe77dbe36bc7d3a7e5fe428e5523bed3714b0a0477bdf0e61b8d3880218c9927c5980cf46b591609dfa8d8479ff7687b8c766bc01be49f0b166da8f9836322a81bde04af67b688370f312645fa84c89c1098ca578d1b41fbf3c1ff30f07620a898fcf1ebbf6e2d2b482a0d73c46184978d78d2975921890f4c6e6369b50ccf2b9a21d1b718a5ef43894c0480b9b39c924912ef59879fbbfb6cc336da6b24a456940d1b71ce622154add2e5cc782840f23ae8dad75841e322317ee6852e16e479c02d797ff29f6ed9c71922b75f0055c2a7519277f869be10d297084053eecf626735dc357ffc15e5f6b59a6530e6f888cf87f4bc10995e40a09f34eeb5a52c5bda7c11076b22709c44e6926c98f9524ec5c3d9373c78b130e7e43ea66a39c16308808c506d36066e5a6162317971561e802a64d0560d95b914c8cf2a1e392d1f610ab5454e0d116cf5e69f2a74ca0b8d608b221621e6d49eaeecd011aab499f684acfd091b6390becb40434830065d19f83864480ff60a87d7e5a2b0381b7f5d0453ad4af7d5f6a32b5f1755812893f28141e6c535477fcc4eeada9c1633232bbcd3ae91daf95177a0394ab2a331acd1897e277f77871a63eefaf1a842400e2ac6ad6ba46fb66543a2a7cfa8bebbfb39febe4dbd0d58c221ffa6da54a672944024658766fd65c049c44db1c6b1d2af4cd39740d02f333428b6cc814fea179ab65d4d1982824a8d5827c601821126a041f7d7573866a77446bb2284e18575b4590e27d8bd0b72d2ca44983c2031a71f1bc761e8876dcabb7008dd590a39931845aad900dcca1980bddb6cfe65d1811cdd9ba631c9bd9892fe24d5c3b35a09363f63fbbde88252d7bdc4e3dc759d8f2fbb65d2a41502e872559ecd10bfb90d4e3854dc47da7a573e841168778c0ef31e7be3e66a4339e1689245c9b1751747841eab2d2042007f799b5c9837e306d78ad94ff96f6c3e19a319b2d2aefb407e1200066849e6dd036b5835caa29b07e18122796d69fa3541d6da8d3b5798a62d81ff5cbdbf213a39df9bba0d1aebc3c1bc63e21821f87aa7a2c7cc867dbe9942cc13d0c1d05ee6b18262a9f1a9542b0b9104f891d8b069b534c48afa7223a5c1592d0596c6dbb85440ad9140b7bf7ecf2153a043c74c386155c17fafbc02bd4bbbd4cebaecf787ed4128edfea0526b9948913c6674cc0f378edd1a319cfd81d0e6824eca456539e13e20574042950804d7c6ef37c8f818e9be39948baf5b53f2af363efa399df30585099edddf9e624e32b389dab7bf2b785cc3bd3b8e2c61d415e896aa572116b2ce1c50eca73d717057008e4dd46f7676deda7edce906be2fd79a64cf3d604b4ab63d5bb4232e2aa517a25e0e29cb093604068cd583d55834b2cad05f186835e6ee0ab77a769d27c37a1ee4411791e9eac6de54d473bd52effa9505858e747f6e6b257fb04126f495b01a30f53332472209580e22a6968e77a58776a1ebc5b6b8a253a884b9c031c0a405a539f9ecee2bfaaad1a8c96df07d88b6edeb9ea8844137887abfabaa1f9e910ef1e8a60d92cccd2724a72e73c56ba509897902b95722e4ba8bf87d4f05506f90bf504c10e71f02bc380ef2688313a999890905a6b9ed3115b674add8f747740be9d75bd843c57e9a54673d88ce7892e87eda663672a7c19d86466a650e923411ab1935b95c088966a812c0e3e42c2851b5d225526c766b2fd7f50ee4c9bf3023c53a12e1f88405ee6a1c03c6cf1fdd1088990e764019329010de5d99a6642a5e36038b7382d1030f1a0644fcb6bbcf968df1a60e6dcc214656dc4e6514d8f04e57b1d11253bc9a1220738c38954ecdca020009d52624a5a4a8ba9743f51ded7ac383e9c409969b69c71673f5b74e07ca0781ed7da06cdde0e8788f01c681d73dca683952cc38f10f465585ff135194e8716f091db535d56a3e11209100fa815ab8a63e742920c82eef0c5673af3661f801c96a0f0d0b2e880d6b40fcb94723d84a9336f7392c823464d0699fbcd93894c370756752d87bb9d9b76654eb90066f30df6e0865bb00fb725c57a265b68a1447e0b3f1aaeffd8b52b01ba4bd7738654e3b5a8635301b40534691461f6b530b752fb4779e061c126debe2b59877b08a6bde392b4a36894d45ba2f4d19f972bf36fef488b670c00cb5d08b4e844267c8680d6ee3f923ded7380155d6d334f3cdad3cfbb26199c72a8527416c178242837621dbceb9b320bb454900891935bdb2004bd265bdffbf3026d6bbf1eaf8122deb3e2e044d8c6e5af4b4e9be723e120b151e7237bb30f595650f0bcc07bb2b3017cb55887954e35e7b11d042aa94412f8a72fbd9af0871c0c9370a3d0d07ae9ddb6b5db559267b0d2e1fdef51bcfc524bdadfcbfb47b66d0816339c1760f8e0f43aaa718a83f6cd4890c8fa1c93181830231076ad11fde4a4fb59b9113ca4b896c2b5d62ef16b861e17846434ee613e82c4dd0e733a97598d56013bb8ddbb9e3f412791920d4b1eb6ae081a1aa9935a4a6cfef5b149951ad103883a4a6265bb92bb534a53f6f6ae2fd0d99fc56b92aab6c34b14b8188508839f01252e2820262d269dfd03ae9d774add1e86b4f5bea5ba92883eed9a6e394bc3666cf8f89694986d52fdc311133df25851b99eeaef6e466a632ea8a85985c8f73b22541859830eeb656eba62156e04d4fba26e721f31ad23f2eb168e837aaa10895567ef8d9e73978a89702ee36705e4f892056ec3d331b799083031878cecde6a802541b50dd10a2e4ed4a6f2d1004f280a9d9b773c4fae42193b334672ffbc012bf3baddf42be9c1675e456ec0b6232bd88b6612f7b33aee80486bfec087f74c4602c180f24f77a4f4d28f23a058702425abd2aaa986ef9b6db2bd23567d8893a09f8c98b4a6b01430c941f204c2f9bbe5f712fb64479982235529f45ddc4c6e1654dc5e089126c54bb0692663b0e11cdac291a700f5d7ae442d2f209fd8093d1d7229592b6e6d040a97b33bcba1ce07d5ed8f9749b04073490f1f1343192da6e05c02c94be8fb1a9238b0d6638549dec72770df64e90132c8b6251f0d32937183a2eb37c81eb9fe14826be791de1cdcc67f45734e73cef2592c3a72793efbf41bb3ad0de80deb3a6cbb22b3ec0991daf066ea13306d6c686b30e624d342d5ef3edead627fe6c9da683ec3c4969c96ffdfe031e4b47ce7a8dcc8b449749c266a340611b943158b4ff6a89d3785caaa2b6d23580e11a2afe629d4f4660ebd3972c03bf8da59824db0a38c5a5405e594deab1cb026f3dc0cecd94929f47466a3c345997f2576decd6bf130c764bd7bca5e93ebf4292d9f6c51cb99c111d95fde781f484d1c00e5106ab14fa41c12cab582b3e83b744b1eede1893007a9334ff4e2ecb84035ba56d9f57b45657bff37ec86a2433c9fb2ddfc9d5d5f905a9ce10d5acdf0c1d045b0973d1e520f7de9e724513cecf41c08965f9b185ad0f88bc1bc06bf9fcf3cf5bbb8737628afae9ed2a36f793124b44cdb3f8d63f298ac7c62c00177bb2542f20ddd45bb0699ef432fc10b521920cf8ee03094a8bbd47e80cf28e27c7e7e024af1bda3b5ee65b35809405910f17691a1ace5e1138ce5666b65d87a3a8fbd31abb8ebcc2f32cf865626f37221513177ac75b36627bc36b08fc2ee9ee8ec10446af166d0263d5e1bcac6e8545f3c34af4605c79b7ba7a7fde538b01b65439f8326ba0c3703bfa0362b344aea000539c2ea5b0d4b9620749d3a2c5511ffacabbd42a3c7c172cf34b52a8cc173193fda2ce05b66461a0c109b08953941e7047fb21806f09de03f0d3c45e11c0b76133e43c793c075c0308665da350e2fb40f938ebc7b74d2b8de578254aa6429db4f84d4404ea10cb7f2f38a26e98d36e0c4f3a92539538810215052394558d4c2405a6a5649fb96eae267b3fb8ce846a24f8841d3f15770b529351f4a7cea0f53847c346de642e79c195947d1b4e317056edebbe48446f82c3ae8f2a79a32a3e2fc7ebe692b8bab4d96ae156bf48ad01e3fb5248cdcc869213278ce202221e18538435d526ba53735d6bec35a5eb4639402d67607029f9739dd89a6ca9e614e0d27587174dcf30519601646d7e20cdef02608a53d05afbf64ede92376128157478c902f423ebd3aafd36016583c77c276dd7747e56547888bf316c88367abbcf0f9552bb4c9b69aa3b0a8bab5d38347079fea178f17a50cd4ad98dcdb73c9c5cda547766cca601caf63d06b8e6cc5baa25d71d67c4d28ee7690d113d67e4210125e6bae59d09d46a6c64ff85894696b94ecd9f4a3d88341309bcd9f04d8d107bb4609be3bef445e05374973cab95b78a2a930973c0e200b12e335b01444c96f73869c26e5b8510915d0c20923b4234d149dd601a2a18a612b36d3c18a06b8e24f6522c43e74f41941b71dc197939a7ff1d06ab9661a7bc458e778027bb8074af9925607fce538575c0f8c6e7ce43a413ae1f69d131e7906b0d7c674c811103e1a230a026e787a2cb1d4afe64973da16837700ea3ae9158ffb9b973625177030965f8d87ceffb48a1d8dc8e6012b6b7b72a683c3f323639d42ca0659d01cd05d5919b38bab77d1105f23c5fca31de179a50c48032536ed98d1af80f387aabe2e90f8b5438649678adcf34761d2cd315ab3ded5106c47630c25c2e7ebf7bf1d7e5f7128d26b4d41fe0a3dae86caa5eb91611e3c0211d0a5d65b63e6280a4ec918b2700fd8e8aec56abd99462ed4a906354a37746e3707e2f7132ae838983392b69de3af1c50a57ab328f680f747dae7b610b431cccabc308f83f49e3411520864dcb0e8fc3ce0f401fbd0863359bf071e88af1db14297a0153364f5e0fc1d4a924992e0d768602f7b4109149e0b74a16b7a3056fb399dcc88eaf9e6802764311d2a700b18f60cf3dac2bf4ccfe005c9056f06c0c6044c9e2fc7e9fc48ed79f461a72456c070e09b1dd413b58181dab1fc04b8255ace7d3ea18a0e7af7e147fb4c1614ab17960cde967ba946f3b5617150cfab5f2fce0e459290590b552b3c3b5294b37feab9c6c6674de4fb950828266f0c033ca24565c583d81804c791a9596ce9136dfe753c3d14a6d77b6a4750c1017dc8435630fcb58069a55cf871cfcd068656d05fb60df9f58b3c4f56138a2985a2dcacbffb3ff157b4faf07a1386e56d0573eefd077de13a8b69fa58533037c7383872b872342e6419dc7a822ddfc51be6b84761bde2d64af4fc25b54a8a88b10f81fcfce3486fdb1d35ad016c2e1b13d8c01342a9f250a3900546e8a6fcaddd45206dd4b26984e43ebf1003d5a6a4ccc79f915325764a60a3f044b3cfe0b0573b71f7fc12f755432bc862e4e42ff7e33feb1ef50fdb16e1c3656d10eec9a64909936a2681a98e2040aebe3662b4ec95073e002f41a3e3e106732aaa9923ddc9d871ceb0ff8f4cd48192e5a26742b8fafa2eab3a5be81211298879cd5e6e4e6f68cc039645f0088ce890465f9ba199e8676abcff2da1c05e9a31122bacb71cfe734813ad96b04a1e8a727ec514d98bb2bdc96e189d1c21c3288e0dff8de019ea473bace2328f54937af416e19668e6ba3e068596856c78a2dddf13b237a6a67db8e4f61c010e049ae24495185d30f7f8f24aa6e91ab48052fdbdb2fc8d3270d500872c8a81115cff0cfd9364db2722483b5429d2480e13c93661f7e70dafd24a87af0b5f1e5fbb8b355f788559e95903e117a5b9e19e3617aeb5c346990510f9a6d7d08710a7c27bfff228373c4ba6734a42ce4bd9cbfb3ee5456f352fd97781453f833daa0209ead6f18471d059aafa552c3390b53c1eee3c0d4b11e1e67ce1b63eda75d43f72f0a60187ff23e216ab608fc0452f9dad51623d885fede94cf3bffd9e740d8c97fbb6ce0f4b8490e07043004d654cb963bcbc47d732bb918dece86dd77fdc5d84674b8561ca2bf5ccf576abd50b9a351ac9843af1edbd35aefc270e17fab00d7b5cc2850272f7f468e7e3eca0b812dbbe80052010092936ac108d3a4f84eb7393413a55aa04e9b316f18f9ce4ae60964368179384d31eae29e2afa3f301f531949345458b0cbcbfa0e57791d90fb8a5e6078b7328236e456097774774d7c4c2351fd022747e1cf00af8f7c243272f3f3e3dadda982c0c1480508c1525ee62d7ae5ff18ee7f83157ae8275a7fc5cae1ee7db93b6a8dd576ac0027c8300433e2b098f9a6e694bbcfc3bda9f6afb1a1983ffdd6a6165ffcef5cc830281f5af0b524e75a4b3bf4688c117849b319f2cc4dc3aa54e1f98ae3a2640253b0fabe042103c15ee16d611c393df8a1bbfc83bee3f62f17e57e723704ddd6b730826e5fa0f6f3cdc2489cd61a8113711cbd99903bd3e3156fce46432c7c99ca701e00ba0dc6ec39949b7b3c2786e33a857e818fc8d681150846329a5008178f3cc6a3d74ff53f5693e584ec4e3d04688c4577aa554ee5adc205864b2f7630a682768928b33580b26cfff7f2a8966b58842c97e78e7d3a0b88dfe97ea5133103102231736851ad54cb97e74b828d33fc175668e2f28f581dac29f39aaa9ef12ed777f45fc6bec03517902f3f03ea5042a3273bd3b4f1921e958ab99e2345d0777f9cf095e3ae3eee34e5395f80419f01128c6942593c395b35f459527081c6e7eea461230cb482582a2b5a0e6ddba16cb9098a0755dba8bee6c474d98801f73b8cfd755957c7edb5b1fb72edbff4cb6c741e7a108a0299ded4abfa0636ae880606b704d3251a0d9aea6fa9a8278b537aeeee904a08600159ebb79a6912405069d8866656e35072b86139e1e48d06b9f9a86ed0664681c71c8ba8c52f8de04ef080a1d46985b820f51efceaca4ddfd6adb2ad979a8640f8bcd8db6c488a75b7a70de8ca8823169f1f9d4423cc12576e6b2dcc1bd857ff290cf847ae47700d14f90528c237fe9b2c2732353012a49d08108d3edc7987ca95711b9e7797cb6c6cffc6d8c3ac71fc7dc610a0f3a0ef06d77726505a157682cd4b3dc1fae1c51f95982d5b3693145e2af9dd6c9caaaa493c29aa557671ea768659d0a8c24cf301d3552f59c173fcabddd6ec550745d3edfd837895db2911f47e5df18a09dba98000f6a2b566c01e82056215e0efb35734d7063bd3f029ed1c5d66e4ffebd492555be554165897befe91ab84cd18c31ea7fff0fadefef24a4f028fe557e2d459362f5fc058128abbd3b2e8da3609f5e5679762dc067b2704fe7e1673ddb3031ebd7727c411feaef29c8a284a773c310c30b248eb37af505235ad4b411ba617c9ee6749e5d98895fbb64974bf77de9544cf7725d0c8e0774bf28c9015405794af3af4b20cc09712080dac694f85e94a7c5aa4cec56d5e6bb33e389ad2c0d1a5e177473c55a4445c97487228896998aa2e915c8730336ab621f08d50eb85ed44a4c63a647b30cb6e214ac8adc0f9b3942ee7e3524dfc24ca9e5bbe580cd74969dee7c84a14f8b18f58e47988af071af349bad8343dfe0816d9cd936a5d20b5214dd8060d7d0501417b9302e830d57416705e54ad64bb2d21aae1c505bd9954b9e67bdeedaed4eb75a7a77ef611febb087d7eb9201b327872ec16ca6ed6e09cad6f7f7137a481e24df9d3f4a9bb626e6b606842c324020b98b865d408285460f3fbf758db1d0aa2453b103b895935480913cde18daf7d821d36f07a2219beef30563946b650afb1af2c7d370b9bd3b14d2991850ee3d1d17dbfce7acfe1cf36e4dd9b50f4fab034f472dbb5edd58e96229c827da464b30035a3ac37db22b676f45819c22f43b0f1db2f822bc385b335eac9c15d0fb42ee9be808961e713467faa3b9b8b1a7d1cffb9d98654b9753f5d654ddf69fd73812b74678bb9ef61630a2c34ddb83e4ee75fdf74e0f5f9edea894c7b3a095e2b3f18f134f700ad4f5e2e4a2022a22d5c8556afaa014a1a05f558bce1c8eff208960e20e02c21bea5761d852f9c0dfa94c7452c47bcc4d6c97b08164134f7bbd64492737291c4ba441956c4f645ba1cec41f8ddeb77105f460008dbd09af37a21545dd9f9b467fd826f210b5e2692a78320c85cd3ea2400ef52588b8588a15aab3d4cf2111ac92c02e1b8f1577a6a5d7329c3324fb5c863ac8a3f54a44aa7c72aea6d3b7405269134621b3e2b91e6aad279c649f3cf28e6a2c5183d6d685b409a64b9bbd8b14236652a600bd6133e878fc5ddfb256aa10fe306956aef3dfea88e1e2ec9199d0e32005b6b4e628fb75ada94168068b3d840d82592d838ac064fdf85b38b5f0b25f74c16977d45d712aecbddceb7721bb7e9e5b115066bbca00e7029e2c7c4d8cd09aaa4585f1bde675cd47470492b4622fee369df73506a1c90400a7054b9070990d9de23b80868a21b43ded06c3d286b9562483c24e8ff589d8f96bf5a06fcbbb700262686d3ea32aa3ea18cd6a32ab467006e95bb30deea98d9d5196b61d702b0939b57bcfd88aca6703ba875a6477e7b2475e4ecf667701b359ea0136481e563574d50b2d983a9bf6a0103d14f7bd2e315003c825b69e2b373422bc2aba96c3d54c125fb49cf560cc5bba9cef40d560863a7a1a5a9eea8f2cfe0895066db5ff86ffaf30f7e76308be7582f2429aa9dc8b249020febc49c89804d1332c4fb72887a90ec7e6eb0c365e746003b86bab9463deedd6a33a2ef512789faf83503d62c6cec1266985d37a88c0c97336fd791ae97e942c91fb7d8262561469c76c2d20e33d62544a4b53467105a02f37a9220dc4e2b8f7293fd02aa254d7b369b458c942671bc8052ad09a0fef892e97bb19d1497e8bb8412777bd8e747c95ecc7ae0fd1e68044ec144239965eb62679ce933de7682ee4f94adf73f236ed74cf53401c88363105e0a0275f517c3097ac8026c4714eb7f13debe19186d742080caefde5775ffee6e68fa01101ac7e7a7db4eee488f4cda5706a4a438c7d64148bdbd25f716f3be2d58b065abfa9d2f27641633755b5342687242a600450b5a7b6e20e2c9ec42dacd4592e8a51e88ff0b24d6310ea27f3363d5872427c74603804cf0facfd940eda35b1e6e39e38210efba43e7b6789b51d2dc626a2a935a9cccfa2cb265ac6f96d1d8b8c95b350b6e807e2e1a7c3516844726a1c1376e73be7c75572f1002cf5174150cac118fbc731c0c86cbdbdf060dec99a552f2d8817bbd2c3c622735cef1931910f15de00f10163c046a42f8c0d9fbf00cadb573a301e08245bfeaf9460c1424a7336f360bed8e80867d6e0510db07f55ba2ed92c467bebc66687902b39ee943368c6fc72cc307b21427fd6ad4581570b5bc67fac934901787f52607c98b4486122df0f68cf161d995247fe8333bac8a474a97061bb044f6cecb6f5907f8d94596a62e07d2e8fd8d8b509eec9dcdfa5aab199edbc6f187d6a89d1c57bba404725a24744acc1d0d391ac3a039cda63588056b53f0a8079f9e76009b3970d8d75587efdbcb7de49a86e89fc96201eec9c3e1c0f7c4e092e407874dd822e3504513b52aa5eb386b7b52a2ab78b71df5291af965e80aa6bd52b9eb0ca3259a97be9f06a5d01d09316e91cb1d56148854768c2f599192a989ad0313e63edcaef6f0ba4ae5f06c99c2317b6ea7372991a923da8dd66dee2e014967879173f71795d76708e949e373b4b5fc2e3ed448b5a4eacd8d5e3487c6bff6b064e758bd5047303fb71d4f63d47407aa44eab90484ea58a1d1f29e17d801ac9729eb3f66322c07835f657be0da279047a2fe3e93951195535c767aa579cb3b693d4f26f0087bc83d1073ae702f874ac529a48abdb7d867592a47f68cdf16d6a051d227e2108f3bffbbcb5d93f919d1c81f2896f60b89c37ce0cfdf97cb1512ed86e8ec8b8d28a649d822204a3e8d455a9e12b6eaa24389fba2246dccbcb865bc7d187fb1ec2bc2e94a2ff8b974f1859a7d676b4dc1e91ab7ea82e9c7bbe0eda35141ec55d3e2fe3476a9739d0fd8db2a38c9b618b5f901b50cc7bdd12d8f2993aca84cafea579d2354dee3a709e2d74427ecd460cb602ffae1dd61afbd4d5b9aeea7055c45bd819d22fc61cefb11f22e3dbe28af8696485263ed9bc527690f1e2c4f9bb329c7dbda61add910b9dd16f20578adad11311140901f5b7285749434dfba185bb2e2b1d0b0d13728eabefa27c0b39fa6eeda86c89ef16d9d93887bf5e3c4c406563535e6e9f120ed21c3d7e39208b841eb00d0f6cb15c65a5617dcd62475c25f9ebdb406026b89ddcbc0c9c52bfbc9d9bd454587088c2a812fd92992d2e50d6a1032155262739b873cb09d5f2352d06caff3f84d543c1dd6885a63de984f242ab1912410e8a4d00f48b73c4d6d81670727f2f4a9b647d445b52a22145d08824448d955e73640b2f014558b05de1ec83c86065c2d9026715ac07ab0c95e0a20ea326e253ca5d79cd74633d96c8ff7c412cf75719319919c91c2a30d20a3bd78f65b8c6d68c43283fa9b7d04a3855effa469e9b34af9c36c430ed819bc0742bb1759efd5588c19763c143b838d16f20af4d04f7e3b8d5b05f14e4ee99f353dcede866c3fb2010022a0c468f300dad0a12e2b25f1c7f91a965022cda1446206aafa48cfa3cbe607eaf9cd98d708abcaa9b2ecc88782638d75a9b50774f59d7d1373c43eb19a40993de09aabdecebbfef29ff2db7bb6eec4c72751666b2326d05a267a05d0503f537bf0f9d3555b042676a2f080626d480a619848b543dffe252d624047b982e30e02e5e69592c10e079a68c971790748466ea0f85fc137d550407cad2652e62ee71f855c45f43d1f2469ed1cd7d261e75f26bcf4489a917e3a4317cdca104b153f103d726f95ecdec2786f8ced08e3aad24b2d0909e80ff4a38c5ae0d6103159ba0eed76ba895a0bd86ef10ce717808c6023fbf4e8bf41b69af0651c2482965b42206b50f5c8f991414ebdb0e3380e626bbfcb48cf97bfb03017e34fc0d7141ec1037835a6a0c3ab847b8febac62a0abedb1da28463b4e31c1bd437867d86472e3a115b1e05498d54c930fcba110e7bc5dbfd115d8f356dbd7c6cf8055ce5c7865905279804cb019e2f68247f3daab6942e0ad29cd87602ad3c4d996840320e554c46480a67a5eb9bbc07b8f5232ada9fcef387e760d5d5f8bcfdd59fb6168cbe53b30c553e40e3741f3bcad9ffe33a38151dce5bd99d8838b3607f5322c1543b8b008493728764c812730d55ee19ba7f160231ae910e3a844ea61bcc31d36983ca869816dcc147d4ce86275da716c0c9dad2ca7df9d731f1fa9f04df96b6f47d5b65086e2b21a4e7ab231e6e370df5d313bec32a3ce3e63e089fda8279da8f7bec5199a61468c71eb80f7c5854d3c81316a1383bfac1c952b3df6fd6e79a827f51e737c924e66dc360b31d2f6777acfeced46de6a88bce517e58a538997e5e9dcb44a63709a5b6474ed8de7cc51064b9c45f7ea31b82fa33bb6c27f5efa34dde8f48f05022308d974c182d22b78ee112a836357577ba8a35a942efad02ec212e3ff13c2c55e81596b0b61adeb5cd480f1ecb6d621bb45b5825f889e5b8b9c1a4bdc714c70c00ab016ef056db805fc5fdac62355af70a46e04826eddc99321d2b0b7e9afc779de9160f6b4697f6b8569d9ac4a4f931d376272d39abf9571728e3b194d90e54d68cc0ba5d0133fe6611796ae9518e6edf4ead2a52c5738c2d9db0601e46b39c6d85627eafa576eaa7a3b10a20f90c8c523609483ac15e86e42ab1afe0f5faa514d337f27eea8a00dc756353c460dea2ed271c4f79cee60902acbf9b5088575c84feaff0d7daa87de2eed7f9c209416ac06f96db718c7255deea50700bf8a3ed9f7dff1f0f1a812a4fd4f407fd2936008950d128b60d116aa5cb833ca0facae8f167aa5678b927e8fed5ab1ec2932e378098d2acfae24c5eaf532a9a6f42b2399eef46eea7e0ad8b9547703978e5cec047851305fba94092c9479770d1d7ba5dd88de27c3c4c7ad19b1609713b13861019379025762fd6f1291092519e59b42fcb3932e1b6e54cc33a7fe0404346d44782a4a702fdcf059844757bcfc3ba46ee108e82811a018747c4021c9d2d67560fcd47113da49c06855f279e89f7e1c61aa9fa6b7ec3cd8381d5ab00c52eb0b864f473d8b9de391ba808e12f8b52728e233675c0db18e7a2e585f9e920c9e1a3f420b440d0ec6a5a17e596b88442a7f44d2609023a2f342ee032f56e12fee364e1207abf99c964e7eabc35d4cb9db3c314ab310a44de2eb0c746d48d0dd2f56e0bc2c9a627e8ec4583e5b68cba8a473eee32f090f79dda35b0a7e3ca55029433d8201ddf6b46153c51ecb3b74af17aad925629b4ab39bdf4b542492c05b0c663f2ebc8c540acd742ba62fb6a777a57725089b709e86ecb2518e3954e9ee8c65b832ca3a65dc762862c6381317d71b1515dc2c3d666a4ed168a4ca6e3f9c86cd457b75df4719b1892d2e389c7c41476305b48b3467b3d5a94a81c85bd16b47609c214af086f9be55e96b14b6708194ee65e843288096b18b7148d3a9c40ee05d53d625c0a95ee5c1f39645e7f93f588d0d3163f40e783a967995463ec1f564bf660b2c5deaf85cf5394834ed14198898b0b3bf3dfcbe9a6de14dd9f9dbed726de2646fd5cb9b49e200ea94341f3fb5ca8685b94071950b221200bcc45bf52aab31bdccf10200cf0849f7dd1b34f0a0e9c6719d4b0ee1c64ae12ad0ec4f08620af64fb2e2c5d85669e01332b32ef1dcddfe6c250407387a33cfb44a3f98ac8b4fa00c46c6fb5056f5d285f6c35126653911aba2177878ed402d3a6a4e910a945fe1c96391f53205abde83e6b4a3af1296a677489a5804086c028c10cea7d5da0fa3bdb0b828f32ea82f843896ace6057fd60fa76ddb61b0331a65db1b58526d83b37eb485329bc07e9312f29173886bbef07c97fbd21327cb66286781038b245df4a7778fb4db5b977525524467dfcef8e8b3de3d2f4e7e768aaa7e984129aa60b858eb08a33c7a53798f64ee4ea9e1028e2b4f83d5663c5cd2e56b3d6f649d6b62a951ee4f073a0f42f7ac991eb1b36a198642bda34bb991480103959c2bfded1465f8dd0d4acbe7c4023a842d38f6eb10b4636b87b7fd29dadfcb2e323318ec93e83eb86d59a910ebe60e0a71efae4995d11931edc2cef1bab462ca90ba874565f384b7d92b647a5e5e141ffaa5c891ef2a69fe7cb1ab8722701a870776edcb95de1c101daa957e570597b6c968b73cf9bfc64b808f0ac627953b8ee4fbb6796cb06f37ebf5c5a50a0baf08f4a0fdb393b43cc660c44d493e70872b18052b8476b9494cf833cbf37e06147c6541eedd2cdf98e7c7579b4dd37d4d774d59e82a5f9e146fa53ae934b7660c456a106b24240883163a3169dd778e29178bd2cf84f092047bd9fa65d2e2e854cb6bd754a2de758cbe787be023da3edd54b9c0e37778ffa01405734c925465cf6f7808cd8b0a8413ae0e9cef70acb725470d1ef899c0748c2e32d9b0f2e73836d747517fce609f644970d6a88b2b44ad31dc95eb5db6c0644639d85fff2f49798ba4e6fde714956b802ac6abf08398fa1659877e952ff715f3dc55313bc326ed3e16f3aab2fa6b7f71a24a60726a7d9d7fc20c52b8cc6653fc4b462ab090adddc0334c1f7f96da02198032aab8c620d8221c0d3a2c42ad575388e441a163a8c37388a48a16f72af9cad91f1ae9db40481b1cc74ea8e58c9c87f3576902ac60c0ae6da8ab066d4a020647333dffda5430c9cacb3d767747afe6d726ce6349a6ac1bb65256b0ee574aef6aab5ca2ec3ef692ec0f8862dc56b6402d7e66cac8487073f255be90b172c9176d81b5ba74d4069d15e8a6ed6d45c5d8d1d3758ba50c8eeab7a927cd542d3e0469377483b3dd17a1076043859451d494194c140e920eaaa4c6ded966ba13abd089c2981a9078bd6a9c0f79d838488fbaf5f773dc6547b7eb1ea8379bf48cd3b06fa3b36a323f75341b0113c2523a2b63c3fcc46e972bdf08e18faf1f4832c2fbd6e69d124998491d1c4015e5d82a6631d9fbba64eccaca8690cd128905a1cd66bd042070fe8305e992877c9289215a86f59720d4fdd39e3808eced1a98715ec837f1d65699a752c4f7d3a39983e81f541ce0aab198a3cce8f64e23be522ee076762675366fbeb1c2cfa111ad6ce8bdf71d052347e0ac8f6ece4486c8314bc77595876b88f82e0074945c186f964e10f6260a7ee837267d386b24498806dab7a97035ae97501a4a76ab5d8cc64992c04472cf61ca7965ee73747698173cae96e21e5e38cb78914827b2993fa98a6509cc4d2d47b881957127c88ad812465d74ce2570de085d7ca4f3cb875693c5027e58a01ffa20d576c2cdab1a04f1f1090179ec50cd99f96b5ecc0dd05eca09f4db5f438311a415d9c6a29ba96bea525067b9e76c08088df3a0b6d9ca6f0d757baafa4acab3f78e2e7967f0a913f0473ca6d9d619efc27efb8b5b0807cdff326063a5db7c4b80d94bbe22875e9dd98f57cf81f06dd1ba493be2adcbcd6a3f484b796215f5b791e1c5736963ddbe83d9f30d42fbfbfb8962913b8f21444b4711e45ddd79b1ce74faf90ed07ee8d47669b792eaf405a95b2b564a7a7baca161f75a48f89c5bc1d5d4ad558320d4d0b96b667160b01705aadfc23c4d729bbc411095dbe911fb911f5cac61308f5012adfc20f7ed387a17ec8d6437f129d25319b7f335fb03d4b5640150d303709e1a1155515106cac3ffd19f75e2395a6a33332354aa4a9c6350133359b98f0871c065c108d8c74690152f9af946129e2d84dffcb4afb51b4364890126747225c4644d1f6fa0d36f361ff00bffe35debb8516f013fd9337ac4418381d78174a4d3ed05179d0781df884ba6049ba48d267f5068f759f8070a26882b761a587579ad99f43dbd27b7070fbcc69569e5abd23f6f27d5bcd915717c0a8d7ce66abc304ca613860efcf56320e5bc48b2ced5680591b0bd8018149a5027ef5d2a12616d27c2aa1ac6f86e70c447f78ef00c45eae03f151f5f79b8462b8a16ef5d67d82a6a319a7d75d3c5d5ee61526693de10f867d0a810397bb27c37c3ef98719891122c10570ec07a70f13e6d97ff296f3ac3a60fe4b1ecbb9bb1698138fd664da91c8abd66c7d3d8405ff8fba41a2778fa86dcb8a25d7d49e0e9eca720ac7c7d8d00481fbeabd98733e5306146bea8c4d43e96e0be555329da86726a5a1e3918cb7f8881c233c17e9d0e1b1f0e58809242e606f526de337c339958a7951d336aa49bc0a17c5ac8a931d3f60cef3f7f92b449bab570a18beb12f472434249b78112eef333750118ecfc9d970fa59ad0df66538ddbfa9b61f8e3b7f76e665706da127fdf2825df8d82ba4e4d4dc4c92bdb9678f2f20522f545f0dcff71cbf67075363cade10611b7a8007a5c75cb4095577cb1d2437c60d91edcf85e43f3165b04bdaec94f563277bb1421ffb1426e8ef803e3b3b0f576864ac10c4864d14b34d70a8046d954d86b66ce0348121d63fc3964035ec54545a1ec905576af74a965befb2f6d9837499f95bff159c24bada315caad39a41a26cc0af5d4f09e1bff1528802681bc7de690c984776a564d79341fad1a9123f7b1f19d2eed9359bceeb5734b45d8ee1e3513e4c0b1e28140ae118f2bbf9eb6ee7f51a0d60f94cede330b7193ffa806d2bb989d48510a9c78356b085f4f58afc490a54fb831ccc8ab7a17d4b76d9a2a47c9b3f56875c884fbfe539b3483060eceb0625671263d6a13a00c69a4ab655248f4a855128e4449ac2b72000eb526ea19dbae7969625b0c0010a3274bcb1babdd43166d1a0a644b53516515bb7adcc106286592b346079222b94327fcb3d3a53ab8629105e41a8e2f4b1887f9862aa0402a723b788e8484e389e0571ad7d1e435e71bc50d5d053c6bb080a477a5e9266f2ff4550ed9c1b05bf5aa7d654d16e7257fd016efc9f499da9058344dc8a198f5de4635ccbe6525294b8978417c1486a4ae3cf983d4b1ce8f72a4affd7e692c80e7b8acac3064b4682940fbea292464c4fc7dea939828ddbfee5d8ab578b5dcdccad345a05a2a7e26043f389522f59181c5204efbe77ebbce9d50dbe1abe6e45b885bf8503c6e7f54e03f41caa2d1bd76b1006d622864b0343811398a583b7c210c03b46c577462a11c1b277ab26706fb5c89da6b8705ffde39bf32e8cdd2501ff3785e90702d4975040adfc60e4a7c8f321b7dd583da0f20a09b56e9005d19d9ad375af2ecde58021f6a5384eacdc5f659bd0e8d9198ad5f19e53f1de67eb14025beb937c1dcfa9c46446f67d7b4880dd2423a5250ceade5e2505f7f699038dd9dfa5a22eb3dfdc6520e76979bf4223ca6391114f705de38f7e0da1a5f59ceb2c59f5e08954f14d0ca01c0dbaf50f7ab0fd8ff709c23fb908a12412377c563a1fe13ce24a1de7bb402abd83b4e3a32e1aab415c19281572139619f0e90b57798ba2dda29552064ed8fe2f2cc6c4c4e1a9b458f689163b9d28f559496cf1ca853df8a011a9d2552babbe737d13feacd3fbd13890034cbadc6fd1a2790a778d975e751c155ed02d49c12cc835a4f82dabcc33e9161edc34a412f2762f66cb269a0cf11a4d4b14758e56508139a4ba5745d5457288554274e1aa57bd6bbcb59b9d84c5fc5d023a91fd873c1973e5ce02800956ae338058fdaa2c5c14e7c8962bf0fc5a80e99bc5ad87bfe3c1a1bc6b6f1a3e29c855c06174837059087f81f7eff3c6114940d74e41e5a53a6101f1ebc58abeed605006375dd99bf693e48c2f21a12606602fc2d7be1d3b87decb7332c1f06451422fbd28c85c469230e9f9e6822661f3b05b47727cbb2cf7117d17a549b828296dc490c0558870ac0734c0ae306972efdbbf3552772c9042fd6919258cb0a601efec3a85d2be3d8de038d18ca115f56a1481ae5fbb467f2624a87738a2268c849335cb0ab07000f17d7d92d7a9a7309ba46ad22bcc0dae9a46e1dc262aaea0b62a35d709fd09b36e0de40a43e946a20952754287aad8d1c11cd214db9d6338f3b724d95d348b9901c95581206efbd18b6f2e8eeb42daf484fac5c90e6eb1f0fbd44947a0e5e23a607decea2b99f741bb4fe5008f057016988ddd9a9a414d141278f3b49d8b36933549672f450fbdaadc975397ce939a1d2f7e672004f4bacccb1802803229b6748de70b0f521ab4935ebff95970bc1359c48634dfc5cf89285045f588e2dcba0dc7e068280b42eb1f7f9b379c33e76a1b81e8efe69aa0cba217f834082400fc197ecb7827249ce5edbf1f0c126374539ddfb0d6e739f9469d5d3fcd0fa2c0d6e59851ebd8a77a5ddf944e2fc17ee9f9442174f7eff9b6086f11f75dd767d8eaa00e0cbe93d51757631ae792ea6014deb94f83390ee14e2df2747ceed2817aa440fa1e0fe093b58fba92ebeaafcb872930f5db99acc86f3db80543f9220c83e8827285ef3e1461de4ed67f1e6564afb4cba966b132014164baa26e0aa1d72186d1d5e3a7df7c0f4f1ff14b6da1ad38f50d503fdb5536fff5c35dd0bec3da1451a202f979c7a221019cacb33c561c842cfded0abfdc875cbcc41dfdc5b157b6fda27d2a7b69dfffa0f815e090d5f25d381cc85f49267ed2fa8d2696b98fabcf1d06795deb51deb1ccd256e593cc577adc78e81d9cdcf57c81a69e72690874e7585adbd1d6152f771ce86bac5fa1f85276fa1501160a6a79b913cb32e462273651cf1825e549034eed1b2e48afd247add2494c9789af417b35eec993b332b89812f777dc973445053823c6ee5479085f072f49f2a2b37a277c3e2ca7801b3fa9f081d7ac0177af6ba6628ab21f0fdc0509aaa2e4a16b09e103d9f8089b8c4f3c6009c8489f54599aff5ee48acad0d9e742ba7ae09d276b65af81e25d8629ab5383cadbab28c11bf5572bc95b5b67f2cbf34351f34b81e03f4ff0639755bd8eac32588bc5ec6094df4c36b002947f0f7d8aeae562663a5fecd70612189adf36b57a80bde7af05b76e5025c124107d654383706f57570daf8dd700ff48a89809bd9d01c1cdf16b738b9f9cb5bb88b767809e6aa2fb5f14859038d63367d6e75b560bf601087ca802da97cf935a0c4fdcc9fd10bd6dd4b5e87dec890ff139a8373695a63a89d2df69577e88c03d457d8fae9c65aa8c204b23421f66bdd9a4be5f82190f6de8ddfe176ca7c81022b8caefb0667355ecd2e66ab250a803f89252ef9e444a7840fa2f76cf1dcdacc5a7c51dbe1307c04ff0cd0ce6845f652358b723c7126c31b89515acdfaa735938f792a5962775eb24e2d1d14201f7fb68d8d93cb4f6d4ae0581f2b77b0411d9aedb5bd2009abc166bbe4a84899906951232cc66a00c578c9fd645327f42c56a3478821528d03123d33a895445db142797ea099d3ae2e82d67c1aa908876b3a90c8be0af0dc28cdc01fc6c74ca8995218668b0f0a973d6373530293f21a5c5c34fd7e635ab4dfb67beb6a6d37d5b63c2886ab6b9d31f307995c306ed8cfc57a0a3572c3dc75296352e50c656fd744792b9baa879fa35b6aa8de4af82f84778a1e357efd9736e999b6cebbbf647ce664fd49178dbfee1475a0e614f414df5527164cae3008819a54c58eb0eddb1a1bf0a8326bb6b61274dfc2c43eae52e7778b948e4366ce546cadc7ce1dc56fd95a0114eefce4bcbdd730c61fcbc165b64c73c2303359e2aaf8dec3f7eb78484c5e0bfbc75dedbe95ad42228a88a1b0d7e405edb1c2789d484fafb7cc63b02c1c4bf18abf41f4f56069a5f2e921aba33eb9d9f36512610b04b8ebc30fd9cde16f4eda53985e4bb9441c75ca5759d51ee91c565ee6ba3545cd4aa71383c69221de0622024e21ffcc45647ec77112a4e42d19c5918776d3e2b5c8cec24ba2dbea9e97c73b5499e1e5c71ff983442ea7d77041da5a009641fdb1acbb22b396d4ae353d873cba6aa353a6fdeca2dd2f17f73c6196dcc1fa2377252e8ccf871be3416aba6c3ebe2fc61981ef00f84fe0d17f8c689e0cab662ceb1827d9e290d86f6b6f537d64a56daa885a3a4f4ad636eb1c77eb46a839751da622465e21e2b731de09b62a1f667afe13d0e947deef8c595942484d776dbe1f95df7b974fed071d136026b626e457da5484ebc0eb3a76a2dccafba1138660fde64cb5c21d98019cfeb843f71ed68b84c4f91fc93fbfde5188e85b06a306864678f1d7cb1ca34ed338b4be91d3f47d555b10e0dda796e4b62f7137a5a0a9a60946c05570d8307ab736b3a4be60ee41ca6a5b171ac4fceabec145b0a3f7ef3e67eeda91ec144169346e8bb8a67da3a081d67609ad24ea376aa5e69d3c1faa1757b8b650d1405f76f4a1e4b6bf1b0c9269b31da2a58b714cb6c4819e50e2058ecd50afdccbdc72c2fad7d2cc05c9f86c198478196e059c3175db79cbd14822d81e517836adfc8739355f9a4f384ab2e334e5937201700e6eb0c76664a717b45c285f61951286e401b393408a0c3333a8bf6e101d90f997a50c6313bf6607ea95ee3086d8357aa90b7fc86d7b955557541363d44f0d2b60c6f877300b8aebaebed914b7738b0754d7f8106779c64f8795e7efc09f1f06b99c6f3918c1b74d75e0d832fa6ea0dbfe2f6d1fe855aecb2701339281878e393f995a5b07c800cbf23c0e4cc5fd9184a8b82fbffb3e10c4c0a90f13203347aa29cb891712728c6f35340b58564f094115e7ddace3f77854df7e0ed8c1234cc90e6fe041d2e2469c2d2bcd56d2f0b03ea584be875e56b818de2ea86ae5482dfe61b2a73514cbd8de792f1b596add75e968f2d150782731b62dd2ed07f2acbffa67aa46c8471d7b7bb74c3c3ca0afb50e5588d51c83e7792f3771886c09c6b038fb91488cb9614ca03195611cbef1d5c43462223e5e29d1791a901a5c4f38100dd2222e7c8d9cbd5b8730897535baf29dadb61346afb1662aa68368</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">私有文章，仅供自己学习使用。</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 组件库 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 模板模式 </tag>
            
            <tag> 策略 </tag>
            
            <tag> 幂等性 </tag>
            
            <tag> 组件库 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Git操作规约</title>
      <link href="/posts/c35b2800.html"/>
      <url>/posts/c35b2800.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试!" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="c4403f6361cadb67919b1a0bec0ef136fd3d5f5e76d22bfd22744f83560a7461">2ddec83a87db3033ff4ab408c7ae30ff2eee36628ac8c932ee1030cdd143b94295fe7f6d8d15b674e517c1f891b48e161229d86c5f5cc4563b1009fdf3b546d5d003bbb3811f0997eaf0caf7de3a0d915079cb6a2050d43887a7aa4266b49cf43a0306d6a5a1251d30097f4b67fe3cfd8911144ef191adc62e82ab7ae86316d3d7779af3d7baa6faad268a2c853d858cf581551675428e859190ec62b2c996a861a44229bf4750ee18abe2b8a9596c61ca52d362a7a482dd3f9da23d697eff9851f9aa8e64b75a8857ace83b9d7dc15f93f7c98d5c7065b54cd35710b00d6c56e1aa9bbb0f840e511f79e649c1314f53d9dd536d1c01c9706d395d814b083b39e3a172cc56db044d545408d1519f5c9f36d53f7b361f78edcfbbff085dadd54f671ed6fba3709d47f75af0bff906680d2c70ce07ac6c892914067b2803689eae8a52151ae17a01b4154d31740b56e0f7c0690e6eaff14efe02ec6317db753b64d10c1e1c99328319ab6b38bff84580cadbafe7fbb62ad10a8c9ce2aca0a6b6d7b77bc0bd50e7e2258d72abd217dba1f329ca29d5ff80b0a75d28342287061ae6d8e0a755f7236c74dae50877f15964dd5e3ed8fab94d2a644c17c1db4dc37e459d1fb59c29efd4d553fda2589ed3a48aaa2e922d9c883cef8eb6ed59e0dda7d85d6dfcfe026edfd6674298227465cca56a9a0c845b585dcfae2ff391cc2856a3c2f6b4fece379c8fb0875d56468e262ebfb5af84bcd987d86ca67a9932bd7738c314224cfe85d244b770ac8bc8b3f80cce9b945db02da1749f8c0071175f8ec5785482093c8d85e0ed94c71448648e4c2ad222ca8631ca90eb6499bf6d598d12fca420309d0e5b3284c869b08a86af9be38e0beaf28c3bdfd2ae9c4a443fb5b18382a50df19327d124cec45763b211e3b26b714d439e04600138e0913d1d411f11fa65006f8906885538828e1e68cdcb482353ba87ef26dfef4ddcf8a4bd57db7113fa31aa2f2f73d6be703203b88c1ed714f3407e106ecec44a36a28f6b256aa353cc14114ea6ebe14bed8b68c33131e2b11418bf80ad3bbd4304f9dd7486a2758941c6e4670c1daa0e2ec79f1eadb71030785434424f8824ecca16e3a1df779cb098db9d5ff16ac74651661d7ee6831c5cfde604eb8aebc35af8bba70925d9e6f47aed7b056b34a998f6ad4d64f825778a1f4874433f53b04752e9ad454701dd63fe0d47286c11e83008b45912b0bed71d0d74a54f056383ec0fdcdb029087506cf1d51d71381c462682241e95cf83e8d7316cf41f48595486f44c74fc756d598d08e80a30f8e2ac0310c0800ec0aaeb39ec3943fe18086fc412659b1daed972272de04077978fd7160be1135e048f9373cef647f4e8e9b92b6730407650c5d4e55079adf14312f6c78abcee5a8cbf328c2ef2f304a1972581994597a66bf70eacb566450a150aa7e3588b92c2cf80f1e38fb01a8c2e3f62664c3f212e687e4b7675bd4665abc864d4cd0aa4de2bd8f0b4c635eb3205b0fc7f8def3eaf8c2f383b369abd93e0b206f3af6512a1ec9a62c600f7c74428f856c0a093cb4222b07ed774d9595b2f80dfa888580cea9884bd722d4fcfb3042d90225ee1d7e70aba46bc73220e3f07dd3b828ecf4a6d5dd010dd89691119b1017c9059aaa47666f9773d9ca3c0240574ee270e1889ece76523b6b20c2528a045432faf1500572a8615c4f5d9629b9501e0e676f240df53e819154c14fa69c278f2c9a5530c30b80bbf72a2c94bacf5fc3070e253718cb3923f622265c72767a2c57edb18e5d196a57fe18ddb6d260f0259dbd052e740b823cc883c697683167a47293bfae072efbda4405d0c95119769c317d4b2be56054324982513c7d4da9d8c738f217c55ab665338a61a111f0b43d9f17c7407b0934e96f69c27319b738842dd5865cc00e1ab02b6f49b07105ffa31bf0eb2ad9ef10d00ce89f671094ca632493f5e8f105b81ffadacddc5ba9080d32b442919f8b7961059d5c50a6e12ec5c2da84d43667fbe45d0c2de9d91048917758a96b86b601b99174de596776b102dbdba1b0f328228737f882835bc24778e9a53d36d1339c9419d2813787583df95fb9a53b1b1b04fa7b2a90bcf74fab9e4943af7dd096a5aba1ff338114834e62fa2f82a9a43cb2946d1a9b294948ff2c5dbe150d49d73f09dc725eef0f6f2f59f4e15f53c81c62be1d5739687c37800ff7d6d047db973ad5c9c4df95352835c972e5377b12987613e78fb46857f981706eba2834b8e6f590d1b48717c3e04929669994e51f97dd166d5ff5bcc328822540f47abae8f7ffb0a75c0ab197bf4865e67ebba3295d295cd6b223bda7f3ebe29fc3539ef5bd538dcb7f7cd56896f3006f1b716913c4648f593024a9e7c7c6bea8a6b4f8c7f8b8a9d4b7bdfd6a79ff027a8a4b7a620cb518c7aa1b91475020a2d6e304a3282e2d37781bfefac9e594e3c2a3627ec1d4cec6607ba608f212d1d04fb30cada730d04d640f546aef4c4f9435fddb57da0c6fb451a241a2992e88846b9900b7cd146189c0c102dd9446351a885fe3f4de7a027378b6a77590337c43971b29b810097b5b4e0257a28cb7a40d29bf426be479bed8db76348d5e411e3f489ef96c874867c994e3be529632a20a6e64d14a4ee423aed0a9f703c03fec62ff596e32f41c8b88af065efa4e104629c087052cbf99e96679e5bf6f289eed69749ac81a29268409cd1f49d7ee3971e62a57c269b8ac6e4823b76d07edbc9faa7d2da17ffc720f39d1551d30de6fdf36073eb044cb2d342b466e07fcb9249609c67dc8f7ea64cb85dfc1ed140bb482efb309e78107879b26a896862d29e53d34244899ae88cd56e4916392ae0a1acf0a5c96ecaf2b002727527fcf3512e4498d20c4a8fc2dead7b2747371b5d9e09b7236d4c78a6d45dc54e50035311819a17e92085b0f687c8a9cec1dbf01dce44c89a655c140cf0a6d7fc1c124c8bec3232f6842acf3868355a3ece9355d7bbbea5b2d6166caeb65d2acfd4931d05624481e1c9fdb60053e8737949e46f48534ad19e02423991b310494a9b9f2e7f3cc5d73ae0313e1d96c0f52f1b4ebb9a679caaab602d3c79825fa042c6aa6a57abd85373c6a83caf5be4478f6ee83edab050100eab5c69d7f7fa6ab882f1e4ae675d36a12e80ca440cfaf704e3fa509fdda563b9b5f81ffcc8b565772c3e766839e3b0de0dd3308c5b19a9cdd87e236aa69697f484bfa92ab42f6101f83a4fd37388cad3dba3058febe9b55cdbce3125be61bf6d92ee9561010ec32be186a1cab62def81664beedeb0236d66ba46f95a4dd3f097319fa4256e8027ebffbe78bcf6204b636d0584b24813165c0099065ea07528c10d65030c25a85369e0648a4e5e3c8bb3f92e29b81b7a005b9ef4d073c434cb62a08f442f74083a1393bdcd89656132d63e72ff9d7b386550941cc34481ae3db4606bd4f89f6df9e152aff852488042baebd9ceb54a730cc226ad4c800596048bb90d7432b6fcf4f6bfae2d60e6ebfd200f105e9df46ff79e78f2fb2302ad636d541219d107fda1583d84e7c0ba804a0fbdf6feb077e010fb0d989a2c3f21023f994d7a68e8afe9213218f1d97f1f581dafac7ce98805b77ef52318a88ba236368df6cf68fc3b139c1bdcd5ce4b6847911adacb005fc07fd39afb919f0f94942e505ea6656af9a52ba821ce5602f97919d1a6a46f5886b7fd420497a4f0c335c8e4faaaf4614e4635b4ca3ff7e72118892283b5f0f63a1897a4ebdadf283937c3789e6dd1ad9c66d7713ff5789a7544d2a51dbf70dcef57686bfc531dcedd13877c2ff987e3c5c7a7aeb9aa4bb3113535f9b379a3dc390b2eb50baba1c0246d122ff2dab2abdd859b0999317c19fc96fc975c16b3bf2e0a55008814d020dca7d7e9d3070f78eb2728fd4cb461545177ac2442afa154a978649fe0146587889e8fee376e3be846e1d66aa4cc22894ee38604484a791016a19f77747814bbf229e5d8b15991080b1a266a4c47be8cd67613b133f4f35c4e16aa28af68df184c755c037bc663a5ae0807ff27e628e629a5bf059b4a7e26ddc790caf5a99275f6238a6cf23b25df56f99d87935def6b651ecc116f4bf66f3f6fb8a07d32756cdafe67cbb1f9bf5400366a87429c4fb4dc036e362609213653daa22f5714e1593cf9675743b9fb30479f2b0dd166f1866107dcca032f98d6ee6e5bc0f8c7ade60f568b9e9a612eebb9d73c307430e626b1c449c5a8726f43f4b88c2e2c1010ab150e3744b44e17c36a1b146b04e687da3434c838b4771d0908bb81db212c428d3d5cea2067f67649348ae817e5a0a9cb7755d8425b98f9cee7dc7cbd316122489db92d8593c2f59deeaddb3dab86526642de666e3c42ec89bd5318f8bd325b0dd7e405ad38e091e889061923d25c8c30329dbf2caf59af24d09ee6391bb603f37acd8264d32e675aaaba1483c66407c7ba9998b90c4b5d53b6126a6cceef6ed7c332cc5b7f1ca03cb62016577c7eb6966a6e96afac1b979d1c9f8938c27742f6ff86b4ef200a63eb17da6835801aa4b08247e211c4501e81a3b82ed5a41f61bc083b9bb0d6c129d75bb64a176f052a263a23b524bb14e042fa62859a8a2af23df69dc7079ad78ba8f48ac4d159f93d55fe7326c8efad0b8b7e7d3ec8ef8b4a0e3163426e5ae2e572d2a5a7c7cba445643a98121ea6912dee77c15202dee1f5e8a7f165a436ac204efe1d84a5edd5b9fb2795217d7b68beb7a9a32f69b332aa0c3f3b27ba69073deaaa145b2e5c8b61245c4ccbc726a096b582c08194749a4ee720235c543197a2c08df022c13f8919264b9d789baf2c2beafb0234d80df1b5c08474ff86191ca1a336d78be40f94069d7c7a07fd45ddf61bed63002dcc15a1b0f100d4b523dea3b2d8b0ef5134b0ef46bab7c9d3239a4d4b0b98f408c415ea3c4944facbcb39ce6f08529017ab2b91724622d8a49f4c681e2587cf323432f77e0112eca94b3ce9115d899693759d62c8e6aae406cd78fd809d3431888a325ef9d5dc1011699c1a52d34976e1786507c8e5238defdf803ecc931d2de2227cc6dea5b26cbebac5971410b83e5caf2959134648270df3f3598d3448</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">私有文章，仅供自己学习使用。</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 开发规约 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 开发规约 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>项目优雅的实现责任链模式</title>
      <link href="/posts/940364b3.html"/>
      <url>/posts/940364b3.html</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试!" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="c730a71e3475775ad3d079caa5d82c8b3e5d50f131f902ccb26df1245d074ffd">2ddec83a87db3033ff4ab408c7ae30ff2eee36628ac8c932ee1030cdd143b942e6040af85c01e3b5d158d9a94898e4c06a5a56eed1b54f1093dcd631e3d0e4b9872c72bc3cd7a63dd713e555222e6d5bbd1475ba77af9eec90c36e7e546bb335a33a96a7464d78c08470592a676610230dcae0f81c45be7d44ad4cf4c2f501f007234aa5ac0234b75c3d46e8e17167121f009a2752b77e43398d59af9c42b5f9d94c90f0a0058933abb84e096a5def7fdcefe482177f4543d69331c0aeace4467ca79f5e34f75ccdeb835f0c875e357c025e50b97807d1762657829a0334307828da6e8ed9d814e5243f41ea8b56da5b1bbd36167e816050e35a4307eeed056ada6ae48857d3750b2b8c6232225ed32ff914a17c2a1a3d2b6cff64e4e95e5f944fac2c4921275a781fcdbf2de9a8416ca58f52448bdfb950ce0f1550a3a6d9dc092fffca45ecd1358065b5626f2550461de834615a30eff13c579a80c1de097c4af37d446e314410f0e76d6355abeead38abd05f098469c120be6a0783b1beae84c4a1838833a8666fc74b026f2b60e237f51b62f38113c1b4cb9421ad44f2abc3bd7b2db8b0ce95f6892af7f4522869dc03c5ce912cd9b2722499f7f28876c10309b0d8cd5ed784f64e9c184e72d938e18df89191381e45142a4b2c4c109d8ae9f434ad414a1331c80c0ef6c0b3a9ca82d00622bad13eb0d9899f0877b7255e6b150ad71935c2d357690070be055dedded5981543897bf73224fa91db3882c3f1f8f06ce49c1c1e141b1c0371b0a048ed0afea251985371abdae26c0a2e40d7dacdb1b61422820e8f24e966915db0ec4fca061ca851d14c26e6cd50d781d5c22f42a07cc8490c5065481a22a9184d7b0906a08ea5ccb65442e9894f2408ccdcf501f1809cfe9fdb0254592a47ab18b212d635e0d2c7a793aebffe24a1b0167be9863eb03a1ee8072cf9e6b7c04a4c345dcd59c3f2abb1142a2f771692e9bc1bc5531c8a6ccc6f8f853931eb287d3c658f307382e89fd601021e547cba1eba768bf8bd642ecbb0c6f56b5b62eeb0de55fc84caa69792f7eb19bffbbbca93a1af5a56a360b9a67c451f15342850c4c4b87971119c52a2476284c20dab85b29f14b2f4adff730f0e92e1079dfd8ccd416ed0abe6235e21f1ca74f62645c7fc42d916265a084a7ad005fab475e0d23cf7032d6ae8ccbf86f50528f7691d7665a379edc20536359f17cc428f8130ce0e44d3df171b4d89ff9bd8d10d514e9bd17cac196c3d989302e1b2587fc3ca2da02dfe0756cb139343a233645c11b9aa8ac70b0cf33071fd22af7b2bfeb659779c87ea53a320ce835d77c04e628bd75061cb0ffbe8d21170172e991274344d719065d5ae85b48935dd52f37a6889a37cc3543a828e9cc15ad46c42b1019a812a1a3c179d6f6239db2a8cf041c3ba6441139f12d0d3b84eb0552d2e8a7c6fd578188a11a356d73ee60f91d97473c35c8c8c2a1f754137d4c408f6d447ee3e7330ca39eeb94d69632c718b6b4aa23c183768662721bd911ad2b78d4adb8e93ac5b560d7dd210cb4fe31753646a7ec2c9aa7363b3fedf4eff7bacbbaf958b18cd4e3fe754cf21c885d962aa1402f41a0dc9a9476a365281ab1bd71d2df043d11d7c075b21a2e96d7f9662d450435aeb0e06b1ebc53860c5eec6b8524e1be7843170aa0954b9e766a1b7022fee636154c3870ac0111220bfc71c9dbdd0a7dade284a84407f22605560a9b4118938b544f2b4c049e818c65c597410d83cb4b9559052a736a98fe7b3c550d5de902b22efce4282fcfa5c87d79ecd723c656cfb62e721a4ed172712a90435091c34490c3d184e03360806f321f8a555835f7d19abccd0514f1893d2519648e0f3f24dd5af486584aa45bf32ba55b680e7775c32b830230619683ea37194f4b3ffa7a71ed7799a7df28dc51287c1297106cec9dfe981a5eadd20d0d7f3a40ee030305eb4177f2b504c0c6ee51a2578846a1f74f02efdf65bdba24f88f9163ce45413c0fe283f7163b381911350f7461a3413e44ad90da3b86c97fabac1b2c78cc55a7e4ee4f0511c051806eb51e7fd056a8bb7ca2094dd4ff7769d6e45d82001d3fc63afd651fd4ae6d93b5ac0f69dad3dd5630c100fdb6492a053a7e87d2fb21692eb47efc8191402b094fe445a07085516b3be51b78d73bd7a45de2cdd8a99e2dd2909a3d46760a1665cd1103b23ba48896013ab870a399042a39a0a7653cab8f8a91702312d43f757922bac3fd276feff13fd4d8276ce1970c4dcea63698f9a03d4cb37cb8fdc9486a4073f5db2d266d3366b49e41aff4c60f659bf51d01ef5978daf92b3e61b11a6bcdf12ffaf3ae83a4d7b2c5c56b7d4e0ffc34d12227a99c1b33b508c91b2348c7dd20993e179db5d502de9b993a4e362327b8dbfb8882185927cce66f9f3637699bd29aae113e62ca71cbe826b20f8ec10bf79f65d3ed15b14516ee9dcd32eb5612b011ddea602f01ebbbc419f6aa50ec5c5c977b6de2f31a350b1d6843a3480fd535e5350584e85fc15e5e94fc7234f609859c643d1a5e18ffe281e9e6b586627f4aa88d96162337168f25d2c597a4ffd80e090f53e0086a7f2bbcef9a9cef4ba01f01d7fb586cc574239909f91f1c41c66c2080264652cd48118361ac398e123d9486eef52f71d15e346d9f611b918d528a8abe17246adefab7354bed01d63149de99c79f8043887755c05b6fd7bfb1be0b9421cf071e5df5cd2313cd82e9c5d3d64fade74e61184a6b36deb58023aff63c6b046f37439cf46957eb6eb02d2276192dcd412c7f071f5d8b8f7ca6b0e4b816a16cab232c27a3b6f3dafc01cab0132e454e6c3ddac8ff2ff2e0afc0abc0bbd22ba99ec2c79a22f0cb7ea72ae522508ab68f391b31bb260a40fb426d81b8cf958e50559726a68bace0eaacccb5507bf7f4b9de40f9815500f3a481bf5dc2ec46bbd41a30099338a9fb7450120f49456b1a42832fa826b39c73c087ac66fa6d77b06eaeee34eca2f2a5cc2b24e06c16ea7ee1fb4c362d8fa52f6862217e807acffc8a4787c93bd72069de74b40e0c07132ae2c0f5e60427710a9450b69c42c42f367c8e4e270b2b6a565456d899162f871ad9f47ac51a8490a36a953eedf418fc0472f8796d75df2de1338bb4e00f2e3da4e49d9f389142bf76cd6905fcd1864598ab0f20806ef3cb07cfc0bf5111d4d1436bcae34e0d200d5ed1c85699466271c7cff6f0a0d95867a5674e5c099d35b7abe604ad2c0dea8a5e6d77adb5fc8564edbf3520acda327be3b4aedba43eb7693e8583e5eda16d515b92e54d3f70d001d0ab22c311cae9d3a09aa3f5c055336072ba676e3d64ab0e06add363b5b6b8a032e413feaea810fc9361140e6e3bd86f14693f23a7c3b8080ff23a6c2da643a86752256ab917e7038d0c1547178d4e89d398883041c09c265f6d5d4ab50efda53eefa14800cb36d523bd7dae6e560a45ad75472efd52d0074e1db214695310d1d57931d42dbccfacb68fd2dfffe55b564b0ca617e8f6a3e16aa38a44ae885eae5424614cb78c98849b107a80699d81f54368d31297ea5f42447f8ce62b825c34f818db63219be67c48c8309ddd8526859851ab046895155739b2d529743cfc2a5051bb22bff2553b3d9389f112fe639da8bc1b0cca940adce8c2ead02567b4bb3812105bd830461d87bdc993b2707554fb1e2b899f94cc42307d8814b19dc41d0e4fef4fd5444fde0c9a48e0696292494e00d4151445f901ca5d7b3962b810f656ab17fd58df364e9bf724982701a0a9d64ccddad8786200af4dce01cfb4c76e5559c47eb12c4727abceb0df520e56cd3e4494772b919b75cf9a7a11106e9efd33ee3d30e03443548b9e72b99f145f14041b5554c4df3eff26f7094d5c005fc5b83890df8dbae06fb7fbfc115ec8973cd2a3ae8b02baa6935d31789bd1d6f2818572d1c02f7a1b396627bffb7bb23af7c884874626d630e1f72a516e8a995674e1bdf7642d29117d96d2a93e593836f21aae25fdcea6bcf9d83892b86a33ae646239992b90a29cb16e68bc152d30774f3914e12eed1d2e56b309b8f0c9eafac6df064ad1e1152960bb336957e4e5eadf96fd689498665f7ef02faaa982dcf356f8f29472071c37193ffb039510d3daa9db51e2f9a12ac6153483d2c7018c069dbc56c98134c1e3a70e6785efe37826688794c514319cd48381f39e910c9f726016a19f0766b77f987c5d45e6031135e1cf22f50ec298ce4a9089f2ad1b2a0ffcedde5649433484c2323073fd6f073a8a2914422d33f2041025b5f3d28d1225b9cecd8555ade49e846fb7b67d9dfc7a7a5cab590113e30e47459c00d65c145dd91e79a59e487cd968b9b70e609486299363b76923889e3f7cfc83838a5c486d145431ec5abe66ad2e36eb85a2d638df893e6a267bf9ce25d5a6c519bc83f14185f22d5286f90783ae6166fc3369e6a1742084c44f60b905ae6ffbf733ae2b8dec7ba445bfad21f69142590efbf18f2b9e12e307163be159855e9f11a23b1bb3b3bce2530afd6a23fd2a2687b8f0c0a63670d8890a90f84bbed49f4ee8e946729d921e0a9473ba7b672074478585a32adfce276b6ab266bec75b3461d12b010d21f29f3e8bcbae2a5576ba21a8c06b2d41e87acb3e0e9c5210d67dabd1ad73660bfffb7047fbb0a01f3325ff92c1377539197e8f02b74e782cbe96ef7e367998159b2da8d88ca08932b35d0d8921ab6a7d922bbd62938b8b914b96354f678892e0755171012391617d621b7f8041e08dea929925122a3f871c1838618710423d972c958f46ba26688540243c8fc95cc72f858cf01cef7409a8e471bf119fa2b3ceb3e8c220488ca986778489a652acc035a34770ff46842701813c59bff4d180875974ccd06e5d9f64c58881d3ce1e68e525195ead5d3d459095fc69e49991aa9ae4b77fb1abe4389d835ec1d4a651fd7ef03e674decd94777c60fe4864ec1efdcb68987fb155054bbad89b5b87adb26ff2676ac871dc19fa707d571f0436843f0c04f7666539d15e004ef0cd065544772bc3641d15f581b6a201819c73f3e73a37d215d5fca4f7b01fbe0907b0a7c55b03b245785d784954bf9926aa64899b0518d36b49079f03e7992f75aa530b8801929d8c3867b1c587bf87473295878443f1779962d2921fa210aa4113ed5662cd4c7cc12d8bbf9bd5f439f42a6426d41169f10d0acec48f31e3a04e6d9a9e952d03519f12d8a1a7c9392668c415634648aad52049d7976288476656b97a49933e4a946943e761eb33552e1bf371cb3809356fa536e9f3821d11bfc1a19bc33cb5593225f9d489304f7d016688c68fa89328302568ec6b671dbb9a3b9e8a4d17e220a9537af0ec8b5584f5e86302b43eaa0e3e0952baedf7274c08e08451f6fb7cb8d5e4f17c334b781944deb3daed173f48c244908ec85d4b90949241f24db0c770d1ef169863166a1cda655243f0e04006f88f66d908205ed009e0b92b5ed251c34ea9e5a1e9b560bfdf35e0112d12c3eb570a803c492efca57383ff2ea8542ee8e6020aa57e7d97a360f1118ec529e3abc7ca0501ce6e1a17d2e821d0850527723e3b3af3aabe4d07b485cad55c1b7fcc3e80566c04f1da9c4d260cb4517288370515cc09ca595b430c3257c65fe281a7cd38631ddacf8f2ae506312793a0162ec6cf5a611eb96bef7c57126d18a033ae2b3f47604c8954ac52e360cc9e2c64d866225ee00fa0e6d5ec5091262b83c121bde5e876cd4e40fc3e176ae5ac9b0bf68af733ab1194311b38b5b96fe64c80215ac7bf43bbc61e73a9f299f6da9fa78c877df758f1e92ea04fef4954a2c9e189818b7c4692dec9f30d7caa770c388dcdd4a41ff70ffd60e24ca3824870f75079b5a999be80693de5c44cb6219c982a0694f9b6aaf13c039a6f900588ad8eecc37c82e4b85dd833b9a5fff54ce9d1bc3786b9211f4aad37d42213f7d9d5a532870ca1e48aabc5cfeb4991a9f514ba6624a9ed3f0fcb32d8c06906db7c8c095322810cb66ca70322e9087b5a46a484b3b075ad7f7a52a6a1b9042934d0fc165b2126f38150dcc27c572c94649b43ef050aeda708a21a7f69dd8fd567d2262a47016bbb03ed80e601133540c8401773c0155e37937ab741948d2cccce3242dd04a82f128a3419a3e7c639d1e6efe9bb7b55c0245f1fa7cba5a49f5f3c849e727731a8f0529e27c0de76682f6a5c44b809d8b73d8ca0270d90620790822fa6396e0010df806db49bd797296c2ebb4964417830d7f735252dc1d497bf61eabe12d416366e8dcf62e6f6a291a9fac0afbb03fc7fcb037af1a2dff9165684543d286ec4a365a84579b18bbfb15f84d2e3c95d2776d7cc054d14d6563aa5fefc6a61ebf2788d36299c77471aae05d7fa29cf7a9d0df06d71477839f6abb7e55e3fdf1edaa20539e13005407fc25b2e72d274fd9e6def6b808594ffaea7d12ac7a116549c204aacda4d6417d0a1685d26d5ade8ef91cb8fabb366122617c45cf2ee39b54e4e4f8eea9240592adc68c04af3b029fc2439e39f9c594823217f0abc72d1ea51576aa34beac618929aae80251ce27409bd49e3f57bc9558dfb368596cbe3f21f3135f60cc5cb723e870a018cb16b8e974d2d877638ce4df1be8be1d004426f7a12962439e839d8a5397997588facfefa55d363aefd356a1e6b72bba3ed975559a297a5fe3b98d5f8647634982b2d5ff972d8cf8b61e5a621dcca4d46a9dadbe462b0415f22ac7a51f9cbc517b017a25f570f5b56d9380a71163f48e27ef52d52b2a3f4a47b2d686f16ca67b4ee13e5b4fb6086a071291c4303b4d26762bec87a3cf0466f2442f2e2e2ce63b2527f92a2757a14f74f1b15e2cf6e358a6c77b0f2c8482994884e76e82d57c7e333f0645733bf6f981ca2d592dbcb52c680d1fa729af62b49b04b895efafbfb9a801cb8046bcedb1e3f8fac8a445aec57cc33456efb796d4c3bbbc704f77fd3089c1323081c1f6142077abded16e97eef092e5b5633e49958f70194ada527c14b137bdd6e2b3cd714ee5086f81a0ec36c0a7e24a88b965e237cfea214acf0fb8368a6d2566b93ad4ae6f319409036e99718eb624e0eb62be862b1310a62ba30f95deed409b4a98de87508fdf3a40a538412b2edff4e1507e458f3e76cf0f82f38ec77881a466a769aa246c0f40bc798ce7b40341ad7280d5541594cc68e3cf527225dc4ceea7d674ff97a1e852adcf9d3e297197803f0cd3e1618d342e0748df18f82f60e66ed5ef06d9b65b47144b776bdb37c541bd6709b346a1013d4bb02a447926ecaf40ca573b1dba5ed6c97986dba2ea693128b0d80fff75f243389acf1cd02258f4723d2766a532f0e5cf61a6448f3ae2fa6c7fa883bc929bbca995cb8aade6ae80ab151d474afe199d2d5fa8e5a41dc89bfe2637500ae0e8c8b357e44dc053535831ca99987050d747f665a0d8fa32423f5e40f19abeb8d454d11799f8b762b45f8568a8b7eab16103e34a59a51f6490a9160545fba098db758dba351e3b4f87d461c3c1c9417b2e0c15edc4a26bd8599327e25919b5c334d12d1205bdcae160248084314854f2bb79273d9849a81fefbc2ed0a6f4a4b617e6e775c13491402d5939e178edc3020fc98d05b4cf2a343524c613872f7c64233e6562dbc12e1613f296b4cc2346efd7ddba5690a54d8d10c74d62577dec4f4a0b477d64ea92c194a8043f8388a2c97e6fe0ffe749a264222c3e19db64d5f8d021656facec5083dff065201c85848f9cd3ee67805df914edca8b68a7ffb5fb4a6a174ee2955ef0dcff9d003a117ab574b2c0b7eb95d8e2c1b77733d9fbff1c36c2a47bb0afa238f9676ab0c1a3b6ef1337c61f39f9f3b55127a3fdd9cf223351652ab9dd5ee0b5a32ce46c56be88daf734ed2e5730dd8aa90f76445f5e622a83ffecf800b9cb5ffaecf66bbaa4874091a20f91fe8fa6d12e1808ecab7e2c9ab7f1cd8f419fb1b80b01f543f3be91a398e02e7a048d57d4a305f9608cdb0990868364b3a6ed871fa11895773ae187321a20efa0bbacee3effce01d5406e64bb5cc0e771702afdae48925ef09c99c0fb65c6a11f3e4b03ea39dc51e3395b8ae59ec4420119e57837c7c329a3da108ca4e44af4d25a74c6a62eb2259fade5d604c3a964169f729375b6169f3fb56e514f6242cf7f9bd68885e91e0a65d451416473e7dddea36e73d72bfa32f62e5b1b83679c376c1a850fe361b0a0b266e8f8e2b9b25d47cf2e4ad8cba94385171ffd638dfcfd468eb5ac97f5ab9e18aad1a36539320ab32df4493a9d3dee18a203b2a3c7cfd40b0e0f419e442c8c2a7091c280e5480f7a368968478c53646902927dbdd7358cbddb626a2d76a5918223bee2021648de3836086ccebbf0c7a9aa6de095ba76eac951ffe72a02cf128d1aa02af4ee344a18134fabffedcc6c7063d15f61e7f99f656cece3158b8555097719b51349c9ff58d9e03600223fa2e01b2a54f7121c85fc30cac56ee6074e8b35ae52dd4a6f6c6e9b710a6db7ba93bf7c1174394ae9e772db6392a38c8b1729f6238f6561a393219051ef96a792bebc2048946fd3f37dc6cba0da7d2af576b73f305efcc8fb65849b26c211ec6fbb08165ee5f708aa5548b2895edee6405823893f67a3ea44a2069cf7f12404c48c2ec1278eb01bfffc1c24175a2b257ea5555200d8166be97e153f14ff91c9280d56e6ce8e0b61cff661352494b0a69484b8c52eca8bafe53cbdd16fb567c528447ef5c88e24368c56421e3b83f24c9d7820bea6ec18e2324884da96ec54faeb909a6821a536b0abfb3cfe6ac6e1853bc16fef567b6a4088649c69c503ac2861dafcb703225fb5416886b8b3997ce5616d0f9c8e1e33c62ff2d5e8197048e8dd0e46e8b2e19b180dd239be3feb252a7fe9160a1b860b5da8beda888e40a5efbc10bed06d1f76c10d5b981f13c1e3013d8c097b4b24f6a507598e3a9dca2fafe95bf88489b6e2d3e711c4f29d1b6896e1cd1e2525d1a6a14c5da3844c1bcf65cb520cee340f8dd2d1c536f79a8428e3772be716b38815a48ca7854763b7ec88b871e3bed8534560254b0f5ed25d1d8d03f6eafa4ce45f9f8f741b2f25598340745dfd756e22733d73d02defa31ff23f682da63391ba991f01ff7107ddf816658ddfae90816d55986073798a4202bbc5f6dd411b09a9974f112b3e69944f683dd8f48ab41686e3f5e431b0cea077898c1527797e4496bb866f726474860c845298a08492bef1bbd0331a81a9f91605b501b1287649cb8a9c22b99d96bedee0b376f33718a170902df2c13273e0f139ee387e7fce55f2cb8cce6bff41ba6260cef3db6e52cb34097659bd5317c0e97e1a6c2d4330d2581063f20def432c9dccf59c0571c8425281ad2fe00a0102c4759592da3afbc967b7e98514a8085b10b39f35ea0eb3c87dba2737c50a77d28067daa80c208997092a4faf51c817f3bf5e224febef2aaabeaee6428dc1666406a7e52c168885df8c9e2437ffa983606d8558b3645d8ae7a1de8c7e59ff052a7839989624d49f5cdf9ac319466a8c6f30753bb1dda0c2f33a064f8df81b10e1678276ae65c818ff23ebdd2e08c5752756cf0ee13eb0b067919837a4f52694c8c1726b11f4c34c1128e2815133044e8f84c623ddcffd5acf0f711bab37eaf655f9eb533040d71e12cd3545a486b6aa8ebecb2733eb25bb70231047415b167afd6be6eb93cf6f85b70c0d2978dc01d3b264cc09d42dcd48be468a13b9552e2faa746265ff42fb305acef72a6b4df32152697ba5c6b208935719581a6bd7ce3e7cd1c6520251efc203621108d70c34fc3a3aa5809878fc8bee1f2a95f1509231b84774806c390726acebba44e22bfe28eb8f78ea8b74bf53001df05aa10b0df995fde6e4b6790887a9dfe763b412fb6864bb3df2c38a4025c3f43af562d3d54da2b5b90c6125ab6c2769e1ae36ed1541c06237bef753e209f8154d996b378aac5b80ee9e4440c911ee712d2a0db93eae5b97d3ebf85f14326d8e9797485626bd88228424720d15e3f38150353ab9c6f5036e86aeb1c05c50926d0435ae0952fd21a7638b0ed01e0545ce1ee2896abf4317febbbe912a5d748e40818098a67d5f8c268c78145d794249e7c7a262716cfacd238faf8cb9403f39be90dedbbb76a8256d35e9c56c708c76d4fe281c2a436ffdc52460088e599327bda4f3d06aee30e6fc70194247f33eb21c4a6c3a81bf0fc8470154d151cf17199e5cb1a2bbe7ea96ee6876a0b6075b8e03c9e83927c4360f765912c0f8fec36fa56d6d580857a425791a6d0baf8476f901aec351a3f9e43f2b76d0e12f5d89724b1e992b361aab7a926d9aa3ca949a7c5ca501b7b63094e173586cb09af32c1b254cd5456b7025f2d0b9e4df71826a66f1acba96b95dbb0daa642e3f8f8559d75c5177495d645e0f0d7f292eaae3c1bbb45c528c55d3912a1e686f62019b9e389811577e2613f0d6385d1f4a68f1e72dfc92c8f9328c5c9b81738f8bea965bece0d6d73e68f3116f2489bd2e7177a99f34b1866becc6cfb4ab884b092433938955be9a78408f51f110f0e86620319a13fda955fdb0c5c54d33340f5f583efef0430978c9349b83503e6864d8306b45e9be26a6491da306b7be5724f7761bdd9b062c8218bb33118733c24e75b5c325429706740607312d04fb419495e8e6851696eb789c40fb60a4156df8394733ada31d444393f47953b5399b522de597cb426ac59b287f6579be0011b534db55d719e7f5cff2a656c53a1c6d9f6e92e08a878f612ce832d7c9c4b5271c6d01c1d04c9c87f7032b8ff4d07bae1d49c178a630e27748a862713badae56430a8886b0a11839ffb0e927d0692b02eab2f2cdd439612a8aea86022e7d6f94c0b97da306840ed2c0a527b7b14b102b21c0ca04650a22d4d100295e195a4cb7c7c11f9f9522de184410c7f740f1cfe2ae8f087adc2b266fe504f7ad3dc4cd91625a0479774e760c90c4abf1c67654e5a750507f51b5935034629c97ce695d2369dc13ca4681ada6d77556f31335482b6f51a552b0779bf34bda25837537efa9da2f9f51f3a9798789a96053690345ae741dfea669dbbbae3b6d2d9c96ed48ca1777368a3d7c7c4e47c2cbdd00aa9597d6e769b7beb6f0334df5821020a90d7c414137bf6528ba27f158e625a287d5f9dbb839d50e8a50b1b8084dd5a12aa1b327a43ae003cf0d25d1c7622480287e296546428665adf25d3533bdbc55cd1d5406a44d1d9dc2a1631ba37a5f0685f51cbabf87f53deeae6ffeaaea7823fdc62ded6971ed9ea6e9021ad95a4f81c838b3d66e609769ed7a4ad434988dd0dd133c90e8f5206e014fa4b92e70476e411a7fc05fb29c3ded480b91a432f145c65f73d46ed2017f2b8e979c0db721054df02a181bcd23b572d620dce0d56acf6a11fa1367ebcd0c961e6842c3e00d2e67edcc05ce55d52c6661080e10e7ebee193d106526bdc33aa547025115840df6bf8ef86ec2032f606faa3ca363e1ac4367c80fd1d7fc82f5e26ab8605cf3d6707c759dbc88829daf91fcf5e221f6a31406671270bfea996d806a8feff893d8f53a7757de57cdc4d0cf5eed1f337632386a207bb30ec3d26f11562fdef3d4d8bfca0a4c86dea2390119c89bfdefe09c3a1ad7e9679d05e514a410893efaf76894e24467b27ef9a81ae9c02034569d28e7c8a4d493228e76fb0381a49d4499e905da20a12d41b5330a512e4686cba9ddb6069ba7d559fa983d7864fcfa44b7edfe7fbb54db59b5037a6d872d448cbfd1c58d240ff5cec42340a49fd3e463269c35e9f982e3ff6be847558cd5a404885450e5643d8171d3327362442952bdf78e94902ae71c053e61149893e39097fd809ad2d4f6d8f86e02c3be54da71a22bef6913bc9c9e368556e225966796e1635452bcfad4b68995dc81d8493c04aad77b65239eb2476aead550897549a3ed705f0f580b6e48aede68fc4c36e2b7d64e38f4cc79ba6bbbb3119b9b96754a078ae8af4c0693073101973728ae31788d67b8c407c03a53960f2230288189059de6343a20cc63e571fef0a77eed8cff502add6bf6409217be47c4ad86c0d9f7fee2274ca74939e552aa3d31735b2ad3cc7823f6881bb85cdf8fe3cba6d6de8229aae3e8ef635e577e04e97ce4ab564f29ad143907e77be247de25ba91f1e98690c5a2611c0a94bb6403f1a3a24fcf13577781b5d2cf4321f77b264aead96821a47770b8d77048ff8410c1237d6f3c252d7a67e872da70ed0b4c3ad4fff3239ecf055d410fe8b937c3ba2b9fd42094d3c27b36e89e4bb7251ba5dd16cba144012e602178fe354edb7d83c46855483afb33bdbbd0b31175af90553f5978b71a218f3435555304a1d688356591e73adc960c11f122b2a9d4d7f49f79c1ed42c5e122efcd459a1b0df831176b24f9d982f47316aff568a2269a5fe2c0a514b19836771772aa0772a5a65d6c961738a913fb229d7cea454cdb0232e6467260ab8ab62944b6c1a404584046b6de640f3420454d6b8029d9d63edf76cfa0c76b1d9c1571b5824542ec7947b8713ce3d315959b0c7d7025f5f13666ea860ab4ccfc8ac743556333deaa67369934f1780fe0b234129aaca5b7e48eb9d97da1780659bf57fe97fa9adaba52a6833c77f13bd545283f9a255cc4b5a0e475a55f952e06f8d4306f26c77369d07da9e87c8cf5fb98e78c6247905fc45972d46900a51c969c47a50311ae27c74b718db19718b0bdb41411827a291bfa74b0f37bbaa55db73935c8e36ee590e35b5e9d5aca66185e3f3d1adcfb260c2e7c0ded7b565067df99656449f23b4cf1efb4f50abe38d9eac79e2330dbe10f10d82f21dbcef116c7b9a53bcbae43b6d5c9ff7b03aa30c6aa4aa3c167d440b62309f075d252fa67b003d2d41e0f3c02b690713a8f8f147c9686d384bf80fc1ef7c4a98db0817f9e690c445a45fc422b52b4f15eee688736ab1ddbb7976a8df50971fe392313e9e864f5c79034f5303c9a091ea2a4879422cb7f710a243ba4462ed8a6cda0e3655fecedb1c0cf6a128c9975b1f2bb7ea6afee3ea5b74169383b03478b95c2aa2804495321f2259c75841382e2fc58610a17574bed9a1b5dc16f18ae069efb4733e58c56dbd277345cfba190cfb503d3effdef0af3c7004010338aab030bd13703e8dcf0196eaeae8ccbf2bc487ad60bbbc1a189019f657a5e4c00ae35548d071e8557216e97fd5dd81da07568f4894ce98b1a3f190280bb5e8ab1da039961388d1d22bd465d9a9d78847ae702b1398695a518fd88e9a138f65849cb570776ab668bbbbbe72b287d265b7888f0898ad42a7850e384172014aa67a041ae57887c5edfd276bd2cf4e3c19f3be25467c6dca43431987ecb55ed009add027e59892a91a1bfc0dc29f6013d06364d2c6b1e01cfe8ce96f11ecaa4eb92d379a7698cbf460c275c0c0efa4f886dcda7d394d5477b333f8b34dbc5d8d08f66c5b7caebb94a596ae448ffba0884c7e56bc093908f9b1b853666b15e50878e2b1c1dd1b6dae5f4f908cb2b978351ca0a5e2a551cf6bc425f91c043695acd578dc93e153c933fe43c62385dfa9b0bb3c951800916ff0fc523baf388a8b7fdfbe1ea9c75e12d11b4c38f8426f150feca0c8c0e455f7a2a608fdbd224ea29acdf333298cc064243002acbb174b454c45f83150f5c3542020be7e9621eb28aec996e4c2ae3ef88cf4a5cb3f39da7a23138e44a2fbf90d3bcadf139cb8b09cd12f6d9219114693186cc945473a978ca27334b1cbf5178ee9037d2e391aefae7365f0b44845c9f0d886bfadd683b4f78c25f3f159849d8764ccee19e2902d7f1fd17953680f0a3b1f7e3273c462e1cf221387003e3099131fae4fed442b6de54afaa4e3f1cf7200698a97f60fb75a91ca7eac48df64594e7e26687f28c4d3f7b109eba58a9244eac9295085d98656b9ce483b4c856b8bebf8c0571f8f5757fff8fca8be7531f7757da79ea5508f9cb3298633d4372a41ac8da23a5aa7cfaf55ca16e2eb2bc8b28ad018d68b9e4a35f1a686c80afbf66d9c2c23624f8d474d47888aa5891df49bfda7b6d109233785178405265de4d0e115ba433c19c6892ff3886d7e91b11a5d50284bb83bdb6c99820e68fe88268fc9ef8fdf42bcab490989d83c7a30688f056619063efef1f26c24fe420c6055326df30935747a681d7a97eca927a97819e7410aa21ce13cf5de0e84f13a484251f54ff7fa39d68ba18d8645a8edd584f7645aac4b7e3617dd09281d41f9000ec28b40fbd22f1dd89ea579b8c3db5a9043212f1e56dce026416eaf59fc0c48746702a5993a231ed647f8273627bacc9246a5fe4c660e4f7f19052f0db15b5c4d5c3e1fd5e048b9b6dda5991d4cbc9c00237ae4b881c767edbe7b293ee4cba831aaad2cbc14d8bea54d0be3e1fce42624493c44ece42938c4299fa247835ae3918a94d70988ca047ad9ea7557c6e8a63e432a29724a146dfeb01de643d2784deed8d664558c36a3eec1c97c62a30c35d56bd7611c0d4d75e94a11873f3f164979c83b6a109a8dea3d28afeedc4d4df10d1eebcaa62240ab5fa78c23e02ae4b0d2c35abed20a7376277d1382afc46ce312cacc6b8139e3ee79fbd0f2752da9c0d9887f215e63eff068e15e35323ef9e149221400dae0f675a35aa4c0b08484a5631cde1536a58041ab370045ef1abc050f7f650717b513de223bd95461bf8a572ba7ae308921377ad0693a85a8d56c888928ee5b253ed567656623e71bd82abaeb051f18457363322935273c77591a244cd6247bc3342a061bb329404430be658e9111f866e40b4ce8bb20c4e88d855445936e403283eb6b5b865ae3c5f10b16f448b2c24d8e1b42df094b1c3493f808e69aea814eb2a5def585a1559d1c760c47a97ee42ea579d72ac16fa7e620fca6960bd2f525b0a7da138d2f1c6a68ffaa263960b5c3beaed5147b9fa998de84bbc56bcb73bf83351c1b230ff421b9970b336cd16d4aa1a69f0ee49ba2dd55bf4b9f19b628c0a954ccf0a58c2390752879e8512e19f152ac0e95ad2a542cd2419ab2cf94251579556c340187e68ff01b765e5b0dfbca75eb832434d1914d08cc51342e15258813326e14eb0d0701868a0408d44f54a36e1849d8e61d96e0317602f727ad6927ecb53c6a586f37e158738cf8140868e6ea23ca090d7d74998138f45066ca71d9ae602568edaf271ecdfd3de555030ea75f6b284198211a3c4d390dfd073ca8095f1ded820b3bd3f5229f2cd59e7a534854c939806256dd11549d50374b2b08c94b13ffd96b12bb2723c94f17f112247e7548a8ca07c3ab6a40b61057862b7936b25488ba633ddd9b88705fa30a49964ffce69136d47e55e5a6f3e42f665f73f7c8e73ae334b95e8f3a9118f17065b629948cc0d18b6d8c3b8fc680de6e421e69fe93dbba2bbacac82244a51e2aae1787ea3d607041c6234c704eb971937b23b4d023aef2005037ee92db4bc3af99e305f1f2e93a25d22b49824e7b2fd8ff6d24f4211b039876e15dd420f55056198a60714afd2312f536761799759695470f3fdffa89db5d891a58be51fcf3546de51997e91afb608851d30c5e63c5455df1de961064e97cb42c09bc5467fe27cd8e5163ca29e21cc93e168f9bee5b94df62f031f5232786c778473f1010a3383089673bf7618ab51732543920f4619d571c897561458ff7b884ea584f2020610c958c870556268a1f38a8bc496ef486153088e029e979914191a02d128e288c5f39b3ead598331eabc58b3c388fb836ea21f7aa798482d82148d660754cfe345a225061ba3a59d0b160cacee67c8532e28de37db56904000837b47ff71999e0db56786b2efeb73b57c3e7afe2bce3981705f1e49ec6371fb38eb98e5aef9dd6f0599f36f3b97da83d34776075e97986e99eae18f39cd061f91cd7068cb896020597265c9dae9d3601bd58d73af3573e6a2e2502b48027c678caf85f79162f2b5112c42023c74ea824643151807d118acd465252d8f6d3303a47f07e7175dd434b82f576bc10e4949ada02171750bc864068debc06b1f77632dcbaf3d18e606abf2cbd6195f80df9a7fdec041d9b456dbb8d13d59e9d7aae9d9ea40b6901aefe1b1ce597640bc01e18b1be24eed9b13051b341dd7c44104ad3cd8ead2cdf1ded188e597991b7aa249cfe3b7d6ada2f1ba526a9e0ae921dadfc3e71a6ba48961cb952486e8fa52a778ae8c5ce0579257cfe22d74a8e1c436e4686e8a2e4fd7f399ac8ebb551beb6fdc94391a02db4a4798f14ef379d3d507496714df6d31e007a07341c5bc1f7703845f839c7ade80b14ed4597a91fd6c36624336ce016d93566ac01da7ddbf4570e20682ef1bd84b25a084fed0f10ff8c7782ab0ed5ab8345c4237f01bbdf2d6efc57090370336c28423fe0897fff5242cefd2b3a5a7e790331782a0a0836dd69677bb958828412debd6115569a4389bbd4d2425feed2331e2851a15b2f583972dc9fe392dcc76c496783c487ae5dfd20d65aec1f4995d655ef2f4b6523ddf4021181a32a54a41e84bfe0dc9048cabe6f2dd36efeb6cae8f4b1e27f16d3c5656ee626db4e16ec8c614f617470e9012893dbb08349c52950e0aa4dd2f86ae0fe9cf8e9d804c5c44b44948da272335444ff4674397134c5577fe8734e31e4e6eb2b96c5804a050ea63f3bc547633577c54ff3bbe237f9f06e70cef32a111e3c26fdacba36dfc11ccaa8f9d2a392b3a64fb7a812656740a0e0ca70e18d9ee589c0e3f4000714b467ef1f90d0c5473aa5e3091f06de850f1328e249e56fc74f4aa1f4b89f210a4c32211f1151da9d927730ce849c4071cf50ee4f475c402ba38fc80151f89b7c1176bb55a910b6048b3bc4669004d27c7bf4887e09cd8d80d13a9a96007d5a938d5a22f3c481290efa477397c8eed1a0ec72df540d48b1efc460da86d9571ac70ff588f98df3e73a1f6010f92859b7384bff79dbde9345c7338ba1228ab4b913fc6bcb71d734a595280d2ee5e38ccf9e3b7dfb473e17216b1a17f3b584afd0c952e4251ab05867ceae58a825d759ca878a5e6431b01a5bcab0a23e4431be7bda0d5ea4aba4e6475e9ad44cae7c7c34686688e4c61c9ce79049ea5890c8042560e038a739c9bb31a53b3066e0db5631ab4ab124aa6d7ddc84400943d1afcacfaf08a4bb8457bde2983f9dd0a020ae632452cb29b70f5c6e4b52a7be441f6538f11e58f1227ba24330c99a48c04d3dd951286a6e9d09a7f785b482d1b8b0f66460b611b91f3e4119978504551e40543373472834723ce18a42e027b93e3a970f6313a4147a0ac7a63eb6cec38922fd65f79b1fdac769f549e1496d6de098f07e402085833eb37a90b5e496d30c95a56660c997e468ff25f5ba092eb2e7dd1707c642b56f1a9aae0428651ac4f520f34cd8f335a268d5a50d44a25ff3eb82ab5cc723e1c3b7e9f7498290a82a28713f91be6d72c987cfce2b1d8637c479b5c1836d3bb4b21c0f3fb8ade2056997f5478cea93b7fab1bd78d6502930cbe3f49de42c8d7f8966fdd4882e655eed3f9a60b62d0b800f00cdd43463035bbf87fd81b010ed8480a2b676b00ca703a287b92919400b5cea8610f65cfcb9cf6d3afb53a255a3118e24fa7c0ac5d7a1a77bf881641611344a773ab3d745d91d486e0497e58da3be0cdfa037c3c1804623ff634296a8c14867e49c863906f88b7792781b9d06223ff33cd5bd960f31feac1e830f8cd0ae39503966c52b3320d7515f16669ea52890d65185f8f2ad48d0090ec8481876f0b12bd5004344f6d1b6bf5ec13d1ae74049509fbedaae2b717e6ac99bc98e01675466a9a2e98fd3f68717c49b02d3a179114176102bb56cb66170561c323323110e9fbe3844a7ef07051d988f19a1fefe303dec381984866d32052d9e62dab94092f10e79f56e6b97d63c26ceeb2eaa4aaf61c16e64438a4c7187ddbb52f509d0687011d4e5fb8796e056f8c1c07112120d2a0d63ccefd20ff30a220bdb4ee9eaeda9b445c17ca648b58c32e54edc5fdc532e87d2c9e2ed3fe1305f1635eae629cbcc2fefc529c75e6cfee6e127e5ad48e60d3cf34148f17d7c96f1bb5350be36299c5ccf82942e30f7ed5bfea30a594ab2007f19adc141ea082d319e23eb600d293daf9acd97bcc91aece28643cd5f74808381bca9ff676cf3683c6389795b50b3576e3cae6070acd0ac9b1424135cecc0f1b585da768da407559c51a9823d27492018f58f43f2928339cbcf0c4e6174da559be58458164421b6084ebfb0a93d2a427e2e3f3b2564c57af409e658279288525c22f8168a32bbee175fea74ae99664c4675731329f68cb29eaeb13f34f7e00b6e82a4a2c3c01a3b758ce34fba2036e0a8311b8f4e3b2268bf2e6fd894f8e7ce2d4f9e9af69795357835715474c8177cc254e3de14fa84ce9dd7bf80e7ba547675a1e7baa48ea5d9066d0738bdfafcd2d73480d1228ed7e01020089ce35017a9b205f645c31c4099a599f9ec99f74213fc0e6aaee4761573d38dfb4423f0cef07df2bd0bf613b10c7d295c0249f514dd6b4326adc11717fd96370597237ae7de29105e37cbb12cc28c4ed1b2d97808080d9cce97e9aeaa0fda14caadb3ec9b8d87945c1fdee0d2a877435411b75c50ac88e404c676c1379fddb075a2a575fddc725d1cb0035992be91a34480c452a6085d9370d2096294946709effe60a155a01d3b6a85525cddb724dda686e2b22fbeaa86d19acebef56b11f03e9bb43a77ecd35226dc3a4267d2888b06f69bde4aefab2f338b711c1634e1149266ee046a500606dde1337fea7b8252aa5e01ab52f398828b0e0204b40a3f12bec104b38e1cf7b0cab5c81bc794ace927fbafe91eac47046701ba5080393f0c802943990a5ed18a386dbb81cb6c9771173dda44e5039abd1c513741fd0bfe19e3771e3e782b608b02d3d0ab8bf7d916c835c6f0ebf1881f09a9f5f969de894c9cc5b2b7a4663b0a04edc691d103313566c295994b4dd9fa5cc514eed4e3b77d1b03005fd155d0d8d892e50475d22501de9523301750dc2e5f8d248557f061746ac18e87835c39145bff3a1a9c4e0488e3d4ebe12aa49c28929d8d20e7edc87e72fbff855755a9d3ca6189420b2469a88cced5b3a63508050781548ae441127058fd5a3bb06139ce003153ecb6b7dcd2b10b10424dd8f09e3faefb2623d0c7fb39547de011157e64c8cc33f6efa0013d6a47439fd2873ca2b496ac8b3099c5ea56aac5e5879ecb4b78596335075c409d7728c4ca9864758226ff28e5e16283c86f37f2e26cefc3260638ab43ae03a35148fc7a03816b7564ba6550dfd8563c4b74a724f1f1242b1b0ece0b0fb0f3934e812d397c6e762f2457ace6474164c936dd16277ed287fee1918bff97d6522068664bb75d9c472adb80259b36e69787ef28cbbe31f9e7850886e8dddd68c3e5088625516e5808c818cdc78a0df99de6ff294659ab0f6295ae136918b732c0fe614db13093ad36e90f0e26fbf6414766316443ce702d233c59a1d5485747b36babcd763166d1cf9d206d1925c3958189462f44dfff597c02d821d1b41a0c568da6e1a2a99161612bd82c4d3a8f2dc50a4ea035b1d7b6bbe58534501d519bbd11bb9961cffa53c5e864a7d96e94786bf8f5b6de512bc89e534c1f6d514fe47510d4eafb93124f8db867f60e1a7e161604d63b72e0d3a83be283c896375be1d57f16682bbdf94ebd70adb206beb6fad742025e5a7db82f9c77f5806949efbfc13fd15ec42c69d4b494b0c57d7eb5ebf2a1f142f83bfc499e61518127152f218ac58a16c50dd5988395cc9108fa6007199015c720be2f097b19b022741c1ff2c36cd92d5a0980fdc193adc18885a6b8937158932945de09fe03df8e158f9aacd73ff667b207ddf2b7ff36021d0c9411e45268717d2566315f63dee1e7b894ef405c0ba72513340e7b60f15c5c00fae1c569fb80dfc5815e8d54d152b2edbf52e9872b56b1aad403a96a4aa9d305e6076cc56a5a7d3507e802bc90df5c42f9f5ade2c92bbb0ecfeb903c1115bb1bec7284d9145b775d974ad5acfa13443a6214f0272b44bc0618a2e4da5151580943cb9a3390b0186fe19b9047daca4166d773ef3227f2da401c06429338fda0660a5004afbb6faa8a7c443ed90db53c7da88575fb1e88bbc0fde3ebdd05c3a04a999c7988c905d4e250814295fb17d8aaa674ce13f6bfaab88186a4b74766729c1c0b6ec089d224420d099bcf323867bcb78a626a712ce379df8d116c0abcaef677742be1779fc7c5273818b9348e0770eb115ae1d9aa4754607dedb4c9aaa6e66b68d326f49ced38d3b76bbcf2b3b4416c4e1f99397fc97fa582930a8adc77461a9ccc5f916d9b62e9a34890f345b0a903e4147f9b852da41dceaaec00fbbd6439d8865d0183b7964bc014bea73ae8e10e3a100b5378dc63a06ce16822ce4d8d87926f25b834c0b8a60299c0f23725622ac31b1f9cb893277e30fb11adc4a643764520fa909c62c2b6d1ed2a4ff602c8f1fae5fca317ab9a7bee0b0c69deb279a7bb50a4efb88f2b9626f206956fa9b33f3bea75cfc9d67d51cb4a75f6e99942ced9ed991a239ed03c5b499caf4f18564c845e23010cc760cf17dca4168115d2684f3b39f8f89f19fec157360492329487984d8446f3afbb1d1579f36835c2b9bc6492f9b9ffe7f059f9b7269aa397066d1bd7ecc52e9cc999a8b18a35db0169f37eb731c947f9ea5452f6faa33332759b6aa1efeb386e01180f9aaac922b3e6a8df0262acd2768ea5c630c91bf1e498f1bf7e5c17d8c8cc7f1f51361ae091cf82871d8cd040e78e69c2a06f5d6f55ca787cd6b405e7d0434a24c2d56ba2f03e889d57e97e912a79d4b88c0c71e67c07e75c8956b38db867207a142b2f2ad93e4635ce7ededea6809605c6f3b6a0f8d2c4ee1d6f68a19482beb3be9b86607209c6b642c8f119576fdf365780067bfb3e08202f391c512f52fd769d0e4f83345f6faad30f6d1735abf20a8b143c094d3eecd9c250bf62bb40acff4f29bdf1d0a0efef0565ab45c4bdcca076d0b397274b834234184538b8609a17d54bb7cbf7b35a81da5439d8f6c95e6534e487bbfe347363987f4898ba936002b87ba0d6e5d40e3120dc88c60c564d08de61f13de439e42db637ca2ce0cc3317cdf9a742080fe07837573312c7f8cff2b6a288e644c3171fa17c704b9db4a4b398819b06286184cf1ec6c0748bf17c68652392ba315ac895da76fbeb9c0f12fd02b1270aa5778ab1e377df4ccafa135c8fa7b1cc1e2ba114d47e04dbdfefadb3e092717be3a503c60fe2f3cf067cbd656b809eac9f1d4583320051716dce033d46e98105012e4498399544faacb5de3240e293b11eceb09de142b2fd41d30e19c589e5bd62bcf5c198db902b5d8aa6c56b6e24dc211866b0a02099856f81f7345f303f3473f67581490c34e62948db6a62830bb8221038d9a32d85541c13a0f365cf9dba8f227646ae71ed9c01700413a257c10e2b20382df8df7c9801e285c6a815e7b6492d92eabe1d5a0cdc806937c985ac060e29c3a28180772eaa60c137b544e51633dfb58eb7d0585a7fbb630c13e649637cde609124d845555b90c59099c02f7c0ca82c2d5e5576a1266e0800bde4beb1b4ea66b22e63baadd4f38bddb7040535d1dd4b227e65cb73e34fd6a81bf0dcd3dab3112e26f61eeceb319d45f5b58313bae0956f30f0fce8ed7bde2bb3d8c467facb79761dae130bdd61a988c88e990436dbd9b9e8288d61cafc119737f4d01db35053f9fb7e6f7b7b0916dc490bec773d7074d1ee5f78b3ba60853397520b0c23639080f715fe017ab20a73b63ed568011e391077a2fab00e5184bb9162f29ff71c920be9bbff4cb6930c8319f81c0683ca11e74c88647d27ccc9faa6414913387223705980ba4befef05729a08a8a21cadb865fb47fdd6662ce149f23e95b1dba3997e401059dca1407ba3722d146cecb3cf349dd08a241ea3e0e1a23b08aff48bc278202c01af8421da5171f0bcf412aa7ec771190476e93dd4983daaa61f5534444d35012f7275efeb16979e176f3a600b2b7eca541a51ffcc30a809778505d82c6c940ee8632d42165de5e69bc9ad08ab03b8200b4bdd4cdee9d029a60716b4a8e9c5f427007506118f0914c5f9690da08215afadc218626cb7d48e960c209e960119de13e08220cb9684ee871a550b0dd12c27cda0eae807429d7b9841e246d96699ac2d5180efdf00f8bebce120d26fbf1b6e9c2ec4bd2c5c0782af0ca29cd2c517a415cc9b37c0f35c305414d676fe0b2364a37578aa9f5e2bca9b8ebf38f0c4a33f265af3a2d215611655f218ed4dfff694af358b7a9eabd3cc78dcca04beed2d7ab6a7ee70011c679524da764cc8f578a01fe41602376a7a8c6e5f58bec09ad9fd8b72809fec631fcca13fd90432c28fcccd681ed876fbd09b69ba29a534d3b04585942f506dd0b1acdd8387d3a0469f7ec6182486bc1912340205b9df04088e184a5f1cd9062e692515aeb73de4c3a623147c43a90977b4a314eaa16f98516c6ff5295dee5aa4c93f654a45608a2c7db67f6317756a5fea10330b4bf666fc3ffd1f03e9831a7db5fefd1ecb0732198ace758b96509259983b04b4d71da16e40f536c5baf791c01eb8c668e1cf5a123b093485dfd6540ddb7c5b40c11a96c5d806ff2fcd23669130d88cd493c9a9eca29b95c7359dbc0bf49d7d6c0a4a2087476f8ce7bdbf3ce56b25e542bc6ad9e32819e5445c1f3dbdecee1cb0503aee1a674613a0330856363b70609f2bfabc31b76fa4a80527b4024b6d345dd260d9df89b89ccdb0904a97e0ccb0467f99b37ff644fb5ffd07a0a2e0c7563144660c2a7867fb714841d375ae04bed7a420d09d423e09d939b235989da5310ccd98a589396b5a9327dfbf561ed2914fe35c778cf657be3b921a46dfed143cd7d5ada00bb0a427c14af344b7bfc60eb897abdd9215b806d0180787c66c4d3c273bf530a285a1cdaffae081d9ca36b6838149a489705d454445b5abac61f16c1514585d3ec99f18de0b0a225c3abca07427f8ef233ca66351abb89e0962bd511502f927aeb5c1cd61edc5a292d1b08cfa3bd6ff0532b0eaf58b3f016a97bcc8fbce281c469ffad02753d25d8a0e5977624083a57dbcbb684ffd95e56a55270e96ed407b0dec85d20a54a89468ff974049b87a8338170ff7d1922bb7cc9937efa2fcecb345403de39a32546ca06308614fb50dc0c1f7730bb17ddb8cf1a74eb4438ba4af61b5c46f1a05582bd05c57e7c85a57d86539c1dba6a65f068c9e4f8ecf0508a6208fc3c30b0dd82ff56fd5b6a7525b341908f3197a8afc467e47a49c344c3bd87fca67d8c019f54454f168bb79d1f26027d1749f1b8ec069d74a0a29c555be0b51267051f613a1e6fa7d35b660f479703677c3642d931fbd52ccba8bdc4ba78cd575e1d52cdff80ba84d5ad72252ca03ca8286a1b81537177498222632799bbef31c61e173456b76a8875d1376b94a9eb411862f48bf1c648b72adac14b6e56f8aa74318e035cb291b1f15ec5d3b2f802afbb0d456ed657fefb9b93f7c175665b51535693defd3e7bde96e50f8b06f1aa7a112aea11238aee16a7529398d25e837bcc5b7dac73f71baab4c087de6fafb3c7960b023a55806a83ce655476f4b80403918647eb2d8182301d0cbf256a957c42a51ac81645384e6640abb741f03abe4ca72098824cd94d900307bf7a78697e194dda966d63f0b91dd17bb42d7eb6c797b55b7e602ef5b7cf4ca4e3f320dd0924f515c331ef5a8ba98f6cc5aaeeb7325b747b824d77bcb20adfc2908da34a0132061e034e31c871a59887b80ca16bebe458e652d5ce97fdfe4b9f125d5181ddf5542c763b09de20f9b32be66e7e24dee15c33291dacd833cbf0325fbf7ae15c16c7949a4819c3ea5ada971e0f6c63878512b582c4c44029f1dc3612127a1ed31532ea2a4ca82a42d4be2cc9df3f4ed7f183d0ca4cac5f574b4fb91a09c5ca80db44befc7e85ca2e355d1799ef96146d5c5339739222fb2f2</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">私有文章，仅供自己学习使用。</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> 设计模式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 模板模式 </tag>
            
            <tag> 责任链模式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>敏感信息加密存储</title>
      <link href="/posts/e6f2be7b.html"/>
      <url>/posts/e6f2be7b.html</url>
      
        <content type="html"><![CDATA[<h2 id="1、需求背景">1、需求背景</h2><blockquote><p>安全控制一直是治理的重要环节，数据加密属于安全控制的范畴。 无论对互联网公司还是传统行业来说，数据安全一直是极为重视和敏感的话题。 数据加密是指对某些敏感信息通过加密规则进行数据的变形，实现敏感隐私数据的可靠保护。 涉及客户安全数据或者一些商业性敏感数据，如身份证号、手机号、卡号、客户号等个人信息按照相关部门规定，都需要进行数据加密。</p></blockquote><p>对于数据加密的需求，在现实的业务场景中存在如下情况：</p><ul><li>密码样式的文本：<psw>安全部门规定需将涉及用户敏感信息，例如银行、手机号码等进行加密后存储到数据库，在使用的时候再进行解密处理。</psw></li></ul><blockquote><p>在真实业务场景中，相关业务开发团队则往往需要针对公司安全部门需求，<br>自行实行并维护一套加解密系统。 而当加密场景发生改变时，自行维护的加密系统往往又面临着重构或修改风险。<br>此外，<emp>对于已经上线的业务</emp>，<span class='p red'>在不修改业务逻辑和 SQL 的情况下</span>，透明化、安全低风险地实现无缝进行加密改造也相对复杂。</p></blockquote><h2 id="2、项目实战">2、项目实战</h2><h3 id="1、引入ShardingSphere">1、引入ShardingSphere</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.shardingsphere<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>shardingsphere-jdbc-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2、新增加密配置">2、新增加密配置</h3><p><code>application.yaml</code> 配置文件修改配置，将数据库驱动变更为 <span class='nota' data-nota='Apache ShardingSphere 是一款分布式的数据库生态系统， 可以将任意数据库转换为分布式数据库，并通过数据分片、弹性伸缩、加密等能力对原有数据库进行增强。'>ShardingSphere Driver</span> 。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">    <span class="attr">datasource:</span></span><br><span class="line">        <span class="attr">driver-class-name:</span> <span class="string">org.apache.shardingsphere.driver.ShardingSphereDriver</span></span><br><span class="line">        <span class="attr">url:</span> <span class="string">jdbc:shardingsphere:classpath:shardingsphere-config.yaml</span></span><br></pre></td></tr></table></figure><p>并配置 <code>shardingsphere-config.yaml</code> 相关配置。为了方便大家理解，这篇文章只讲敏感数据信息加密存储</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置数据源，底层被 ShardingSphere 进行了代理</span></span><br><span class="line"><span class="attr">dataSources:</span></span><br><span class="line">  <span class="attr">ds_0:</span></span><br><span class="line">    <span class="attr">dataSourceClassName:</span> <span class="string">com.zaxxer.hikari.HikariDataSource</span></span><br><span class="line">    <span class="attr">driverClassName:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">jdbcUrl:</span> <span class="string">jdbc:mysql://127.0.0.1:3306/12306_user_0?useUnicode=true&amp;characterEncoding=UTF-8&amp;rewriteBatchedStatements=true&amp;allowMultiQueries=true&amp;serverTimezone=Asia/Shanghai</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line"></span><br><span class="line"><span class="attr">rules:</span></span><br><span class="line">  <span class="comment"># 数据加密存储规则</span></span><br><span class="line">  <span class="bullet">-</span> <span class="type">!ENCRYPT</span></span><br><span class="line">    <span class="comment"># 需要加密的表集合</span></span><br><span class="line">    <span class="attr">tables:</span></span><br><span class="line">      <span class="comment"># 用户表</span></span><br><span class="line">      <span class="attr">t_user:</span></span><br><span class="line">        <span class="comment"># 用户表中哪些字段需要进行加密</span></span><br><span class="line">        <span class="attr">columns:</span></span><br><span class="line">          <span class="comment"># 身份证字段，逻辑字段，不一定是在数据库中真实存在</span></span><br><span class="line">          <span class="attr">id_card:</span></span><br><span class="line">            <span class="comment"># 身份证字段存储的密文字段，这个是数据库中真实存在的字段</span></span><br><span class="line">            <span class="attr">cipherColumn:</span> <span class="string">id_card</span></span><br><span class="line">            <span class="comment"># 身份证字段加密算法</span></span><br><span class="line">            <span class="attr">encryptorName:</span> <span class="string">common_encryptor</span></span><br><span class="line">          <span class="attr">phone:</span></span><br><span class="line">            <span class="attr">cipherColumn:</span> <span class="string">phone</span></span><br><span class="line">            <span class="attr">encryptorName:</span> <span class="string">common_encryptor</span></span><br><span class="line">          <span class="attr">mail:</span></span><br><span class="line">            <span class="attr">cipherColumn:</span> <span class="string">mail</span></span><br><span class="line">            <span class="attr">encryptorName:</span> <span class="string">common_encryptor</span></span><br><span class="line">          <span class="attr">address:</span></span><br><span class="line">            <span class="attr">cipherColumn:</span> <span class="string">address</span></span><br><span class="line">            <span class="attr">encryptorName:</span> <span class="string">common_encryptor</span></span><br><span class="line">        <span class="comment"># 是否按照密文字段查询</span></span><br><span class="line">        <span class="attr">queryWithCipherColumn:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># 加密算法</span></span><br><span class="line">    <span class="attr">encryptors:</span></span><br><span class="line">      <span class="comment"># 自定义加密算法名称</span></span><br><span class="line">      <span class="attr">common_encryptor:</span></span><br><span class="line">        <span class="comment"># 加密算法类型</span></span><br><span class="line">        <span class="attr">type:</span> <span class="string">AES</span></span><br><span class="line">        <span class="attr">props:</span></span><br><span class="line">          <span class="comment"># AES 加密密钥</span></span><br><span class="line">          <span class="attr">aes-key-value:</span> <span class="string">d6oadClrrb9A3GWo</span></span><br><span class="line"><span class="attr">props:</span></span><br><span class="line">  <span class="attr">sql-show:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="3、最终效果如下">3、最终效果如下</h2><p>当配置好之后，执行对于的插入逻辑，新插入一条用户信息，在应用程序里还是明文，经过 ShardingSphere 代理后，存储数据库时，就已经是密文的了。可以通过Stream-Query来配置打印执行sql</p><blockquote><p>原始SQL :</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_user (id_card, phone, mail, address) <span class="keyword">values</span> (<span class="string">&#x27;34020xx023081xx338&#x27;</span>, <span class="string">&#x27;1x60111xx983&#x27;</span>, <span class="string">&#x27;mading@axxche.org&#x27;</span>, <span class="string">&#x27;xx东城x&#x27;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>代理后SQL :</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_user (id_card, phone, mail, address) <span class="keyword">values</span> (<span class="string">&#x27;YUvr+8Xf17VCgGonU2WXqmKuhB5FMazUEbh3y+h0B38=&#x27;</span>, <span class="string">&#x27;MZObk+5TeYPLHtP2A6+aiw==&#x27;</span>, <span class="string">&#x27;vX/5iWTyfAvMJMt+ioipj9vd6cnZ4rz4qKBAXQ9C9oU=&#x27;</span>, <span class="string">&#x27;vX/5iWTyfAvMJMt+ioipj9vd6cnZ4rz4qKBAXQ9C9oU=&#x27;</span>);</span><br></pre></td></tr></table></figure><div class="tip ban faa-flash animated faa-slow"><p>注：</p></div><blockquote><p>ShardingSphere 在执行查询语句时，如果涉及到相关加密表，会自动将加密数据转换为明文数据，也就是会把 YUvr+8Xf17VCgGonU2WXqmKuhB5FMazUEbh3y+h0B38= 转换为 34020xx023081xx338.由此形成加密敏感信息落库闭环。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 数据处理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 真实项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>用户敏感信息展示脱敏</title>
      <link href="/posts/c35b28d3.html"/>
      <url>/posts/c35b28d3.html</url>
      
        <content type="html"><![CDATA[<div class="tip warning faa-horizontal animated-hover"><h2 id="业务需求">业务需求</h2></div><blockquote><p>将用户敏感信息脱敏展示到前端是出于保护用户隐私和信息安全的考虑。<br>敏感信息包括但不限于手机号码、身份证号、银行卡号等，这些信息泄露可能导致用户个人信息的滥用、身份盗用等严重问题。脱敏是一种常用的保护用户隐私的方式，它的目的是减少潜在的风险，同时保持一定的用户信息可读性。<br>比如咱们在选择用户信息以及展示选座信息时，用户证件号码的脱敏展示。</p></blockquote><div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='0.5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>项目实战</p></div></div><p>技术选型<br>网上很多教程都是在说，通过 AOP、自定义注解和反射的方式完成字段脱敏功能。但是这种方式有点重量级且性能一般，遇到高并发场景存在性能瓶颈。<br>我举个循环嵌套的例子：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> B b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">B</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> C c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">C</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> D d;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">D</span> &#123;</span><br><span class="line"></span><br><span class="line">    @自定义注解</span><br><span class="line">    <span class="keyword">private</span> String phone;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>如果按照反射的逻辑，就需要一层一层的解析嵌套对象直到找到自定义加密注解进行脱敏，性能可想而知。<br>为此，我想是否存在一种更为轻量级的脱敏技术实现？在网上搜索后，找到了一种比较符合我预期的实现方案：Jackson序列化方案。<br>实现思路<br>在 SpringMVC 返回数据时，通过默认的 Jackson 序列化器进行指定，替换为咱们已经包装后的序列化器，这样就能依赖现有解决方案，降低技术复杂度。<br>代码实现<br>定义手机号和证件号的 Jackson 自定义序列化器，并在对应需要脱敏的敏感字段上指定自定义序列化器。</p></blockquote><h2 id="1、身份证号序列化器。">1、身份证号序列化器。</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 身份证号脱敏反序列化</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IdCardDesensitizationSerializer</span> <span class="keyword">extends</span> <span class="title class_">JsonSerializer</span>&lt;String&gt; &#123;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(String idCard, JsonGenerator jsonGenerator, SerializerProvider serializerProvider)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">  <span class="type">String</span> <span class="variable">phoneDesensitization</span> <span class="operator">=</span> DesensitizedUtil.idCardNum(idCard, <span class="number">4</span>, <span class="number">4</span>);</span><br><span class="line">  jsonGenerator.writeString(phoneDesensitization);</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h2 id="2、手机号序列化器。">2、手机号序列化器。</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 手机号脱敏反序列化</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PhoneDesensitizationSerializer</span> <span class="keyword">extends</span> <span class="title class_">JsonSerializer</span>&lt;String&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">serialize</span><span class="params">(String phone, JsonGenerator jsonGenerator, SerializerProvider serializerProvider)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">phoneDesensitization</span> <span class="operator">=</span> DesensitizedUtil.mobilePhone(phone);</span><br><span class="line">        jsonGenerator.writeString(phoneDesensitization);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>3）敏感字段上自定义序列化器。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* 乘车人返回参数</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line">  <span class="meta">@Data</span></span><br><span class="line">  <span class="meta">@Accessors(chain = true)</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PassengerRespDTO</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 证件号码</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="meta">@JsonSerialize(using = IdCardDesensitizationSerializer.class)</span></span><br><span class="line">      <span class="keyword">private</span> String idCard;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 手机号</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">      <span class="meta">@JsonSerialize(using = PhoneDesensitizationSerializer.class)</span></span><br><span class="line">      <span class="keyword">private</span> String phone;</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><blockquote><p>完成上述步骤后，前端调用 HTTP 请求获取数据时，SpringMVC 通过 Jackson 进行序列化数据时，操作证件号码和手机号两个字段就会采用咱们自定义的序列化器，完成敏感信息脱敏功能。<br>扩展思考<br>对接前端的敏感数据脱敏展示功能做到上面这些就已经实现了。但是总感觉哪里不对</p><span class='p red'>举个例子</span> ：在购票服务中，下单接口会调用乘车人详细信息接口获取到手机号、证件号等信息保存入库。</blockquote><p>如果我在后端服务里去调用乘车人的信息接口，那岂不是也是脱敏的？这样的话，存储到数据库的数据就不准确了，期望是真实的数据，但是实际是脱敏后的。</p><blockquote><span class='p green'>解决方案</span> ：基于这种真实情况，我们拆分一个新的实体，叫做 XxxDTO，返回的信息是不脱敏的。其实本质上就是复制了一个乘车人实体，但是在证件号和手机号字段上不添加 @JsonSerialize 注解，以此满足业务需求。</blockquote>]]></content>
      
      
      <categories>
          
          <category> 数据处理 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 真实项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>优雅计算坐标(对接算法)</title>
      <link href="/posts/daabcd9d.html"/>
      <url>/posts/daabcd9d.html</url>
      
        <content type="html"><![CDATA[<div class="tip warning faa-horizontal animated-hover"><h2 id="需求">需求</h2></div><blockquote><p>首先是有一段档案文章在没有换行符的情况下发送给了算法，算法识别出来了敏感词与敏感句以及他们的坐标(此时的坐标是没有换行符/n的情况下的)<br>但是我们的原始档案文章是有换行符的因为要让前端去解析，但是现在<span class='p red'>问题</span>就出现了</p><emp>因为前端展示界面要有换行所以给前端的数据要携带/n，但是现在要把敏感词和敏感句高亮，如果我们的坐标还是没有/n的坐标前端就没办法匹配高亮了</emp><p>有些人可能会说直接index不就好了？ ，但是如果词或句子在/n之间呢，那怎么计算，所以我写了一个算法来计算敏感词句的start和end</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 寻找给定文本中换行字符的索引。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> text 需要搜索换行字符的文本。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 一个包含换行字符索引的整数数组。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">Function&lt;String, <span class="type">int</span>[]&gt; findNewLineIndices = text -&gt; &#123;</span><br><span class="line">    ArrayList&lt;Integer&gt; indicesList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> text.indexOf(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">    <span class="keyword">while</span> (index != -<span class="number">1</span>) &#123;</span><br><span class="line">        indicesList.add(index - indicesList.size());</span><br><span class="line">        index = text.indexOf(<span class="string">&#x27;\n&#x27;</span>, index + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span>[] indicesArray = <span class="keyword">new</span> <span class="title class_">int</span>[indicesList.size()];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; indicesList.size(); i++) &#123;</span><br><span class="line">        indicesArray[i] = indicesList.get(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> indicesArray;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 在文本字符串中找到一个句子的起始和结束索引。</span></span><br><span class="line"><span class="comment"> * 如果整个句子没有被找到，它会尝试找到存在于文本中的句子的一个子字符串。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> sentence 要查找的句子。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> text 要搜索的文本。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 一个包含两个元素的整数数组：起始索引和结束索引。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">BiFunction&lt;String, String, <span class="type">int</span>[]&gt; findSentence = (sentence, text) -&gt; &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">sentenceLength</span> <span class="operator">=</span> sentence.length();</span><br><span class="line">    <span class="type">int</span>[] result = <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">while</span> (sentence.length() &gt; <span class="number">4</span> <span class="comment">/* 最小句子长度 */</span> &amp;&amp; !text.contains(sentence)) &#123;</span><br><span class="line">        sentence = sentence.substring(<span class="number">0</span>, sentence.length() - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> text.indexOf(sentence);</span><br><span class="line">    <span class="keyword">if</span> (index &gt;= <span class="number">0</span> &amp;&amp; !sentence.isEmpty()) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;index, index + sentenceLength&#125;;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 确定起始节点周围的索引。</span></span><br><span class="line"><span class="comment"> * 具体来说，这个函数找到起始节点索引之前的换行字符的数量。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> indices 表示换行字符的一个索引数组。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> startNode 起始节点索引。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> 一个包含起始节点前索引和起始节点与结束节点之间的换行字符数量的整数数组。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">BiFunction&lt;<span class="type">int</span>[], Integer, <span class="type">int</span>[]&gt; findCountIndices = (indices, startNode) -&gt; &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">indexBeforeStart</span> <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">indicesBetween</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; indices.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (indices[i] &gt; startNode) &#123;</span><br><span class="line">            indexBeforeStart = i;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;indexBeforeStart, indicesBetween&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">String</span> <span class="variable">replace</span> <span class="operator">=</span> artificialText.replaceAll(<span class="string">&quot;\\n&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="type">int</span>[] newLineIndices = findNewLineIndices.apply(artificialText);</span><br><span class="line"><span class="type">int</span>[] sentenceIndices = findSentence.apply(cleanSentenceText, replace);</span><br><span class="line"><span class="type">int</span>[] countIndices = findCountIndices.apply(newLineIndices, sentenceIndices[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">jsonObject.add(<span class="string">&quot;start&quot;</span>, <span class="keyword">new</span> <span class="title class_">JsonPrimitive</span>(sentenceIndies[<span class="number">0</span>] + countIndices[<span class="number">0</span>]));</span><br><span class="line">jsonObject.add(<span class="string">&quot;end&quot;</span>, <span class="keyword">new</span> <span class="title class_">JsonPrimitive</span>(sentenceIndices[<span class="number">1</span>] + countIndices[<span class="number">0</span>] + countIndices[<span class="number">1</span>]));</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 算法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 真实项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>1、服务器路径上传</title>
      <link href="/posts/5e439ae3.html"/>
      <url>/posts/5e439ae3.html</url>
      
        <content type="html"><![CDATA[<h2 id="0、策略常量类">0、策略常量类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PathUploadType</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">PDF</span> <span class="operator">=</span> <span class="string">&quot;PDF文件&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">TIF</span> <span class="operator">=</span> <span class="string">&quot;TIF文件&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">IMAGE_TO_PDF</span> <span class="operator">=</span> <span class="string">&quot;合并图片文件&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">VOLUME</span> <span class="operator">=</span> <span class="string">&quot;案卷合并&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">OFD</span> <span class="operator">=</span> <span class="string">&quot;OFD文件&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a name="zQ4eH"></a></p><h2 id="1、合并图片为PDF">1、合并图片为PDF</h2><blockquote><p>这里的逻辑是将当前根目录下所有的包含PDF目录的文件夹里边所有的【jpg&quot;, “jpeg”, “png”, “tif”, &quot;tiff】文件都合并成一个PDF文件</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">logger.info(<span class="string">&quot;接受到图片合并处理任务…………&quot;</span>);</span><br><span class="line">List&lt;File&gt; fileFolders = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">List&lt;String&gt; legalSuffix = Arrays.asList(<span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;png&quot;</span>, <span class="string">&quot;tif&quot;</span>, <span class="string">&quot;tiff&quot;</span></span><br><span class="line"><span class="type">File</span> <span class="variable">rootFolder</span> <span class="operator">=</span> FileUtil.file(upload + localPath);</span><br><span class="line">DirectoryScanner.getFileFoldersWithImages(rootFolder, fileFolders, legalSuffix);</span><br><span class="line">logger.info(<span class="string">&quot;列出包含文件的文件夹成功，一共包含&#123;&#125;个文件夹&quot;</span>, fileFolders.size()</span><br><span class="line"><span class="keyword">for</span> (File uploadFileFolder : fileFolders) &#123;</span><br><span class="line">    pathUpLoadProducer.syncSendPathUpload(tenantId,Convert.toStr(taskId),<span class="literal">null</span>,Convert.toStr(uploadFileFolder),Convert.toStr(overWrite),PathUploadType.IMAGE_TO_PDF);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a name="GrMaP"></a></p><h2 id="2、OFD转PDF">2、OFD转PDF</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">List&lt;File&gt; fileFolders = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">List&lt;String&gt; legalSuffix = List.of(<span class="string">&quot;ofd&quot;</span></span><br><span class="line">getFoldersWithPDFFiles(upload + localPath, fileFolders, legalSuffix);</span><br><span class="line">logger.info(<span class="string">&quot;成功列出包含PDF的文件夹，总共包含&#123;&#125;个文件夹&quot;</span>, fileFolders.size());</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">folderIndex</span> <span class="operator">=</span> <span class="number">0</span>; folderIndex &lt; fileFolders.size(); folderIndex++) &#123;</span><br><span class="line">    <span class="type">File</span> <span class="variable">uploadFileFolder</span> <span class="operator">=</span> fileFolders.get(folderIndex);</span><br><span class="line">    pathUpLoadProducer.syncSendPathUpload(tenantId,Convert.toStr(taskId),<span class="literal">null</span>,Convert.toStr(uploadFileFolder),Convert.toStr(overWrite),PathUploadType.OFD);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a name="ktU3W"></a></p><h2 id="3、案卷合并">3、案卷合并</h2><p>:::warning<br>这个逻辑与合并图片为PDF不同的是，这个会根据全宗去合并 举个例子：<br />A001-004-021-0001.jpg<br />A001-004-021-0002.jpg<br />A001-004-022-0001.jpg<br />A001-004-022-0002.jpg<br />A001-004-022-0003.jpg<br />A001-004-023-0001.jpg<br />最终合并成的文件就是【<br />A001-004-021-0001，<br />A001-004-022-0001，<br />A001-004-023-0001<br />】<br>:::</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">logger.info(<span class="string">&quot;接受到案卷合并处理任务…………&quot;</span>);</span><br><span class="line">List&lt;File&gt; fileFolders = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">List&lt;String&gt; legalSuffix = Arrays.asList(<span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;png&quot;</span>, <span class="string">&quot;tif&quot;</span>, <span class="string">&quot;tiff&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">File</span> <span class="variable">rootFolder</span> <span class="operator">=</span> FileUtil.file(upload + localPath);</span><br><span class="line">DirectoryScanner.getFileFoldersWithImages(rootFolder, fileFolders, legalSuffix);</span><br><span class="line">logger.info(<span class="string">&quot;列出包含文件的文件夹成功，一共包含&#123;&#125;个文件夹&quot;</span>, fileFolders.size());</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">folderIndex</span> <span class="operator">=</span> <span class="number">0</span>; folderIndex &lt; fileFolders.size(); folderIndex++) &#123;</span><br><span class="line">    <span class="type">File</span> <span class="variable">uploadFileFolder</span> <span class="operator">=</span> fileFolders.get(folderIndex);</span><br><span class="line">    pathUpLoadProducer.syncSendPathUpload(tenantId,Convert.toStr(taskId),<span class="literal">null</span>,Convert.toStr(uploadFileFolder),Convert.toStr(overWrite),PathUploadType.VOLUME);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a name="wQQw6"></a></p><h2 id="4、TIFF文件转PDF">4、TIFF文件转PDF</h2>]]></content>
      
      
      <categories>
          
          <category> 各种类型文件操作 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 服务器路径上传 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2、MQ配置以及生产者消费者逻辑</title>
      <link href="/posts/97da32d6.html"/>
      <url>/posts/97da32d6.html</url>
      
        <content type="html"><![CDATA[<h2 id="相关配置">相关配置</h2><h3 id="RabbitConfig">RabbitConfig</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RabbitConfig</span> <span class="keyword">implements</span> <span class="title class_">RabbitTemplate</span>.ConfirmCallback, RabbitTemplate.ReturnCallback &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(RabbitConfig.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostConstruct</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">initRabbitTemplate</span><span class="params">()</span> &#123;</span><br><span class="line">        rabbitTemplate.setConfirmCallback(<span class="built_in">this</span>);</span><br><span class="line">        rabbitTemplate.setReturnCallback(<span class="built_in">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">confirm</span><span class="params">(CorrelationData correlationData, <span class="type">boolean</span> ack, String cause)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (ack) &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;&#123;&#125;消息成功到达交换机&quot;</span>,correlationData.getId());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;消息发送到Exchange失败, &#123;&#125;, cause: &#123;&#125;&quot;</span>, correlationData, cause);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">returnedMessage</span><span class="params">(Message message, <span class="type">int</span> replyCode, String replyText, String exchange, String routingKey)</span> &#123;</span><br><span class="line">        logger.error(<span class="string">&quot;消息从Exchange路由到Queue失败: exchange: &#123;&#125;, route: &#123;&#125;, replyCode: &#123;&#125;, replyText: &#123;&#125;, message: &#123;&#125;&quot;</span>, exchange, routingKey, replyCode, replyText, message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="MessageHelper">MessageHelper</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MessageHelper</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Message <span class="title function_">objToMsg</span><span class="params">(Object obj)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == obj) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//System.out.println(JSONUtil.toJsonStr(obj));</span></span><br><span class="line"></span><br><span class="line">        <span class="type">Message</span> <span class="variable">message</span> <span class="operator">=</span> MessageBuilder.withBody(JSONUtil.toJsonStr(obj).getBytes()).build();</span><br><span class="line">        message.getMessageProperties().setDeliveryMode(MessageDeliveryMode.PERSISTENT);<span class="comment">// 消息持久化</span></span><br><span class="line">        message.getMessageProperties().setContentType(MessageProperties.CONTENT_TYPE_JSON);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">msgToObj</span><span class="params">(Message message, Class&lt;T&gt; clazz)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="literal">null</span> == message || <span class="literal">null</span> == clazz) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">String</span>(message.getBody());</span><br><span class="line">        <span class="type">T</span> <span class="variable">obj</span> <span class="operator">=</span> JSONUtil.toBean(str, clazz);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> obj;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="RabbitDirectConfig">RabbitDirectConfig</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RabbitDirectConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">pathUploadQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; arguments = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">2</span>);</span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-exchange&quot;</span>, PathUpLoadDeadMessage.EXCHANGE + APP_KEY);</span><br><span class="line">        <span class="comment">//绑定该队列到死信交换机的队列1</span></span><br><span class="line">        arguments.put(<span class="string">&quot;x-dead-letter-routing-key&quot;</span>, PathUpLoadDeadMessage.ROUTING_KEY + APP_KEY);</span><br><span class="line">        <span class="keyword">return</span> QueueBuilder.durable(PathUpLoadMessage.QUEUE + APP_KEY).withArguments(arguments).build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DirectExchange <span class="title function_">pathUploadExchange</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DirectExchange</span>(PathUpLoadMessage.EXCHANGE + APP_KEY,</span><br><span class="line">                <span class="literal">true</span>,  <span class="comment">// durable: 是否持久化</span></span><br><span class="line">                <span class="literal">false</span>);  <span class="comment">// exclusive: 是否排它</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">pathUploadBinding</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(pathUploadQueue()).to(pathUploadExchange()).with(PathUpLoadMessage.ROUTING_KEY + APP_KEY);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Queue <span class="title function_">pathUploadDeadQueue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Queue</span>(PathUpLoadDeadMessage.QUEUE + APP_KEY, <span class="comment">// Queue 名字</span></span><br><span class="line">                <span class="literal">true</span>, <span class="comment">// durable: 是否持久化</span></span><br><span class="line">                <span class="literal">false</span>, <span class="comment">// exclusive: 是否排它</span></span><br><span class="line">                <span class="literal">false</span>); <span class="comment">// autoDelete: 是否自动删除</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> DirectExchange <span class="title function_">pathUploadDeadExchange</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">DirectExchange</span>(PathUpLoadDeadMessage.EXCHANGE + APP_KEY,</span><br><span class="line">                <span class="literal">true</span>,  <span class="comment">// durable: 是否持久化</span></span><br><span class="line">                <span class="literal">false</span>);  <span class="comment">// exclusive: 是否排它</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> Binding <span class="title function_">pathUploadDeadBinding</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> BindingBuilder.bind(pathUploadDeadQueue()).to(pathUploadDeadExchange())</span><br><span class="line">                .with(PathUpLoadDeadMessage.ROUTING_KEY + APP_KEY);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="pathUpload包">pathUpload包</h2><h3 id="PathUploadConsumer">PathUploadConsumer</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023/9/28 15:00</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@DependsOn(&#123;&quot;appraisalFileRepository&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PathUploadConsumer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">LOG</span> <span class="operator">=</span> LoggerFactory.getLogger(PathUploadConsumer.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PathUploadStrategyContext pathUploadStrategyContext;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@RabbitListener( queues = PathUpLoadMessage.QUEUE + &quot;$&#123;spring.application.name&#125;&quot;, concurrency = &quot;1&quot;)</span></span><br><span class="line">    <span class="meta">@RabbitHandler</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onMessage</span><span class="params">(Message msg, Channel channel, <span class="meta">@Header(AmqpHeaders.DELIVERY_TAG)</span> <span class="type">long</span> deliveryTag)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">PathUpLoadMessage</span> <span class="variable">message</span> <span class="operator">=</span> MessageHelper.msgToObj(msg, PathUpLoadMessage.class);</span><br><span class="line">        DBContextHolder.setDB(message.getTenantId());</span><br><span class="line"></span><br><span class="line">        LOG.info(<span class="string">&quot;接收到文件上传消息--[线程编号:&#123;&#125;]-[文件夹名:&#123;&#125;]&quot;</span>, Thread.currentThread().getId(), <span class="keyword">new</span> <span class="title class_">File</span>(message.getFile()).getName());</span><br><span class="line"></span><br><span class="line">        <span class="type">long</span> <span class="variable">timeStart</span> <span class="operator">=</span> DateUtil.current();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            pathUploadStrategyContext.getFileInferStrategy(message, message.getStrategy());</span><br><span class="line">            <span class="comment">// 只在成功处理后确认消息</span></span><br><span class="line">            channel.basicAck(deliveryTag, <span class="literal">false</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="type">Boolean</span> <span class="variable">redelivered</span> <span class="operator">=</span> msg.getMessageProperties().getRedelivered();</span><br><span class="line">            <span class="keyword">if</span> (redelivered) &#123;</span><br><span class="line">                LOG.info(<span class="string">&quot;异常重试次数已到达设置次数，将发送到死信交换机&quot;</span>);</span><br><span class="line">                channel.basicAck(deliveryTag, <span class="literal">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            LOG.error(<span class="string">&quot;处理异常，准备进行重试：&#123;&#125;&quot;</span>, Thread.currentThread().getId());</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 设置 requeue 参数为 true 以将消息重新放回队列</span></span><br><span class="line">            channel.basicNack(deliveryTag, <span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 暂停一段时间，可根据需要调整</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Thread.sleep(<span class="number">3000</span>); <span class="comment">// 等待 5 秒</span></span><br><span class="line">            &#125; <span class="keyword">catch</span> (InterruptedException interruptedException) &#123;</span><br><span class="line">                Thread.currentThread().interrupt();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span>; <span class="comment">// 返回，以避免在 finally 块中再次确认消息</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">finally</span> &#123;</span><br><span class="line">            DBContextHolder.clearDB();</span><br><span class="line">            LOG.info(<span class="string">&quot;完成路径上传，总耗时：&#123;&#125;s--[线程编号:&#123;&#125;]&quot;</span>, (DateUtil.current() - timeStart) / <span class="number">1000</span>, Thread.currentThread().getId());</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="PathUpLoadDeadMessage">PathUpLoadDeadMessage</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PathUpLoadDeadMessage</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">6106380050056919533L</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE</span> <span class="operator">=</span> <span class="string">&quot;QUEUE_PATH_UPLOAD_DEAD&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;EXCHANGE_PATH_UPLOAD_DEAD&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">ROUTING_KEY</span> <span class="operator">=</span> <span class="string">&quot;ROUTING_KEY_PATH_UPLOAD_DEAD&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String taskId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String tenantId;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String importTaskId;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="PathUpLoadMessage">PathUpLoadMessage</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PathUpLoadMessage</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> -<span class="number">3452912668432655539L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">QUEUE</span> <span class="operator">=</span> <span class="string">&quot;QUEUE_PATH_UPLOAD&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">EXCHANGE</span> <span class="operator">=</span> <span class="string">&quot;EXCHANGE_PATH_UPLOAD&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">ROUTING_KEY</span> <span class="operator">=</span> <span class="string">&quot;ROUTING_KEY_PATH_UPLOAD&quot;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 任务ID</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String taskId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 租户ID</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String tenantId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 文件名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String fileName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 所需合并文件夹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String file;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 所需执行策略</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String strategy;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 是否覆盖</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String overWrite;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="PathUpLoadProducer">PathUpLoadProducer</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@DependsOn(&#123;&quot;rabbitConfig&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PathUpLoadProducer</span> &#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RabbitTemplate rabbitTemplate;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;spring.application.name&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String ROUTING_KEY;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">syncSendPathUpload</span><span class="params">(String tenantId, String taskId, String fileName,String file, String overwrite, String strategy)</span> &#123;</span><br><span class="line">        <span class="type">PathUpLoadMessage</span> <span class="variable">message</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PathUpLoadMessage</span>();</span><br><span class="line">        <span class="type">String</span> <span class="variable">msgId</span> <span class="operator">=</span> UUID.fastUUID().toString();</span><br><span class="line">        <span class="type">CorrelationData</span> <span class="variable">correlationData</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CorrelationData</span>(msgId);</span><br><span class="line">        message.setTaskId(taskId);</span><br><span class="line">        message.setTenantId(tenantId);</span><br><span class="line">        message.setFileName(fileName);</span><br><span class="line">        message.setStrategy(strategy);</span><br><span class="line">        message.setOverWrite(overwrite);</span><br><span class="line">        message.setFile(file);</span><br><span class="line">        <span class="comment">// 消息经过的交换机，通过名称指定，路由键：该路由键回去寻找绑定在交换机上相同路由键的队列</span></span><br><span class="line">        rabbitTemplate.convertAndSend(PathUpLoadMessage.EXCHANGE + ROUTING_KEY,</span><br><span class="line">                PathUpLoadMessage.ROUTING_KEY + ROUTING_KEY,</span><br><span class="line">                MessageHelper.objToMsg(message), correlationData);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 各种类型文件操作 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 消息发送与消费 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>3、策略模式所需代码</title>
      <link href="/posts/1396f9d4.html"/>
      <url>/posts/1396f9d4.html</url>
      
        <content type="html"><![CDATA[<h2 id="1、策略接口上下文">1、策略接口上下文</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PathUploadStrategyContext</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Resource</span></span><br><span class="line">        <span class="keyword">private</span> Map&lt;String, PathUploadStrategy&gt; pathUploadStrategyMap;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getFileInferStrategy</span><span class="params">(PathUpLoadMessage message, String strategy)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">            pathUploadStrategyMap.get(IBaseEnum.getLabelByValue(strategy, PathUploadEnum.class)).upload(message,strategy);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2、策略抽象实现类">2、策略抽象实现类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 服务器路径上传文件</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023/9/28 15:16</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractPathUploadStrategyImpl</span> <span class="keyword">implements</span> <span class="title class_">PathUploadStrategy</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">LOG</span> <span class="operator">=</span> LoggerFactory.getLogger(AbstractPathUploadStrategyImpl.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">upload</span><span class="params">(PathUpLoadMessage message, String strategy)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        LOG.info(<span class="string">&quot;开始执行&#123;&#125;服务器路径上传策略&quot;</span>, strategy);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (exist(message))&#123;</span><br><span class="line"></span><br><span class="line">            LOG.info(<span class="string">&quot;档号为&#123;&#125;的档案已经存在，跳过上传&quot;</span>,message.getFileName());</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        uploadByPath(message, strategy);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 服务器路径上传抽象方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message 队列消息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> strategy 路径上传策略</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 2023/9/28 15:16</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">uploadByPath</span><span class="params">(PathUpLoadMessage message, String strategy)</span> <span class="keyword">throws</span> IOException;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断当前任务是否已经上传抽象方法</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> message 队列消息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * true:已经上传</span></span><br><span class="line"><span class="comment">     * false:未上传</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@since</span> 2023/9/28 15:16</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">abstract</span> <span class="type">boolean</span> <span class="title function_">exist</span><span class="params">(PathUpLoadMessage message)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> List&lt;File&gt; <span class="title function_">getAllPDFFiles</span><span class="params">(File rootFolder, List&lt;String&gt; legalSuffix)</span> &#123;</span><br><span class="line">        List&lt;File&gt; pdfFiles = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (rootFolder.isDirectory()) &#123;</span><br><span class="line">            File[] fileList = rootFolder.listFiles();</span><br><span class="line">            <span class="keyword">if</span> (fileList != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (File file : fileList) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (file.isDirectory()) &#123;</span><br><span class="line">                        pdfFiles.addAll(getAllPDFFiles(file, legalSuffix));</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (file.isFile() &amp;&amp; legalSuffix.contains(getFileExtension(file)) &amp;&amp; !file.getName().startsWith(<span class="string">&quot;._&quot;</span>)) &#123;</span><br><span class="line">                        pdfFiles.add(file);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pdfFiles;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取文件的后缀名</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">getFileExtension</span><span class="params">(File file)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> file.getName();</span><br><span class="line">        <span class="type">int</span> <span class="variable">dotIndex</span> <span class="operator">=</span> fileName.lastIndexOf(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (dotIndex &gt; <span class="number">0</span> &amp;&amp; dotIndex &lt; fileName.length() - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> fileName.substring(dotIndex + <span class="number">1</span>).toLowerCase();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3、策略枚举类">3、策略枚举类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 服务器路径上传策略枚举</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023/9/28 14:32</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">PathUploadEnum</span> <span class="keyword">implements</span> <span class="title class_">IBaseEnum</span>&#123;</span><br><span class="line"></span><br><span class="line">    VOLUME(<span class="string">&quot;案卷合并&quot;</span>, <span class="string">&quot;volumePathUploadStrategy&quot;</span>),</span><br><span class="line"></span><br><span class="line">    PDF(<span class="string">&quot;PDF文件&quot;</span>, <span class="string">&quot;pdfPathUploadStrategy&quot;</span>),</span><br><span class="line"></span><br><span class="line">    IMAGE_TO_PDF(<span class="string">&quot;合并图片文件&quot;</span>,<span class="string">&quot;mergePicturePathUploadStrategy&quot;</span>),</span><br><span class="line"></span><br><span class="line">    OFD(<span class="string">&quot;OFD文件&quot;</span>, <span class="string">&quot;ofdPathUploadStrategy&quot;</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String value;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String label;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getLabel</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.label;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4、实现类">4、实现类</h2><h3 id="1、-OdfPathUploadStrategyImpl">1、 OdfPathUploadStrategyImpl</h3><p><a href="https://pan.baidu.com/s/1sFWT9XHURnQq6Zj3fgzLkw">OFD转PDF工具源码</a></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * OFD文件服务器路径上传</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023/10/10 9:58</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service(&quot;ofdPathUploadStrategy&quot;)</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor(onConstructor = @__(@Autowired))</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OdfPathUploadStrategyImpl</span> <span class="keyword">extends</span> <span class="title class_">AbstractPathUploadStrategyImpl</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">LOG</span> <span class="operator">=</span> LoggerFactory.getLogger(OdfPathUploadStrategyImpl.class);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AppraisalFileRepository appraisalFileRepository;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AppraisalFileService appraisalFileService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> IOssEndPoint ossEndPoint;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">uploadByPath</span><span class="params">(PathUpLoadMessage message, String strategy)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 接收所有包含pdf的文件夹</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(message.getFile());</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">folderName</span> <span class="operator">=</span> file.getName();</span><br><span class="line">        <span class="comment">// 拿到任务ID</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">Long</span> <span class="variable">taskId</span> <span class="operator">=</span> Convert.toLong(message.getTaskId());</span><br><span class="line">        <span class="comment">// 拿到租户ID</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">tenantId</span> <span class="operator">=</span> message.getTenantId();</span><br><span class="line">        <span class="comment">// 是否覆盖</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">Boolean</span> <span class="variable">overWrite</span> <span class="operator">=</span> Convert.toBool(message.getOverWrite());</span><br><span class="line">        LOG.info(<span class="string">&quot;当前进行服务器路径上传OFD的文件夹是&#123;&#125;&quot;</span>, folderName);</span><br><span class="line">        <span class="keyword">final</span> List&lt;File&gt; pdfFiles = getAllPDFFiles(file, List.of(<span class="string">&quot;ofd&quot;</span>));</span><br><span class="line">        <span class="type">long</span> <span class="variable">timeStart</span> <span class="operator">=</span> DateUtil.current();</span><br><span class="line">        <span class="type">long</span> <span class="variable">countStart</span> <span class="operator">=</span> DateUtil.current();</span><br><span class="line">        LOG.info(<span class="string">&quot;开始解析文件夹&#123;&#125;，包含&#123;&#125;个OFD文件&quot;</span>, folderName, pdfFiles.size());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">fileIndex</span> <span class="operator">=</span> <span class="number">0</span>; fileIndex &lt; pdfFiles.size(); fileIndex++) &#123;</span><br><span class="line">            <span class="type">File</span> <span class="variable">ofdFile</span> <span class="operator">=</span> pdfFiles.get(fileIndex);</span><br><span class="line">            <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> ofdFile.getName();</span><br><span class="line">            <span class="comment">// 判断是否覆盖，如果覆盖就删除原文件，否则跳过</span></span><br><span class="line">            List&lt;AppraisalFile&gt; existingFiles = appraisalFileRepository.findByTaskIdAndFileName(taskId, fileName);</span><br><span class="line">            <span class="keyword">if</span> (!existingFiles.isEmpty()) &#123;</span><br><span class="line">                <span class="keyword">if</span> (overWrite) &#123;</span><br><span class="line">                    List&lt;Long&gt; existingIds = existingFiles.stream().map(AppraisalFile::getId).collect(Collectors.toList());</span><br><span class="line">                    appraisalFileService.deleteExistingFiles(existingIds);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    LOG.info(<span class="string">&quot;已存在的文件将被跳过: &#123;&#125;&quot;</span>, fileName);</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Attach</span> <span class="variable">ofdAttach</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// 使用第一个 FileInputStream</span></span><br><span class="line">                <span class="keyword">try</span> (<span class="type">FileInputStream</span> <span class="variable">fileInputStream1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(ofdFile)) &#123;</span><br><span class="line">                    ofdAttach  = ossEndPoint.putAttachWithTenant(</span><br><span class="line">                            <span class="keyword">new</span> <span class="title class_">InMemoryMultipartFile</span>(fileName, fileInputStream1),</span><br><span class="line">                            tenantId</span><br><span class="line">                    ).getData();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 使用第二个 FileInputStream</span></span><br><span class="line">                <span class="keyword">try</span> (<span class="type">FileInputStream</span> <span class="variable">fileInputStream2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(ofdFile)) &#123;</span><br><span class="line">                    <span class="type">ByteArrayOutputStream</span> <span class="variable">stream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">                    ConvertHelper.toPdf(fileInputStream2, stream);</span><br><span class="line">                    <span class="type">Attach</span> <span class="variable">pdfAttach</span> <span class="operator">=</span> ossEndPoint.putAttach(<span class="keyword">new</span> <span class="title class_">InMemoryMultipartFile</span>(IdUtil.randomUUID() + <span class="string">&quot;.pdf&quot;</span>, stream.toByteArray())</span><br><span class="line">                    ).getData();</span><br><span class="line"></span><br><span class="line">                    <span class="type">AppraisalFile</span> <span class="variable">appraisalFile</span> <span class="operator">=</span> appraisalFileService.createAppraisalFile(taskId, fileName, pdfAttach);</span><br><span class="line">                    appraisalFile.setOfdAttach(ofdAttach.getId());</span><br><span class="line">                    appraisalFile.setFileType(InferFileType.OFD);</span><br><span class="line">                    appraisalFileRepository.save(appraisalFile);</span><br><span class="line"></span><br><span class="line">                    LOG.info(<span class="string">&quot;上传OFD成功所在文件夹名称&#123;&#125; - 当前进度: &#123;&#125;/&#123;&#125;，文件名: &#123;&#125;，共已耗时: &#123;&#125;s&quot;</span>,file.getName(),</span><br><span class="line">                            fileIndex+<span class="number">1</span>, pdfFiles.size(), fileName, (DateUtil.current() - timeStart) / <span class="number">1000.0</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                LOG.error(<span class="string">&quot;上传文件发生异常: &#123;&#125;&quot;</span>, e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        LOG.info(<span class="string">&quot;上传OFD成功 - 总文件数: &#123;&#125;，耗时: &#123;&#125;s&quot;</span>, pdfFiles.size(), (DateUtil.current() - countStart) / <span class="number">1000.0</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">exist</span><span class="params">(PathUpLoadMessage message)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Boolean.FALSE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2、VolumePathUploadStrategyImpl">2、VolumePathUploadStrategyImpl</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 案卷合并服务器路径上传策略</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023/9/28 16:13</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service(&quot;volumePathUploadStrategy&quot;)</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor(onConstructor = @__(@Autowired))</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">VolumePathUploadStrategyImpl</span> <span class="keyword">extends</span> <span class="title class_">AbstractPathUploadStrategyImpl</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">LOG</span> <span class="operator">=</span> LoggerFactory.getLogger(VolumePathUploadStrategyImpl.class);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AppraisalFileRepository appraisalFileRepository;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AppraisalFileService appraisalFileService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> IOssEndPoint ossEndPoint;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">uploadByPath</span><span class="params">(PathUpLoadMessage message, String strategy)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">File</span> <span class="variable">uploadFileFolder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(message.getFile());</span><br><span class="line">        <span class="keyword">final</span> <span class="type">Long</span> <span class="variable">taskId</span> <span class="operator">=</span> Convert.toLong(message.getTaskId());</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">tenantId</span> <span class="operator">=</span> message.getTenantId();</span><br><span class="line">        <span class="keyword">final</span> <span class="type">Boolean</span> <span class="variable">overWrite</span> <span class="operator">=</span> Convert.toBool(message.getOverWrite());</span><br><span class="line"></span><br><span class="line">        File[] imageFiles = uploadFileFolder.listFiles();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建一个Map来存储文件名前缀和相应的文件列表</span></span><br><span class="line">        Map&lt;String, List&lt;File&gt;&gt; groupedFiles = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (File imageFile : imageFiles) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> imageFile.getName();</span><br><span class="line">            <span class="type">String</span> <span class="variable">prefix</span> <span class="operator">=</span> name.substring(<span class="number">0</span>, name.lastIndexOf(<span class="string">&#x27;-&#x27;</span>)); <span class="comment">// 假设前缀是直到最后一个&#x27;-&#x27;符号</span></span><br><span class="line">            groupedFiles.computeIfAbsent(prefix, k -&gt; <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;()).add(imageFile);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        LOG.info(<span class="string">&quot;开始处理文件夹名称为&#123;&#125;的文件夹，里边最终会合并成&#123;&#125;个文件&quot;</span>,uploadFileFolder.getName(),groupedFiles.size());</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">pdfNum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, List&lt;File&gt;&gt; entry : groupedFiles.entrySet()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">prefix</span> <span class="operator">=</span> entry.getKey();</span><br><span class="line">            List&lt;File&gt; filesInGroup = entry.getValue();</span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">folderName</span> <span class="operator">=</span> prefix;  <span class="comment">// 你可以根据需要修改</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> folderName + <span class="string">&quot;.pdf&quot;</span>;</span><br><span class="line">            <span class="comment">//pathUpLoadProducer.syncSendPathUpload(tenantId,Convert.toStr(taskId),fileName,Convert.toStr(uploadFileFolder),Convert.toStr(overWrite),PathUploadType.PDF);</span></span><br><span class="line">            <span class="comment">// 判断是否覆盖已存在的文件</span></span><br><span class="line">            List&lt;AppraisalFile&gt; existingFiles = appraisalFileRepository.findByTaskIdAndFileName(taskId, fileName);</span><br><span class="line">            <span class="keyword">if</span> (existingFiles.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (overWrite) &#123;</span><br><span class="line">                    List&lt;Long&gt; existingFileIds = existingFiles.stream().map(AppraisalFile::getId).collect(Collectors.toList());</span><br><span class="line">                    appraisalFileService.deleteExistingFiles(existingFileIds);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    LOG.info(<span class="string">&quot;跳过已存在的文件&quot;</span>);</span><br><span class="line">                    pdfNum++;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            List&lt;<span class="type">byte</span>[]&gt; images = filesInGroup.stream()</span><br><span class="line">                    .filter(File::isFile)</span><br><span class="line">                    .map(imageFile -&gt; &#123;</span><br><span class="line">                        <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(imageFile)) &#123;</span><br><span class="line">                            <span class="keyword">return</span> IOUtils.toByteArray(fileInputStream);</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .filter(Objects::nonNull)</span><br><span class="line">                    .collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (images.isEmpty()) &#123;</span><br><span class="line">                pdfNum++;</span><br><span class="line">                LOG.info(<span class="string">&quot;跳过空文件夹&quot;</span>);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">final</span> <span class="type">byte</span>[] bytes = appraisalFileService.convertToPdf(images);</span><br><span class="line"></span><br><span class="line">            <span class="type">byte</span>[] modifiedPdfData= <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">try</span> (<span class="type">PDDocument</span> <span class="variable">document</span> <span class="operator">=</span> PDDocument.load(bytes)) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">lastPageNumber</span> <span class="operator">=</span> document.getNumberOfPages();</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 删除最后一页</span></span><br><span class="line">                document.removePage(lastPageNumber - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 保存修改后的PDF</span></span><br><span class="line">                <span class="type">ByteArrayOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">                document.save(outputStream);</span><br><span class="line">                modifiedPdfData = outputStream.toByteArray();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                <span class="comment">// 处理PDF操作异常</span></span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Attach</span> <span class="variable">pdfAttach</span> <span class="operator">=</span> ossEndPoint.putAttachWithTenant(</span><br><span class="line">                    <span class="keyword">new</span> <span class="title class_">InMemoryMultipartFile</span>(fileName, <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(modifiedPdfData)),</span><br><span class="line">                    tenantId</span><br><span class="line">            ).getData();</span><br><span class="line"></span><br><span class="line">            <span class="type">AppraisalFile</span> <span class="variable">appraisalFile</span> <span class="operator">=</span> appraisalFileService.createAppraisalFile(taskId, fileName, pdfAttach);</span><br><span class="line">            appraisalFileRepository.save(appraisalFile);</span><br><span class="line"></span><br><span class="line">            pdfNum++;</span><br><span class="line">            LOG.info(<span class="string">&quot;合并处理文件夹名称为&#123;&#125;的PDF成功，当前进度：&#123;&#125;/&#123;&#125;，当前文件名：&#123;&#125;，共&#123;&#125;页&quot;</span>,</span><br><span class="line">                    folderName,  pdfNum, groupedFiles.size(), folderName, images.size());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">exist</span><span class="params">(PathUpLoadMessage message)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Boolean.FALSE;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3、MergePicturePathUploadStrategyImpl">3、MergePicturePathUploadStrategyImpl</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 合并图片文件服务器路径上传策略</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023/10/7 16:32</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service(&quot;mergePicturePathUploadStrategy&quot;)</span></span><br><span class="line"><span class="meta">@RequiredArgsConstructor(onConstructor = @__(@Autowired))</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MergePicturePathUploadStrategyImpl</span> <span class="keyword">extends</span> <span class="title class_">AbstractPathUploadStrategyImpl</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Logger</span> <span class="variable">LOG</span> <span class="operator">=</span> LoggerFactory.getLogger(MergePicturePathUploadStrategyImpl.class);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AppraisalFileRepository appraisalFileRepository;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> AppraisalFileService appraisalFileService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> IOssEndPoint ossEndPoint;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">uploadByPath</span><span class="params">(PathUpLoadMessage message, String strategy)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 接收所有包含pdf的文件夹</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(message.getFile());</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">folderName</span> <span class="operator">=</span> file.getName();</span><br><span class="line">        <span class="comment">// 拿到任务ID</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">Long</span> <span class="variable">taskId</span> <span class="operator">=</span> Convert.toLong(message.getTaskId());</span><br><span class="line">        <span class="comment">// 拿到租户ID</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">tenantId</span> <span class="operator">=</span> message.getTenantId();</span><br><span class="line">        <span class="comment">// 是否覆盖</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">Boolean</span> <span class="variable">overWrite</span> <span class="operator">=</span> Convert.toBool(message.getOverWrite());</span><br><span class="line">        LOG.info(<span class="string">&quot;当前进行服务器路径上传进行合并图片文件的文件夹是&#123;&#125;&quot;</span>, folderName);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> File[] imageFiles = file.listFiles();</span><br><span class="line">        <span class="keyword">if</span> (ObjectUtil.isNotEmpty(imageFiles)) &#123;</span><br><span class="line">            Arrays.sort(imageFiles, Comparator.comparing(File::getName));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> folderName + <span class="string">&quot;.pdf&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 判断是否覆盖已存在的文件</span></span><br><span class="line">        List&lt;AppraisalFile&gt; existingFiles = appraisalFileRepository.findByTaskIdAndFileName(taskId, fileName);</span><br><span class="line">        <span class="keyword">if</span> (!existingFiles.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (overWrite) &#123;</span><br><span class="line">                List&lt;Long&gt; existingFileIds = existingFiles.stream().map(AppraisalFile::getId).collect(Collectors.toList());</span><br><span class="line">                appraisalFileService.deleteExistingFiles(existingFileIds);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                LOG.info(<span class="string">&quot;跳过已存在的文件&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (ObjectUtil.isNotEmpty(imageFiles)) &#123;</span><br><span class="line">            Arrays.sort(imageFiles, Comparator.comparing(File::getName));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        List&lt;<span class="type">byte</span>[]&gt; images = Arrays.stream(imageFiles)</span><br><span class="line">                .filter(File::isFile)</span><br><span class="line">                .map(imageFile -&gt; &#123;</span><br><span class="line">                    <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(imageFile)) &#123;</span><br><span class="line">                        <span class="keyword">return</span> IOUtils.toByteArray(fileInputStream);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .filter(Objects::nonNull)</span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (images.isEmpty()) &#123;</span><br><span class="line"></span><br><span class="line">            LOG.info(<span class="string">&quot;跳过空文件夹&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">byte</span>[] bytes = appraisalFileService.convertToPdf(images);</span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[] modifiedPdfData= <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">PDDocument</span> <span class="variable">document</span> <span class="operator">=</span> PDDocument.load(bytes)) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">lastPageNumber</span> <span class="operator">=</span> document.getNumberOfPages();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 删除最后一页</span></span><br><span class="line">            document.removePage(lastPageNumber - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 保存修改后的PDF</span></span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            document.save(outputStream);</span><br><span class="line">            modifiedPdfData = outputStream.toByteArray();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// 处理PDF操作异常</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Attach</span> <span class="variable">pdfAttach</span> <span class="operator">=</span> ossEndPoint.putAttachWithTenant(</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InMemoryMultipartFile</span>(fileName, <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(modifiedPdfData)),</span><br><span class="line">                tenantId</span><br><span class="line">        ).getData();</span><br><span class="line"></span><br><span class="line">        <span class="type">AppraisalFile</span> <span class="variable">appraisalFile</span> <span class="operator">=</span> appraisalFileService.createAppraisalFile(taskId, fileName, pdfAttach);</span><br><span class="line">        appraisalFileRepository.save(appraisalFile);</span><br><span class="line"></span><br><span class="line">        LOG.info(<span class="string">&quot;当前文件夹名称为&#123;&#125;,当前文件名：&#123;&#125;，共&#123;&#125;页&quot;</span>, folderName ,fileName, images.size());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">exist</span><span class="params">(PathUpLoadMessage message)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Boolean.FALSE;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 各种类型文件操作 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 设计模式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>字体打包进容器(用于OFD文件)</title>
      <link href="/posts/81a06a9b.html"/>
      <url>/posts/81a06a9b.html</url>
      
        <content type="html"><![CDATA[<div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='0.5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>字体打包进容器(用于OFD文件)</p></div></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">首先将fonts解压出来，把解压后的文件夹放到/usr/share/fonts/win目录下</span><br><span class="line">cd /usr/share/fonts</span><br><span class="line">docker cp win ai-sensitive-x:/usr/share/fonts/win</span><br><span class="line">docker restart ai-sensitive-x</span><br></pre></td></tr></table></figure><p><a href="https://pan.baidu.com/s/1De3VRUQ1yJtpQL4tIBaR4g">字体的百度网盘链接</a></p><blockquote><ol><li>首先从链接中下载所有的字体然后解压到宿主机的/usr/share/fonts/win目录下</li><li>然后进入到fonts目录下  (cd /usr/share/fonts)</li><li>然后将所有的字体放到容器的指定目录中 (docker cp win ai-sensitive-x:/usr/share/fonts/win)</li><li>执行完之后重启服务就可以了</li></ol></blockquote>]]></content>
      
      
      <categories>
          
          <category> 各种类型文件操作 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 字体相关 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>X、工具类</title>
      <link href="/posts/163b33dd.html"/>
      <url>/posts/163b33dd.html</url>
      
        <content type="html"><![CDATA[<h2 id="PicUtil（文件压缩工具类）">PicUtil（文件压缩工具类）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 文件压缩工具类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PicUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] compressPictureForScale(String srcPath, <span class="type">long</span> desFileSize, <span class="type">double</span> accuracy) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isEmpty(srcPath)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">File</span> <span class="variable">srcFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(srcPath);</span><br><span class="line">        <span class="keyword">if</span> (!srcFile.exists()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">formatName</span> <span class="operator">=</span> FilenameUtils.getExtension(srcPath);</span><br><span class="line">        BufferedImage image;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">srcFileSize</span> <span class="operator">=</span> srcFile.length();</span><br><span class="line">            System.out.println(<span class="string">&quot;源图片: &quot;</span> + srcPath + <span class="string">&quot;, 大小: &quot;</span> + srcFileSize / <span class="number">1024</span> + <span class="string">&quot;kb&quot;</span>);</span><br><span class="line"></span><br><span class="line">            image = Thumbnails.of(srcPath).scale(<span class="number">1f</span>).asBufferedImage();</span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">byteArrayOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            compressPicCycle(image, desFileSize, accuracy, formatName, byteArrayOutputStream);</span><br><span class="line">            image.getGraphics().dispose();</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;图片压缩完成!&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">byte</span>[] byteArray = byteArrayOutputStream.toByteArray();</span><br><span class="line">            System.out.println(<span class="string">&quot;源图片压缩后为: &quot;</span> + srcPath + <span class="string">&quot;, 大小: &quot;</span> + byteArray.length / <span class="number">1024</span> + <span class="string">&quot;kb&quot;</span>);</span><br><span class="line">            byteArrayOutputStream.close();</span><br><span class="line">            <span class="keyword">return</span> byteArray;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">compressPicCycle</span><span class="params">(BufferedImage desImage, <span class="type">long</span> desFileSize, <span class="type">double</span> accuracy, String formatName, ByteArrayOutputStream byteArrayOutputStream)</span> <span class="keyword">throws</span> IOException, IOException &#123;</span><br><span class="line">        byteArrayOutputStream.reset();</span><br><span class="line">        ImageIO.write(desImage, formatName, byteArrayOutputStream);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = byteArrayOutputStream.toByteArray();</span><br><span class="line">        <span class="keyword">if</span> (byteArray.length / <span class="number">1024</span> &gt; desFileSize) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">srcWidth</span> <span class="operator">=</span> desImage.getWidth();</span><br><span class="line">            <span class="type">int</span> <span class="variable">srcHeight</span> <span class="operator">=</span> desImage.getHeight();</span><br><span class="line">            <span class="type">int</span> <span class="variable">destWidth</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(srcWidth).multiply(<span class="keyword">new</span> <span class="title class_">BigDecimal</span>(accuracy)).intValue();</span><br><span class="line">            <span class="type">int</span> <span class="variable">destHeight</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(srcHeight).multiply(<span class="keyword">new</span> <span class="title class_">BigDecimal</span>(accuracy)).intValue();</span><br><span class="line">            <span class="type">BufferedImage</span> <span class="variable">image</span> <span class="operator">=</span> Thumbnails.of(desImage).size(destWidth, destHeight).outputQuality(accuracy).asBufferedImage();</span><br><span class="line">            compressPicCycle(image, desFileSize, accuracy, formatName, byteArrayOutputStream);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="IBaseEnum（通用枚举接口）">IBaseEnum（通用枚举接口）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023/9/28 14:40</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IBaseEnum</span> &#123;</span><br><span class="line"></span><br><span class="line">    Object <span class="title function_">getValue</span><span class="params">()</span>;</span><br><span class="line">    String <span class="title function_">getLabel</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取与给定值匹配的枚举常量。</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;E&gt;    继承自Enum并且实现IBaseEnum的泛型</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value  要查找的值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> clazz  枚举类的Class对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>       与给定值匹配的枚举常量，如果没有找到则返回null</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NullPointerException 如果提供的值为null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> &lt;E <span class="keyword">extends</span> <span class="title class_">Enum</span>&lt;E&gt; &amp; IBaseEnum&gt; E <span class="title function_">getEnumByValue</span><span class="params">(Object value, Class&lt;E&gt; clazz)</span> &#123;</span><br><span class="line">        Objects.requireNonNull(value);</span><br><span class="line">        EnumSet&lt;E&gt; allEnums = EnumSet.allOf(clazz);</span><br><span class="line">        <span class="keyword">return</span> allEnums.stream().filter(e -&gt; value.equals(e.getValue())).findFirst().orElse(<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过给定的值获取枚举常量的标签。</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;E&gt;    继承自Enum并且实现IBaseEnum的泛型</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value  要查找的值</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> clazz  枚举类的Class对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>       与给定值匹配的枚举标签，如果没有找到则返回null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> &lt;E <span class="keyword">extends</span> <span class="title class_">Enum</span>&lt;E&gt; &amp; IBaseEnum&gt; String <span class="title function_">getLabelByValue</span><span class="params">(Object value, Class&lt;E&gt; clazz)</span> &#123;</span><br><span class="line">        <span class="type">E</span> <span class="variable">matchEnum</span> <span class="operator">=</span> getEnumByValue(value, clazz);</span><br><span class="line">        <span class="type">String</span> <span class="variable">label</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (Objects.nonNull(matchEnum)) &#123;</span><br><span class="line">            label = matchEnum.getLabel();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> label;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过给定的标签获取匹配的枚举常量。</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;E&gt;    继承自Enum并且实现IBaseEnum的泛型</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> label  要查找的标签</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> clazz  枚举类的Class对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span>       与给定标签匹配的枚举常量，如果没有找到则返回null</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NullPointerException 如果提供的标签为null</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> &lt;E <span class="keyword">extends</span> <span class="title class_">Enum</span>&lt;E&gt; &amp; IBaseEnum&gt; E <span class="title function_">getEnumByLabel</span><span class="params">(String label, Class&lt;E&gt; clazz)</span> &#123;</span><br><span class="line">        Objects.requireNonNull(label);</span><br><span class="line">        EnumSet&lt;E&gt; allEnums = EnumSet.allOf(clazz);</span><br><span class="line">        Optional&lt;E&gt; match = allEnums.stream().filter(e -&gt; label.equals(e.getLabel())).findFirst();</span><br><span class="line">        <span class="keyword">return</span> match.orElse(<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="TextValidator（正则工具类）">TextValidator（正则工具类）</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 通过正则表达判断是否正确的手机号，固定电话，身份证，邮箱等.</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 从AndroidUtilCode的RegexUtils移植, 性能优化将正则表达式为预编译, 并修改了TEL的正则表达式.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TextValidator</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 正则：手机号（简单）, 1字头＋10位数字即可.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">REGEX_MOBILE_SIMPLE</span> <span class="operator">=</span> <span class="string">&quot;^[1]\\d&#123;10&#125;$&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Pattern</span> <span class="variable">PATTERN_REGEX_MOBILE_SIMPLE</span> <span class="operator">=</span> Pattern.compile(REGEX_MOBILE_SIMPLE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 正则：手机号（精确）, 已知3位前缀＋8位数字</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 移动：134(0-8)、135、136、137、138、139、147、150、151、152、157、158、159、178、182、183、184、187、188</span></span><br><span class="line"><span class="comment">     * &lt;/p&gt;</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 联通：130、131、132、145、155、156、175、176、185、186</span></span><br><span class="line"><span class="comment">     * &lt;/p&gt;</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 电信：133、153、173、177、180、181、189</span></span><br><span class="line"><span class="comment">     * &lt;/p&gt;</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 全球星：1349</span></span><br><span class="line"><span class="comment">     * &lt;/p&gt;</span></span><br><span class="line"><span class="comment">     * &lt;p&gt;</span></span><br><span class="line"><span class="comment">     * 虚拟运营商：170</span></span><br><span class="line"><span class="comment">     * &lt;/p&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">REGEX_MOBILE_EXACT</span> <span class="operator">=</span> <span class="string">&quot;^((13[0-9])|(14[5,7])|(15[0-3,5-9])|(17[0,3,5-8])|(18[0-9])|(147))\\d&#123;8&#125;$&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Pattern</span> <span class="variable">PATTERN_REGEX_MOBILE_EXACT</span> <span class="operator">=</span> Pattern.compile(REGEX_MOBILE_EXACT);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 正则：固定电话号码，可带区号，然后6至少8位数字</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">REGEX_TEL</span> <span class="operator">=</span> <span class="string">&quot;^(\\d&#123;3,4&#125;-)?\\d&#123;6,8&#125;$&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Pattern</span> <span class="variable">PATTERN_REGEX_TEL</span> <span class="operator">=</span> Pattern.compile(REGEX_TEL);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 正则：身份证号码15位, 数字且关于生日的部分必须正确</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">REGEX_ID_CARD15</span> <span class="operator">=</span> <span class="string">&quot;^[1-9]\\d&#123;7&#125;((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d&#123;3&#125;$&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Pattern</span> <span class="variable">PATTERN_REGEX_ID_CARD15</span> <span class="operator">=</span> Pattern.compile(REGEX_ID_CARD15);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 正则：身份证号码18位, 数字且关于生日的部分必须正确</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">REGEX_ID_CARD18</span> <span class="operator">=</span> <span class="string">&quot;^[1-9]\\d&#123;5&#125;[1-9]\\d&#123;3&#125;((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d&#123;3&#125;([0-9Xx])$&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Pattern</span> <span class="variable">PATTERN_REGEX_ID_CARD18</span> <span class="operator">=</span> Pattern.compile(REGEX_ID_CARD18);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 正则：邮箱, 有效字符(不支持中文), 且中间必须有@，后半部分必须有.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">REGEX_EMAIL</span> <span class="operator">=</span> <span class="string">&quot;^\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Pattern</span> <span class="variable">PATTERN_REGEX_EMAIL</span> <span class="operator">=</span> Pattern.compile(REGEX_EMAIL);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 正则：URL, 必须有&quot;://&quot;,前面必须是英文，后面不能有空格</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">REGEX_URL</span> <span class="operator">=</span> <span class="string">&quot;[a-zA-z]+://[^\\s]*&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Pattern</span> <span class="variable">PATTERN_REGEX_URL</span> <span class="operator">=</span> Pattern.compile(REGEX_URL);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 正则：yyyy-MM-dd格式的日期校验，已考虑平闰年</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">REGEX_DATE</span> <span class="operator">=</span> <span class="string">&quot;^(?:(?!0000)[0-9]&#123;4&#125;-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[0-9]&#123;2&#125;(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)-02-29)$&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Pattern</span> <span class="variable">PATTERN_REGEX_DATE</span> <span class="operator">=</span> Pattern.compile(REGEX_DATE);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 正则：IP地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">REGEX_IP</span> <span class="operator">=</span> <span class="string">&quot;((2[0-4]\\d|25[0-5]|[01]?\\d\\d?)\\.)&#123;3&#125;(2[0-4]\\d|25[0-5]|[01]?\\d\\d?)&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Pattern</span> <span class="variable">PATTERN_REGEX_IP</span> <span class="operator">=</span> Pattern.compile(REGEX_IP);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/////////////////</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证手机号（简单）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isMobileSimple</span><span class="params">(CharSequence input)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isMatch(PATTERN_REGEX_MOBILE_SIMPLE, input);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证手机号（精确）</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isMobileExact</span><span class="params">(CharSequence input)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isMatch(PATTERN_REGEX_MOBILE_EXACT, input);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证固定电话号码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isTel</span><span class="params">(CharSequence input)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isMatch(PATTERN_REGEX_TEL, input);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证15或18位身份证号码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isIdCard</span><span class="params">(CharSequence input)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isMatch(PATTERN_REGEX_ID_CARD15, input) || isMatch(PATTERN_REGEX_ID_CARD18, input);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证邮箱</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isEmail</span><span class="params">(CharSequence input)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isMatch(PATTERN_REGEX_EMAIL, input);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证URL</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isUrl</span><span class="params">(CharSequence input)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isMatch(PATTERN_REGEX_URL, input);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证yyyy-MM-dd格式的日期校验，已考虑平闰年</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isDate</span><span class="params">(CharSequence input)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isMatch(PATTERN_REGEX_DATE, input);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 验证IP地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isIp</span><span class="params">(CharSequence input)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> isMatch(PATTERN_REGEX_IP, input);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">isMatch</span><span class="params">(Pattern pattern, CharSequence input)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> StringUtils.isNotEmpty(input) &amp;&amp; pattern.matcher(input).matches();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="DirectoryScanner（文件扫描工具类）"><strong>DirectoryScanner（文件扫描工具类）</strong></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 文件扫描工具类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DirectoryScanner</span> &#123;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 递归地遍历指定的文件夹及其所有子文件夹，查找包含具有合法后缀名的图片文件的文件夹。</span></span><br><span class="line"><span class="comment"> * 找到这样的文件夹后，将其添加到给定的fileFolders列表中。</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> folder       要开始遍历的根文件夹。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> fileFolders  用于存储包含合法图片的文件夹的列表。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> legalSuffix  合法图片文件后缀名的列表。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">getFileFoldersWithImages</span><span class="params">(File folder, List&lt;File&gt; fileFolders, List&lt;String&gt; legalSuffix)</span> &#123;</span><br><span class="line">    File[] subFiles = folder.listFiles();</span><br><span class="line">    <span class="keyword">if</span> (subFiles != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">containsValidImage</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (File subFile : subFiles) &#123;</span><br><span class="line">            <span class="keyword">if</span> (subFile.isFile() &amp;&amp; legalSuffix.contains(FileUtil.getSuffix(subFile).toLowerCase())) &#123;</span><br><span class="line">                containsValidImage = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (containsValidImage) &#123;</span><br><span class="line">            fileFolders.add(folder);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (File subFolder : subFiles) &#123;</span><br><span class="line">            <span class="keyword">if</span> (subFolder.isDirectory()) &#123;</span><br><span class="line">                getFileFoldersWithImages(subFolder, fileFolders, legalSuffix);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 递归遍历给定目录及其子目录，找出包含指定后缀名（通常为PDF）的文件夹。</span></span><br><span class="line"><span class="comment"> * 将这些包含有符合后缀名条件的文件的文件夹添加到fileFolders列表中。</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> directoryPath 待遍历的目录路径。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> fileFolders   存储包含有特定后缀名文件的文件夹的列表。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> legalSuffix   有效的文件后缀名列表。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">getFoldersWithPDFFiles</span><span class="params">(String directoryPath, List&lt;File&gt; fileFolders, List&lt;String&gt; legalSuffix)</span> &#123;</span><br><span class="line">    <span class="type">File</span> <span class="variable">rootFolder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(directoryPath);</span><br><span class="line">    <span class="keyword">if</span> (rootFolder.isDirectory()) &#123;</span><br><span class="line">        File[] fileList = rootFolder.listFiles();</span><br><span class="line">        <span class="keyword">if</span> (fileList != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (File file : fileList) &#123;</span><br><span class="line">                <span class="keyword">if</span> (file.isDirectory()) &#123;</span><br><span class="line">                    <span class="comment">// 递归处理子目录</span></span><br><span class="line">                    getFoldersWithPDFFiles(file.getAbsolutePath(), fileFolders, legalSuffix);</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (file.isFile() &amp;&amp; legalSuffix.contains(getFileExtension(file))) &#123;</span><br><span class="line">                    <span class="comment">// 当前文件是PDF文件，将其父目录加入待解析目录列表</span></span><br><span class="line">                    <span class="type">File</span> <span class="variable">parentFolder</span> <span class="operator">=</span> file.getParentFile();</span><br><span class="line">                    <span class="keyword">if</span> (!fileFolders.contains(parentFolder)) &#123;</span><br><span class="line">                        fileFolders.add(parentFolder);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">static</span> List&lt;File&gt; <span class="title function_">getAllPDFFiles</span><span class="params">(File rootFolder, List&lt;String&gt; legalSuffix)</span> &#123;</span><br><span class="line">        List&lt;File&gt; pdfFiles = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">if</span> (rootFolder.isDirectory()) &#123;</span><br><span class="line">            File[] fileList = rootFolder.listFiles();</span><br><span class="line">            <span class="keyword">if</span> (fileList != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (File file : fileList) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (file.isDirectory()) &#123;</span><br><span class="line">                        pdfFiles.addAll(getAllPDFFiles(file, legalSuffix));</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (file.isFile() &amp;&amp; legalSuffix.contains(getFileExtension(file)) &amp;&amp; !file.getName().startsWith(<span class="string">&quot;._&quot;</span>)) &#123;</span><br><span class="line">                        pdfFiles.add(file);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pdfFiles;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ConvertToPDF-各种类型文件转换PDF">ConvertToPDF(各种类型文件转换PDF)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">byte</span>[] convertToPdf(List&lt;<span class="type">byte</span>[]&gt; files) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// calculate mime type in advance</span></span><br><span class="line">        <span class="type">Tika</span> <span class="variable">tika</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Tika</span>();</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; mimeTypes = files.stream().map(fileData -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> (<span class="type">TikaInputStream</span> <span class="variable">tikaStream</span> <span class="operator">=</span> TikaInputStream.get(fileData)) &#123;</span><br><span class="line">                <span class="keyword">return</span> tika.detect(tikaStream);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (mimeTypes.stream().noneMatch(mimeType -&gt; mimeType != <span class="literal">null</span> &amp;&amp; mimeType.toLowerCase().contains(<span class="string">&quot;pdf&quot;</span>))) &#123;</span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">finalOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            <span class="type">PdfWriter</span> <span class="variable">finalWriter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PdfWriter</span>(finalOutputStream);</span><br><span class="line">            <span class="type">PdfDocument</span> <span class="variable">finalPdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PdfDocument</span>(finalWriter);</span><br><span class="line">            <span class="type">Document</span> <span class="variable">finalDocument</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Document</span>(finalPdf);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; files.size(); i++) &#123;</span><br><span class="line">                <span class="type">byte</span>[] fileData = files.get(i);</span><br><span class="line">                <span class="type">String</span> <span class="variable">mimeType</span> <span class="operator">=</span> mimeTypes.get(i);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(fileData)) &#123;</span><br><span class="line">                     <span class="keyword">if</span> (mimeType != <span class="literal">null</span> &amp;&amp; (mimeType.toLowerCase().contains(<span class="string">&quot;png&quot;</span>)</span><br><span class="line">                            || mimeType.toLowerCase().contains(<span class="string">&quot;jpg&quot;</span>) || mimeType.toLowerCase().contains(<span class="string">&quot;jpeg&quot;</span>))) &#123;</span><br><span class="line">                        com.itextpdf.io.image.<span class="type">ImageData</span> <span class="variable">imageData</span> <span class="operator">=</span> ImageDataFactory.create(changeDPI(fileData));</span><br><span class="line">                        <span class="type">Image</span> <span class="variable">image</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Image</span>(imageData);</span><br><span class="line">                        <span class="type">PageSize</span> <span class="variable">pageSize</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PageSize</span>(image.getImageWidth(), image.getImageHeight());</span><br><span class="line">                        finalDocument.getPdfDocument().addNewPage(pageSize);</span><br><span class="line">                        <span class="comment">// 使用已有的布局器，并将页面边距设置为0</span></span><br><span class="line">                        finalDocument.setMargins(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">                        <span class="comment">// 将图像添加到已有的布局器</span></span><br><span class="line">                        finalDocument.add(image);</span><br><span class="line">                        <span class="keyword">if</span> (i == files.size() - <span class="number">1</span>) &#123;</span><br><span class="line">                            finalDocument.add(<span class="keyword">new</span> <span class="title class_">AreaBreak</span>(AreaBreakType.NEXT_PAGE));</span><br><span class="line">                            finalDocument.close();</span><br><span class="line">                            <span class="keyword">return</span> finalOutputStream.toByteArray();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mimeType != <span class="literal">null</span> &amp;&amp; (mimeType.toLowerCase().contains(<span class="string">&quot;tiff&quot;</span>) || mimeType.toLowerCase().contains(<span class="string">&quot;tif&quot;</span>))) &#123;</span><br><span class="line">                        <span class="keyword">try</span> (<span class="type">ImageInputStream</span> <span class="variable">imageInputStream</span> <span class="operator">=</span> ImageIO.createImageInputStream(inputStream)) &#123;</span><br><span class="line">                            Iterator&lt;ImageReader&gt; imageReaders = ImageIO.getImageReaders(imageInputStream);</span><br><span class="line">                            <span class="keyword">if</span> (imageReaders.hasNext()) &#123;</span><br><span class="line">                                <span class="type">ImageReader</span> <span class="variable">reader</span> <span class="operator">=</span> imageReaders.next();</span><br><span class="line">                                reader.setInput(imageInputStream);</span><br><span class="line">                                <span class="type">int</span> <span class="variable">pageCount</span> <span class="operator">=</span> reader.getNumImages(<span class="literal">true</span>);</span><br><span class="line">                                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>; k &lt; pageCount; k++) &#123;</span><br><span class="line">                                    <span class="type">BufferedImage</span> <span class="variable">page</span> <span class="operator">=</span> reader.read(k);</span><br><span class="line">                                    <span class="keyword">try</span> (<span class="type">ByteArrayOutputStream</span> <span class="variable">pageOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>()) &#123;</span><br><span class="line">                                        ImageIO.write(page, <span class="string">&quot;png&quot;</span>, pageOutputStream);</span><br><span class="line">                                        <span class="type">ImageData</span> <span class="variable">imageData</span> <span class="operator">=</span> ImageDataFactory.create(pageOutputStream.toByteArray());</span><br><span class="line">                                        <span class="type">Image</span> <span class="variable">image</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Image</span>(imageData);</span><br><span class="line">                                        finalDocument.add(image);</span><br><span class="line">                                        finalDocument.add(<span class="keyword">new</span> <span class="title class_">AreaBreak</span>(AreaBreakType.NEXT_PAGE)); <span class="comment">// Add a page break after each image</span></span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            finalDocument.close();</span><br><span class="line">            finalPdf.close();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> finalOutputStream.toByteArray();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">batchSize</span> <span class="operator">=</span> <span class="number">50</span>;                     <span class="comment">// 每批处理的文件数量</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">totalFiles</span> <span class="operator">=</span> files.size();</span><br><span class="line">            <span class="type">int</span> <span class="variable">batches</span> <span class="operator">=</span> (<span class="type">int</span>) Math.ceil((<span class="type">double</span>) totalFiles / batchSize);</span><br><span class="line"></span><br><span class="line">            <span class="type">ExecutorService</span> <span class="variable">executorService</span> <span class="operator">=</span> Executors.newFixedThreadPool(Math.min(batches, Runtime.getRuntime().availableProcessors()));</span><br><span class="line"></span><br><span class="line">            List&lt;CompletableFuture&lt;PDDocument&gt;&gt; futures = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; batches; i++) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">fromIndex</span> <span class="operator">=</span> i * batchSize;</span><br><span class="line">                <span class="type">int</span> <span class="variable">toIndex</span> <span class="operator">=</span> Math.min((i + <span class="number">1</span>) * batchSize, totalFiles);</span><br><span class="line">                List&lt;<span class="type">byte</span>[]&gt; batchFiles = files.subList(fromIndex, toIndex);</span><br><span class="line"></span><br><span class="line">                CompletableFuture&lt;PDDocument&gt; future = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">                    <span class="type">PDDocument</span> <span class="variable">batchPdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDDocument</span>();</span><br><span class="line">                    <span class="type">PDFMergerUtility</span> <span class="variable">merger</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDFMergerUtility</span>();</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">byte</span>[] fileData : batchFiles) &#123;</span><br><span class="line">                        <span class="type">String</span> <span class="variable">mimeType</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            mimeType = URLConnection.guessContentTypeFromStream(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(fileData));</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> (isPDF(fileData)) &#123;</span><br><span class="line">                            <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(fileData)) &#123;</span><br><span class="line">                                <span class="type">PDDocument</span> <span class="variable">sourcePdf</span> <span class="operator">=</span> PDDocument.load(inputStream);</span><br><span class="line">                                merger.appendDocument(batchPdf, sourcePdf);</span><br><span class="line">                                sourcePdf.close();</span><br><span class="line">                            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                                e.printStackTrace();</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mimeType != <span class="literal">null</span> &amp;&amp; (mimeType.toLowerCase().contains(<span class="string">&quot;png&quot;</span>)</span><br><span class="line">                                || mimeType.toLowerCase().contains(<span class="string">&quot;jpg&quot;</span>) || mimeType.toLowerCase().contains(<span class="string">&quot;jpeg&quot;</span>))) &#123;</span><br><span class="line">                            <span class="type">PDPage</span> <span class="variable">page</span> <span class="operator">=</span> createPDPageFromImage(batchPdf, fileData);</span><br><span class="line">                            <span class="keyword">if</span> (page != <span class="literal">null</span>) &#123;</span><br><span class="line">                                batchPdf.addPage(page);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mimeType != <span class="literal">null</span> &amp;&amp; (mimeType.toLowerCase().contains(<span class="string">&quot;tiff&quot;</span>) || mimeType.toLowerCase().contains(<span class="string">&quot;tif&quot;</span>))) &#123;</span><br><span class="line">                            List&lt;<span class="type">byte</span>[]&gt; tiffImages = <span class="literal">null</span>;</span><br><span class="line">                            <span class="keyword">try</span> &#123;</span><br><span class="line">                                tiffImages = tiffToImage(fileData);</span><br><span class="line">                            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">for</span> (<span class="type">byte</span>[] imageFileData : tiffImages) &#123;</span><br><span class="line">                                <span class="type">PDPage</span> <span class="variable">page</span> <span class="operator">=</span> createPDPageFromImage(batchPdf, imageFileData);</span><br><span class="line">                                <span class="keyword">if</span> (page != <span class="literal">null</span>) &#123;</span><br><span class="line">                                    batchPdf.addPage(page);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> batchPdf;</span><br><span class="line">                &#125;, executorService);</span><br><span class="line"></span><br><span class="line">                futures.add(future);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            CompletableFuture&lt;Void&gt; allFutures = CompletableFuture.allOf(futures.toArray(<span class="keyword">new</span> <span class="title class_">CompletableFuture</span>[<span class="number">0</span>]));</span><br><span class="line">            allFutures.join();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 构建最终的有序 PDF 文档</span></span><br><span class="line">            <span class="comment">// 构建最终的有序 PDF 文档</span></span><br><span class="line">            <span class="type">PDDocument</span> <span class="variable">finalPdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDDocument</span>();</span><br><span class="line">            <span class="type">PDFMergerUtility</span> <span class="variable">merger</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDFMergerUtility</span>();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (CompletableFuture&lt;PDDocument&gt; future : futures) &#123;</span><br><span class="line">                <span class="type">PDDocument</span> <span class="variable">batchPdf</span> <span class="operator">=</span> future.join();</span><br><span class="line">                merger.appendDocument(finalPdf, batchPdf);</span><br><span class="line">                batchPdf.close();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">PDPage</span> <span class="variable">blankPage</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDPage</span>();</span><br><span class="line">            finalPdf.addPage(blankPage);</span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            finalPdf.save(outputStream);</span><br><span class="line">            finalPdf.close();</span><br><span class="line"></span><br><span class="line">            executorService.shutdown();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> outputStream.toByteArray();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*  设置图片的DPI为符合国家文档标准的300DPI便于查看</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">byte</span>[] changeDPI(<span class="type">byte</span>[] imageData) &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 从字节数组读取图像</span></span><br><span class="line">            <span class="type">BufferedImage</span> <span class="variable">image</span> <span class="operator">=</span> ImageIO.read(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(imageData));</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 获取一个ImageWriter</span></span><br><span class="line">            <span class="type">ImageWriter</span> <span class="variable">writer</span> <span class="operator">=</span> ImageIO.getImageWritersByFormatName(<span class="string">&quot;png&quot;</span>).next();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 准备输出流</span></span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">baos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            <span class="type">ImageOutputStream</span> <span class="variable">ios</span> <span class="operator">=</span> ImageIO.createImageOutputStream(baos);</span><br><span class="line">            writer.setOutput(ios);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 设置DPI为300</span></span><br><span class="line">            <span class="type">IIOMetadata</span> <span class="variable">metadata</span> <span class="operator">=</span> writer.getDefaultImageMetadata(<span class="keyword">new</span> <span class="title class_">ImageTypeSpecifier</span>(image), <span class="literal">null</span>);</span><br><span class="line">            <span class="type">IIOMetadataNode</span> <span class="variable">root</span> <span class="operator">=</span> (IIOMetadataNode) metadata.getAsTree(<span class="string">&quot;javax_imageio_1.0&quot;</span>);</span><br><span class="line">            <span class="type">IIOMetadataNode</span> <span class="variable">dimension</span> <span class="operator">=</span> getChildNode(root, <span class="string">&quot;Dimension&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (dimension == <span class="literal">null</span>) &#123;</span><br><span class="line">                dimension = <span class="keyword">new</span> <span class="title class_">IIOMetadataNode</span>(<span class="string">&quot;Dimension&quot;</span>);</span><br><span class="line">                root.appendChild(dimension);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">IIOMetadataNode</span> <span class="variable">horiz</span> <span class="operator">=</span> getChildNode(dimension, <span class="string">&quot;HorizontalPixelSize&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (horiz == <span class="literal">null</span>) &#123;</span><br><span class="line">                horiz = <span class="keyword">new</span> <span class="title class_">IIOMetadataNode</span>(<span class="string">&quot;HorizontalPixelSize&quot;</span>);</span><br><span class="line">                dimension.appendChild(horiz);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">IIOMetadataNode</span> <span class="variable">vert</span> <span class="operator">=</span> getChildNode(dimension, <span class="string">&quot;VerticalPixelSize&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (vert == <span class="literal">null</span>) &#123;</span><br><span class="line">                vert = <span class="keyword">new</span> <span class="title class_">IIOMetadataNode</span>(<span class="string">&quot;VerticalPixelSize&quot;</span>);</span><br><span class="line">                dimension.appendChild(vert);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            horiz.setAttribute(<span class="string">&quot;value&quot;</span>, Double.toString(<span class="number">25.4</span> / <span class="number">300</span>));</span><br><span class="line">            vert.setAttribute(<span class="string">&quot;value&quot;</span>, Double.toString(<span class="number">25.4</span> / <span class="number">300</span>));</span><br><span class="line">            metadata.setFromTree(<span class="string">&quot;javax_imageio_1.0&quot;</span>, root);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 写入图像</span></span><br><span class="line">            writer.write(<span class="literal">null</span>, <span class="keyword">new</span> <span class="title class_">IIOImage</span>(image, <span class="literal">null</span>, metadata), <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">            ios.close();</span><br><span class="line">            writer.dispose();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> baos.toByteArray();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 将PDF的页拆分为图片</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">private</span> PDPage <span class="title function_">createPDPageFromImage</span><span class="params">(PDDocument pdf, <span class="type">byte</span>[] imageData)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(imageData)) &#123;</span><br><span class="line">            <span class="type">BufferedImage</span> <span class="variable">image</span> <span class="operator">=</span> ImageIO.read(is);</span><br><span class="line">            <span class="keyword">if</span> (image == <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">PDImageXObject</span> <span class="variable">imageObject</span> <span class="operator">=</span> LosslessFactory.createFromImage(pdf, image);</span><br><span class="line">            <span class="type">PDPage</span> <span class="variable">page</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDPage</span>(<span class="keyword">new</span> <span class="title class_">PDRectangle</span>(image.getWidth(), image.getHeight()));</span><br><span class="line">            <span class="keyword">try</span> (<span class="type">PDPageContentStream</span> <span class="variable">contentStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDPageContentStream</span>(pdf, page)) &#123;</span><br><span class="line">                contentStream.drawImage(imageObject, <span class="number">0</span>, <span class="number">0</span>, image.getWidth(), image.getHeight());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> page;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Error processing image data&quot;</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 将TIF以及TIFF文件转换成图片</span></span><br><span class="line"><span class="comment">* 适配多页</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> List&lt;<span class="type">byte</span>[]&gt; tiffToImage(<span class="type">byte</span>[] tiffData) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        List&lt;<span class="type">byte</span>[]&gt; imageFiles = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">ImageInputStream</span> <span class="variable">is</span> <span class="operator">=</span> ImageIO.createImageInputStream(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(tiffData))) &#123;</span><br><span class="line">            Iterator&lt;ImageReader&gt; it = ImageIO.getImageReaders(is);</span><br><span class="line">            <span class="keyword">if</span> (it.hasNext()) &#123;</span><br><span class="line">                <span class="type">ImageReader</span> <span class="variable">reader</span> <span class="operator">=</span> it.next();</span><br><span class="line">                reader.setInput(is);</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; reader.getNumImages(<span class="literal">true</span>); i++) &#123;</span><br><span class="line">                    <span class="type">BufferedImage</span> <span class="variable">image</span> <span class="operator">=</span> reader.read(i);</span><br><span class="line">                    <span class="keyword">try</span> (<span class="type">ByteArrayOutputStream</span> <span class="variable">imageStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>()) &#123;</span><br><span class="line">                        ImageIO.write(image, <span class="string">&quot;png&quot;</span>, imageStream);</span><br><span class="line">                        imageFiles.add(imageStream.toByteArray());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> imageFiles;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* PDF转图片</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;<span class="type">byte</span>[]&gt; pdfToImagePlus(InputStream inputStream) &#123;</span><br><span class="line">        List&lt;<span class="type">byte</span>[]&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">PDDocument</span> <span class="variable">document</span> <span class="operator">=</span> PDDocument.load(inputStream);</span><br><span class="line">            <span class="type">PDFRenderer</span> <span class="variable">renderer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDFRenderer</span>(document);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; document.getNumberOfPages(); i++) &#123;</span><br><span class="line">                <span class="type">BufferedImage</span> <span class="variable">bufferedImage</span> <span class="operator">=</span> renderer.renderImageWithDPI(i, DEFAULT_DPI);</span><br><span class="line">                <span class="type">ByteArrayOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">                <span class="type">ImageOutputStream</span> <span class="variable">imageOut</span> <span class="operator">=</span> ImageIO.createImageOutputStream(out);</span><br><span class="line">                ImageIO.write(bufferedImage, DEFAULT_FORMAT, imageOut);</span><br><span class="line">                result.add(out.toByteArray());</span><br><span class="line">                out.close();</span><br><span class="line">                imageOut.close();</span><br><span class="line">                inputStream.close();</span><br><span class="line">            &#125;</span><br><span class="line">            document.close();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="pom-xml-依赖项">pom.xml(依赖项)</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.twelvemonkeys.imageio<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>imageio-tiff<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.6.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.pdfbox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pdfbox<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.pdfbox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pdfbox-tools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.26<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tika<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tika-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itextpdf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>itext7-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>7.1.18<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--解决PDF转图片的时候jpeg2000问题--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.jai-imageio<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jai-imageio-jpeg2000<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.ofdrw<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ofdrw<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.ofdrw<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ofdrw-reader<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.ofdrw<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ofdrw-converter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 各种类型文件操作 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 工具类 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>K、各种格式文件拼接为PDF</title>
      <link href="/posts/30ce191e.html"/>
      <url>/posts/30ce191e.html</url>
      
        <content type="html"><![CDATA[<h2 id="所需数据">所需数据</h2><ol><li>首先需要将所有需要合并的文件转换成字节流也就是byte[] 然后把，每个数据都放到一个list</li></ol><h3 id="文件路径转换成byte">文件路径转换成byte[]</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> List&lt;String&gt; collect = <span class="comment">//你的文件路径集合</span></span><br><span class="line">logger.info(<span class="string">&quot;开始转换pdf&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">totalUrls</span> <span class="operator">=</span> collect.size();</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="variable">batchSize</span> <span class="operator">=</span> <span class="number">20</span>; <span class="comment">// 每批文件数量</span></span><br><span class="line"><span class="type">int</span> <span class="variable">totalBatches</span> <span class="operator">=</span> (<span class="type">int</span>) Math.ceil((<span class="type">double</span>) totalUrls / batchSize); <span class="comment">// 共多少批任务</span></span><br><span class="line"><span class="keyword">if</span> (totalBatches &lt;=<span class="number">0</span> ) <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">0</span>];</span><br><span class="line"><span class="type">ExecutorService</span> <span class="variable">executorService</span> <span class="operator">=</span> <span class="comment">//你的自定义线程池</span></span><br><span class="line"></span><br><span class="line">List&lt;CompletableFuture&lt;<span class="type">byte</span>[]&gt;&gt; futures = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; totalBatches; i++) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">fromIndex</span> <span class="operator">=</span> i * batchSize;</span><br><span class="line">    <span class="type">int</span> <span class="variable">toIndex</span> <span class="operator">=</span> Math.min((i + <span class="number">1</span>) * batchSize, totalUrls);</span><br><span class="line">    List&lt;String&gt; batchUrls = collect.subList(fromIndex, toIndex);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (String url : batchUrls) &#123;</span><br><span class="line">        CompletableFuture&lt;<span class="type">byte</span>[]&gt; future = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">            logger.info(<span class="string">&quot;开始合并数据路径为:&#123;&#125;&quot;</span>, url);</span><br><span class="line"></span><br><span class="line">            <span class="type">File</span> <span class="variable">imageFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(url);</span><br><span class="line">            <span class="keyword">if</span> (imageFile.exists() &amp;&amp; imageFile.isFile()) &#123;</span><br><span class="line">                <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(imageFile)) &#123;</span><br><span class="line">                    <span class="type">byte</span>[] fileData = IOUtils.toByteArray(fileInputStream);</span><br><span class="line">                    logger.info(<span class="string">&quot;文件大小为:&#123;&#125;&quot;</span>, fileData.length);</span><br><span class="line">                    <span class="keyword">return</span> fileData;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">/*if ((extName != null &amp;&amp; (extName.toLowerCase().contains(&quot;png&quot;)</span></span><br><span class="line"><span class="comment">                            || extName.toLowerCase().contains(&quot;jpg&quot;) || extName.toLowerCase().contains(&quot;jpeg&quot;)))) &#123;</span></span><br><span class="line"><span class="comment">                        try &#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                            final byte[] bytes = PicUtil.compressPictureForScale(url, 1024, 0.9);</span></span><br><span class="line"><span class="comment">                            logger.info(&quot;文件大小为:&#123;&#125;&quot;, bytes.length);</span></span><br><span class="line"><span class="comment">                            return bytes;</span></span><br><span class="line"><span class="comment">                        &#125; catch (IOException e) &#123;</span></span><br><span class="line"><span class="comment">                            throw new RuntimeException(e);</span></span><br><span class="line"><span class="comment">                        &#125;</span></span><br><span class="line"><span class="comment">                    &#125;*/</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;, executorService);</span><br><span class="line"></span><br><span class="line">        futures.add(future);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">List&lt;<span class="type">byte</span>[]&gt; imageFiles = futures.stream()</span><br><span class="line">.map(CompletableFuture::join)</span><br><span class="line">.collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">executorService.shutdown();</span><br></pre></td></tr></table></figure><blockquote><p>上图中进行注释的地方是进行大图片压缩的，本文中所有涉及到的工具类都会在另一篇文章中附上源码</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 各种类型文件操作 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 前置处理操作 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Idea推送Github仓库超时问题</title>
      <link href="/posts/440070d0.html"/>
      <url>/posts/440070d0.html</url>
      
        <content type="html"><![CDATA[<div class="tip error"><h2 id="Idea推送Github仓库-emp-超时-emp-问题">Idea推送Github仓库<emp>超时</emp>问题</h2></div><blockquote><p>有时候在本地推送Github的仓库的时候经常Time OUT 并且你挂了梯子之后还是会超时，这个时候只需要配置一下终端代理就行</p></blockquote><div class="tip key"><p>寻找终端代理的</p></div><h2 id=""></h2><ol><li>找到梯子的终端代理端口号然后替换掉下边指令的</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export https_proxy=http://127.0.0.1:33210 http_proxy=http://127.0.0.1:33210 all_proxy=socks5://127.0.0.1:33211</span><br></pre></td></tr></table></figure><ol start="2"><li>或者找到您对应的梯子的可视化界面复制终端代理的代码</li></ol><div class="tip cogs"><h2 id="配置终端代理">配置终端代理</h2></div><blockquote><p>打开git bash 输入终端代理的代码<br>最后打开Idea重新推送代码就可以了</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Git </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小技巧 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RabbitMQ如何保证消息不丢失？</title>
      <link href="/posts/3bd74647.html"/>
      <url>/posts/3bd74647.html</url>
      
        <content type="html"><![CDATA[<div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='0.5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>RabbitMQ如何保证消息不丢失？</p></div></div><div class="tip cogs"><p>1、生产者需要做的</p></div><blockquote><p>生产者重写 RabbitTemplate.ConfirmCallback的 confirm方法以及 returnedMessage 方法。<br>将 ack==false 的消息 持久化到数据库,定时扫描 DB 中投递失败的数据，重新投递到MQ中；</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 生产者 确认消息的配置</span></span><br><span class="line"><span class="comment"> * 此函数为回调函数,用于通知producer消息是否投递成功</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> correlationData 消息唯一ID</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ack             确认消息是否被MQ 接收,true是已被接收,false反之</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> cause</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">confirm</span><span class="params">(CorrelationData correlationData, <span class="type">boolean</span> ack, String cause)</span> &#123;</span><br><span class="line">   <span class="comment">//投递成功</span></span><br><span class="line">   <span class="keyword">if</span> (ack) &#123;</span><br><span class="line">      <span class="comment">//不做处理，等待消费成功</span></span><br><span class="line">      log.info(correlationData.getId() + <span class="string">&quot;：发送成功&quot;</span>);</span><br><span class="line">      <span class="comment">//删除redis里面备份的数据</span></span><br><span class="line">      redisTemplate.delete(correlationData.getId());</span><br><span class="line">   &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">//投递失败 //测试该逻辑时候 把上边的if(ack) 改成if(!ack)即可</span></span><br><span class="line">      <span class="comment">//持久化到数据库 (TODO 注意: 有时候 (严格保证消息投递成功的场景下) 可能需要增加定时任务，</span></span><br><span class="line">      <span class="comment">//TODO 定时扫描 redis或者DB (这里我们把投递失败的保存到了DB 所以定时任务扫描DB就可以了) 中投递失败的数据，重新投递到MQ中,这也是保证消息投递成功的一个手段)</span></span><br><span class="line">      <span class="comment">//TODO (但是 :  如果是需要顺序消费的话，这种重新投递的策略就显得不那么合适了，我想的是某几个顺序消息拥有同一个会话ID 。。。具体的实现我将在后续研究一下,这里先不考虑顺序消费的场景)</span></span><br><span class="line">      log.error(correlationData.getId() + <span class="string">&quot;：发送失败&quot;</span>);</span><br><span class="line">      log.info(<span class="string">&quot;备份到DB的内容：&quot;</span> + redisTemplate.opsForValue().get(correlationData.getId()));</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">         <span class="type">SaveNackMessage</span> <span class="variable">strategy</span> <span class="operator">=</span> SaveNackMessage.getStrategy(SaveNackMessage.NackTypeEnum.PRODUCER.getType());</span><br><span class="line">         HashMap&lt;String, Object&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">         map.put(<span class="string">&quot;cause&quot;</span>, StringUtils.isNoneBlank(cause) ? cause : StringUtils.EMPTY);</span><br><span class="line">         map.put(<span class="string">&quot;ack&quot;</span>, ack ? <span class="number">1</span> : <span class="number">0</span>);</span><br><span class="line">         map.put(<span class="string">&quot;correlationData&quot;</span>, Objects.nonNull(correlationData) ? correlationData : StringUtils.EMPTY);</span><br><span class="line">         saveNackMessageThread.execute(strategy.template(map));</span><br><span class="line">      &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">         <span class="comment">//TODO 发布event事件 监听方发送钉钉消息提醒开发者</span></span><br><span class="line">         log.error(<span class="string">&quot;记录mq发送端错误日志失败&quot;</span>, e);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>另外除了实现confirm方法，还需要实现returnedMessage方法 即(投递消息后，交换机找不到具体的queue将会回调该方法 一般我们需要配置钉钉预警，告知开发者)<br>具体代码如下:</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> ApplicationEventPublisher publisher;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 当投递消息后，交换机找不到具体的queue将会回调该方法 一般我们需要配置钉钉预警，告知开发者</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> message</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> replyCode</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> replyText</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> exchange</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> routingKey</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">returnedMessage</span><span class="params">(Message message, <span class="type">int</span> replyCode, String replyText, String exchange, String routingKey)</span> &#123;</span><br><span class="line">   log.error(<span class="string">&quot;returnedMessage 消息主体 message : &#123;&#125;&quot;</span>, message);</span><br><span class="line">   log.error(<span class="string">&quot;returnedMessage 描述：&#123;&#125;&quot;</span>, replyText);</span><br><span class="line">   log.error(<span class="string">&quot;returnedMessage 消息使用的交换器 exchange : &#123;&#125;&quot;</span>, exchange);</span><br><span class="line">   log.error(<span class="string">&quot;returnedMessage 消息使用的路由键 routing : &#123;&#125;&quot;</span>, routingKey);</span><br><span class="line"></span><br><span class="line">   HashMap&lt;String, Object&gt; maps = Maps.newHashMap();</span><br><span class="line">   maps.put(<span class="string">&quot;message&quot;</span>, message);</span><br><span class="line">   maps.put(<span class="string">&quot;replyCode&quot;</span>, replyCode);</span><br><span class="line">   maps.put(<span class="string">&quot;replyText&quot;</span>, replyText);</span><br><span class="line">   maps.put(<span class="string">&quot;exchange&quot;</span>, exchange);</span><br><span class="line">   maps.put(<span class="string">&quot;routingKey&quot;</span>, routingKey);</span><br><span class="line">   <span class="type">String</span> <span class="variable">returnedMessage</span> <span class="operator">=</span> JSON.toJSONString(maps);</span><br><span class="line"></span><br><span class="line">   <span class="type">SendFailNoticeEvent</span> <span class="variable">noticeEvent</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SendFailNoticeEvent</span>();</span><br><span class="line">   noticeEvent.setLevel(<span class="number">1</span>);</span><br><span class="line">   noticeEvent.setErrorMsg(</span><br><span class="line">         System.lineSeparator() +</span><br><span class="line">               <span class="string">&quot;producer投递消息失败；报错信息: &quot;</span> + returnedMessage);</span><br><span class="line">   noticeEvent.setTalkTypeEnum(DingTalkTypeEnum.BIZ_NOTICE);</span><br><span class="line">   <span class="comment">//发送消息投递失败事件，监听器方将信息发送至钉钉机器人群里或者是某个具体的人。</span></span><br><span class="line">   publisher.publishEvent(noticeEvent);      </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="tip cogs"><p>2、(MQ需要做的) 开启持久化参数</p></div><blockquote><p>durable=true</p></blockquote><div class="tip cogs"><p>3、消费者需要做的</p></div><blockquote><p>(消费者) 需要做的 手动ack,保证业务执行完后再ack,通知mq将某条消息删除</p></blockquote><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.rabbitmq.listener.simple.acknowledge-mode</span>=<span class="string">manual</span></span><br></pre></td></tr></table></figure><p>我的博客即将同步至腾讯云开发者社区，邀请大家一同入驻：<a href="https://cloud.tencent.com/developer/support-plan?invite_code=ocj4bhqfct36">https://cloud.tencent.com/developer/support-plan?invite_code=ocj4bhqfct36</a></p>]]></content>
      
      
      <categories>
          
          <category> RabbitMQ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 真实项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RabbitMQ如何保证消息幂等？</title>
      <link href="/posts/20032586.html"/>
      <url>/posts/20032586.html</url>
      
        <content type="html"><![CDATA[<div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='0.5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><h1>RabbitMQ如何保证消息幂等？</h1></div></div><div class="tip cogs"><h2 id="1、生产端做消息幂等-即不重复投递">1、生产端做消息幂等 (即不重复投递)</h2></div><blockquote><p>在生产端的话，其实消费端做好幂等，生产端就算投递多次，也无所谓了。 如果实在想在生产者做幂等的话，可以参考消费端的思路，比如通过redis的 setnx (key可以设计成 producer:具体业务:具有唯一性的某几个或者某一个业务字段 作为key) ,添加防重表等等。但是我个人觉得没必要。把消费端做好幂等就可以了。</p></blockquote><div class="tip cogs"><h2 id="2、消费端做消息幂等-即不重复消费">2、消费端做消息幂等 (即不重复消费)</h2></div><div class="note purple no-icon flat"><h3 id="A、方案">A、方案</h3></div><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/** </span></span><br><span class="line"><span class="comment">  * 是否能消费，用于防止重复消费</span></span><br><span class="line"><span class="comment">  * false 代表未消费过 ，true代表消费过</span></span><br><span class="line"><span class="comment">  * </span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  content </span></span><br><span class="line"><span class="comment">  * <span class="doctag">@param</span>  queueName </span></span><br><span class="line"><span class="comment">  * <span class="doctag">@return</span>  </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> Boolean <span class="title function_">checkConsumedFlag</span><span class="params">(T content, String queueName)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">messageKey</span> <span class="operator">=</span> queueName + <span class="string">&quot;:&quot;</span> + content.getId();</span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isBlank(redisTemplate.opsForValue().get(messageKey))) &#123;</span><br><span class="line">        <span class="comment">//从redis中没获取到value，说明未消费过该消息，返回true</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">//获取到了value说明消费过，然后将该消息标记为已消费并直接响应ack，不进行下边的业务处理，防止消费n次(保证幂等)</span></span><br><span class="line">        redisTemplate.opsForValue().set(messageKey, <span class="string">&quot;lock&quot;</span>, <span class="number">60</span>, TimeUnit.SECONDS);</span><br><span class="line">        <span class="comment">//事实上，set操作应该放在业务执行完后，确保真正消费成功后执行。这里偷个懒。写在业务执行前了。</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><div class="note green no-icon flat"><h3 id="B、方案-防重表">B、方案(防重表)</h3></div><blockquote><p>并发高情况下可能会有<span class='p red'>IO瓶颈</span> (先读在写) 该方式需要在发送消息时候，指定一个业务上唯一的字段。<br>如 xzll:order:10001 (10001代表订单id) 然后，在消费端获取该字段，并插入到防重表中(插入代码写在哪？)<br>如果你<span class='p green'>声明了事务</span>，那么插入防重这段代码位置无需关注(因为出现异常肯定会回滚)，<br>如果<span class='p green'>没实现事务</span>，那么最好在执行完业务逻辑后，再插入防重表，保证防重表中的数据肯定是消费成功的。实现步骤:<br>接收到消息后，<span class='p yellow'>select count(0) from 防重表 where biz_unique_id=message.getBizUniqueId();</span><br>如果大于0，那么说明以及消费过，将直接ack，告知mq删除该消息。如果=0说明没消费过。进行正常的业务逻辑。</p></blockquote><div class="note red no-icon flat"><h3 id="C、方案-唯一键-真正保证了幂等">C、方案(唯一键 : 真正保证了幂等)</h3></div><blockquote><p>直接写) 如果消费端业务是新增操作，我们可以为某几个或者某一个字段<span class='p cyan'>设置业务上的唯一键约束</span>，<br>如果重复消费将会插入两条相同的记录，数据库会<span class='p red'>报错</span>从而可以保证数据不会插入两条。</p></blockquote><div class="note orange no-icon flat"><h3 id="D、方案-乐观锁">D、方案(乐观锁)</h3></div><blockquote><p>并发高下也可能会产生<span class='p red'>IO瓶颈</span> (先读再写) 如果消费端业务是更新操作（例如扣减库存），<br>可以给<span class='p green'>业务表</span>加一个 <span class='p green'>version 字段</span>，每次更新把 <span class='p green'>version</span> 作为条件，更新之后 <span class='p green'>version + 1</span>。<br>由于 <span class='p cyan'>MySQL的innoDB</span>是<span class='p cyan'>行锁</span>，当其中一个请求成功更新之后，另一个请求才能进来(注意此时该请求拿到的<span class='p gray'>version</span>还是1)，<br>由于版本号<span class='p blue'>version</span>已经变成 2，所以<span class='p blue'>更新操作</span>不会执行，从而<span class='p blue'>保证幂等</span>。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> RabbitMQ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 真实项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RabbitMQ消费者ack超时问题</title>
      <link href="/posts/e5894e20.html"/>
      <url>/posts/e5894e20.html</url>
      
        <content type="html"><![CDATA[<div class="tip error"><h3 id="报错信息">报错信息</h3></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Shutdown Signal: channel error; protocol method: <span class="comment">#method&lt;channel.close&gt;(reply-code=40, reply-text-PRECONDITION FAILED </span></span><br><span class="line">- deliveryacknowledoement on channel 2 timed out, Timeout value used: 1800000 ms, This <span class="built_in">timeout</span> yalue can be confaured. se consumers doc ouide to learmore. </span><br><span class="line">class-id=0.method-id=0)</span><br></pre></td></tr></table></figure><div class="tip success"><h3 id="解决方法">解决方法</h3></div><blockquote><p>rabbitmq默认客户端超时时间是30分钟，手动ACK情况下会如果业务事件较长会超时，可以采用下面修改方式：</p></blockquote><h4 id="swig￼7"><span class='p blue'>第一种：需要重启MQ</span></h4><blockquote><p>在etc目录下建一个文件，/etc/rabbitmq.conf，rabbitmq默认不会建这个文件，然后文件里面设置consumer_timeout = 360000（根据需要来决定）。然后重新启动rabbitmq。</p></blockquote><h4 id="swig￼8"><span class='p blue'>第二种：无需重启，动态修改：</span></h4><blockquote><p>修改前，在MQ服务器上执行：<span class='p cyan'>rabbitmqctl eval application:get_env(rabbit</span> 来查看当前时间是多少，然后：</p></blockquote><h5 id="swig￼10"><span class='p green'>如果你是在docker容器中</span></h5><p>要在Docker容器中运行<code>rabbitmqctl</code>命令，你需要先进入到运行RabbitMQ的Docker容器内。下面是一些步骤说明如何执行这个任务：</p><ol><li>查找容器ID或名称:<br />首先，你需要找到运行RabbitMQ的Docker容器的ID或名称。你可以通过运行以下命令来做到这一点：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% span yellow, docker ps %&#125;</span><br></pre></td></tr></table></figure><p>这会列出所有正在运行的容器，包括它们的ID和名称。</p><ol start="2"><li>进入容器:<br />现在，你可以使用<code>docker exec</code>命令进入容器。替换<code>&lt;container_id_or_name&gt;</code>**为你在上一步找到的容器ID或名称：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% span cyan, docker <span class="built_in">exec</span> -it &lt;container_id_or_name&gt; /bin/bash %&#125;</span><br></pre></td></tr></table></figure><blockquote><p>这将打开一个bash shell，让你能够在容器内运行命令。</p></blockquote><ol start="3"><li>运行<code>rabbitmqctl</code>命令:<br />现在你可以运行<code>rabbitmqctl</code>命令来更新RabbitMQ的配置：</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% span cyan, rabbitmqctl <span class="built_in">eval</span> <span class="string">&#x27;application:set_env(rabbit, consumer_timeout, 3600000).&#x27;</span> %&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>修改后，再执行验证。</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% span cyan, rabbitmqctl <span class="built_in">eval</span> <span class="string">&#x27;application:get_env(rabbit,consumer_timeout).&#x27;</span> %&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li><span class='p red'>退出容器:</span></li></ol><blockquote><p>完成后，你可以通过输入exit命令退出容器的bash shell。<br />请注意，更改RabbitMQ的配置可能需要RabbitMQ服务重启才能生效。在生产环境中执行此类操作时应当谨慎，并确保你已经备份了所有重要的数据和配置。**<br />此外，为了持久化这些配置更改，你可能需要考虑更新RabbitMQ的配置文件，并重新创建和启动容器。这样，即使容器被重新启动，配置更改也会保留。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> RabbitMQ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 真实项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RabbitMQ消费者ack超时问题</title>
      <link href="/posts/e5894e26.html"/>
      <url>/posts/e5894e26.html</url>
      
        <content type="html"><![CDATA[<h2 id="消息手动ack-手动重试">消息手动ack + 手动重试</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 消息最大重试次数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">MAX_RETRIES</span> <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 重试间隔(秒)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">RETRY_INTERVAL</span> <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">ObjectMapper</span> <span class="variable">OBJECT_MAPPER</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();</span><br><span class="line">    </span><br><span class="line"><span class="meta">@RabbitListener(queues = RabbitMqConfig.USER_ADD_QUEUE, concurrency = &quot;10&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">userAddReceiver</span><span class="params">(String data, Message message, Channel channel)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">    <span class="type">UserVo</span> <span class="variable">vo</span> <span class="operator">=</span> OBJECT_MAPPER.readValue(data, UserVo.class);</span><br><span class="line">    <span class="comment">// 重试次数</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">retryCount</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">success</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// 消费失败并且重试次数&lt;=重试上限次数</span></span><br><span class="line">    <span class="keyword">while</span> (!success &amp;&amp; retryCount &lt; MAX_RETRIES) &#123;</span><br><span class="line">        retryCount++;</span><br><span class="line">        <span class="comment">// 具体业务逻辑</span></span><br><span class="line">        success = messageHandle(vo);</span><br><span class="line">        <span class="comment">// 如果失败则重试</span></span><br><span class="line">        <span class="keyword">if</span> (!success) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">errorTip</span> <span class="operator">=</span> <span class="string">&quot;第&quot;</span> + retryCount + <span class="string">&quot;次消费失败&quot;</span> +</span><br><span class="line">                    ((retryCount &lt; <span class="number">3</span>) ? <span class="string">&quot;,&quot;</span> + RETRY_INTERVAL + <span class="string">&quot;s后重试&quot;</span> : <span class="string">&quot;,进入死信队列&quot;</span>);</span><br><span class="line">            log.error(errorTip);</span><br><span class="line">            Thread.sleep(RETRY_INTERVAL * <span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (success) &#123;</span><br><span class="line">        <span class="comment">// 消费成功，确认</span></span><br><span class="line">        channel.basicAck(message.getMessageProperties().getDeliveryTag(), <span class="literal">false</span>);</span><br><span class="line">        log.info(<span class="string">&quot;创建订单数据消费成功&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 重试多次之后仍失败，发送到死信队列</span></span><br><span class="line">        channel.basicNack(message.getMessageProperties().getDeliveryTag(), <span class="literal">false</span>, <span class="literal">false</span>);</span><br><span class="line">        log.info(<span class="string">&quot;创建订单数据消费失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> RabbitMQ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 真实项目 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vavr(颠覆你对Java的认知)</title>
      <link href="/posts/9940a3e5.html"/>
      <url>/posts/9940a3e5.html</url>
      
        <content type="html"><![CDATA[<h1>Vavr(颠覆你对Java的认知)</h1><h3 id="什么是Vavr">什么是Vavr</h3><p>Vavr core是一个Java函数库。它有助于减少代码量并提高健壮性。函数式编程的第一步是开始思考不可变的值。Vavr 提供不可变的集合以及必要的函数和控制结构来操作这些值。</p><h2 id="引入依赖">引入依赖</h2><h3 id="maven">maven</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.vavr<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>vavr<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.10.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="gradle">gradle</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    compile <span class="string">&quot;io.vavr:vavr:0.10.4&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="gradle-7">gradle 7+</h3><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    implementation <span class="string">&quot;io.vavr:vavr:0.10.4&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="1、Tuples-元组">1、Tuples(元组)</h2><h3 id="1-1-什么是元组">1.1 什么是元组</h3><p>Java缺少元组的一般概念。元组将固定数量的元素组合在一起，以便它们可以作为一个整体传递。与数组或列表不同，元组可以保存不同类型的对象，但它们也是不可变的。<br>元组的类型为 Tuple1、Tuple2、Tuple3 等。目前有 8 个元素的上限。要访问元组的元素，可以使用方法访问第一个元素，访问第二个元素，依此类推。tt._1t._2</p><h3 id="1-2-创建元组">1.2 创建元组</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Tuple2&lt;Integer, String&gt; eliauk = Tuple.of(<span class="number">1</span>, <span class="string">&quot;Eli auk&quot;</span>);</span><br><span class="line">Assert.equals(eliauk._1, <span class="number">1</span>);</span><br><span class="line">Assert.equals(eliauk._2, <span class="string">&quot;Eli auk&quot;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>通过Tuple.of()静态工厂方法创建元组，元组的类型为Tuple2，元组的元素类型为Integer和String，元组的元素个数为2，元组的元素下标从1开始。</p></blockquote><h3 id="1-3-逐个映射元组组件">1.3 逐个映射元组组件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Tuple2&lt;Integer, String&gt; map = eliauk.map(</span><br><span class="line">        a -&gt; a + <span class="number">1</span>,</span><br><span class="line">        b -&gt; b + <span class="string">&quot;1&quot;</span></span><br><span class="line">        );</span><br><span class="line">Assert.equals(map._1, <span class="number">2</span>);</span><br><span class="line">Assert.equals(map._2, <span class="string">&quot;Eli auk1&quot;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>通过map()方法逐个映射元组组件，map()方法的参数为一个函数，函数的参数为元组的元素，函数的返回值为一个新的元组。</p></blockquote><h3 id="1-4-使用一个映射函数映射元组组件">1.4 使用一个映射函数映射元组组件</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Tuple2&lt;Integer, String&gt; eliauk = Tuple.of(<span class="number">1</span>, <span class="string">&quot;Eli auk&quot;</span>);</span><br><span class="line"><span class="keyword">final</span> Tuple2&lt;Integer, String&gt; map = eliauk.map((a, b) -&gt; Tuple.of(a + <span class="number">1</span>, b + <span class="string">&quot;1&quot;</span>));</span><br><span class="line">Assert.equals(map._1, <span class="number">2</span>);</span><br><span class="line">Assert.equals(map._2, <span class="string">&quot;Eli auk1&quot;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>通过map()方法使用一个映射函数映射元组组件，map()方法的参数为一个函数，函数的参数为元组的元素，函数的返回值为一个新的元组。</p></blockquote><h3 id="1-5-变换元组">1.5 变换元组</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">String</span> <span class="variable">apply</span> <span class="operator">=</span> eliauk.apply((a, b) -&gt; b.substring(<span class="number">2</span>) + a);</span><br><span class="line">Assert.equals(apply, <span class="string">&quot;i auk1&quot;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>通过apply()方法变换元组，apply()方法的参数为一个函数，函数的参数为元组的元素，函数的返回值为一个新的元组。</p></blockquote><h2 id="2、Function-函数">2、Function(函数)</h2><h3 id="2-1-什么是函数">2.1 什么是函数</h3><p>函数式编程是关于使用函数进行值和值转换的。Java 8 只提供了一个接受一个参数和一个接受两个参数的参数。Vavr 提供的功能最多为 8 个参数。功能接口被调用等。</p><h3 id="2-2-创建函数">2.2 创建函数</h3><h4 id="2-2-1-匿名类创建">2.2.1 匿名类创建</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Function2&lt;Integer, Integer, Integer&gt; sum = <span class="keyword">new</span> <span class="title class_">Function2</span>&lt;Integer, Integer, Integer&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">apply</span><span class="params">(Integer a, Integer b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> a + b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>通过匿名类创建函数，匿名类的参数为函数的参数，匿名类的返回值为函数的返回值。</p></blockquote><h4 id="2-2-2-lambda表达式创建">2.2.2 lambda表达式创建</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Function2&lt;Integer, Integer, Integer&gt; sum = (a, b) -&gt; a + b;</span><br></pre></td></tr></table></figure><h4 id="2-2-3-静态工厂创建">2.2.3 静态工厂创建</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Function1&lt;Integer, Integer&gt; function1 = Function1.of(a -&gt; a + <span class="number">1</span>);</span><br></pre></td></tr></table></figure><h3 id="2-3-Composition-组合操作">2.3 Composition(组合操作)</h3><h4 id="2-3-1-andThen">2.3.1 andThen</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Function1&lt;Integer, Integer&gt; plusOne = a -&gt; a + <span class="number">1</span>;</span><br><span class="line">Function1&lt;Integer, Integer&gt; multiply = a -&gt; a*<span class="number">2</span>;</span><br><span class="line"><span class="keyword">final</span> Function1&lt;Integer, Integer&gt; add1AndMultiplyBy2 = plusOne.andThen(multiply);</span><br><span class="line">Assert.equals(add1AndMultiplyBy2.apply(<span class="number">2</span>),<span class="number">6</span>);</span><br></pre></td></tr></table></figure><blockquote><p>通过andThen()方法组合函数，andThen()方法的参数为一个函数，函数的参数为当前函数的返回值，函数的返回值为一个新的函数。</p></blockquote><h4 id="2-3-2-compose">2.3.2 compose</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Function1&lt;Integer, Integer&gt; plusOne = a -&gt; a + <span class="number">1</span>;</span><br><span class="line">Function1&lt;Integer, Integer&gt; multiply = a -&gt; a*<span class="number">2</span>;</span><br><span class="line"><span class="keyword">final</span> Function1&lt;Integer, Integer&gt; add1AndMultiplyBy2 = plusOne.compose(multiply);</span><br><span class="line">Assert.equals(add1AndMultiplyBy2.apply(<span class="number">2</span>),<span class="number">5</span>);</span><br></pre></td></tr></table></figure><blockquote><p>通过compose()方法组合函数，compose()方法的参数为一个函数，函数的参数为当前函数的参数，函数的返回值为一个新的函数。</p></blockquote><blockquote><p>andThen()和compose()的区别在于参数的顺序不同，andThen()方法的参数为一个函数，函数的参数为当前函数的返回值，compose()方法的参数为一个函数，函数的参数为当前函数的参数。<br>上边说的解释可能太官方了，大概理解为andThen()方法是先执行当前函数，再执行参数函数，compose()方法是先执行参数函数，再执行当前函数。</p></blockquote><h3 id="2-4-Lifting-提升操作">2.4 Lifting(提升操作)</h3><p>您可以将部分函数提升为返回结果的总函数。术语偏函数来自数学。从 X 到 Y 的部分函数是函数 f：X′ → Y，对于 X 的某个子集 X′。它推广了函数 f：X → Y 的概念，不强制 f 将 X 的每个元素映射到 Y 的元素。这意味着部分函数仅对某些输入值正常工作。如果使用不允许的输入值调用函数，它通常会引发异常。</p><h4 id="2-4-1-lift">2.4.1 lift</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Function2&lt;Integer, Integer, Integer&gt; divide = (a, b) -&gt; a / b;</span><br><span class="line"><span class="keyword">final</span> Option&lt;Integer&gt; apply = Function2.lift(divide).apply(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">Assert.equals(apply.isEmpty(),<span class="literal">true</span>);</span><br></pre></td></tr></table></figure><blockquote><p>通过lift()方法提升函数，lift()方法的参数为一个函数，函数的参数为当前函数的参数，函数的返回值为一个新的函数，新的函数的返回值为一个Option。</p></blockquote><h3 id="2-5-Partial-application-部分应用">2.5 Partial application(部分应用)</h3><p>部分应用程序允许您通过修复某些值从现有函数派生新函数。您可以修复一个或多个参数，固定参数的数量定义了新函数的 arity，例如 .参数从左到右绑定</p><h4 id="2-5-1-apply">2.5.1 apply</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Function2&lt;Integer, Integer, Integer&gt; sum = Integer::sum;</span><br><span class="line">Function1&lt;Integer, Integer&gt; add1 = sum.apply(<span class="number">1</span>);</span><br><span class="line">Function5&lt;Integer, Integer, Integer, Integer, Integer, Integer&gt; sum1 = (a, b, c, d, e) -&gt; a + b + c + d + e;</span><br><span class="line">Function2&lt;Integer, Integer, Integer&gt; add6 = sum1.apply(<span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">final</span> Function2&lt;Integer, Integer, Integer&gt; memoized = add6.memoized();</span><br><span class="line">Assert.equals(add1.apply(<span class="number">2</span>),<span class="number">3</span>);</span><br><span class="line">Assert.equals(add6.apply(<span class="number">4</span>).apply(<span class="number">5</span>),<span class="number">15</span>);</span><br></pre></td></tr></table></figure><blockquote><p>通过apply()方法部分应用函数，可以先传一个参数再传一个在传一个从左到右一次绑定</p></blockquote><h4 id="2-5-2-curried">2.5.2 curried</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Function2&lt;Integer, Integer, Integer&gt; sum = Integer::sum;</span><br><span class="line"><span class="keyword">final</span> Function1&lt;Integer, Integer&gt; add1 = sum.curried().apply(<span class="number">1</span>);</span><br><span class="line">Function5&lt;Integer, Integer, Integer, Integer, Integer, Integer&gt; sum1 = (a, b, c, d, e) -&gt; a + b + c + d + e;</span><br><span class="line"><span class="keyword">final</span> Function1&lt;Integer, Function1&lt;Integer, Function1&lt;Integer, Function1&lt;Integer, Integer&gt;&gt;&gt;&gt; apply = sum1.curried().apply(<span class="number">1</span>);</span><br><span class="line">Assert.equals(add1.apply(<span class="number">2</span>),<span class="number">3</span>);</span><br><span class="line">Assert.equals(apply.apply(<span class="number">2</span>).apply(<span class="number">3</span>).apply(<span class="number">4</span>).apply(<span class="number">5</span>),<span class="number">15</span>);</span><br></pre></td></tr></table></figure><blockquote><p>区别</p><ol><li>语法: 偏函数通常通过 .apply() 来指定一些参数，而柯里化则使用 .curried().apply()。</li><li>返回类型: 偏函数直接返回一个新的函数，这个新的函数期待剩余的参数。柯里化返回一个新的单参数函数，这个函数会返回另一个单参数函数，依此类推。</li><li>灵活性: 偏函数更灵活，因为你可以一次性指定多个参数。柯里化则严格地每次只能应用一个参数。</li><li>用途: 偏函数通常用于指定一些固定的参数来创建新的函数。柯里化则更多地用于函数组合和链式调用。</li></ol></blockquote><h3 id="2-6-Memoization-记忆化">2.6 Memoization(记忆化)</h3><p>记忆是缓存的一种形式。记忆函数仅执行一次，然后从缓存返回结果。<br>下面的示例在第一次调用时计算一个随机数，并在第二次调用时返回缓存的数字。</p><h4 id="2-6-1-memoized">2.6.1 memoized</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Function0&lt;Integer&gt; randomGenerator = getRandomGenerator();</span><br><span class="line"><span class="keyword">final</span> <span class="type">Integer</span> <span class="variable">apply</span> <span class="operator">=</span> randomGenerator.apply();</span><br><span class="line"><span class="keyword">final</span> <span class="type">Integer</span> <span class="variable">apply1</span> <span class="operator">=</span> randomGenerator.apply();</span><br><span class="line">Assert.equals(apply,apply1);</span><br></pre></td></tr></table></figure><blockquote><p>肯定大多数人不太理解这个memoized和普通变量声明有什么区别，其实这个memoized是一个函数，这个函数的返回值是一个随机数，但是这个函数只会执行一次，第二次调用的时候会直接返回第一次调用的结果，这就是memoized的作用。<br>普通变量声明</p></blockquote><h5 id="memoized与普通变量的区别与使用场景">memoized与普通变量的区别与使用场景</h5><ol><li><p><strong>配置设置</strong>: 当你有一个固定的值（如配置信息）需要在整个应用程序中使用时。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">API_KEY</span> <span class="operator">=</span> <span class="string">&quot;your-api-key-here&quot;</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>配置设置</strong>: 当你有一个固定的值（如配置信息）需要在整个应用程序中使用时。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">API_KEY</span> <span class="operator">=</span> <span class="string">&quot;your-api-key-here&quot;</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>单次计算</strong>: 当你只需要进行一次计算并存储结果时。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">double</span> <span class="variable">squareRootOfTwo</span> <span class="operator">=</span> Math.sqrt(<span class="number">2</span>);</span><br></pre></td></tr></table></figure></li><li><p><strong>状态存储</strong>: 当你需要在应用程序的生命周期内维护某种状态时。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">counter</span> <span class="operator">=</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure></li><li><p><strong>临时变量</strong>: 在循环或条件语句中作为临时存储。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">square</span> <span class="operator">=</span> i * i;</span><br><span class="line">    System.out.println(square);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h6 id="使用-Function0-和-memoized">使用 Function0 和 <code>.memoized()</code></h6><ol><li><p><strong>缓存计算密集型操作</strong>: 如果你有一个计算密集型的操作，多次调用它是不高效的，你可以使用 <code>.memoized()</code> 来缓存结果。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Function0&lt;Double&gt; expensiveCalculation = Function0.of(() -&gt; &#123;</span><br><span class="line">    <span class="comment">// ... some expensive calculations</span></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;).memoized();</span><br></pre></td></tr></table></figure></li><li><p><strong>懒加载</strong>: 如果你有一个操作可能不会被立即需要，或者可能根本就不需要，使用 Function0 会更高效。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Function0&lt;DatabaseConnection&gt; lazyDbConnection = Function0.of(() -&gt; connectToDatabase()).memoized();</span><br></pre></td></tr></table></figure></li><li><p><strong>函数组合</strong>: 当你需要将多个函数组合在一起进行复杂的操作时，使用 Function0 可以更容易地实现函数组合。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Function0&lt;Integer&gt; combinedFunction = Function0.of(() -&gt; function1()).andThen(result -&gt; function2(result));</span><br></pre></td></tr></table></figure></li><li><p><strong>高阶函数</strong>: 当你需要将函数作为参数传递或从另一个函数返回函数时。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Function0&lt;Double&gt; <span class="title function_">getRandomGenerator</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Function0.of(Math::random).memoized();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>测试与模拟</strong>: 使用 Function0 可以更容易地在单元测试中模拟依赖。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Function0&lt;Long&gt; currentTimeProvider = Function0.of(System::currentTimeMillis).memoized();</span><br></pre></td></tr></table></figure></li></ol><h2 id="3、Value-值">3、Value(值)</h2><h3 id="3-1-Option-选项">3.1 Option(选项)</h3><p>用法可以参考<a href="http://stream-query.dromara.org/pages/53b6d6/">Stream-Query的Opp</a></p><h3 id="3-2-Try-尝试">3.2 Try(尝试)</h3><p>用法可以参考<a href="http://stream-query.dromara.org/pages/53b6d6/#oftry">Stream-Query的Opp中的ofTry</a></p><h3 id="3-3-Lazy-懒加载">3.3 Lazy(懒加载)</h3><p>惰性是表示惰性求值的 monadic 容器类型。与Supplier相比，Lazy 是记忆的，即它只评估一次，因此在引用上是透明的。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Lazy&lt;Double&gt; lazy = Lazy.of(Math::random);</span><br><span class="line">lazy.isEvaluated(); <span class="comment">// = false</span></span><br><span class="line">lazy.get();         <span class="comment">// = 0.123 (random generated)</span></span><br><span class="line">lazy.isEvaluated(); <span class="comment">// = true</span></span><br><span class="line">lazy.get();</span><br><span class="line">Assert.equals(lazy.get(),lazy.get());</span><br><span class="line"><span class="keyword">final</span> Supplier&lt;Double&gt; doubleSupplier = Math::random;</span><br><span class="line">doubleSupplier.get();</span><br><span class="line">doubleSupplier.get();</span><br><span class="line">Assert.notEquals(doubleSupplier.get(),doubleSupplier.get());</span><br></pre></td></tr></table></figure><blockquote><p>通过Lazy.of()方法创建Lazy，Lazy.of()方法的参数为一个函数，函数的返回值为Lazy的值，Lazy的值只会计算一次，之后再调用get()方法都会返回第一次计算的值。</p></blockquote><h3 id="3-4-Either-左或右">3.4 Either(左或右)</h3><p>Either 表示一个值是左值还是右值。通常，左值用于错误，右值用于成功。默认情况下，Either 是一个不可变的类型，但是您可以使用 Either.left() 和 Either.right() 创建可变的 Either。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testEither</span><span class="params">()</span> &#123;</span><br><span class="line">        Either&lt;String, Integer&gt; value = compute().map(i -&gt; i * <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (value.isRight()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Success: &quot;</span> + value.get());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Failure: &quot;</span> + value.getLeft());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Either&lt;String, Integer&gt; <span class="title function_">compute</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// 模拟一个条件，例如，随机数生成来决定是否成功</span></span><br><span class="line">        <span class="keyword">if</span> (RandomUtil.randomBoolean()) &#123;</span><br><span class="line">            <span class="comment">// 计算成功，返回一个“右”值</span></span><br><span class="line">            <span class="keyword">return</span> Either.right(<span class="number">42</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// 计算失败，返回一个“左”值</span></span><br><span class="line">            <span class="keyword">return</span> Either.left(<span class="string">&quot;Computation failed&quot;</span>);  <span class="comment">// 这是一个示例错误消息</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p>这个方法还是挺有意思的，大多数情况下成功设定为返回右边的值，失败返回左边的值，这样就可以通过isRight()方法判断是否成功，通过get()方法获取值，通过getLeft()方法获取错误信息。<br>还可以对返回成功的值进行一些列的操作也可以使用toEither()自定义失败的返回值</p></blockquote><h3 id="3-5-Validation-验证">3.5 Validation(验证)</h3><p>验证控件是一个应用函子，有助于累积错误。当尝试组合Monads时，组合过程将在第一次遇到错误时短路。但是“验证”将继续处理组合函数，累积所有错误。这在验证多个字段（例如 Web 表单）时特别有用，并且您希望知道遇到的所有错误，而不是一次一个错误。</p><h4 id="3-5-1-combine">3.5.1 combine</h4><h5 id="3-5-1-1-接下来我们验证一下，首先创建一个实体类Person">3.5.1.1 接下来我们验证一下，首先创建一个实体类Person</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> String name;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">        Person(String name, <span class="type">int</span> age) &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Person(&quot;</span> + name + <span class="string">&quot;, &quot;</span> + age + <span class="string">&quot;)&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h5 id="3-5-1-2-然后编写一个用于验证的方法">3.5.1.2 然后编写一个用于验证的方法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Validation&lt;Seq&lt;String&gt;, Person&gt; <span class="title function_">validatePerson</span><span class="params">(String name, <span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Validation.combine(validateName(name), validateAge(age)).ap(Person::<span class="keyword">new</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Validation&lt;String, String&gt; <span class="title function_">validateName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> name == <span class="literal">null</span> || name.trim().isEmpty() ? Validation.invalid(<span class="string">&quot;Name cannot be empty&quot;</span>) : Validation.valid(name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Validation&lt;String, Integer&gt; <span class="title function_">validateAge</span><span class="params">(<span class="type">int</span> age)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> age &lt; <span class="number">0</span> || age &gt; <span class="number">150</span> ? Validation.invalid(<span class="string">&quot;Age must be between 0 and 150&quot;</span>) : Validation.valid(age);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h5 id="3-2-1-3-最后编写一个测试方法">3.2.1.3 最后编写一个测试方法</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Validation&lt;Seq&lt;String&gt;, Person&gt; validPerson = validatePerson(<span class="string">&quot;John&quot;</span>, <span class="number">30</span>);</span><br><span class="line">        Assert.equals(validPerson.get().age,<span class="number">30</span>);</span><br><span class="line">        Assert.equals(validPerson.get().name,<span class="string">&quot;John&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Validation&lt;Seq&lt;String&gt;, Person&gt; invalidPerson = validatePerson(<span class="string">&quot; &quot;</span>, -<span class="number">1</span>);</span><br><span class="line">        Assert.equals(invalidPerson.getError().asJava(), List.of(<span class="string">&quot;Name cannot be empty&quot;</span>, <span class="string">&quot;Age must be between 0 and 150&quot;</span>).asJava());</span><br></pre></td></tr></table></figure><h2 id="4、Collection-集合">4、Collection(集合)</h2><p>为了设计一个全新的Java集合库，它满足了函数式编程的要求，即不变性，已经投入了很多精力。</p><p>Java的Stream将计算提升到不同的层，并在另一个显式步骤中链接到特定的集合。有了Vavr，我们不需要所有这些额外的样板。</p><h3 id="4-1-List-列表">4.1 List(列表)</h3><p>Vavr 是一个不可变的链表。突变会创建新的实例。大多数操作都是线性时间执行的。后续操作将逐个执行。</p><h4 id="4-1-1-创建列表">4.1.1 创建列表</h4><h5 id="4-1-1-1-Java8的使用">4.1.1.1 Java8的使用</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> Optional&lt;Integer&gt; reduce = Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>).reduce(Integer::sum);</span><br><span class="line"><span class="keyword">final</span> <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> IntStream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>).sum();</span><br></pre></td></tr></table></figure><h5 id="4-1-1-2-Vavr的使用">4.1.1.2 Vavr的使用</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">Number</span> <span class="variable">sum1</span> <span class="operator">=</span> List.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>).sum();</span><br><span class="line"><span class="keyword">final</span> <span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> sum1.intValue();</span><br><span class="line">Assert.equals(i,sum);</span><br></pre></td></tr></table></figure><h3 id="4-2-Stream-流">4.2 Stream(流)</h3><p>因为Vavr引入了元组的说明那么与JDK8的Stream相比，Vavr新增了好多便捷的方法以及新特性这里举一个例子</p><blockquote><p>将一个list转换为Map</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> java.util.Map&lt;Integer, Character&gt; collect = Stream.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>).collect(Collectors.toMap(a -&gt; a, b -&gt; (<span class="type">char</span>) (b + <span class="number">64</span>)));</span><br><span class="line"><span class="keyword">final</span> Map&lt;Integer, Character&gt; map = List.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>).toMap(a -&gt; a, b -&gt; (<span class="type">char</span>) (b + <span class="number">64</span>));</span><br><span class="line">Assert.equals(map.get(<span class="number">1</span>).get(), collect.get(<span class="number">1</span>));</span><br><span class="line"><span class="comment">// 上边是普通的转换为map的方法，下边是Vavr新加入了元组之后的转换为map的方法</span></span><br><span class="line"><span class="keyword">final</span> HashMap&lt;Integer, Character&gt; javaMap = List.of(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>).toJavaMap(HashMap::<span class="keyword">new</span>, a -&gt; Tuple.of(a, (<span class="type">char</span>) (a + <span class="number">64</span>)));</span><br><span class="line">Assert.equals(javaMap.get(<span class="number">1</span>), <span class="string">&#x27;A&#x27;</span>);</span><br></pre></td></tr></table></figure><h2 id="5、Property-Checking-属性检查">5、Property Checking(属性检查)</h2><p>这个特性需要引入</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.vavr<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>vavr-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.10.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Arbitrary&lt;Integer&gt; ints = Arbitrary.integer();</span><br><span class="line"></span><br><span class="line"><span class="comment">// square(int) &gt;= 0: OK, passed 1000 tests.</span></span><br><span class="line">Property.def(<span class="string">&quot;square(int) &gt;= 0&quot;</span>)</span><br><span class="line">        .forAll(ints)</span><br><span class="line">        .suchThat(i -&gt; i * i &gt;= <span class="number">0</span>)</span><br><span class="line">        .check()</span><br><span class="line">        .assertIsSatisfied();</span><br></pre></td></tr></table></figure><blockquote><p>通过Arbitrary.integer()方法创建一个随机数，然后通过Property.def()方法创建一个属性，然后通过forAll()方法传入随机数，然后通过suchThat()方法传入一个函数，函数的返回值为boolean，最后通过check()方法检查属性是否满足，最后通过assertIsSatisfied()方法断言属性是否满足。</p></blockquote><h2 id="6、Pattern-Matching-模式匹配">6、Pattern Matching(模式匹配)</h2><p>模式匹配是一种功能，它允许您根据值的类型和结构执行不同的操作。模式匹配是函数式编程的一个重要特性，因为它允许您编写更简洁，更可读的代码。</p><h3 id="6-1-基础匹配">6.1 基础匹配</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> Match(<span class="number">1</span>).of(</span><br><span class="line">        Case($(<span class="number">1</span>), <span class="string">&quot;one&quot;</span>),</span><br><span class="line">        Case($(<span class="number">2</span>), <span class="string">&quot;two&quot;</span>),</span><br><span class="line">        Case($(), <span class="string">&quot;?&quot;</span>)</span><br><span class="line">        );</span><br><span class="line">Assert.equals(s,<span class="string">&quot;one&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">final</span> <span class="type">String</span> <span class="variable">opt</span> <span class="operator">=</span> Match(<span class="literal">null</span>).of(</span><br><span class="line">        Case($(<span class="number">1</span>), <span class="string">&quot;one&quot;</span>),</span><br><span class="line">        Case($(<span class="number">2</span>), <span class="string">&quot;two&quot;</span>),</span><br><span class="line">        Case($(), <span class="string">&quot;?&quot;</span>)</span><br><span class="line">        );</span><br><span class="line">Assert.equals(opt,<span class="string">&quot;?&quot;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>单值匹配，通过Match()，如果值为null可以通过$()匹配，如果值不为null可以通过$(value)匹配</p></blockquote><h3 id="6-2-多条件匹配">6.2 多条件匹配</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">input</span> <span class="operator">=</span> <span class="number">5</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">output</span> <span class="operator">=</span> Match(input).of(</span><br><span class="line">        Case($(n -&gt; n &gt; <span class="number">0</span> &amp;&amp; n &lt; <span class="number">3</span>), <span class="string">&quot;Between 1 and 2&quot;</span>),</span><br><span class="line">        Case($(n -&gt; n &gt; <span class="number">3</span> &amp;&amp; n &lt; <span class="number">6</span>), <span class="string">&quot;Between 4 and 5&quot;</span>),</span><br><span class="line">        Case($(), <span class="string">&quot;Other&quot;</span>)</span><br><span class="line">);</span><br><span class="line">Assert.equals(output,<span class="string">&quot;Between 4 and 5&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="6-3-断言匹配">6.3 断言匹配</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> Match(<span class="number">2</span>).of(</span><br><span class="line">        Case($(a -&gt; a==<span class="number">1</span>), <span class="string">&quot;one&quot;</span>),</span><br><span class="line">        Case($(a-&gt; a==<span class="number">2</span>), <span class="string">&quot;two&quot;</span>),</span><br><span class="line">        Case($(), <span class="string">&quot;?&quot;</span>)</span><br><span class="line">);</span><br><span class="line">Assert.equals(s,<span class="string">&quot;two&quot;</span>);</span><br></pre></td></tr></table></figure><blockquote><p>断言也就是使用lambda表达式Predicate进行匹配</p></blockquote><blockquote><p>Vavr内部还提供了一些常用的断言，比如is(),isIn(),isNotNull(),isNull(),isOneOf(),isZero()等等<br>比如</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">String</span> <span class="variable">opt</span> <span class="operator">=</span> Match(<span class="literal">null</span>).of(</span><br><span class="line">        Case($(is(<span class="number">1</span>)), <span class="string">&quot;one&quot;</span>),</span><br><span class="line">        Case($(is(<span class="number">2</span>)), <span class="string">&quot;two&quot;</span>),</span><br><span class="line">        Case($(), <span class="string">&quot;?&quot;</span>)</span><br><span class="line">);</span><br><span class="line">Assert.equals(opt,<span class="string">&quot;?&quot;</span>);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Lambda </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 语法糖 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ElasticSearch和Kibana配置</title>
      <link href="/posts/e81b0353.html"/>
      <url>/posts/e81b0353.html</url>
      
        <content type="html"><![CDATA[<h2 id="ElasticSearch和Kibana配置">ElasticSearch和Kibana配置</h2><h3 id="1、docker-comppose">1、docker-comppose</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">elasticsearch:</span></span><br><span class="line">  <span class="attr">container_name:</span> <span class="string">gw-es</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zhengqing/elasticsearch:7.14.1</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">./elasticsearch/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">./elasticsearch/logs/elasticsearch.log:/usr/share/elasticsearch/logs/elasticsearch.log</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">./elasticsearch/data:/usr/share/elasticsearch/data</span> <span class="comment">#配置文件挂载</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">./elasticsearch/plugins:/usr/share/elasticsearch/plugins</span> <span class="comment">#日志文件挂载</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&quot;39200:9200&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&quot;39300:9300&quot;</span></span><br><span class="line">  <span class="attr">environment:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">discovery.type=single-node</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ES_JAVA_OPTS=-Xms512m</span> <span class="string">-Xmx1024m</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ELASTIC_PASSWORD=</span> <span class="string">&quot;123456&quot;</span> <span class="comment"># elastic账号密码</span></span><br><span class="line">  <span class="attr">networks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">gw_net</span></span><br><span class="line">  <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line"><span class="attr">kibana:</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zhengqing/kibana:7.14.1</span></span><br><span class="line">  <span class="attr">container_name:</span> <span class="string">gw-kibana</span></span><br><span class="line">  <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">./elasticsearch/kibana/config/kibana.yml:/usr/share/kibana/config/kibana.yml</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&quot;5601:5601&quot;</span></span><br><span class="line">  <span class="attr">depends_on:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">elasticsearch</span></span><br><span class="line">  <span class="attr">links:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">elasticsearch</span></span><br><span class="line">  <span class="attr">networks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">gw_net</span></span><br></pre></td></tr></table></figure><h3 id="2、配置文件">2、配置文件</h3><h4 id="2-1、kibana-yml">2.1、kibana.yml</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server.name:</span> <span class="string">kibana</span></span><br><span class="line"><span class="attr">server.host:</span> <span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line"><span class="attr">elasticsearch.hosts:</span> [ <span class="string">&quot;http://elasticsearch:9200&quot;</span> ] <span class="comment"># http://www.zhengqingya.com:9200 TODO 修改为自己的ip</span></span><br><span class="line"><span class="attr">xpack.monitoring.ui.container.elasticsearch.enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">elasticsearch.username:</span> <span class="string">&quot;elastic&quot;</span>  <span class="comment"># es账号</span></span><br><span class="line"><span class="attr">elasticsearch.password:</span> <span class="string">&quot;123456&quot;</span>   <span class="comment"># es密码</span></span><br><span class="line"><span class="attr">i18n.locale:</span> <span class="string">zh-CN</span> <span class="comment"># 中文</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="2-2、elasticsearch-yml">2.2、elasticsearch.yml</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cluster.name:</span> <span class="string">&quot;docker-cluster&quot;</span></span><br><span class="line"><span class="attr">network.host:</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line"><span class="attr">http.port:</span> <span class="number">9200</span></span><br><span class="line"><span class="comment"># 开启es跨域</span></span><br><span class="line"><span class="attr">http.cors.enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">http.cors.allow-origin:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line"><span class="attr">http.cors.allow-headers:</span> <span class="string">Authorization</span></span><br><span class="line"><span class="comment"># 开启安全控制</span></span><br><span class="line"><span class="attr">xpack.security.enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">xpack.security.transport.ssl.enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="3、初始化密码">3、初始化密码</h2><h3 id="3、1-首先执行以下命令进如到ES容器中">3、1 首先执行以下命令进如到ES容器中</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it [容器ID/容器名] /bin/bash </span><br></pre></td></tr></table></figure><h3 id="3、2-执行以下命令初始化密码">3、2 执行以下命令初始化密码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/elasticsearch-setup-passwords interactive</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ElasticSearch </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker-compose </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>解析双层DDF</title>
      <link href="/posts/8dda91f7.html"/>
      <url>/posts/8dda91f7.html</url>
      
        <content type="html"><![CDATA[<p>需引入Maven依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.pdfbox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pdfbox<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.pdfbox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pdfbox-tools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.26<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Map&lt;Integer, String&gt; <span class="title function_">PDFIdentification</span><span class="params">(InputStream inputStream)</span> &#123;</span><br><span class="line">        Map&lt;Integer, String&gt; textMap = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//读取PDF</span></span><br><span class="line">        <span class="type">PDDocument</span> <span class="variable">document</span> <span class="operator">=</span> PDDocument.load(inputStream);</span><br><span class="line">        <span class="comment">//按照页码读取文本</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; document.getNumberOfPages(); i++) &#123;</span><br><span class="line">            <span class="comment">//文本剥离器</span></span><br><span class="line">            <span class="type">PDFTextStripper</span> <span class="variable">stripper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDFTextStripper</span>();</span><br><span class="line">            stripper.setStartPage(i + <span class="number">1</span>);</span><br><span class="line">            stripper.setEndPage(i + <span class="number">1</span>);</span><br><span class="line">            <span class="comment">//按照位置排序</span></span><br><span class="line">            stripper.setSortByPosition(<span class="literal">true</span>);</span><br><span class="line">            <span class="comment">//获取文本</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> stripper.getText(document);</span><br><span class="line">            <span class="keyword">if</span> (StrUtil.isBlank(text)) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            text = text.replace(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            textMap.put(i + <span class="number">1</span>, text);</span><br><span class="line">        &#125;</span><br><span class="line">        document.close();</span><br><span class="line">        <span class="keyword">return</span> textMap;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p>解析完之后Map的Key是pdf的页数，Value是pdf的内容</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 小技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 模板模式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数据最终一致性问题</title>
      <link href="/posts/3224ec7a.html"/>
      <url>/posts/3224ec7a.html</url>
      
        <content type="html"><![CDATA[<p>数据库和缓存Redis的一致性问题无论在面试还是平时使用的时候都是一个很常见且关键的问题这里我写一篇文章记录一下</p><h2 id="Cache-Aside">Cache-Aside</h2><p>旁路缓存模式，应用最为广泛的一种缓存策略。</p><h3 id="读请求">读请求</h3><p>首先查询redis查看是否存在，如果存在的话直接返回数据，如果不存在查询数据库，然后写入缓存</p><h3 id="写请求">写请求</h3><p>直接更新数据库然后删除缓存</p><blockquote><h3 id="为什么先更新数据库，而不是先删除缓存">为什么先更新数据库，而不是先删除缓存</h3><p>因为在并发的情况下如果线程A先去删除缓存然后线程B去查询了数据K，此时线程B查询了数据K，并且将数据写入了缓存，然后线程A才去更新了数据库，然后此时我们的缓存就会是一个旧数据所以不能先删除缓存</p></blockquote><h4 id="在这种情况下怎么解决缓存一致性的问题呢">在这种情况下怎么解决缓存一致性的问题呢</h4><p>由于先删除缓存后更新数据会有缓存脏数据，所以业内又提出了延时双删，也就是在删除数据之后，更新数据库，防止别的线程读取了数据产生了脏缓存延时之后再进行一次删除，这个延时的时间一般稍微大于业务的读时间耗时，但是无论这个值如何预估，都很难和读请求的完成时间点准确衔接，这也是延时双删被诟病的主要原因。</p><h3 id="先更新数据之后再删除缓存就没有问题了么">先更新数据之后再删除缓存就没有问题了么</h3><p>肯定不是的，在读写并发的时候也是会出现数据不一致的问题的，下面列举一种场景</p><ol><li>线程A读取数据K</li><li>线程B更新数据K</li><li>(在线程B)更新了数据K的时候，现在并没有缓存所以我们不需要去删除掉缓存</li><li>线程A读取的旧数据K就将旧数据写入到Redis缓存中了</li></ol><blockquote><p>此时就会造成数据不一致，单无论是缓存双删还是先更新数据后删除缓存都会有可能删除失败</p></blockquote><h2 id="删除数据失败的补偿机制">删除数据失败的补偿机制</h2><p>在上边说到的所有机制里边都会发生缓存不一致的问题，所以针对可能出现删除失败问题，主要有一下几种补偿机制</p><h3 id="消息队列进行重试">消息队列进行重试</h3><p>原因是因为如果我们使用另外一个线程的话，如果在执行失败的线程中一直重试，还没等执行成功，此时如果项目重启了，那这次重试请求也就丢失了，那这条数据就一直不一致了。所以，这里我们必须把重试或第二步操作放到另一个服务中，这个服务用消息队列最为合适。</p><ul><li><strong>消息队列保证可靠性</strong>：写到队列中的消息，成功消费之前不会丢失（重启项目也不担心）</li><li><strong>消息队列保证消息成功投递</strong>：下游从队列拉取消息，成功消费后才会删除消息，否则还会继续投递消息给消费者（符合我们重试的场景）</li></ul><blockquote><p>但是无论是使用消息队列或者去异步的进行重试都会去触及业务层所以我们在为了不干扰业务的时候去进行同步可以监听binlog</p></blockquote><h3 id="使用maxwell监听binlog">使用maxwell监听binlog</h3><p>使用maxwell监听binlog，在数据发生变化的时候生成JSON格式的消息，作为生产者发送给mq然后通过mq去根据这条数据删除对应的缓存</p><p>订阅变更日志，目前也有了比较成熟的开源中间件，例如阿里的 canal，使用这种方案的优点在于：</p><ul><li><strong>无需考虑写消息队列失败情况</strong>：只要写 MySQL 成功，binlog 肯定会有</li><li><strong>自动投递到下游队列</strong>：canal 自动把数据库变更日志「投递」给下游的消息队列</li></ul><h2 id="Write-Read-Through">Write/Read-Through</h2><p>核心思想：应用需要操作数据时只与缓存组件进行交互；缓存数据不会过期</p><p><code>Read-Through</code>应用查询缓存是否存在，存在则直接返回，不存在则由缓存组件去数据库加载数据</p><p><code>Write-Through</code>，先查询数据是否存在，存在则先更新缓存再去由缓存组件更新数据库，如果不存在的话有两种办法1. 直接更新数据库 2. 更新缓存然后由缓存组件去同步数据库</p><blockquote><p>存在的问题：</p><ul><li>因为应用操作数据时只与缓存组件交互，相对于Cache-Aside而言数据不一致的概率要低一些。</li><li>因为此模式下缓存没有过期时间，所以缓存的使用量会非常大。</li></ul></blockquote><h2 id="Write-Back">Write-Back</h2>]]></content>
      
      
      <categories>
          
          <category> 实用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AQS万字解析</title>
      <link href="/posts/be7fed04.html"/>
      <url>/posts/be7fed04.html</url>
      
        <content type="html"><![CDATA[<h1>AQS源码</h1><p>最近研究了一下AQS的源码这里写一篇文章讲一下AQS到底是干什么的怎么工作的</p><h2 id="AbstractQueuedSynchronizer">AbstractQueuedSynchronizer</h2><p>AbstractQueuedSynchronizer这个类大家应该都听说过，他是一个用于编写并发编程的框架，可以在他的基础上对一些方法进行重写实现不同的策略</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20221213112527308.png" alt="image-20221213112527308"></p><p>可以看到我们这个类是一个抽象类，但是他里边并没有任何一个抽象方法，而是留有很多这种以protected关键字修饰的方法</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20221213112838142.png" alt="image-20221213112838142"></p><p>那么可能会有疑问,为什么在抽象类中一个抽象方法都没有,而是好多这种默认方法呢，因为为了子类更好的实现定制化如果子类不去实现的话直接就会抛出异常，而不是像抽象方法一样必须重写。</p><p>然后我们看一下里边的Node节点是怎样的</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">Node</span> &#123;</span><br><span class="line">    <span class="comment">/** Marker to indicate a node is waiting in shared mode */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Node</span> <span class="variable">SHARED</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>();</span><br><span class="line">    <span class="comment">/** Marker to indicate a node is waiting in exclusive mode */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Node</span> <span class="variable">EXCLUSIVE</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** waitStatus value to indicate thread has cancelled */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">CANCELLED</span> <span class="operator">=</span>  <span class="number">1</span>;</span><br><span class="line">    <span class="comment">/** waitStatus value to indicate successor&#x27;s thread needs unparking */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SIGNAL</span>    <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">    <span class="comment">/** waitStatus value to indicate thread is waiting on condition */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">CONDITION</span> <span class="operator">=</span> -<span class="number">2</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * waitStatus value to indicate the next acquireShared should</span></span><br><span class="line"><span class="comment">     * unconditionally propagate</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">PROPAGATE</span> <span class="operator">=</span> -<span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Status field, taking on only the values:</span></span><br><span class="line"><span class="comment">     *   SIGNAL:     The successor of this node is (or will soon be)</span></span><br><span class="line"><span class="comment">     *               blocked (via park), so the current node must</span></span><br><span class="line"><span class="comment">     *               unpark its successor when it releases or</span></span><br><span class="line"><span class="comment">     *               cancels. To avoid races, acquire methods must</span></span><br><span class="line"><span class="comment">     *               first indicate they need a signal,</span></span><br><span class="line"><span class="comment">     *               then retry the atomic acquire, and then,</span></span><br><span class="line"><span class="comment">     *               on failure, block.</span></span><br><span class="line"><span class="comment">     *   CANCELLED:  This node is cancelled due to timeout or interrupt.</span></span><br><span class="line"><span class="comment">     *               Nodes never leave this state. In particular,</span></span><br><span class="line"><span class="comment">     *               a thread with cancelled node never again blocks.</span></span><br><span class="line"><span class="comment">     *   CONDITION:  This node is currently on a condition queue.</span></span><br><span class="line"><span class="comment">     *               It will not be used as a sync queue node</span></span><br><span class="line"><span class="comment">     *               until transferred, at which time the status</span></span><br><span class="line"><span class="comment">     *               will be set to 0. (Use of this value here has</span></span><br><span class="line"><span class="comment">     *               nothing to do with the other uses of the</span></span><br><span class="line"><span class="comment">     *               field, but simplifies mechanics.)</span></span><br><span class="line"><span class="comment">     *   PROPAGATE:  A releaseShared should be propagated to other</span></span><br><span class="line"><span class="comment">     *               nodes. This is set (for head node only) in</span></span><br><span class="line"><span class="comment">     *               doReleaseShared to ensure propagation</span></span><br><span class="line"><span class="comment">     *               continues, even if other operations have</span></span><br><span class="line"><span class="comment">     *               since intervened.</span></span><br><span class="line"><span class="comment">     *   0:          None of the above</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * The values are arranged numerically to simplify use.</span></span><br><span class="line"><span class="comment">     * Non-negative values mean that a node doesn&#x27;t need to</span></span><br><span class="line"><span class="comment">     * signal. So, most code doesn&#x27;t need to check for particular</span></span><br><span class="line"><span class="comment">     * values, just for sign.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * The field is initialized to 0 for normal sync nodes, and</span></span><br><span class="line"><span class="comment">     * CONDITION for condition nodes.  It is modified using CAS</span></span><br><span class="line"><span class="comment">     * (or when possible, unconditional volatile writes).</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">volatile</span> <span class="type">int</span> waitStatus;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Link to predecessor node that current node/thread relies on</span></span><br><span class="line"><span class="comment">     * for checking waitStatus. Assigned during enqueuing, and nulled</span></span><br><span class="line"><span class="comment">     * out (for sake of GC) only upon dequeuing.  Also, upon</span></span><br><span class="line"><span class="comment">     * cancellation of a predecessor, we short-circuit while</span></span><br><span class="line"><span class="comment">     * finding a non-cancelled one, which will always exist</span></span><br><span class="line"><span class="comment">     * because the head node is never cancelled: A node becomes</span></span><br><span class="line"><span class="comment">     * head only as a result of successful acquire. A</span></span><br><span class="line"><span class="comment">     * cancelled thread never succeeds in acquiring, and a thread only</span></span><br><span class="line"><span class="comment">     * cancels itself, not any other node.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">volatile</span> Node prev;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Link to the successor node that the current node/thread</span></span><br><span class="line"><span class="comment">     * unparks upon release. Assigned during enqueuing, adjusted</span></span><br><span class="line"><span class="comment">     * when bypassing cancelled predecessors, and nulled out (for</span></span><br><span class="line"><span class="comment">     * sake of GC) when dequeued.  The enq operation does not</span></span><br><span class="line"><span class="comment">     * assign next field of a predecessor until after attachment,</span></span><br><span class="line"><span class="comment">     * so seeing a null next field does not necessarily mean that</span></span><br><span class="line"><span class="comment">     * node is at end of queue. However, if a next field appears</span></span><br><span class="line"><span class="comment">     * to be null, we can scan prev&#x27;s from the tail to</span></span><br><span class="line"><span class="comment">     * double-check.  The next field of cancelled nodes is set to</span></span><br><span class="line"><span class="comment">     * point to the node itself instead of null, to make life</span></span><br><span class="line"><span class="comment">     * easier for isOnSyncQueue.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">volatile</span> Node next;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The thread that enqueued this node.  Initialized on</span></span><br><span class="line"><span class="comment">     * construction and nulled out after use.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">volatile</span> Thread thread;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Link to next node waiting on condition, or the special</span></span><br><span class="line"><span class="comment">     * value SHARED.  Because condition queues are accessed only</span></span><br><span class="line"><span class="comment">     * when holding in exclusive mode, we just need a simple</span></span><br><span class="line"><span class="comment">     * linked queue to hold nodes while they are waiting on</span></span><br><span class="line"><span class="comment">     * conditions. They are then transferred to the queue to</span></span><br><span class="line"><span class="comment">     * re-acquire. And because conditions can only be exclusive,</span></span><br><span class="line"><span class="comment">     * we save a field by using special value to indicate shared</span></span><br><span class="line"><span class="comment">     * mode.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Node nextWaiter;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns true if node is waiting in shared mode.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">isShared</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> nextWaiter == SHARED;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Returns previous node, or throws NullPointerException if null.</span></span><br><span class="line"><span class="comment">     * Use when predecessor cannot be null.  The null check could</span></span><br><span class="line"><span class="comment">     * be elided, but is present to help the VM.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the predecessor of this node</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">final</span> Node <span class="title function_">predecessor</span><span class="params">()</span> <span class="keyword">throws</span> NullPointerException &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> prev;</span><br><span class="line">        <span class="keyword">if</span> (p == <span class="literal">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>();</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> p;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Node() &#123;    <span class="comment">// Used to establish initial head or SHARED marker</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Node(Thread thread, Node mode) &#123;     <span class="comment">// Used by addWaiter</span></span><br><span class="line">        <span class="built_in">this</span>.nextWaiter = mode;</span><br><span class="line">        <span class="built_in">this</span>.thread = thread;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Node(Thread thread, <span class="type">int</span> waitStatus) &#123; <span class="comment">// Used by Condition</span></span><br><span class="line">        <span class="built_in">this</span>.waitStatus = waitStatus;</span><br><span class="line">        <span class="built_in">this</span>.thread = thread;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>waitStatus这个属性是一个当前的节点状态，可能有以下状态</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="comment">// 为1的时候说明这个任务可能因为中断或者其他原因取消了</span></span><br><span class="line">&gt;<span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">CANCELLED</span> <span class="operator">=</span>  <span class="number">1</span>;</span><br><span class="line">&gt;<span class="comment">// 代表下一个节点需要被唤醒</span></span><br><span class="line">&gt;<span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">SIGNAL</span>    <span class="operator">=</span> -<span class="number">1</span>;</span><br><span class="line">&gt;<span class="comment">// 用于条件队列</span></span><br><span class="line">&gt;<span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">CONDITION</span> <span class="operator">=</span> -<span class="number">2</span>;</span><br><span class="line">&gt;<span class="comment">// 用于共享锁</span></span><br><span class="line">&gt;<span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">PROPAGATE</span> <span class="operator">=</span> -<span class="number">3</span>;</span><br></pre></td></tr></table></figure></blockquote><h2 id="从ReentrantLock的非公平锁独占锁来看AQS的原理">从ReentrantLock的非公平锁独占锁来看AQS的原理</h2><p>以lock和unlock来看</p><p>ReentrantLock中有这样一个静态内部类NonfairSync也就是非公平锁的实现</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">class</span> <span class="title class_">NonfairSync</span> <span class="keyword">extends</span> <span class="title class_">Sync</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">7316153563782823691L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Performs lock.  Try immediate barge, backing up to normal</span></span><br><span class="line"><span class="comment">     * acquire on failure.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">void</span> <span class="title function_">lock</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (compareAndSetState(<span class="number">0</span>, <span class="number">1</span>))</span><br><span class="line">            setExclusiveOwnerThread(Thread.currentThread());</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            acquire(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">tryAcquire</span><span class="params">(<span class="type">int</span> acquires)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> nonfairTryAcquire(acquires);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="lock详解">lock详解</h2><p>我们来看一下lock中的语句,一开始他通过cas操作将标识state从0更改为1，如果更改成功的话将当前线程设置为有访问权限线程当前拥有权限，如果cas失败的话会进入else语句执行acquire(1),这个方法很重点</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public final void <span class="built_in">acquire</span>(int arg) &#123;</span><br><span class="line">    if (!tryAcquire(arg) &amp;&amp;</span><br><span class="line">        <span class="built_in">acquireQueued</span>(addWaiter(Node.EXCLUSIVE), arg))</span><br><span class="line">        <span class="built_in">selfInterrupt</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 里边包含了三个方法分别是tryAcquire(), addWaiter(Node.EXCLUSIVE), acquireQueued()</span></span><br></pre></td></tr></table></figure><p>从第一个方法开始看,tryAcquire是ReentrantLock自己重写的, 它里面调用了nonfairTryAcquire</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Performs non-fair tryLock.  tryAcquire is implemented in</span></span><br><span class="line"><span class="comment"> * subclasses, but both need nonfair try for trylock method.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">nonfairTryAcquire</span><span class="params">(<span class="type">int</span> acquires)</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">Thread</span> <span class="variable">current</span> <span class="operator">=</span> Thread.currentThread();</span><br><span class="line">    <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> getState();</span><br><span class="line">    <span class="keyword">if</span> (c == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (compareAndSetState(<span class="number">0</span>, acquires)) &#123;</span><br><span class="line">            setExclusiveOwnerThread(current);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (current == getExclusiveOwnerThread()) &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">nextc</span> <span class="operator">=</span> c + acquires;</span><br><span class="line">        <span class="keyword">if</span> (nextc &lt; <span class="number">0</span>) <span class="comment">// overflow</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Maximum lock count exceeded&quot;</span>);</span><br><span class="line">        setState(nextc);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个方法总体来说就是通过cas的方式去尝试获得锁，获取不到的话也不会自旋而是进入addWaiter(Node.EXCLUSIVE)方法，我们来看一下</p><ol><li><p>获得当前的线程, 然后拿到当前锁的状态, 这个状态在不同同步器中有不同的含义, 在ReentrantLock中状态为0代表锁是空闲的, 1代表有线程持有锁, 大于1代表锁被重入的次数(1其实也可以看作第一次重入)</p></li><li><p>如果当前资源的状态为0, 使用cas尝试将状态从0设为1，如果成功, 标记当前线程持有锁</p></li><li><p>如果不是的话, 会再去判断当前线程是不是持有锁的线程, 如果是的话, 会将当前的state的值加上申请的资源值, 意味着锁被重入</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (nextc &lt; <span class="number">0</span>) <span class="comment">// overflow</span></span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Maximum lock count exceeded&quot;</span>);</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 在重入过程中, 如果资源数量由正变负, 代表资源溢出了, 毕竟初始值是0, 获取资源时也是不断累加, 不会有人尝试获取负数的资源, 那没有意义. </span></span><br><span class="line"><span class="comment"> * 我们都知道int类型的数据取值范围是[-2147483648, 2147483647]&quot; 所以一般是不可能触发这个Error的</span></span><br><span class="line"><span class="comment"> * */</span></span><br></pre></td></tr></table></figure><blockquote><p>如果都不满足返回false<br>上面我说的是理想状态下，如果是多线程竞争状态下呢，我们可以看一下, 假如线程A进来的时候, 状态码为0, 此时cas按理说应该是成功的, 可是在这个时候线程B来了, 获得的状态码也为0，而且线程B的cas先一步成功了，那么线程A获取锁就失败了, 又由于A和B是两个不同的线程, 所以线程A调用nonfairTryAcquire()的结果是false, 继续往后执行</p></blockquote><p>下面我们回到acquire方法, 如果tryAcquire方法返回了true, 说明已经成功获取到锁, 那么我们直接返回，继续往后执行代码就行，如果返回了false, 我们就会执行后边的方法addWaiter和acquireQueued方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!tryAcquire(arg) &amp;&amp;</span><br><span class="line">    acquireQueued(addWaiter(Node.EXCLUSIVE), arg))</span><br><span class="line">    selfInterrupt();</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">acquireQueued(addWaiter(Node.EXCLUSIVE), arg))</span><br><span class="line"><span class="comment">// 这个方法会先执行assWaiter方法，参数为当前的模式独占模式和1，这个方法在尝试获得锁之后如果没有获得锁的话会将他加入到队列中</span></span><br></pre></td></tr></table></figure><h3 id="addWaiter-Node-EXCLUSIVE">addWaiter(Node.EXCLUSIVE)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Node <span class="title function_">addWaiter</span><span class="params">(Node mode)</span> &#123;</span><br><span class="line">    <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(Thread.currentThread(), mode);</span><br><span class="line">    <span class="comment">// Try the fast path of enq; backup to full enq on failure</span></span><br><span class="line">    <span class="type">Node</span> <span class="variable">pred</span> <span class="operator">=</span> tail;</span><br><span class="line">    <span class="keyword">if</span> (pred != <span class="literal">null</span>) &#123;</span><br><span class="line">        node.prev = pred;</span><br><span class="line">        <span class="keyword">if</span> (compareAndSetTail(pred, node)) &#123;</span><br><span class="line">            pred.next = node;</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    enq(node);</span><br><span class="line">    <span class="keyword">return</span> node;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>addWaiter方法是给当前线程创建一个节点, 并添加到同步队列中, 排队等待机会获取锁, 参数Node.EXCLUSIVE代表当前线程希望以独占模式获取锁</p><p>然后获得尾节点, 如果尾节点已经创建，则使用尾插法将节点入队, 如果没有则调用enq方法入队, 实际上enq就是多了一步初始化头节点和尾节点的处理, 入队依然是使用相同的尾插法, 我们直接讲enq(node)里边的逻辑</p><h4 id="enq-node">enq(node)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Node <span class="title function_">enq</span><span class="params">(<span class="keyword">final</span> Node node)</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">        <span class="type">Node</span> <span class="variable">t</span> <span class="operator">=</span> tail;</span><br><span class="line">        <span class="keyword">if</span> (t == <span class="literal">null</span>) &#123; <span class="comment">// Must initialize</span></span><br><span class="line">            <span class="keyword">if</span> (compareAndSetHead(<span class="keyword">new</span> <span class="title class_">Node</span>()))</span><br><span class="line">                tail = head;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            node.prev = t;</span><br><span class="line">            <span class="keyword">if</span> (compareAndSetTail(t, node)) &#123;</span><br><span class="line">                t.next = node;</span><br><span class="line">                <span class="keyword">return</span> t;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这个里边的逻辑其实也挺简单的, 我们看一下, 首先是一个死循环, 这个死循环相当于一个自旋</p><blockquote><p>理想状态</p><p>在理想状态下首先同样会拿到当前队列的尾节点然后判断是否为null，如果为null的话说明此时还不存在尾节点，则创建一个节点当队列的头节点，里边的数据是null，然后cas的方式将其设为头节点然后尾节点也是它，因为我们这个分支里边并没有return语句所以还会重新进入循环，此时尾节点已经不是null了，那么我们进入else里边的分支，首先</p>  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">node.prev = t;</span><br><span class="line"><span class="comment">// 这句话会将当前节点的上一个节点设为头节点，然后通过cas的方式去将当前的节点设置为队列的尾节点</span></span><br><span class="line"><span class="comment">// 如果设置成功的话将当前队列的尾节点的下一个节点设置成当前节点然后将其返回</span></span><br></pre></td></tr></table></figure><p>不理想状态(并发)</p><p>在不理想状态的时候，模拟一下场景, 假如线程A进入了for循环, 判断了当前的尾节点为null，但是他在执行compareAndSetHead(new Node())的时候, 刚new出自己的节点来之后，就被线程B抢先将队列的头节点设置为自己new的节点，此时队列的尾节点就是线程B的节点数据，那么此时线程A去cas设置头节点就会失败，然后线程A进入下一轮循环, 此时的尾节点已经存在，我们就会使用尾插法将线程A设置为新的尾节点，最终返回旧的尾节点(这是因为AQS是前驱节点负责唤醒当前节点)</p></blockquote><blockquote><p>注意：enq()方法会返回旧的尾节点，但是addWaiter是返回当前线程的节点</p></blockquote><h3 id="acquireQueued-addWaiter-Node-EXCLUSIVE-arg">acquireQueued(addWaiter(Node.EXCLUSIVE), arg)</h3><p>上边讲完了addWaiter下面讲一下acquireQueued方法，上一个方法将当前线程的节点添加到同步队列之后, 会将其前驱节点返回, acquireQueued方法会尝试将该前驱节点设置为新的头节点, 以此来唤醒当前线程的节点, 我们来看一下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">acquireQueued</span><span class="params">(<span class="keyword">final</span> Node node, <span class="type">int</span> arg)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">failed</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">boolean</span> <span class="variable">interrupted</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">for</span> (;;) &#123;</span><br><span class="line">                <span class="keyword">final</span> <span class="type">Node</span> <span class="variable">p</span> <span class="operator">=</span> node.predecessor();</span><br><span class="line">                <span class="keyword">if</span> (p == head &amp;&amp; tryAcquire(arg)) &#123;</span><br><span class="line">                    setHead(node);</span><br><span class="line">                    p.next = <span class="literal">null</span>; <span class="comment">// help GC</span></span><br><span class="line">                    failed = <span class="literal">false</span>;</span><br><span class="line">                    <span class="keyword">return</span> interrupted;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (shouldParkAfterFailedAcquire(p, node) &amp;&amp;</span><br><span class="line">                    parkAndCheckInterrupt())</span><br><span class="line">                    interrupted = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (failed)</span><br><span class="line">                cancelAcquire(node);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p>这个方法理解起来还是有点难度的，我们先看一下这两个标志位</p><p>boolean failed = true; // 在获取锁的过程中是否获取失败</p><p>boolean interrupted = false; // 在获取锁的过程中是否发生了中断</p></blockquote><p>接下来我们看一下for循环里边的逻辑</p><blockquote><ol><li><p>首先会拿到当前节点的前置节点, 如果前置节点是头节点的话, 代表当前节点已经是队列中第一个待执行的节点, 此时可以再次尝试获取锁, 无需任何等待(这里再次尝试获得锁的原因是，可能在添加节点到队列的过程中，拥有当前锁线程已经被释放)</p></li><li><p>我们先看获取锁成功的时候，如果获取锁成功的话我们就会将当前的节点设置为头节点，我们来看一下这个设置头节点的代码是怎么做的。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">setHead</span><span class="params">(Node node)</span> &#123;</span><br><span class="line"><span class="comment">// 首先将我们的当前节点设为头节点</span></span><br><span class="line">    head = node;</span><br><span class="line">    <span class="comment">// 然后将当前节点的线程数据置为null</span></span><br><span class="line">    node.thread = <span class="literal">null</span>;</span><br><span class="line">    <span class="comment">// 将当前节点的前驱节点置为null</span></span><br><span class="line">    node.prev = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>接下来将我们的前驱节点的后继节点设为null</p></li></ol><pre><code><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这里的意思也就是，因为我们上一步已经将当前节点的前置节点设为了<span class="literal">null</span>所以现在已经不需要之前的头节点了，所以我们需要将原始头节点的的后继节点设为<span class="literal">null</span>，此时头节点就没有任何的引用了我们的GC会将他进行回收</span><br></pre></td></tr></table></figure></code></pre><ol start="3"><li><p>然后将是否获取失败标志位设为false，然后返回false</p></li><li><p>我们现在看了当前节点的前置节点是头节点并且抢占锁成功的状态，我们接下来看一下如果当前节点不是头节点或者是头节点但是抢占锁失败的情况下是如何处理的，也就是</p></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (shouldParkAfterFailedAcquire(p, node) &amp;&amp;</span><br><span class="line">                         parkAndCheckInterrupt())</span><br><span class="line">                         interrupted = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">// 这里的处理我们挨个方法来讲首先来看一下shouldParkAfterFailedAcquire(p, node)</span></span><br></pre></td></tr></table></figure><pre><code> 1. shouldParkAfterFailedAcquire(p, node)    <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">shouldParkAfterFailedAcquire</span><span class="params">(Node pred, Node node)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">ws</span> <span class="operator">=</span> pred.waitStatus;</span><br><span class="line">        <span class="keyword">if</span> (ws == Node.SIGNAL)</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * This node has already set status asking a release</span></span><br><span class="line"><span class="comment">             * to signal it, so it can safely park.</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span> (ws &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// 这里我在下边没有讲到这里就是如果大于0就说明这个任务可能因为中断或者其他原因取消了，我们就将当前的节点的前驱节点置为前驱节点的前驱，其实目的就是跳过有问题的节点，找到我们上一个可以唤醒下一节点的节点</span></span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                node.prev = pred = pred.prev;</span><br><span class="line">            &#125; <span class="keyword">while</span> (pred.waitStatus &gt; <span class="number">0</span>);</span><br><span class="line">            pred.next = node;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">/*</span></span><br><span class="line"><span class="comment">             * waitStatus must be 0 or PROPAGATE.  Indicate that we</span></span><br><span class="line"><span class="comment">             * need a signal, but don&#x27;t park yet.  Caller will need to</span></span><br><span class="line"><span class="comment">             * retry to make sure it cannot acquire before parking.</span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            compareAndSetWaitStatus(pred, ws, Node.SIGNAL);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>    &gt;这个方法呢他的作用就是检查并重新获取失败节点的状态，我们可以看一下详细的代码，以为我们使用的非公平独占锁来进行讲解所以他的waitStatus只可能为-1，1，还有初始值0，注意有两个参数，参数一是我们的前驱节点，参数二是我们的当前的节点，当我们队列中添加了节点之后int ws = pred.waitStatus;获得前驱节点默认值肯定是0，然后进来进行判断走进else语句中执行compareAndSetWaitStatus(pred, ws, Node.SIGNAL);将前驱节点的状态值改为Node.SIGNAL，也就是-1，然后返回false此时就不去执行parkAndCheckInterrupt()方法了，而是重新进入for循环，此时如果还不满足第一个if的条件的话还是进入我们的    &gt;    &gt;<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">   <span class="keyword">if</span> (shouldParkAfterFailedAcquire(p, node) &amp;&amp;</span><br><span class="line">parkAndCheckInterrupt())</span><br></pre></td></tr></table></figure>    &gt;    &gt;此时在进入shouldParkAfterFailedAcquire(p, node)之后我们的前驱节点的标志位就是-1了所以进入parkAndCheckInterrupt()方法中    &gt;    &gt;<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">parkAndCheckInterrupt</span><span class="params">()</span> &#123;</span><br><span class="line">    LockSupport.park(<span class="built_in">this</span>);</span><br><span class="line">    <span class="keyword">return</span> Thread.interrupted();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>    &gt;    &gt;这个方法就是将当前的线程挂起</code></pre><ol start="2"><li><p>我为什么没有说finally里边的cancelAcquire(node);方法呢因为他在我们的非公平锁独占模式下发生的概率很小，可以看一下上边的代码，如果我们想要进入cancelAcquire(node);方法首先failer必须为true，但是呢一旦进入了</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (p == head &amp;&amp; tryAcquire(arg)) &#123;</span><br><span class="line">    setHead(node);</span><br><span class="line">    p.next = <span class="literal">null</span>; <span class="comment">// help GC</span></span><br><span class="line">    failed = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> interrupted;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 只有进入这段代码之后才会进入finally但是一旦进入finally我们的faile的值已经变成false了不会执行，还有一种情况就是抛出异常但是只有node.predecessor();这段代码会抛出异常所以概率很小很小，下面我单独讲一下这个方法的内部实现就不说出现的场景了</span></span><br></pre></td></tr></table></figure></li></ol></blockquote><h3 id="cancelAcquire-node">cancelAcquire(node)</h3><p>这个方法的作用是在当前节点再次获取锁失败后，判断当前线程是否需要挂起等待,  此时, 当前节点确实是队列中下一个执行的节点, 但是前面的节点还没释放锁, 所以当前线程可能需要挂起自己, 等待唤醒, 该方法返回true则挂起当前线程, false则返回acquireQueued方法继续自旋.<br>我们可以看一下详细的代码，因为我们使用的非公平独占锁来进行讲解, 所以他的waitStatus只可能为-1，1，还有初始值0，注意该方法有两个参数，参数一是我们的前驱节点，参数二是我们的当前的节点，当前节点是我们队列中的新节点, 获得前驱节点的waitStatus值肯定是0，直接执行compareAndSetWaitStatus(pred, ws, Node.SIGNAL);将前驱节点的状态值改为Node.SIGNAL，也就是-1，代表着, 当前线程已经将唤醒自己的任务托付给了前驱节点(这里我比较疑惑, 为什么要将等待状态放到前驱节点上, 放自己身上不行吗), 然后返回false, 此时就不去执行parkAndCheckInterrupt()方法了，而是重新进入for循环，此时如果还不满足第一个if的条件的话还是进入我们的, 第二次循环中, 如果再次进入shouldParkAfterFailedAcquire, 此时前驱节点的等待状态就是Node.SIGNAL, 所以直接返回true, 并执行parkAndCheckInterrupt(), 将当前线程挂起</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">cancelAcquire</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">    <span class="comment">// Ignore if node doesn&#x27;t exist</span></span><br><span class="line">    <span class="keyword">if</span> (node == <span class="literal">null</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    node.thread = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Skip cancelled predecessors</span></span><br><span class="line">    <span class="type">Node</span> <span class="variable">pred</span> <span class="operator">=</span> node.prev;</span><br><span class="line">    <span class="keyword">while</span> (pred.waitStatus &gt; <span class="number">0</span>)</span><br><span class="line">        node.prev = pred = pred.prev;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// predNext is the apparent node to unsplice. CASes below will</span></span><br><span class="line">    <span class="comment">// fail if not, in which case, we lost race vs another cancel</span></span><br><span class="line">    <span class="comment">// or signal, so no further action is necessary.</span></span><br><span class="line">    <span class="type">Node</span> <span class="variable">predNext</span> <span class="operator">=</span> pred.next;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Can use unconditional write instead of CAS here.</span></span><br><span class="line">    <span class="comment">// After this atomic step, other Nodes can skip past us.</span></span><br><span class="line">    <span class="comment">// Before, we are free of interference from other threads.</span></span><br><span class="line">    node.waitStatus = Node.CANCELLED;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// If we are the tail, remove ourselves.</span></span><br><span class="line">    <span class="keyword">if</span> (node == tail &amp;&amp; compareAndSetTail(node, pred)) &#123;</span><br><span class="line">        compareAndSetNext(pred, predNext, <span class="literal">null</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// If successor needs signal, try to set pred&#x27;s next-link</span></span><br><span class="line">        <span class="comment">// so it will get one. Otherwise wake it up to propagate.</span></span><br><span class="line">        <span class="type">int</span> ws;</span><br><span class="line">        <span class="keyword">if</span> (pred != head &amp;&amp;</span><br><span class="line">            ((ws = pred.waitStatus) == Node.SIGNAL ||</span><br><span class="line">             (ws &lt;= <span class="number">0</span> &amp;&amp; compareAndSetWaitStatus(pred, ws, Node.SIGNAL))) &amp;&amp;</span><br><span class="line">            pred.thread != <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="type">Node</span> <span class="variable">next</span> <span class="operator">=</span> node.next;</span><br><span class="line">            <span class="keyword">if</span> (next != <span class="literal">null</span> &amp;&amp; next.waitStatus &lt;= <span class="number">0</span>)</span><br><span class="line">                compareAndSetNext(pred, predNext, next);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            unparkSuccessor(node);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        node.next = node; <span class="comment">// help GC</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>同样来一步一步的分析，我们aqs是如何将Node节点的状态标记为CANCELLED的</p><p>首先进入方法后会先判断当前节点是否为null也就是是否是有意义的，如果没有意义直接结束</p><p>然后当前节点的关联线程设置为null，然后获取到我们的前驱节点</p><p>通过while循环将我们waitStatus的值大于0的过滤掉也就是跳过有问题的节点，找到我们上一个可以唤醒下一节点的节点。并且把当前的节点状态设置为Node.CANCELLED;此时出现if语句根据不同情况进行不同的处理</p><p>情况一:</p><ol><li><p>如果当前节点是尾节点的话，将从后往前找，找到第一个状态为非取消状态的节点设置为尾节点</p><ol><li>如果设置成功的话将当前尾节点的后继节点设为null</li><li>如果设置失败的话将进入else语句</li></ol></li><li><p>如果当前节点不是尾节点的话也进入eles语句</p><ol><li><p>进入else语句之后声明一个ws变量再次进入if语句判断这里也分为不同的情况下面挨个说一下</p><ol><li><p>首先这一段</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pred != head</span><br></pre></td></tr></table></figure><blockquote><p>如果当前节点不是头节点的后继节点</p></blockquote></li><li><p>然后中间的</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((ws = pred.waitStatus) == Node.SIGNAL || (ws &lt;= <span class="number">0</span> &amp;&amp; compareAndSetWaitStatus(pred, ws, Node.SIGNAL)))</span><br></pre></td></tr></table></figure><blockquote><ol><li>判断当前节点的前驱节点状态是不是SIGNAL ，如果不是的话则把前驱节点设置为SIGNAL 看看是否成功</li></ol></blockquote></li><li></li></ol></li></ol></li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pred.thread != <span class="literal">null</span></span><br></pre></td></tr></table></figure><pre><code>     &gt; 如果上边中间条件任意成立一个的话再判断当前节点的线程是否为null</code></pre><ol start="2"><li><p>此时如果上述条件都满足则把当前节点的前驱节点的后继指针指向当前节点的后继节点</p></li><li><p>如果上述条件都不满足的话也就是当前节点是头节点的后继节点或者不满足上边的条件那就调用unparkSuccessor(node);环形当前线程的后继节点</p></li></ol></blockquote><p>以上就是所有的加锁流程了</p><h2 id="unlock详解">unlock详解</h2><p>我们ReentrantLock中的解锁并没有区分公平锁和非公平锁，我们来根据源码一步一步的来看</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">unlock</span><span class="params">()</span> &#123;</span><br><span class="line">sync.release(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>进入release方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">release</span><span class="params">(<span class="type">int</span> arg)</span> &#123;</span><br><span class="line"><span class="keyword">if</span> (tryRelease(arg)) &#123;</span><br><span class="line"><span class="type">Node</span> <span class="variable">h</span> <span class="operator">=</span> head;</span><br><span class="line"><span class="keyword">if</span> (h != <span class="literal">null</span> &amp;&amp; h.waitStatus != <span class="number">0</span>)</span><br><span class="line">unparkSuccessor(h);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>会先进入tryRelease(arg)方法</p></blockquote><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20221214202126150.png" alt="image-20221214202126150"></p><p>很明显这个方法是由子类去实现的我们下面来看一下</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">tryRelease</span><span class="params">(<span class="type">int</span> releases)</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="variable">c</span> <span class="operator">=</span> getState() - releases;</span><br><span class="line">    <span class="keyword">if</span> (Thread.currentThread() != getExclusiveOwnerThread())</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">IllegalMonitorStateException</span>();</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">free</span> <span class="operator">=</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span> (c == <span class="number">0</span>) &#123;</span><br><span class="line">        free = <span class="literal">true</span>;</span><br><span class="line">        setExclusiveOwnerThread(<span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    setState(c);</span><br><span class="line">    <span class="keyword">return</span> free;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>引入我们的ReentrantLock加锁过程中支持可重入锁，首先会减去可重入的次数，然后判断一下当前持有锁的线程是不是当前线程如果不是的话直接抛出IllegalMonitorStateException();异常</p><ol><li>接下来定义一个free，如果我们tryRelease将当前持有的线程全部释放掉的话则返回true，否则返回false</li><li>如果已经全部释放掉了做一下处理将free设置为true然后设置当前的锁没有线程拥有它然后返回true</li></ol></blockquote><p>然后我们回到release()方法，如果此时的tryRelease(arg)返回了ture说明了该锁没有被任何线程持有然后我们可以进行if语句里边的操作</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取头节点</span></span><br><span class="line"><span class="type">Node</span> <span class="variable">h</span> <span class="operator">=</span> head;</span><br><span class="line"><span class="comment">// 头节点不为空并且头节点的waitStatus不是初始化节点情况，解除线程挂起状态</span></span><br><span class="line"><span class="keyword">if</span> (h != <span class="literal">null</span> &amp;&amp; h.waitStatus != <span class="number">0</span>)</span><br><span class="line">unparkSuccessor(h);</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br></pre></td></tr></table></figure><blockquote><p>我说一下这里为什么是<code>h != null &amp;&amp; h.waitStatus != 0</code></p><ol><li><p>h == null Head还没初始化。初始情况下，head == null，第一个节点入队，Head会被初始化一个虚拟节点。所以说，这里如果还没来得及入队，就会出现head == null 的情况。</p></li><li><p>h != null &amp;&amp; waitStatus == 0 表明后继节点对应的线程仍在运行中，不需要唤醒。</p></li><li><p>h != null &amp;&amp; waitStatus &lt; 0 表明后继节点可能被阻塞了，需要唤醒。</p></li></ol></blockquote><h3 id="unparkSuccessor">unparkSuccessor();</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">unparkSuccessor</span><span class="params">(Node node)</span> &#123;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * If status is negative (i.e., possibly needing signal) try</span></span><br><span class="line"><span class="comment">     * to clear in anticipation of signalling.  It is OK if this</span></span><br><span class="line"><span class="comment">     * fails or if status is changed by waiting thread.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">int</span> <span class="variable">ws</span> <span class="operator">=</span> node.waitStatus;</span><br><span class="line">    <span class="keyword">if</span> (ws &lt; <span class="number">0</span>)</span><br><span class="line">        compareAndSetWaitStatus(node, ws, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">     * Thread to unpark is held in successor, which is normally</span></span><br><span class="line"><span class="comment">     * just the next node.  But if cancelled or apparently null,</span></span><br><span class="line"><span class="comment">     * traverse backwards from tail to find the actual</span></span><br><span class="line"><span class="comment">     * non-cancelled successor.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">Node</span> <span class="variable">s</span> <span class="operator">=</span> node.next;</span><br><span class="line">    <span class="keyword">if</span> (s == <span class="literal">null</span> || s.waitStatus &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        s = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">Node</span> <span class="variable">t</span> <span class="operator">=</span> tail; t != <span class="literal">null</span> &amp;&amp; t != node; t = t.prev)</span><br><span class="line">            <span class="keyword">if</span> (t.waitStatus &lt;= <span class="number">0</span>)</span><br><span class="line">                s = t;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (s != <span class="literal">null</span>)</span><br><span class="line">        LockSupport.unpark(s.thread);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>首先进入方法后会会的头节点的状态，如果小于0则设置为0，也就是初始状态</p><p>然后获取当前节点的下一个节点</p><p>if语句的意思就是如果当前节点的下一个节点被<em>cancelled</em>掉了就找到队列最开始的非<em>cancelled</em>的节点，但是里边的for循环是从队列的尾部开始找的，而不是从一开始就找，是从队尾到队首拿到队列的第一个<em>waitStatus&lt;0</em>的节点</p><blockquote><p>这里我说一下为什么是从后往前找这里要回顾一下我们的addWaiter方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;<span class="keyword">private</span> Node <span class="title function_">addWaiter</span><span class="params">(Node mode)</span> &#123;</span><br><span class="line">   <span class="type">Node</span> <span class="variable">node</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Node</span>(Thread.currentThread(), mode);</span><br><span class="line">   <span class="comment">// Try the fast path of enq; backup to full enq on failure</span></span><br><span class="line">   <span class="type">Node</span> <span class="variable">pred</span> <span class="operator">=</span> tail;</span><br><span class="line">   <span class="keyword">if</span> (pred != <span class="literal">null</span>) &#123;</span><br><span class="line">       node.prev = pred;</span><br><span class="line">       <span class="keyword">if</span> (compareAndSetTail(pred, node)) &#123;</span><br><span class="line">           pred.next = node;</span><br><span class="line">           <span class="keyword">return</span> node;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   enq(node);</span><br><span class="line">   <span class="keyword">return</span> node;</span><br><span class="line">&gt;&gt;&#125;</span><br></pre></td></tr></table></figure><p>这个节点入队列的操作并不是原子的，所以不排除有这种情况在入队过程中执行到了pred.next = node的时候，此时还没有执行这条代码，但是这时候调用了unparkSuccessor，到达这里的时候就没有办法从前往后找了因为这里相当于链表的断链了所以需要从后往前找</p></blockquote></blockquote><h3 id="线程被唤醒后的操作">线程被唤醒后的操作</h3><p>在我们的中断线程恢复之后会做什么操作呢</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="type">boolean</span> <span class="title function_">parkAndCheckInterrupt</span><span class="params">()</span> &#123;</span><br><span class="line">LockSupport.park(<span class="built_in">this</span>);</span><br><span class="line"><span class="keyword">return</span> Thread.interrupted();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 首先回到这里执行return Thread.interrupted();</span></span><br><span class="line"><span class="comment">// 这里的作用是返回当前执行线程的中断状态，并清除</span></span><br></pre></td></tr></table></figure><p>然后回到我们的acquireQueued()方法中</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (shouldParkAfterFailedAcquire(p, node) &amp;&amp;</span><br><span class="line">                    parkAndCheckInterrupt())</span><br><span class="line">                    interrupted = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">// 这里parkAndCheckInterrupt返回True或者False的时候，interrupted的值不同，但都会执行下次循环。如果这个时候获取锁成功，就会把当前interrupted返回。</span></span><br></pre></td></tr></table></figure><h3 id="selfInterrupt">selfInterrupt</h3><p>能力有限当前方法的作用后续会补充</p>]]></content>
      
      
      <categories>
          
          <category> AQS </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mysql8.0中的Json数据类型</title>
      <link href="/posts/9aeaf84b.html"/>
      <url>/posts/9aeaf84b.html</url>
      
        <content type="html"><![CDATA[<h2 id="场景">场景</h2><p>在某张表中存在一个字段数据类型是一个Json，这个字段保存的数据格式是一个JsonArray，其中每个JsonObject都有一个属性为UUID，现在我们有以下两个需求<br>1、 根据UUID查询出对应的JsonObject<br>2、 根据UUID查询出对应的JsonObject并且将其删除，并保留该JsonArray的其他数据</p><blockquote><p>条件只有一个UUID，而没有该JsonArray所在的数据的主键索引</p></blockquote><h2 id="根据UUID查询出对应的JsonObject">根据UUID查询出对应的JsonObject</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过uuid查询当页对应的敏感句对应的jsonObject</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Query(value = &quot;SELECT json_extract(machine_wording, &#x27;$[0]&#x27;) &quot; +</span></span><br><span class="line"><span class="meta">            &quot;FROM xxxxxx &quot; +</span></span><br><span class="line"><span class="meta">            &quot;WHERE json_extract(machine_wording, &#x27;$[0].uuid&#x27;) = :uuid&quot;,</span></span><br><span class="line"><span class="meta">            nativeQuery = true)</span></span><br><span class="line">    String <span class="title function_">findJsonObjectByUuid</span><span class="params">(<span class="meta">@Param(&quot;uuid&quot;)</span> String uuid)</span>;</span><br></pre></td></tr></table></figure><blockquote><p>上述machine_wording就是存放这个JsonArray的字段名称<br>通过json_extract函数可以获取到JsonArray中的第一个JsonObject，然后通过json_extract函数获取到该JsonObject中的uuid属性，然后与传入的uuid进行比较，如果相等则返回该JsonObject</p></blockquote><h2 id="根据UUID查询出对应的JsonObject并且将其删除，并保留该JsonArray的其他数据">根据UUID查询出对应的JsonObject并且将其删除，并保留该JsonArray的其他数据</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过uuid删除当页对应的敏感句</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Modifying</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="meta">@Query(nativeQuery = true, value = &quot;UPDATE xxx AS a &quot; +</span></span><br><span class="line"><span class="meta">            &quot;SET a.machine_wording = coalesce((&quot; +</span></span><br><span class="line"><span class="meta">            &quot;    SELECT JSON_ARRAYAGG(json_object) &quot; +</span></span><br><span class="line"><span class="meta">            &quot;    FROM (&quot; +</span></span><br><span class="line"><span class="meta">            &quot;        SELECT JSON_EXTRACT(a.machine_wording, CONCAT(&#x27;$[&#x27;, jt.idx - 1, &#x27;]&#x27;)) as json_object &quot; +</span></span><br><span class="line"><span class="meta">            &quot;        FROM JSON_TABLE(&quot; +</span></span><br><span class="line"><span class="meta">            &quot;            a.machine_wording, &quot; +</span></span><br><span class="line"><span class="meta">            &quot;            &#x27;$[*]&#x27; COLUMNS (&quot; +</span></span><br><span class="line"><span class="meta">            &quot;                idx FOR ORDINALITY, &quot; +</span></span><br><span class="line"><span class="meta">            &quot;                uuid VARCHAR(255) PATH &#x27;$.uuid&#x27;&quot; +</span></span><br><span class="line"><span class="meta">            &quot;            )&quot; +</span></span><br><span class="line"><span class="meta">            &quot;        ) AS jt &quot; +</span></span><br><span class="line"><span class="meta">            &quot;        WHERE jt.uuid != :uuid&quot; +</span></span><br><span class="line"><span class="meta">            &quot;    ) AS filtered_json_objects&quot; +</span></span><br><span class="line"><span class="meta">            &quot;), a.machine_wording)&quot; +</span></span><br><span class="line"><span class="meta">            &quot;WHERE JSON_CONTAINS(a.machine_wording, JSON_OBJECT(&#x27;uuid&#x27;, :uuid));&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteJsonObjectByUuid</span><span class="params">(<span class="meta">@Param(&quot;uuid&quot;)</span> String uuid)</span>;</span><br></pre></td></tr></table></figure><blockquote><ul><li>上述machine_wording就是存放这个JsonArray的字段名称</li><li>上述xxx就是表名</li><li>通过json_table函数将JsonArray转换成一个表，然后通过where条件过滤掉uuid等于传入的uuid的JsonObject，然后通过json_arrayagg函数将过滤后的JsonObject转换成JsonArray，最后通过update语句将原来的JsonArray替换成过滤后的JsonArray</li></ul></blockquote><h2 id="2323-07-22测试环境产生问题">2323-07-22测试环境产生问题</h2><blockquote><p>在测试环境中的时候对下边这个需求进行测试的时候产生了一些小问题<br>根据UUID查询出对应的JsonObject并且将其删除，并保留该JsonArray的其他数据</p></blockquote><ol><li>首先使用我上边deleteJsonObjectByUuid方法时会在特殊环境下产生一些问题</li><li>出现问题的场景<br>当我们的machine_wording字段中的JsonArray中的JsonObject为一个的时候会出现删除不掉的问题</li><li>产生问题的原因是对应的sql是先找到UUID不等于传入的时候他就会拿到所有不等于的然后更新到这个字段中，相当于删掉了，所以当只有一个的时候他找不到然后没有办法更新上去，所以就会出现问题</li></ol><p>以下是我进行修改之后的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Modifying</span></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="meta">@Query(nativeQuery = true, value = &quot;UPDATE ai_sensitive_appraisal_file_ocr_post_artificial AS a &quot; +</span></span><br><span class="line"><span class="meta">            &quot;SET a.mark_words = CASE WHEN (&quot; +</span></span><br><span class="line"><span class="meta">            &quot;    SELECT JSON_ARRAYAGG(json_object) &quot; +</span></span><br><span class="line"><span class="meta">            &quot;    FROM (&quot; +</span></span><br><span class="line"><span class="meta">            &quot;        SELECT JSON_EXTRACT(a.mark_words, CONCAT(&#x27;$[&#x27;, jt.idx - 1, &#x27;]&#x27;)) as json_object &quot; +</span></span><br><span class="line"><span class="meta">            &quot;        FROM JSON_TABLE(&quot; +</span></span><br><span class="line"><span class="meta">            &quot;            a.mark_words, &quot; +</span></span><br><span class="line"><span class="meta">            &quot;            &#x27;$[*]&#x27; COLUMNS (&quot; +</span></span><br><span class="line"><span class="meta">            &quot;                idx FOR ORDINALITY, &quot; +</span></span><br><span class="line"><span class="meta">            &quot;                uuid VARCHAR(255) PATH &#x27;$.uuid&#x27;&quot; +</span></span><br><span class="line"><span class="meta">            &quot;            )&quot; +</span></span><br><span class="line"><span class="meta">            &quot;        ) AS jt &quot; +</span></span><br><span class="line"><span class="meta">            &quot;        WHERE jt.uuid != :uuid&quot; +</span></span><br><span class="line"><span class="meta">            &quot;    ) AS filtered_json_objects&quot; +</span></span><br><span class="line"><span class="meta">            &quot;) IS NULL THEN &#x27;[]&#x27; ELSE (&quot; +</span></span><br><span class="line"><span class="meta">            &quot;    SELECT JSON_ARRAYAGG(json_object) &quot; +</span></span><br><span class="line"><span class="meta">            &quot;    FROM (&quot; +</span></span><br><span class="line"><span class="meta">            &quot;        SELECT JSON_EXTRACT(a.mark_words, CONCAT(&#x27;$[&#x27;, jt.idx - 1, &#x27;]&#x27;)) as json_object &quot; +</span></span><br><span class="line"><span class="meta">            &quot;        FROM JSON_TABLE(&quot; +</span></span><br><span class="line"><span class="meta">            &quot;            a.mark_words, &quot; +</span></span><br><span class="line"><span class="meta">            &quot;            &#x27;$[*]&#x27; COLUMNS (&quot; +</span></span><br><span class="line"><span class="meta">            &quot;                idx FOR ORDINALITY, &quot; +</span></span><br><span class="line"><span class="meta">            &quot;                uuid VARCHAR(255) PATH &#x27;$.uuid&#x27;&quot; +</span></span><br><span class="line"><span class="meta">            &quot;            )&quot; +</span></span><br><span class="line"><span class="meta">            &quot;        ) AS jt &quot; +</span></span><br><span class="line"><span class="meta">            &quot;        WHERE jt.uuid != :uuid&quot; +</span></span><br><span class="line"><span class="meta">            &quot;    ) AS filtered_json_objects&quot; +</span></span><br><span class="line"><span class="meta">            &quot;) END &quot; +</span></span><br><span class="line"><span class="meta">            &quot;WHERE JSON_CONTAINS(a.mark_words, JSON_OBJECT(&#x27;uuid&#x27;, :uuid));&quot;)</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteBModelWord</span><span class="params">(<span class="meta">@Param(&quot;uuid&quot;)</span> String uuid)</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> MySQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>多种格式文件合并为pdf(大数据量)</title>
      <link href="/posts/a532201c.html"/>
      <url>/posts/a532201c.html</url>
      
        <content type="html"><![CDATA[<h2 id="需求场景">需求场景</h2><p>最近遇到了一个比较恶心的需求，就是用户为了安全性，本地的富文本文件不存放到我们的minio中，而是富文本的原件存在了客户的服务器中，但是我们只能在数据库存放对应的路径。<br>富文本与档案的绑定关系是多对一，也就是多个富文本绑定一个档案，现在有个问题就是我们系统都是档案都是以pdf进行展示的，而客户那边档案下对应的富文本是多种数据类型的包括以下几种：jpg，png，jpeg，pdf，tif，tiff<br>所以我要去做兼容也就是说需要把档案下对应的各种格式的富文本拼接成一个pdf，然后再去展示。</p><p>先看一下我最开始写的方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isPDF</span><span class="params">(<span class="type">byte</span>[] data)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">PDDocument</span> <span class="variable">document</span> <span class="operator">=</span> PDDocument.load(data)) &#123;</span><br><span class="line">            <span class="comment">// 如果加载成功，表示是有效的 PDF 文件</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="comment">// 加载失败，不是有效的 PDF 文件</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">byte</span>[] convertToPdf(List&lt;<span class="type">byte</span>[]&gt; files) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">PDDocument</span> <span class="variable">pdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDDocument</span>();</span><br><span class="line"></span><br><span class="line">        List&lt;<span class="type">byte</span>[]&gt; imageFiles = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">byte</span>[] fileData : files) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">mimeType</span> <span class="operator">=</span> URLConnection.guessContentTypeFromStream(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(fileData));</span><br><span class="line">            <span class="keyword">if</span> (isPDF(fileData)) &#123;</span><br><span class="line">                imageFiles.addAll(pdfToImage(fileData));</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mimeType != <span class="literal">null</span> &amp;&amp; (mimeType.toLowerCase().contains(<span class="string">&quot;png&quot;</span>)</span><br><span class="line">                    || mimeType.toLowerCase().contains(<span class="string">&quot;jpg&quot;</span>) || mimeType.toLowerCase().contains(<span class="string">&quot;jpeg&quot;</span>))) &#123;</span><br><span class="line">                imageFiles.add(fileData);</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mimeType != <span class="literal">null</span> &amp;&amp; (mimeType.toLowerCase().contains(<span class="string">&quot;tiff&quot;</span>) || mimeType.toLowerCase().contains(<span class="string">&quot;tif&quot;</span>))) &#123;</span><br><span class="line">                List&lt;<span class="type">byte</span>[]&gt; tiffImages = tiffToImage(fileData);</span><br><span class="line">                imageFiles.addAll(tiffImages);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">numThreads</span> <span class="operator">=</span> Runtime.getRuntime().availableProcessors() * <span class="number">2</span>;</span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">executorService</span> <span class="operator">=</span> Executors.newFixedThreadPool(numThreads);</span><br><span class="line"></span><br><span class="line">        List&lt;Future&lt;PDPage&gt;&gt; futures = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">byte</span>[] imageFileData : imageFiles) &#123;</span><br><span class="line">            futures.add(executorService.submit(() -&gt; &#123;</span><br><span class="line">                <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(imageFileData)) &#123;</span><br><span class="line">                    <span class="type">BufferedImage</span> <span class="variable">readPic</span> <span class="operator">=</span> ImageIO.read(is);</span><br><span class="line">                    <span class="keyword">if</span> (ObjectUtil.isEmpty(readPic)) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="type">PDImageXObject</span> <span class="variable">fromImage</span> <span class="operator">=</span> LosslessFactory.createFromImage(pdf, readPic);</span><br><span class="line">                    <span class="type">PDPage</span> <span class="variable">page</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDPage</span>(PDRectangle.A4);</span><br><span class="line">                    <span class="type">PDPageContentStream</span> <span class="variable">contents</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDPageContentStream</span>(pdf, page);</span><br><span class="line">                    <span class="type">float</span> <span class="variable">height</span> <span class="operator">=</span> page.getMediaBox().getHeight();</span><br><span class="line">                    <span class="type">float</span> <span class="variable">y</span> <span class="operator">=</span> page.getMediaBox().getHeight() - height;</span><br><span class="line">                    contents.drawImage(fromImage, <span class="number">0</span>, y, page.getMediaBox().getWidth(), height);</span><br><span class="line">                    contents.close();</span><br><span class="line">                    <span class="keyword">return</span> page;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Error processing image data&quot;</span>, e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> (Future&lt;PDPage&gt; future : futures) &#123;</span><br><span class="line">                <span class="type">PDPage</span> <span class="variable">page</span> <span class="operator">=</span> future.get();</span><br><span class="line">                <span class="keyword">if</span> (page != <span class="literal">null</span>) &#123;</span><br><span class="line">                    pdf.addPage(page);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException | ExecutionException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(<span class="string">&quot;Error retrieving page futures&quot;</span>, e);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            executorService.shutdown();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            pdf.save(outputStream);</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            pdf.close();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> outputStream.toByteArray();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;<span class="type">byte</span>[]&gt; pdfToImage(<span class="type">byte</span>[] pdfData) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        List&lt;<span class="type">byte</span>[]&gt; imageFiles = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">is</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(pdfData);</span><br><span class="line">             <span class="type">PDDocument</span> <span class="variable">document</span> <span class="operator">=</span> PDDocument.load(is)) &#123;</span><br><span class="line">            <span class="type">PDFRenderer</span> <span class="variable">pdfRenderer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDFRenderer</span>(document);</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">pageIndex</span> <span class="operator">=</span> <span class="number">0</span>; pageIndex &lt; document.getNumberOfPages(); ++pageIndex) &#123;</span><br><span class="line">                <span class="type">BufferedImage</span> <span class="variable">bim</span> <span class="operator">=</span> pdfRenderer.renderImageWithDPI(pageIndex, <span class="number">300</span>, ImageType.RGB);</span><br><span class="line">                <span class="keyword">try</span> (<span class="type">ByteArrayOutputStream</span> <span class="variable">imageStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>()) &#123;</span><br><span class="line">                    ImageIO.write(bim, <span class="string">&quot;png&quot;</span>, imageStream);</span><br><span class="line">                    imageFiles.add(imageStream.toByteArray());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> imageFiles;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;<span class="type">byte</span>[]&gt; tiffToImage(<span class="type">byte</span>[] tiffData) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        List&lt;<span class="type">byte</span>[]&gt; imageFiles = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">ImageInputStream</span> <span class="variable">is</span> <span class="operator">=</span> ImageIO.createImageInputStream(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(tiffData))) &#123;</span><br><span class="line">            Iterator&lt;ImageReader&gt; it = ImageIO.getImageReaders(is);</span><br><span class="line">            <span class="keyword">if</span> (it.hasNext()) &#123;</span><br><span class="line">                <span class="type">ImageReader</span> <span class="variable">reader</span> <span class="operator">=</span> it.next();</span><br><span class="line">                reader.setInput(is);</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; reader.getNumImages(<span class="literal">true</span>); i++) &#123;</span><br><span class="line">                    <span class="type">BufferedImage</span> <span class="variable">image</span> <span class="operator">=</span> reader.read(i);</span><br><span class="line">                    <span class="keyword">try</span> (<span class="type">ByteArrayOutputStream</span> <span class="variable">imageStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>()) &#123;</span><br><span class="line">                        ImageIO.write(image, <span class="string">&quot;png&quot;</span>, imageStream);</span><br><span class="line">                        imageFiles.add(imageStream.toByteArray());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> imageFiles;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p>产生问题的原因是因为我们的数据量比较大，而且每次都是多个文件，所以这个方法的执行时间会比较长，而且在执行的过程中会产生大量的临时文件，这样会导致服务器的磁盘空间不足，所以使用了流代替temp。<br>然后对方数据量都是一个档案可能对应几百页的富文本，这种写法会特别慢，导致接口超时所以要想一种解决办法</p></blockquote><h2 id="现在要优化成什么样子呢">现在要优化成什么样子呢</h2><blockquote><p>1、首先是要保证合并的时候有序，<br>2、所以就直接排除并行流了，<br>3、既要有序也要保证大文件和多页数时候的效率，并且要保证有序合并<br>4、同时还要兼容各种不同的类型，所以就需要对不同的类型进行不同的处理</p></blockquote><h2 id="优化后的代码">优化后的代码</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">logger.info(<span class="string">&quot;开始转换pdf&quot;</span>);</span><br><span class="line">        <span class="comment">// Assume that urls is List&lt;String&gt; urls.</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">totalUrls</span> <span class="operator">=</span> collect.size();</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">batchSize</span> <span class="operator">=</span> <span class="number">20</span>;  <span class="comment">// process 20 URLs in each batch</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">totalBatches</span> <span class="operator">=</span> (<span class="type">int</span>) Math.ceil((<span class="type">double</span>) totalUrls / batchSize);</span><br><span class="line"></span><br><span class="line">        <span class="type">ExecutorService</span> <span class="variable">executorService</span> <span class="operator">=</span> Executors.newFixedThreadPool(Math.min(totalBatches, Runtime.getRuntime().availableProcessors()));</span><br><span class="line"></span><br><span class="line">        List&lt;CompletableFuture&lt;<span class="type">byte</span>[]&gt;&gt; futures = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; totalBatches; i++) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">fromIndex</span> <span class="operator">=</span> i * batchSize;</span><br><span class="line">            <span class="type">int</span> <span class="variable">toIndex</span> <span class="operator">=</span> Math.min((i + <span class="number">1</span>) * batchSize, totalUrls);</span><br><span class="line">            List&lt;String&gt; batchUrls = collect.subList(fromIndex, toIndex);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (String url : batchUrls) &#123;</span><br><span class="line">                CompletableFuture&lt;<span class="type">byte</span>[]&gt; future = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">                    logger.info(<span class="string">&quot;开始合并数据路径为:&#123;&#125;&quot;</span>, url);</span><br><span class="line">                    <span class="keyword">final</span> <span class="type">String</span> <span class="variable">extName</span> <span class="operator">=</span> FileUtil.extName(url);</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> ((extName != <span class="literal">null</span> &amp;&amp; (extName.toLowerCase().contains(<span class="string">&quot;png&quot;</span>)</span><br><span class="line">                            || extName.toLowerCase().contains(<span class="string">&quot;jpg&quot;</span>) || extName.toLowerCase().contains(<span class="string">&quot;jpeg&quot;</span>)))) &#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            <span class="keyword">final</span> <span class="type">byte</span>[] bytes = PicUtil.compressPictureForScale(url, <span class="number">1024</span>, <span class="number">0.9</span>);</span><br><span class="line">                            logger.info(<span class="string">&quot;文件大小为:&#123;&#125;&quot;</span>, bytes.length);</span><br><span class="line">                            <span class="keyword">return</span> bytes;</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="type">File</span> <span class="variable">imageFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(url);</span><br><span class="line">                        <span class="keyword">if</span> (imageFile.exists() &amp;&amp; imageFile.isFile()) &#123;</span><br><span class="line">                            <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(imageFile)) &#123;</span><br><span class="line">                                <span class="type">byte</span>[] fileData = IOUtils.toByteArray(fileInputStream);</span><br><span class="line">                                logger.info(<span class="string">&quot;文件大小为:&#123;&#125;&quot;</span>, fileData.length);</span><br><span class="line">                                <span class="keyword">return</span> fileData;</span><br><span class="line">                            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>;  <span class="comment">// Or throw an exception if a URL does not correspond to a valid image</span></span><br><span class="line">                &#125;, executorService);</span><br><span class="line"></span><br><span class="line">                futures.add(future);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Now futures is a list of CompletableFuture&lt;byte[]&gt;, each of which represents the result of one task.</span></span><br><span class="line"><span class="comment">// We can ensure that we get the results in the same order as the tasks were submitted by retrieving the results in the order they were added to the futures list.</span></span><br><span class="line"></span><br><span class="line">        List&lt;<span class="type">byte</span>[]&gt; imageFiles = futures.stream()</span><br><span class="line">                .map(CompletableFuture::join)  <span class="comment">// This will block until the result is available</span></span><br><span class="line">                .collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">        executorService.shutdown();</span><br><span class="line"></span><br><span class="line"><span class="comment">// Now imageFiles contains all the processed data in the same order as the URLs were provided.</span></span><br><span class="line"></span><br><span class="line">        logger.info(<span class="string">&quot;合并数据路径为&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">byte</span>[] pdfData = appraisalFileService.convertToPdf(imageFiles);</span><br><span class="line">        logger.info(pdfData.length + <span class="string">&quot;&quot;</span>);</span><br><span class="line">        logger.info(<span class="string">&quot;转换pdf结束&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>, <span class="string">&quot;attachment; filename=converted.pdf&quot;</span>);</span><br><span class="line">        response.setContentLength(pdfData.length);</span><br><span class="line">        <span class="type">ServletOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> response.getOutputStream();</span><br><span class="line">        outputStream.write(pdfData);</span><br><span class="line">        outputStream.flush();</span><br><span class="line">        <span class="keyword">return</span> R.success(<span class="string">&quot;导入成功&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="convertToPdf方法">convertToPdf方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">byte</span>[] convertToPdf(List&lt;<span class="type">byte</span>[]&gt; files) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="comment">// calculate mime type in advance</span></span><br><span class="line">        <span class="type">Tika</span> <span class="variable">tika</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Tika</span>();</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; mimeTypes = files.stream().map(fileData -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> (<span class="type">TikaInputStream</span> <span class="variable">tikaStream</span> <span class="operator">=</span> TikaInputStream.get(fileData)) &#123;</span><br><span class="line">                <span class="keyword">return</span> tika.detect(tikaStream);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).collect(Collectors.toList());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (mimeTypes.stream().noneMatch(mimeType -&gt; mimeType != <span class="literal">null</span> &amp;&amp; mimeType.toLowerCase().contains(<span class="string">&quot;pdf&quot;</span>))) &#123;</span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">finalOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            <span class="type">PdfWriter</span> <span class="variable">finalWriter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PdfWriter</span>(finalOutputStream);</span><br><span class="line">            <span class="type">PdfDocument</span> <span class="variable">finalPdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PdfDocument</span>(finalWriter);</span><br><span class="line">            <span class="type">Document</span> <span class="variable">finalDocument</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Document</span>(finalPdf);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; files.size(); i++) &#123;</span><br><span class="line">                <span class="type">byte</span>[] fileData = files.get(i);</span><br><span class="line">                <span class="type">String</span> <span class="variable">mimeType</span> <span class="operator">=</span> mimeTypes.get(i);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(fileData)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (mimeType != <span class="literal">null</span> &amp;&amp; mimeType.toLowerCase().contains(<span class="string">&quot;pdf&quot;</span>)) &#123;</span><br><span class="line">                    <span class="comment">/*PdfDocument sourcePdf = new PdfDocument(new PdfReader(inputStream));</span></span><br><span class="line"><span class="comment">                    int finalPdfNumberOfPages = finalPdf.getNumberOfPages();</span></span><br><span class="line"><span class="comment">                    sourcePdf.copyPagesTo(1, sourcePdf.getNumberOfPages(), finalPdf, finalPdfNumberOfPages + 1);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">                    sourcePdf.close();*/</span></span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mimeType != <span class="literal">null</span> &amp;&amp; (mimeType.toLowerCase().contains(<span class="string">&quot;png&quot;</span>)</span><br><span class="line">                            || mimeType.toLowerCase().contains(<span class="string">&quot;jpg&quot;</span>) || mimeType.toLowerCase().contains(<span class="string">&quot;jpeg&quot;</span>))) &#123;</span><br><span class="line">                        com.itextpdf.io.image.<span class="type">ImageData</span> <span class="variable">imageData</span> <span class="operator">=</span> ImageDataFactory.create(fileData);</span><br><span class="line">                        <span class="type">Image</span> <span class="variable">image</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Image</span>(imageData);</span><br><span class="line"></span><br><span class="line">                        <span class="comment">// Adjust the size of the image if it&#x27;s too large</span></span><br><span class="line">                        <span class="type">float</span> <span class="variable">pageWidth</span> <span class="operator">=</span> finalDocument.getPageEffectiveArea(PageSize.A4).getWidth();</span><br><span class="line">                        <span class="keyword">if</span> (image.getImageScaledWidth() &gt; pageWidth) &#123;</span><br><span class="line">                            image.scaleToFit(pageWidth, Float.MAX_VALUE);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        finalDocument.add(image);</span><br><span class="line">                        finalDocument.add(<span class="keyword">new</span> <span class="title class_">AreaBreak</span>(AreaBreakType.NEXT_PAGE)); <span class="comment">// Add a page break after each image</span></span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mimeType != <span class="literal">null</span> &amp;&amp; (mimeType.toLowerCase().contains(<span class="string">&quot;tiff&quot;</span>) || mimeType.toLowerCase().contains(<span class="string">&quot;tif&quot;</span>))) &#123;</span><br><span class="line">                        <span class="keyword">try</span> (<span class="type">ImageInputStream</span> <span class="variable">imageInputStream</span> <span class="operator">=</span> ImageIO.createImageInputStream(inputStream)) &#123;</span><br><span class="line">                            Iterator&lt;ImageReader&gt; imageReaders = ImageIO.getImageReaders(imageInputStream);</span><br><span class="line">                            <span class="keyword">if</span> (imageReaders.hasNext()) &#123;</span><br><span class="line">                                <span class="type">ImageReader</span> <span class="variable">reader</span> <span class="operator">=</span> imageReaders.next();</span><br><span class="line">                                reader.setInput(imageInputStream);</span><br><span class="line">                                <span class="type">int</span> <span class="variable">pageCount</span> <span class="operator">=</span> reader.getNumImages(<span class="literal">true</span>);</span><br><span class="line">                                <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>; k &lt; pageCount; k++) &#123;</span><br><span class="line">                                    <span class="type">BufferedImage</span> <span class="variable">page</span> <span class="operator">=</span> reader.read(k);</span><br><span class="line">                                    <span class="keyword">try</span> (<span class="type">ByteArrayOutputStream</span> <span class="variable">pageOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>()) &#123;</span><br><span class="line">                                        ImageIO.write(page, <span class="string">&quot;png&quot;</span>, pageOutputStream);</span><br><span class="line">                                        <span class="type">ImageData</span> <span class="variable">imageData</span> <span class="operator">=</span> ImageDataFactory.create(pageOutputStream.toByteArray());</span><br><span class="line">                                        <span class="type">Image</span> <span class="variable">image</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Image</span>(imageData);</span><br><span class="line">                                        finalDocument.add(image);</span><br><span class="line">                                        finalDocument.add(<span class="keyword">new</span> <span class="title class_">AreaBreak</span>(AreaBreakType.NEXT_PAGE)); <span class="comment">// Add a page break after each image</span></span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            finalDocument.close();</span><br><span class="line">            finalPdf.close();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> finalOutputStream.toByteArray();</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">int</span> <span class="variable">batchSize</span> <span class="operator">=</span> <span class="number">50</span>;                     <span class="comment">// 每批处理的文件数量</span></span><br><span class="line">            <span class="type">int</span> <span class="variable">totalFiles</span> <span class="operator">=</span> files.size();</span><br><span class="line">            <span class="type">int</span> <span class="variable">batches</span> <span class="operator">=</span> (<span class="type">int</span>) Math.ceil((<span class="type">double</span>) totalFiles / batchSize);</span><br><span class="line"></span><br><span class="line">            <span class="type">ExecutorService</span> <span class="variable">executorService</span> <span class="operator">=</span> Executors.newFixedThreadPool(Math.min(batches, Runtime.getRuntime().availableProcessors()));</span><br><span class="line"></span><br><span class="line">            List&lt;CompletableFuture&lt;PDDocument&gt;&gt; futures = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; batches; i++) &#123;</span><br><span class="line">                <span class="type">int</span> <span class="variable">fromIndex</span> <span class="operator">=</span> i * batchSize;</span><br><span class="line">                <span class="type">int</span> <span class="variable">toIndex</span> <span class="operator">=</span> Math.min((i + <span class="number">1</span>) * batchSize, totalFiles);</span><br><span class="line">                List&lt;<span class="type">byte</span>[]&gt; batchFiles = files.subList(fromIndex, toIndex);</span><br><span class="line"></span><br><span class="line">                CompletableFuture&lt;PDDocument&gt; future = CompletableFuture.supplyAsync(() -&gt; &#123;</span><br><span class="line">                    <span class="type">PDDocument</span> <span class="variable">batchPdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDDocument</span>();</span><br><span class="line">                    <span class="type">PDFMergerUtility</span> <span class="variable">merger</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDFMergerUtility</span>();</span><br><span class="line">                    <span class="keyword">for</span> (<span class="type">byte</span>[] fileData : batchFiles) &#123;</span><br><span class="line">                        <span class="type">String</span> <span class="variable">mimeType</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            mimeType = URLConnection.guessContentTypeFromStream(<span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(fileData));</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">if</span> (isPDF(fileData)) &#123;</span><br><span class="line">                            <span class="keyword">try</span> (<span class="type">InputStream</span> <span class="variable">inputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(fileData)) &#123;</span><br><span class="line">                                <span class="type">PDDocument</span> <span class="variable">sourcePdf</span> <span class="operator">=</span> PDDocument.load(inputStream);</span><br><span class="line">                                merger.appendDocument(batchPdf, sourcePdf);</span><br><span class="line">                                sourcePdf.close();</span><br><span class="line">                            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                                e.printStackTrace();</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mimeType != <span class="literal">null</span> &amp;&amp; (mimeType.toLowerCase().contains(<span class="string">&quot;png&quot;</span>)</span><br><span class="line">                                || mimeType.toLowerCase().contains(<span class="string">&quot;jpg&quot;</span>) || mimeType.toLowerCase().contains(<span class="string">&quot;jpeg&quot;</span>))) &#123;</span><br><span class="line">                            <span class="type">PDPage</span> <span class="variable">page</span> <span class="operator">=</span> createPDPageFromImage(batchPdf, fileData);</span><br><span class="line">                            <span class="keyword">if</span> (page != <span class="literal">null</span>) &#123;</span><br><span class="line">                                batchPdf.addPage(page);</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mimeType != <span class="literal">null</span> &amp;&amp; (mimeType.toLowerCase().contains(<span class="string">&quot;tiff&quot;</span>) || mimeType.toLowerCase().contains(<span class="string">&quot;tif&quot;</span>))) &#123;</span><br><span class="line">                            List&lt;<span class="type">byte</span>[]&gt; tiffImages = <span class="literal">null</span>;</span><br><span class="line">                            <span class="keyword">try</span> &#123;</span><br><span class="line">                                tiffImages = tiffToImage(fileData);</span><br><span class="line">                            &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">for</span> (<span class="type">byte</span>[] imageFileData : tiffImages) &#123;</span><br><span class="line">                                <span class="type">PDPage</span> <span class="variable">page</span> <span class="operator">=</span> createPDPageFromImage(batchPdf, imageFileData);</span><br><span class="line">                                <span class="keyword">if</span> (page != <span class="literal">null</span>) &#123;</span><br><span class="line">                                    batchPdf.addPage(page);</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">return</span> batchPdf;</span><br><span class="line">                &#125;, executorService);</span><br><span class="line"></span><br><span class="line">                futures.add(future);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            CompletableFuture&lt;Void&gt; allFutures = CompletableFuture.allOf(futures.toArray(<span class="keyword">new</span> <span class="title class_">CompletableFuture</span>[<span class="number">0</span>]));</span><br><span class="line">            allFutures.join();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 构建最终的有序 PDF 文档</span></span><br><span class="line">            <span class="comment">// 构建最终的有序 PDF 文档</span></span><br><span class="line">            <span class="type">PDDocument</span> <span class="variable">finalPdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDDocument</span>();</span><br><span class="line">            <span class="type">PDFMergerUtility</span> <span class="variable">merger</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">PDFMergerUtility</span>();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (CompletableFuture&lt;PDDocument&gt; future : futures) &#123;</span><br><span class="line">                <span class="type">PDDocument</span> <span class="variable">batchPdf</span> <span class="operator">=</span> future.join();</span><br><span class="line">                merger.appendDocument(finalPdf, batchPdf);</span><br><span class="line">                batchPdf.close();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">outputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            finalPdf.save(outputStream);</span><br><span class="line">            finalPdf.close();</span><br><span class="line"></span><br><span class="line">            executorService.shutdown();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> outputStream.toByteArray();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><h2 id="压缩PDF工具类">压缩PDF工具类</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PicUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">byte</span>[] compressPictureForScale(String srcPath, <span class="type">long</span> desFileSize, <span class="type">double</span> accuracy) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isEmpty(srcPath)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">File</span> <span class="variable">srcFile</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(srcPath);</span><br><span class="line">        <span class="keyword">if</span> (!srcFile.exists()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">formatName</span> <span class="operator">=</span> FilenameUtils.getExtension(srcPath);</span><br><span class="line">        BufferedImage image;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">long</span> <span class="variable">srcFileSize</span> <span class="operator">=</span> srcFile.length();</span><br><span class="line">            System.out.println(<span class="string">&quot;源图片: &quot;</span> + srcPath + <span class="string">&quot;, 大小: &quot;</span> + srcFileSize / <span class="number">1024</span> + <span class="string">&quot;kb&quot;</span>);</span><br><span class="line"></span><br><span class="line">            image = Thumbnails.of(srcPath).scale(<span class="number">1f</span>).asBufferedImage();</span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">byteArrayOutputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            compressPicCycle(image, desFileSize, accuracy, formatName, byteArrayOutputStream);</span><br><span class="line">            image.getGraphics().dispose();</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;图片压缩完成!&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">byte</span>[] byteArray = byteArrayOutputStream.toByteArray();</span><br><span class="line">            System.out.println(<span class="string">&quot;源图片压缩后为: &quot;</span> + srcPath + <span class="string">&quot;, 大小: &quot;</span> + byteArray.length / <span class="number">1024</span> + <span class="string">&quot;kb&quot;</span>);</span><br><span class="line">            byteArrayOutputStream.close();</span><br><span class="line">            <span class="keyword">return</span> byteArray;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">compressPicCycle</span><span class="params">(BufferedImage desImage, <span class="type">long</span> desFileSize, <span class="type">double</span> accuracy, String formatName, ByteArrayOutputStream byteArrayOutputStream)</span> <span class="keyword">throws</span> IOException, IOException &#123;</span><br><span class="line">        byteArrayOutputStream.reset();</span><br><span class="line">        ImageIO.write(desImage, formatName, byteArrayOutputStream);</span><br><span class="line">        <span class="type">byte</span>[] byteArray = byteArrayOutputStream.toByteArray();</span><br><span class="line">        <span class="keyword">if</span> (byteArray.length / <span class="number">1024</span> &gt; desFileSize) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">srcWidth</span> <span class="operator">=</span> desImage.getWidth();</span><br><span class="line">            <span class="type">int</span> <span class="variable">srcHeight</span> <span class="operator">=</span> desImage.getHeight();</span><br><span class="line">            <span class="type">int</span> <span class="variable">destWidth</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(srcWidth).multiply(<span class="keyword">new</span> <span class="title class_">BigDecimal</span>(accuracy)).intValue();</span><br><span class="line">            <span class="type">int</span> <span class="variable">destHeight</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigDecimal</span>(srcHeight).multiply(<span class="keyword">new</span> <span class="title class_">BigDecimal</span>(accuracy)).intValue();</span><br><span class="line">            <span class="type">BufferedImage</span> <span class="variable">image</span> <span class="operator">=</span> Thumbnails.of(desImage).size(destWidth, destHeight).outputQuality(accuracy).asBufferedImage();</span><br><span class="line">            compressPicCycle(image, desFileSize, accuracy, formatName, byteArrayOutputStream);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="需引入依赖">需引入依赖</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.coobird<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>thumbnailator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.twelvemonkeys.imageio<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>imageio-tiff<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>3.6.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.pdfbox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pdfbox<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.27<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.pdfbox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pdfbox-tools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.26<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tika<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tika-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.itextpdf<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>itext7-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>7.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">type</span>&gt;</span>pom<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pdf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>导出Excel将指定列加锁不可编辑</title>
      <link href="/posts/e6860ebf.html"/>
      <url>/posts/e6860ebf.html</url>
      
        <content type="html"><![CDATA[<h2 id="导出Excel将指定列加锁不可编辑">导出Excel将指定列加锁不可编辑</h2><p>最近写了一个需求，需要将Excel导出，但是有些列是不允许编辑的，所以需要将这些列加锁，不允许编辑，这里就记录一下</p><h3 id="首先将整个sheet页全部加锁">首先将整个sheet页全部加锁</h3><p>需要创建一个Handler</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.irm.ai.sensitive.excel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Sheet;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.xssf.streaming.SXSSFSheet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.write.handler.SheetWriteHandler;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.write.metadata.holder.WriteSheetHolder;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.write.metadata.holder.WriteWorkbookHolder;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 锁定Sheet页</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023/5/18 14:28</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LockSheetWriteHandler</span> <span class="keyword">implements</span> <span class="title class_">SheetWriteHandler</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">beforeSheetCreate</span><span class="params">(WriteWorkbookHolder writeWorkbookHolder, WriteSheetHolder writeSheetHolder)</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterSheetCreate</span><span class="params">(WriteWorkbookHolder writeWorkbookHolder, WriteSheetHolder writeSheetHolder)</span> &#123;</span><br><span class="line">        <span class="type">Sheet</span> <span class="variable">sheet</span> <span class="operator">=</span> writeSheetHolder.getSheet();</span><br><span class="line">        <span class="comment">//锁定工作簿，设置保护密码</span></span><br><span class="line">        sheet.protectSheet(String.valueOf(UUID.randomUUID()));</span><br><span class="line">        <span class="comment">// 锁定单元格不可选中(防止别人直接复制内容到其他excel修改)</span></span><br><span class="line">        ((SXSSFSheet) writeSheetHolder.getSheet()).lockSelectLockedCells(<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="需要解锁的列，也就是允许编辑的列">需要解锁的列，也就是允许编辑的列</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">package</span> org.irm.ai.sensitive.excel;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.usermodel.Cell;</span><br><span class="line"><span class="keyword">import</span> org.apache.poi.ss.util.CellUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.annotation.ExcelProperty;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.metadata.Head;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.metadata.data.WriteCellData;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.write.handler.CellWriteHandler;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.write.metadata.holder.WriteSheetHolder;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.excel.write.metadata.holder.WriteTableHolder;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> Eliauk</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2023/5/18 14:31</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">final</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CellHandler</span> <span class="keyword">implements</span> <span class="title class_">CellWriteHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将指定的要解锁的列放到set中</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> HashSet&lt;String&gt; values = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line"></span><br><span class="line">        Field[] fields = TriageResultsExcel.class.getDeclaredFields();</span><br><span class="line">        <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">            <span class="keyword">if</span> (field.isAnnotationPresent(ExcelProperty.class)) &#123;</span><br><span class="line">                <span class="type">ExcelProperty</span> <span class="variable">annotation</span> <span class="operator">=</span> field.getAnnotation(ExcelProperty.class);</span><br><span class="line">                <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> Arrays.toString(annotation.value());</span><br><span class="line">                <span class="keyword">if</span> (value.startsWith(<span class="string">&quot;[&quot;</span>) &amp;&amp; value.endsWith(<span class="string">&quot;]&quot;</span>)) &#123;</span><br><span class="line">                    <span class="keyword">final</span> <span class="type">String</span> <span class="variable">substring</span> <span class="operator">=</span> value.substring(<span class="number">1</span>, value.length() - <span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">if</span> (<span class="string">&quot;文件唯一Id(请勿修改)&quot;</span>.equals(substring)) &#123;</span><br><span class="line">                        <span class="keyword">continue</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    values.add(substring);</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                values.add(value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterCellDispose</span><span class="params">(WriteSheetHolder writeSheetHolder, WriteTableHolder writeTableHolder, List&lt;WriteCellData&lt;?&gt;&gt; cellDataList, Cell cell, Head head, Integer relativeRowIndex, Boolean isHead)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 将需要解锁的列解锁</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">dataHead</span> <span class="operator">=</span> head.getHeadNameList().get(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (values.contains(dataHead)) &#123;</span><br><span class="line">            Map&lt;String, Object&gt; properties = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(<span class="number">1</span>);</span><br><span class="line">            properties.put(CellUtil.LOCKED, <span class="literal">false</span>);</span><br><span class="line">            CellUtil.setCellStyleProperties(cell, properties);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 实用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> EasyExcel </tag>
            
            <tag> POI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Swagger刷新页面异常解决</title>
      <link href="/posts/10e6d135.html"/>
      <url>/posts/10e6d135.html</url>
      
        <content type="html"><![CDATA[<p>直接引入maven依赖即可解决</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.swagger<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-annotations<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.22<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.swagger<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-models<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.22<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 异常记录 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>优美的统一返回结果处理</title>
      <link href="/posts/5b3efee2.html"/>
      <url>/posts/5b3efee2.html</url>
      
        <content type="html"><![CDATA[<h2 id="优美的统一返回结果处理">优美的统一返回结果处理</h2><p>我们写项目一般都会自己写一个Result对象，然后去处理，但是有一个问题，逐渐的接口写多了之后</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220920205449418.png" alt="image-20220920205449418"></p><p>会发现每次都要写这个被Result包裹会很麻烦，这时候我们就可以考虑将他抽取出来，使用一个Handler去处理</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zang.blogz.result;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.github.vampireachao.stream.core.optional.Op;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.MethodParameter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.converter.HttpMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.server.ServerHttpRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.server.ServerHttpResponse;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestControllerAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.mvc.method.annotation.ResponseBodyAdvice;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> ZVerify</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@RestControllerAdvice(basePackages = &quot;com.zang.blogz.controller&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AnimeResultHandler</span> <span class="keyword">implements</span> <span class="title class_">ResponseBodyAdvice</span>&lt;Object&gt; &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Whether this component supports the given controller method return type</span></span><br><span class="line"><span class="comment">     * and the selected &#123;<span class="doctag">@code</span> HttpMessageConverter&#125; type.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> returnType    the return type</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> converterType the selected converter type</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@code</span> true&#125; if &#123;<span class="doctag">@link</span> #beforeBodyWrite&#125; should be invoked;</span></span><br><span class="line"><span class="comment">     * &#123;<span class="doctag">@code</span> false&#125; otherwise</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">supports</span><span class="params">(MethodParameter returnType, Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt; converterType)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> !(returnType.getParameterType().isAssignableFrom(Result.class));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Invoked after an &#123;<span class="doctag">@code</span> HttpMessageConverter&#125; is selected and just before</span></span><br><span class="line"><span class="comment">     * its write method is invoked.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> body                  the body to be written</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> returnType            the return type of the controller method</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> selectedContentType   the content type selected through content negotiation</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> selectedConverterType the converter type selected to write to the response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request               the current request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> response              the current response</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> the body that was passed in or a modified (possibly new) instance</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">beforeBodyWrite</span><span class="params">(Object body, MethodParameter returnType, MediaType selectedContentType, Class&lt;? extends HttpMessageConverter&lt;?&gt;&gt; selectedConverterType, ServerHttpRequest request, ServerHttpResponse response)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Op.of(body).map(Result::ok).orElseGet(Result::ok);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>这样只需要在controller层返回要返回的对象就好了，如果想要返回error可以抛出异常然后全局异常处理</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Result </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Sa-Token整合OAuth2</title>
      <link href="/posts/148eb857.html"/>
      <url>/posts/148eb857.html</url>
      
        <content type="html"><![CDATA[<h1>Sa-Token整合OAuth2</h1><p>开源地址 <a href="https://gitee.com/ZVerify/zverify-blog">https://gitee.com/ZVerify/zverify-blog</a></p><h2 id="为什么要整合OAuth2">为什么要整合OAuth2</h2><p>有些时候我们自己写的网站注册过于繁琐需要每个用户花费时间去注册，所以我们可以添加各种第三方登录，方便网站的用户去登录。</p><h2 id="写之前思考一下">写之前思考一下</h2><p>我们先想一下我们在进行第三方登录的时候是怎样的一个步骤，首先第三方登录都需要遵守OAuth2的流程，这里我使用了授权码模式，对于其他三种授权模式请参考网络文章，因为我使用了授权码模式所以他的整体流程都是一样的，这时候我们可以考虑使用模板模式，然后我们可能需要整合多个第三方登录，因为要考虑到用户的体验性，如果你只写一个的话，用户可能没有这个账号，所以可能会造成体验性差。这时候我们就需要横向扩展所以我们可以使用策略模式和模板模式。</p><p>这里我就用Gitee登录作为例子来说一下</p><h2 id="整合Gitee第三方登录">整合Gitee第三方登录</h2><p><a href="https://gitee.com/api/v5/oauth_doc#/list-item-1%EF%BC%8CgiteeOauth%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3">https://gitee.com/api/v5/oauth_doc#/list-item-1，giteeOauth官方文档</a></p><p>这里的策略模式我就不讲解了，不懂的去看之前的文件上传，然后讲一下我所设计的模板，首先我们要要遵守Oauth2的授权码流程，首先前端通过访问网站拿到授权的code，然后回调我们后端的接口，此时只有code是变化的所以只需要接收到code，然后获取access_token ，拿到access_token之后我们可以去获取第三方用户信息，获取完用户信息要检查一下是否已经在我们数据库中存在了，如果存在的话就更新一下数据就放行就好了，如果没有当前用户的话就去保存一下再去更新登录信息就好啦。</p><h2 id="代码解析">代码解析</h2><h3 id="总登录方法">总登录方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">public</span> Result&lt;SaTokenInfo&gt; <span class="title function_">login</span><span class="params">(String data, LoginTypeEnum loginTypeEnum)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">    AtomicReference&lt;Result&lt;SaTokenInfo&gt;&gt; result = <span class="keyword">new</span> <span class="title class_">AtomicReference</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// 创建登录信息</span></span><br><span class="line">    <span class="type">SocialTokenDTO</span> <span class="variable">socialToken</span> <span class="operator">=</span> getSocialToken(data);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取用户ip信息</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">ipAddress</span> <span class="operator">=</span> IpUtil.getIpAddress(request);</span><br><span class="line">    <span class="type">String</span> <span class="variable">ipSource</span> <span class="operator">=</span> IpUtil.getIpSource(ipAddress);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取第三方用户信息</span></span><br><span class="line">    <span class="type">SocialUserInfoDTO</span> <span class="variable">socialUserInfo</span> <span class="operator">=</span> getSocialUserInfo(socialToken);</span><br><span class="line">    <span class="comment">// 判断是否已经注册</span></span><br><span class="line">    Opp.of(userAuthService.getUserAuth(loginTypeEnum, socialUserInfo))</span><br><span class="line"></span><br><span class="line">            .ifPresent((user) -&gt; result.set(getUserDetail(user, ipAddress, ipSource, loginTypeEnum.getType())))</span><br><span class="line">            .orElseRun(() -&gt; &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    result.set(saveUserDetail(socialToken, ipAddress, ipSource, loginTypeEnum.getType(), socialUserInfo));</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="type">Object</span> <span class="variable">loginId</span> <span class="operator">=</span> result.get().getResult().getLoginId();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (StpUtil.isDisable(loginId)) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">DisableLoginException</span>(loginTypeEnum.getDesc(), loginId, StpUtil.getDisableTime(loginId));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result.get();</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="获取第三方登录token信息">获取第三方登录token信息</h3><p>这里对接的是gitee的登录所以是获取code然后调用gitee获取access_token的接口，通过clientId，redirectUri，clientSecret，和code</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> SocialTokenDTO <span class="title function_">getSocialToken</span><span class="params">(String data)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> String.format(SocialLoginConstant.OAUTH2_GITEE_CODE, giteeConfigProperties.getClientId(), giteeConfigProperties.getRedirectUri(), giteeConfigProperties.getClientSecret(), data);</span><br><span class="line"></span><br><span class="line">    <span class="type">CloseableHttpClient</span> <span class="variable">build</span> <span class="operator">=</span> HttpClientBuilder.create().build();</span><br><span class="line">    <span class="type">HttpPost</span> <span class="variable">httpPost</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpPost</span>(url);</span><br><span class="line"></span><br><span class="line">    <span class="type">HttpResponse</span> <span class="variable">response</span> <span class="operator">=</span> build.execute(httpPost);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">json</span> <span class="operator">=</span> EntityUtils.toString(response.getEntity());</span><br><span class="line"></span><br><span class="line">    <span class="type">JSONObject</span> <span class="variable">jsonObject</span> <span class="operator">=</span> JSON.parseObject(json);</span><br><span class="line">    <span class="type">String</span> <span class="variable">access_token</span> <span class="operator">=</span> jsonObject.getString(SocialLoginConstant.ACCESS_TOKEN);</span><br><span class="line">    <span class="keyword">return</span> SocialTokenDTO.builder().accessToken(access_token).openId(data).loginType(LoginTypeEnum.GITEE.getType()).build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>拿到access_token封装到对象中</p><h3 id="通过access-token获得用户信息">通过access_token获得用户信息</h3><p>然后通过access_token去访问gitee提供的通过access_token拿到用户信息的接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> SocialUserInfoDTO <span class="title function_">getSocialUserInfo</span><span class="params">(SocialTokenDTO socialTokenDTO)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">urlUser</span> <span class="operator">=</span> String.format(SocialLoginConstant.OAUTH2_GITEE_USERINFO, socialTokenDTO.getAccessToken());</span><br><span class="line"></span><br><span class="line">    <span class="type">HttpClient</span> <span class="variable">httpClientUser</span> <span class="operator">=</span> HttpClientBuilder.create().build();</span><br><span class="line">    <span class="type">HttpGet</span> <span class="variable">httpPostUser</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpGet</span>(urlUser);</span><br><span class="line"></span><br><span class="line">    <span class="type">HttpResponse</span> <span class="variable">responseUser</span> <span class="operator">=</span> httpClientUser.execute(httpPostUser);</span><br><span class="line"></span><br><span class="line">    <span class="type">String</span> <span class="variable">user</span> <span class="operator">=</span> EntityUtils.toString(responseUser.getEntity());</span><br><span class="line"></span><br><span class="line">    <span class="type">GiteeUserInfoDTO</span> <span class="variable">giteeUserInfoDTO</span> <span class="operator">=</span> JSONUtil.toBean(user, GiteeUserInfoDTO.class);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> SocialUserInfoDTO.builder()</span><br><span class="line">            .nickname(giteeUserInfoDTO.getName())</span><br><span class="line">            .avatar(giteeUserInfoDTO.getAvatarUrl())</span><br><span class="line">            .build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>拿到用户信息之后可以进行封装并返回。</p><p>判断是否我们当前用户数据库中是否存在要登录的用户，我这里使用用户名和登录类型做了一下简单的判断，可以根据自己的需求进行更改。</p><p>如果可以从数据库中查询数据出来，我们就更新一下登录，如果没有查询出来就进行用户信息初始化进行保存数据库然后更新登录就好啦，这两个可以根据自己的需求和业务去改，我这里用了sa-token，就简单把代码放这了</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取用户信息</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> user      用户账号</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ipAddress ip地址</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ipSource  ip源</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> loginType 登录类型</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> SaTokenInfo&#125; 用户信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> Result&lt;SaTokenInfo&gt; <span class="title function_">getUserDetail</span><span class="params">(UserAuth user, String ipAddress, String ipSource, Integer loginType)</span> &#123;</span><br><span class="line">    <span class="comment">// 更新登录信息</span></span><br><span class="line">    StpUtil.login(user.getUserInfoId(), SaLoginConfig</span><br><span class="line">            .setExtra(<span class="string">&quot;name&quot;</span>, user.getUsername())</span><br><span class="line">            .setExtra(<span class="string">&quot;id&quot;</span>, user.getUserInfoId())</span><br><span class="line">            .setExtra(<span class="string">&quot;ipAddress&quot;</span>, ipAddress)</span><br><span class="line">            .setExtra(<span class="string">&quot;ipSource&quot;</span>, ipSource)</span><br><span class="line">    );</span><br><span class="line">    <span class="comment">// 返回信息</span></span><br><span class="line"></span><br><span class="line">    <span class="type">SaTokenInfo</span> <span class="variable">tokenInfo</span> <span class="operator">=</span> StpUtil.getTokenInfo();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Result.ok(ResultConstant.LoginMessage.LOGIN_SUCCESS, tokenInfo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 新增用户信息</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> socialToken token信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ipAddress   ip地址</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> ipSource    ip源</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> Result&lt;SaTokenInfo&gt;&#125; 用户信息</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> Result&lt;SaTokenInfo&gt; <span class="title function_">saveUserDetail</span><span class="params">(SocialTokenDTO socialToken, String ipAddress, String ipSource, Integer loginType, SocialUserInfoDTO socialUserInfo)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 保存用户信息</span></span><br><span class="line">    <span class="type">UserInfo</span> <span class="variable">userInfo</span> <span class="operator">=</span> UserInfo.builder()</span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">            .nickname(socialUserInfo.getNickname())</span><br><span class="line">            .avatar(socialUserInfo.getAvatar())</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">    userInfoService.save(userInfo);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 保存账号信息</span></span><br><span class="line">    <span class="type">UserAuth</span> <span class="variable">userAuth</span> <span class="operator">=</span> UserAuth.builder()</span><br><span class="line">            .userInfoId(userInfo.getId())</span><br><span class="line">            .username(userInfo.getNickname())</span><br><span class="line">            .password(socialToken.getAccessToken())</span><br><span class="line">            .loginType(loginType)</span><br><span class="line">            .lastLoginTime(LocalDateTime.now(ZoneId.of(ZoneEnum.SHANGHAI.getZone())))</span><br><span class="line">            .ipAddress(ipAddress)</span><br><span class="line">            .ipSource(ipSource)</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">    userAuthService.save(userAuth);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 绑定角色</span></span><br><span class="line">    <span class="type">UserRole</span> <span class="variable">userRole</span> <span class="operator">=</span> UserRole.builder()</span><br><span class="line">            .userId(userInfo.getId())</span><br><span class="line">            .roleId(RoleEnum.USER.getRoleId())</span><br><span class="line">            .build();</span><br><span class="line"></span><br><span class="line">    userRoleService.save(userRole);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更新登录信息</span></span><br><span class="line">    StpUtil.login(userAuth.getUserInfoId(), SaLoginConfig</span><br><span class="line">            .setExtra(<span class="string">&quot;name&quot;</span>, userAuth.getUsername())</span><br><span class="line">            .setExtra(<span class="string">&quot;id&quot;</span>, userAuth.getUserInfoId())</span><br><span class="line">            .setExtra(<span class="string">&quot;ipAddress&quot;</span>, ipAddress)</span><br><span class="line">            .setExtra(<span class="string">&quot;ipSource&quot;</span>, ipSource)</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="type">SaTokenInfo</span> <span class="variable">tokenInfo</span> <span class="operator">=</span> StpUtil.getTokenInfo();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Result.ok(ResultConstant.LoginMessage.LOGIN_SUCCESS, tokenInfo);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 第三方登录 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> OAuth2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringSecurity鉴权源码</title>
      <link href="/posts/b43e2d04.html"/>
      <url>/posts/b43e2d04.html</url>
      
        <content type="html"><![CDATA[<p>SpringSecurity鉴权源码</p><p>之前写了一篇SpringSecurity的认证，下面接着来说一下鉴权对源码，SpringSecurity有一个专门对过滤器来进行鉴权FilterSecurityInterceptor，他是专门来进行鉴权对，下面来根据源码一点点看一下。</p><p>这次由于测试我们先写一下基本对数据，基本跟认证时候一样，不过要改一些配置</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220916151258174.png" alt="image-20220916151258174"></p><p>也就是我们对hello请求需要ADMIN这个角色才能通过访问，所以为了测试我把ADMIN角色都给每个用户</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220916151547734.png" alt="image-20220916151547734"></p><p>下面我们登陆之后把断点打到FilterSecurityInterceptor中看一下整体对流程</p><p>登陆就略过了，然后我们请求/hello接口</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220916152501997.png" alt="image-20220916152501997"></p><p>通过源码可以看到FilterSecurityInterceptor实现类Filter所以核心方法应该是doFilter()方法</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220916152552710.png" alt="image-20220916152552710"></p><p>调用了invoke方法</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220916152838721.png" alt="image-20220916152838721"></p><p>进来之后先判断一下isApplied()，这个方法其实就是看一下requert似不似等于null，并且request没有FILTER_APPLIED这个常量的Attribute，很明显返回false，所以就进入下一个if判断observeOncePerRequest这个属性默认为true所以我们会给上个if判断的那个FILTER_APPLIED设置一个true，接下来就是进入我们的beforeInvocation()方法，这个是super调用的，我们去父类AbstractSecurityInterceptor看一眼</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220916153925832.png" alt="image-20220916153925832"></p><p>这个方法其实就很重要了</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220916170128400.png" alt="image-20220916170128400"></p><p>调用本类的SecurityMetadataSource，也就是继承抽象类的FilterSecurityInterceptor的这个方法也就是</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220916170948014.png" alt="image-20220916170948014">FilterInvocationSecurityMetadataSource类下的默认实现类DefaultFilterInvocationSecurityMetadataSource的getAttributes方法</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220916171243212.png" alt="image-20220916171243212"></p><p>这个方法里边有个requestMap其实就是我们配置对什么接口需要什么权限，key是请求路径，value是所需权限然后挨个比对，找到我们当前对请求之后就返回他所需要对权限集合，</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220916172041224.png" alt="image-20220916172041224"></p><p>很明显都不成立，进去下边的authenticateIfRequired();这个方法就是进入ProviderManager进行一下认证,然后出来之后就是进行鉴权attemptAuthorization，也就是AccessDecisionManager接口对默认实现AffirmativeBased类的decide方法，这个方法就是一个投票器，会轮训所有配置的AccessDecisionVoter并在任何AccessDecisionVoter投赞成票时授予访问权限。仅当有拒绝投票且没有赞成票时才拒绝访问。</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220916173021612.png" alt="image-20220916173021612"></p><h2 id="动态鉴权">动态鉴权</h2><p>这就是基本的鉴权了，现在问题来了，难到我们每次所有对接口都要去配置文件里边配置吗，很明显笨死了就，但是我们该如何去定制化对设置动态鉴权呢。前面的讲解应该很清楚了，关键是一个getAttributes()方法获得当前请求路径所需要对角色，一个是accessDecisionManager.decide()的投票，我们的数据一般都是存在数据库中进行动态的权限，这里我简单的说一下要怎么去配置动态权限</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220916190131154.png" alt="image-20220916190131154"></p><p>我们去自定义两个类</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220916190221563.png" alt="image-20220916190221563"></p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220916190252256.png" alt="image-20220916190252256"></p><p>可以根据自己的逻辑自行修改</p>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安全框架 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SpringSecurity认证流程</title>
      <link href="/posts/7dde2051.html"/>
      <url>/posts/7dde2051.html</url>
      
        <content type="html"><![CDATA[<h2 id="SpringSecurity认证流程">SpringSecurity认证流程</h2><p>最近几天比较闲把SpringSecurity的源码看了一下，这里先讲一下认证的流程，debug级别的讲解</p><blockquote><p>注意此篇文章没有角色和鉴权，后续看完源码会发，还有如果不知道AuthenticationManager和ProviderManager还有AuthenticationProvider，可能有些地方会看不懂，后续会单独出一篇文章进行讲解</p></blockquote><p>首先准备，创建一个springboot项目，然后引入必要的一些依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.vampireachao<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>stream-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.velocity<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>velocity-engine-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--freemarker模板--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.freemarker<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>freemarker<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.github.vampireachao<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>stream-plugin-mybatis-plus<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>数据库数据，因为我懒的创建一个新表了，所以这里就使用了之前的表结构</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for tb_user_role</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `tb_user_role`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `tb_user_role`  (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `user_id` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户id&#x27;</span>,</span><br><span class="line">  `role_id` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;角色id&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">612</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">DYNAMIC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of tb_user_role</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">578</span>, <span class="number">2</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">579</span>, <span class="number">3</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">580</span>, <span class="number">4</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">581</span>, <span class="number">5</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">582</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">583</span>, <span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">584</span>, <span class="number">6</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">585</span>, <span class="number">7</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">586</span>, <span class="number">8</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">587</span>, <span class="number">9</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">589</span>, <span class="number">11</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">590</span>, <span class="number">12</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">591</span>, <span class="number">13</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">592</span>, <span class="number">14</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">593</span>, <span class="number">15</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">595</span>, <span class="number">16</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">597</span>, <span class="number">17</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">598</span>, <span class="number">18</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">599</span>, <span class="number">19</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">600</span>, <span class="number">10</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">601</span>, <span class="number">10</span>, <span class="number">3</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">602</span>, <span class="number">20</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">603</span>, <span class="number">21</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">604</span>, <span class="number">22</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">605</span>, <span class="number">23</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">606</span>, <span class="number">24</span>, <span class="number">2</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_user_role` <span class="keyword">VALUES</span> (<span class="number">611</span>, <span class="number">33</span>, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for tb_user_auth</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `tb_user_auth`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `tb_user_auth`  (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `user_info_id` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户信息id&#x27;</span>,</span><br><span class="line">  `username` <span class="type">varchar</span>(<span class="number">50</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户名&#x27;</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">100</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;密码&#x27;</span>,</span><br><span class="line">  `secret_key` <span class="type">varchar</span>(<span class="number">255</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;秘钥&#x27;</span>,</span><br><span class="line">  `login_type` tinyint(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">1</span> COMMENT <span class="string">&#x27;登录类型&#x27;</span>,</span><br><span class="line">  `ip_address` <span class="type">varchar</span>(<span class="number">50</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户登录ip&#x27;</span>,</span><br><span class="line">  `ip_source` <span class="type">varchar</span>(<span class="number">50</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;ip来源&#x27;</span>,</span><br><span class="line">  `create_time` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  `update_time` datetime <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;更新时间&#x27;</span>,</span><br><span class="line">  `last_login_time` datetime <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;上次登录时间&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE,</span><br><span class="line">  <span class="keyword">UNIQUE</span> INDEX `username`(`username` <span class="keyword">ASC</span>) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">30</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">DYNAMIC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for tb_role_resource</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `tb_role_resource`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `tb_role_resource`  (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `role_id` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;角色id&#x27;</span>,</span><br><span class="line">  `resource_id` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;权限id&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">4373</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">DYNAMIC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of tb_role_resource</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4011</span>, <span class="number">2</span>, <span class="number">254</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4012</span>, <span class="number">2</span>, <span class="number">267</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4013</span>, <span class="number">2</span>, <span class="number">269</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4014</span>, <span class="number">2</span>, <span class="number">270</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4015</span>, <span class="number">2</span>, <span class="number">257</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4016</span>, <span class="number">2</span>, <span class="number">258</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4164</span>, <span class="number">3</span>, <span class="number">192</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4165</span>, <span class="number">3</span>, <span class="number">195</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4166</span>, <span class="number">3</span>, <span class="number">183</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4167</span>, <span class="number">3</span>, <span class="number">246</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4168</span>, <span class="number">3</span>, <span class="number">199</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4169</span>, <span class="number">3</span>, <span class="number">185</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4170</span>, <span class="number">3</span>, <span class="number">191</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4171</span>, <span class="number">3</span>, <span class="number">254</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4172</span>, <span class="number">3</span>, <span class="number">208</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4173</span>, <span class="number">3</span>, <span class="number">234</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4174</span>, <span class="number">3</span>, <span class="number">237</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4175</span>, <span class="number">3</span>, <span class="number">213</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4176</span>, <span class="number">3</span>, <span class="number">241</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4177</span>, <span class="number">3</span>, <span class="number">239</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4178</span>, <span class="number">3</span>, <span class="number">276</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4179</span>, <span class="number">3</span>, <span class="number">205</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4180</span>, <span class="number">3</span>, <span class="number">218</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4181</span>, <span class="number">3</span>, <span class="number">223</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4182</span>, <span class="number">3</span>, <span class="number">202</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4183</span>, <span class="number">3</span>, <span class="number">230</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4184</span>, <span class="number">3</span>, <span class="number">238</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4185</span>, <span class="number">3</span>, <span class="number">232</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4186</span>, <span class="number">3</span>, <span class="number">243</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4187</span>, <span class="number">3</span>, <span class="number">196</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4188</span>, <span class="number">3</span>, <span class="number">257</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4189</span>, <span class="number">3</span>, <span class="number">258</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4190</span>, <span class="number">3</span>, <span class="number">225</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4191</span>, <span class="number">3</span>, <span class="number">231</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4192</span>, <span class="number">3</span>, <span class="number">210</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4282</span>, <span class="number">1</span>, <span class="number">165</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4283</span>, <span class="number">1</span>, <span class="number">192</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4284</span>, <span class="number">1</span>, <span class="number">193</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4285</span>, <span class="number">1</span>, <span class="number">194</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4286</span>, <span class="number">1</span>, <span class="number">195</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4287</span>, <span class="number">1</span>, <span class="number">166</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4288</span>, <span class="number">1</span>, <span class="number">183</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4289</span>, <span class="number">1</span>, <span class="number">184</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4290</span>, <span class="number">1</span>, <span class="number">246</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4291</span>, <span class="number">1</span>, <span class="number">247</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4292</span>, <span class="number">1</span>, <span class="number">167</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4293</span>, <span class="number">1</span>, <span class="number">199</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4294</span>, <span class="number">1</span>, <span class="number">200</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4295</span>, <span class="number">1</span>, <span class="number">201</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4296</span>, <span class="number">1</span>, <span class="number">168</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4297</span>, <span class="number">1</span>, <span class="number">185</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4298</span>, <span class="number">1</span>, <span class="number">186</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4299</span>, <span class="number">1</span>, <span class="number">187</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4300</span>, <span class="number">1</span>, <span class="number">188</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4301</span>, <span class="number">1</span>, <span class="number">189</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4302</span>, <span class="number">1</span>, <span class="number">190</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4303</span>, <span class="number">1</span>, <span class="number">191</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4304</span>, <span class="number">1</span>, <span class="number">254</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4305</span>, <span class="number">1</span>, <span class="number">169</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4306</span>, <span class="number">1</span>, <span class="number">208</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4307</span>, <span class="number">1</span>, <span class="number">209</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4308</span>, <span class="number">1</span>, <span class="number">170</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4309</span>, <span class="number">1</span>, <span class="number">234</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4310</span>, <span class="number">1</span>, <span class="number">235</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4311</span>, <span class="number">1</span>, <span class="number">236</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4312</span>, <span class="number">1</span>, <span class="number">237</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4313</span>, <span class="number">1</span>, <span class="number">171</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4314</span>, <span class="number">1</span>, <span class="number">213</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4315</span>, <span class="number">1</span>, <span class="number">214</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4316</span>, <span class="number">1</span>, <span class="number">215</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4317</span>, <span class="number">1</span>, <span class="number">216</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4318</span>, <span class="number">1</span>, <span class="number">217</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4319</span>, <span class="number">1</span>, <span class="number">224</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4320</span>, <span class="number">1</span>, <span class="number">172</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4321</span>, <span class="number">1</span>, <span class="number">240</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4322</span>, <span class="number">1</span>, <span class="number">241</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4323</span>, <span class="number">1</span>, <span class="number">244</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4324</span>, <span class="number">1</span>, <span class="number">245</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4325</span>, <span class="number">1</span>, <span class="number">267</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4326</span>, <span class="number">1</span>, <span class="number">269</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4327</span>, <span class="number">1</span>, <span class="number">270</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4328</span>, <span class="number">1</span>, <span class="number">173</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4329</span>, <span class="number">1</span>, <span class="number">239</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4330</span>, <span class="number">1</span>, <span class="number">242</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4331</span>, <span class="number">1</span>, <span class="number">276</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4332</span>, <span class="number">1</span>, <span class="number">174</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4333</span>, <span class="number">1</span>, <span class="number">205</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4334</span>, <span class="number">1</span>, <span class="number">206</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4335</span>, <span class="number">1</span>, <span class="number">207</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4336</span>, <span class="number">1</span>, <span class="number">175</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4337</span>, <span class="number">1</span>, <span class="number">218</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4338</span>, <span class="number">1</span>, <span class="number">219</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4339</span>, <span class="number">1</span>, <span class="number">220</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4340</span>, <span class="number">1</span>, <span class="number">221</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4341</span>, <span class="number">1</span>, <span class="number">222</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4342</span>, <span class="number">1</span>, <span class="number">223</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4343</span>, <span class="number">1</span>, <span class="number">176</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4344</span>, <span class="number">1</span>, <span class="number">202</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4345</span>, <span class="number">1</span>, <span class="number">203</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4346</span>, <span class="number">1</span>, <span class="number">204</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4347</span>, <span class="number">1</span>, <span class="number">230</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4348</span>, <span class="number">1</span>, <span class="number">238</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4349</span>, <span class="number">1</span>, <span class="number">177</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4350</span>, <span class="number">1</span>, <span class="number">229</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4351</span>, <span class="number">1</span>, <span class="number">232</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4352</span>, <span class="number">1</span>, <span class="number">233</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4353</span>, <span class="number">1</span>, <span class="number">243</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4354</span>, <span class="number">1</span>, <span class="number">178</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4355</span>, <span class="number">1</span>, <span class="number">196</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4356</span>, <span class="number">1</span>, <span class="number">197</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4357</span>, <span class="number">1</span>, <span class="number">198</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4358</span>, <span class="number">1</span>, <span class="number">257</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4359</span>, <span class="number">1</span>, <span class="number">258</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4360</span>, <span class="number">1</span>, <span class="number">179</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4361</span>, <span class="number">1</span>, <span class="number">225</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4362</span>, <span class="number">1</span>, <span class="number">226</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4363</span>, <span class="number">1</span>, <span class="number">227</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4364</span>, <span class="number">1</span>, <span class="number">228</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4365</span>, <span class="number">1</span>, <span class="number">231</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4366</span>, <span class="number">1</span>, <span class="number">180</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4367</span>, <span class="number">1</span>, <span class="number">210</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4368</span>, <span class="number">1</span>, <span class="number">211</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4369</span>, <span class="number">1</span>, <span class="number">212</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role_resource` <span class="keyword">VALUES</span> (<span class="number">4370</span>, <span class="number">1</span>, <span class="number">277</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Table structure for tb_role</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `tb_role`;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `tb_role`  (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;主键id&#x27;</span>,</span><br><span class="line">  `role_name` <span class="type">varchar</span>(<span class="number">20</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;角色名&#x27;</span>,</span><br><span class="line">  `role_label` <span class="type">varchar</span>(<span class="number">50</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;角色描述&#x27;</span>,</span><br><span class="line">  `is_disable` tinyint(<span class="number">1</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;是否禁用  0否 1是&#x27;</span>,</span><br><span class="line">  `create_time` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  `update_time` datetime <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;更新时间&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">5</span> <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">DYNAMIC</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="comment">-- Records of tb_role</span></span><br><span class="line"><span class="comment">-- ----------------------------</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;管理员&#x27;</span>, <span class="string">&#x27;admin&#x27;</span>, <span class="number">0</span>, <span class="string">&#x27;2021-03-22 14:10:21&#x27;</span>, <span class="string">&#x27;2022-01-09 08:10:20&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role` <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;用户&#x27;</span>, <span class="string">&#x27;user&#x27;</span>, <span class="number">0</span>, <span class="string">&#x27;2021-03-22 14:25:25&#x27;</span>, <span class="string">&#x27;2021-08-11 21:12:21&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role` <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;测试&#x27;</span>, <span class="string">&#x27;test&#x27;</span>, <span class="number">0</span>, <span class="string">&#x27;2021-03-22 14:42:23&#x27;</span>, <span class="string">&#x27;2021-08-24 11:25:39&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `tb_role` <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;test&#x27;</span>, <span class="string">&#x27;test&#x27;</span>, <span class="number">0</span>, <span class="string">&#x27;2022-07-22 15:41:14&#x27;</span>, <span class="string">&#x27;2022-07-22 15:41:17&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>然后使用mp自动生成一下entity，controller，service，mapper层，下面我就从源码的角度一步一步的来讲解一下整个认证的流程，注意这里需要有一定的springsecurity基础。</p><h2 id="配置一下基本环境">配置一下基本环境</h2><p>首先我写了一些基本的配置然后从头走一遍认证流程</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zang.securitysourcecodelearning.config.security;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.zang.securitysourcecodelearning.entity.UserAuth;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.authentication.AuthenticationManager;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.authentication.AuthenticationProvider;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.authentication.dao.DaoAuthenticationProvider;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.builders.HttpSecurity;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.crypto.password.NoOpPasswordEncoder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.crypto.password.PasswordEncoder;</span><br><span class="line"><span class="keyword">import</span> org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO SpringSecurity配置类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/9/14 17:07</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZVerifySpringSecurityConfig</span> <span class="keyword">extends</span> <span class="title class_">WebSecurityConfigurerAdapter</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ZVerifyUserDetailService zVerifyUserDetailService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    ZVerifyFilter <span class="title function_">zVerifyFilter</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">ZVerifyFilter</span> <span class="variable">zVerifyFilter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ZVerifyFilter</span>();</span><br><span class="line">        <span class="comment">// 设置登录的路径</span></span><br><span class="line">        zVerifyFilter.setFilterProcessesUrl(<span class="string">&quot;/doLogin&quot;</span>);</span><br><span class="line">        <span class="comment">// 设置表单登录的key</span></span><br><span class="line">        zVerifyFilter.setPasswordParameter(<span class="string">&quot;pwd&quot;</span>);</span><br><span class="line">        zVerifyFilter.setUsernameParameter(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">        <span class="comment">// 设置自定义的AuthenticationManager</span></span><br><span class="line">        zVerifyFilter.setAuthenticationManager(authenticationManagerBean());</span><br><span class="line">        <span class="comment">// 登录成功之后的处理器</span></span><br><span class="line">        zVerifyFilter.setAuthenticationSuccessHandler((re,resp,au) -&gt;&#123;</span><br><span class="line">            <span class="type">UserAuth</span> <span class="variable">details</span> <span class="operator">=</span> (UserAuth) au.getPrincipal();</span><br><span class="line">            System.out.println(details.getUsername());</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> zVerifyFilter;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="comment">// 为了将我的AuthenticationManager放到容器中</span></span><br><span class="line">    <span class="keyword">public</span> AuthenticationManager <span class="title function_">authenticationManagerBean</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.authenticationManagerBean();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(AuthenticationManagerBuilder auth)</span>&#123;</span><br><span class="line">        <span class="comment">// 创建者创建一个AuthenticationManager，并且将我自定义的authenticationProvider放入其中，这就表明不适用默认的authenticationProvider</span></span><br><span class="line">        auth.authenticationProvider(dao());</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> AuthenticationProvider <span class="title function_">dao</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="type">DaoAuthenticationProvider</span> <span class="variable">provider</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DaoAuthenticationProvider</span>();</span><br><span class="line">        <span class="comment">// 自定义获取用户信息逻辑</span></span><br><span class="line">        provider.setUserDetailsService(zVerifyUserDetailService);</span><br><span class="line">        <span class="comment">// 自定义密码加密</span></span><br><span class="line">        provider.setPasswordEncoder(getNoOpPasswordEncoder());</span><br><span class="line">        <span class="keyword">return</span> provider;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> PasswordEncoder <span class="title function_">getNoOpPasswordEncoder</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> NoOpPasswordEncoder.getInstance();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">configure</span><span class="params">(HttpSecurity http)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        http.authorizeRequests().anyRequest().authenticated().and().csrf().disable().formLogin();</span><br><span class="line">        <span class="comment">// 这个东西就是使用我自己创建的filter去过滤器链中替换掉UsernamePasswordAuthenticationFilter这个过滤器</span></span><br><span class="line">        http.addFilterAt(zVerifyFilter(), UsernamePasswordAuthenticationFilter.class);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="启动项目">启动项目</h2><p>在我们进行登录的时候因为我们已经对UsernamePasswordAuthenticationFilter这个过滤器进行了替代，所以会进入我自定义的ZVerifyFilter中</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZVerifyFilter</span> <span class="keyword">extends</span> <span class="title class_">UsernamePasswordAuthenticationFilter</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Authentication <span class="title function_">attemptAuthentication</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> AuthenticationException &#123;</span><br><span class="line">        <span class="comment">// 判断请求方式是否是POST</span></span><br><span class="line">        <span class="keyword">if</span> (!request.getMethod().equals(<span class="string">&quot;POST&quot;</span>)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">AuthenticationServiceException</span>(<span class="string">&quot;Authentication method not supported: &quot;</span> + request.getMethod());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 拿到表单信息</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">userName</span> <span class="operator">=</span> request.getParameter(getUsernameParameter());</span><br><span class="line">        <span class="type">String</span> <span class="variable">passWord</span> <span class="operator">=</span> request.getParameter(getPasswordParameter()) ;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 封装成UsernamePasswordAuthenticationToken</span></span><br><span class="line">        <span class="type">UsernamePasswordAuthenticationToken</span> <span class="variable">authRequest</span> <span class="operator">=</span> UsernamePasswordAuthenticationToken.unauthenticated(userName,</span><br><span class="line">                passWord);</span><br><span class="line">        setDetails(request, authRequest);</span><br><span class="line">        <span class="comment">// 进行认证</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.getAuthenticationManager().authenticate(authRequest);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后一句话会拿到当前的AuthenticationManager接口然后调用其实现类的authenticate()方法，但是AuthenticationManager接口真正的实现类只有ProviderManager，所以此时也就是调用ProviderManager的authenticate()方法此时会进入for循环然后进行判断</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914200622864.png" alt="image-20220914200622864"></p><p>此时会退出当前的循环，因为是第一次进入所以size是1，退出本次循环之后就退出for循环了，进入下面的if判断</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914200818752.png" alt="image-20220914200818752"></p><p>此时</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914200854595.png" alt="image-20220914200854595"></p><p>这个parent其实还是一个AuthenticationManager，所以就又进入了这个方法，这次不同的是<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914201051167.png" alt="image-20220914201051167"></p><h3 id="获取完整用户信息">获取完整用户信息</h3><p>此时的AuthenticationProvider是我们自定义的DaoAuthenticationProvider</p><p>很明显这次if条件不成立了</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914201246815.png" alt="image-20220914201246815"></p><p>然后会进入DaoAuthenticationProvider的authenticate()，首先进入的是抽象类AbstractUserDetailsAuthenticationProvider的authenticate()方法<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914201507925.png" alt="image-20220914201507925"></p><p>首先取出userName，然后判断缓存中存不存在，不存在的话进入下边的方法</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914202000598.png" alt="image-20220914202000598"></p><p>注意当前的类是DaoAuthenticationProvider，所以会进入DaoAuthenticationProvider的retrieveUser()方法，</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914202127093.png" alt="image-20220914202127093"></p><p>这里会看到获取用户信息的方法，所以我想要自定义的实现获取用户信息，只需要创建一个类然后实现UserDetailsService方法，并且设置到我的DaoAuthenticationProvider，这样就可以使用我们的自定义逻辑</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914204148284.png" alt="image-20220914204148284"></p><p>拿到用户信息此时UserDetails对象已经是我们从数据库中查出来的UserAuth对象了<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914204316759.png" alt="image-20220914204316759"></p><h3 id="用户信息校验">用户信息校验</h3><p>拿到user之后会进行一些验证</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914204414887.png" alt="image-20220914204414887"></p><p>现在看很明显</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914204445987.png" alt="image-20220914204445987"></p><p>两个进行用户信息校验的都是使用的默认的，此时有了上面的经验我们如果不想用他默认的我们就可以自己创建一个Checker实现类，然后实现UserDetailsChecker接口，并且设置到我们的DaoAuthenticationProvider中就可以了<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914204753476.png" alt="image-20220914204753476"></p><h3 id="密码加密-自定义">密码加密(自定义)</h3><p>所以这里校验信息就不去看了直接进入additionalAuthenticationChecks()方法，这个方法是用来进行密码判断的，同样道理，因为我在配置类中指定了密码加密的方式<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914205343252.png" alt="image-20220914205343252"></p><p>所以这个方法调用的是我们名文密码中的matches()</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914205421915.png" alt="image-20220914205421915"></p><p>直接进行判断</p><p>结束之后验证通过，然后还是会进行一个校验，这两个校验一个是看是否被锁定，以及各种信息，后面这个是判断密码是否过期，因为我们可能会有指定场景，写一个定时任务，在一个月之后设置为密码过期啥的。</p><h3 id="密码加密（默认）">密码加密（默认）</h3><p>因为我使用了自定义的密码加密，所以这里就带大家走一遍源码就不进行debug了</p><p>在DaoAuthenticationProvider中有这样一段话<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914211905574.png" alt="image-20220914211905574"></p><p>这是一个工厂<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914212000660.png" alt="image-20220914212000660"></p><p>会创建一个DelegatingPasswordEncoder将默认的bcrypt和map放入其中，很明显这是策略模式</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914212153792.png" alt="image-20220914212153792"></p><p>在这里会先去调用extractId，将我们数据库中的密码拿出来看看有没有{xxx}xxxx这种类型的然后解析，解析出来从map中拿，如果没有的话就抛出异常，有的话就使用其对应的加密进行密码验证</p><h3 id="密码加密升级">密码加密升级</h3><p>最后这个<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914205837267.png" alt="image-20220914205837267"></p><p>createSuccessAuthentication()方法也很重要<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914210024831.png" alt="image-20220914210024831"></p><p>首先会判断我们有没有自己实现密码升级的服务，如果实现了，并且是默认的密码加密的话才会进行密码升级服务，这个也是我们自己可以去定义</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914210347579.png" alt="image-20220914210347579"></p><p>但是别忘记要同时满足加密方式也可以进行密码升级服务哦，缺一不可</p><h3 id="认证成功发布事件">认证成功发布事件</h3><p>然后认证成功之后会发布一个事件也就是登录成功回调方法</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914210643807.png" alt="image-20220914210643807"></p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220914210656012.png" alt="image-20220914210656012"></p><p>我们只需要在filter中设置一下就好，将其默认的覆盖掉就可以使用我们自己的了。</p><blockquote><p>此时整个用户认证就结束了，可以说只要把源码搞清楚定制性是非常高的了</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 源码 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安全框架 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>spring-websocket实现聊天室功能</title>
      <link href="/posts/9748f1b4.html"/>
      <url>/posts/9748f1b4.html</url>
      
        <content type="html"><![CDATA[<h1>spring-websocket实现聊天室功能</h1><p>最近看到有些人的博客中有聊天室的功能所以我也在我博客中写了一个，不过他们用的是java原生的，这里我使用了spring封装的spring-websocket</p><h2 id="Spring-WebSocket配置">Spring-WebSocket配置</h2><p>我们第一步要先配置一下websocket 的基本信息</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO WebSocket相关配置</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/9/6 14:21</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableWebSocket</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZVerifyWebSocketConfig</span> <span class="keyword">implements</span> <span class="title class_">WebSocketConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 注册 WebSocket 处理器</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">registerWebSocketHandlers</span><span class="params">(WebSocketHandlerRegistry webSocketHandlerRegistry)</span> &#123;</span><br><span class="line">        webSocketHandlerRegistry</span><br><span class="line">                <span class="comment">// WebSocket 连接处理器</span></span><br><span class="line">                .addHandler(<span class="keyword">new</span> <span class="title class_">ZVerifyWebSocketHandler</span>(), <span class="string">&quot;/ws-connect&quot;</span>)</span><br><span class="line">                <span class="comment">// WebSocket 拦截器</span></span><br><span class="line">                .addInterceptors(<span class="keyword">new</span> <span class="title class_">ZVerifyWebSocketInterceptor</span>())</span><br><span class="line">                <span class="comment">// 允许跨域</span></span><br><span class="line">                .setAllowedOrigins(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>其中连接处理器和拦截器是我们自己定义的</p></blockquote><p><code>&quot;/ws-connect&quot;</code>就是我们的路径</p><p>因为想要建立连接首先要通过我们的拦截器所以按照逻辑来写拦截器</p><h2 id="前置拦截器">前置拦截器</h2><p>这个前置拦截器一般我们会做安全的校验和一系列处理，这里我就简单了写了一下，这里要做安全校验是因为我们定义的websocket并没有托管给我所使用的安全框架去验证用户，所以在这里要简单校验一下，</p><p>前置处理器的创建要去实现HandshakeInterceptor接口然后重写beforeHandshake，afterHandshake，两个方法，beforeHandshake是用做握手前置校验的，afterHandshake是做握手后置校验的</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO WebSocket 前置拦截器</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/9/6 14:19</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZVerifyWebSocketInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandshakeInterceptor</span> &#123;</span><br><span class="line">    <span class="comment">// 握手之前触发 (return true 才会握手成功 )</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">beforeHandshake</span><span class="params">(ServerHttpRequest request, ServerHttpResponse response, WebSocketHandler handler,</span></span><br><span class="line"><span class="params">                                   Map&lt;String, Object&gt; attr)</span> &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;---- 握手之前触发 &quot;</span> + StpUtil.getTokenValue());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 未登录情况下拒绝握手</span></span><br><span class="line">        <span class="keyword">if</span>(!StpUtil.isLogin()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;---- 未授权客户端，连接失败&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 标记 userId，握手成功</span></span><br><span class="line">        attr.put(<span class="string">&quot;userId&quot;</span>, StpUtil.getLoginIdAsLong());</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 握手之后触发</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterHandshake</span><span class="params">(ServerHttpRequest request, ServerHttpResponse response, WebSocketHandler wsHandler,</span></span><br><span class="line"><span class="params">                               Exception exception)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;---- 握手之后触发 &quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="连接处理器">连接处理器</h2><p>这里是我们的主要处理器，基本上所有重要业务都在这里</p><p>首先创建一个自己的ZVerifyWebSocketHandler然后再去继承TextWebSocketHandler我们可以定制的去实现里边的方法，这里我就按照我自己的博客需求进行重写了，如果需要可以自行扩展。</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220908205224501.png" alt="image-20220908205224501"></p><h3 id="重要属性">重要属性</h3><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220908205537147.png" alt="image-20220908205537147"></p><p>这个是用来存放我们当前在线的人的信息的，用于广播和人数统计还有私信</p><h3 id="进入聊天成功的逻辑">进入聊天成功的逻辑</h3><p>首先重写afterConnectionEstablished()方法这个方法是在连接开启的时候触发的，也就是我握手成功之后，因为是聊天室所以功能防QQ做了，在登录之后会看到当前博客群聊中的在线人数，然后加载聊天记录。这一些简单的过程</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220908211059504.png" alt="image-20220908211059504"></p><ol start="0"><li><p>首先要从session中取到当前连接的用户id，这里我要解释一下这个userId是从哪来的，是在我的握手之前触发的那个beforeHandshake()中写的项目中用的安全框架为Sa-Token，不熟悉的请自行查阅，拿到用户id之后将当前用户的webSocketSession存放到map中</p></li><li><p>更新当前的在线人数，这个处理是比较简单的<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220908212420367.png" alt="image-20220908212420367"></p><p>就是获取一下map的大小就是当前在线人数，然后发送广播消息，这里说一下广播消息其实很简单就是将map中的webSocketSession都取出来然后挨个发送消息注意这里要加一个锁因为不加锁的话可能会导致消息前后异常<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220908213052294.png" alt=""></p></li><li><p>加载历史记录也很平常就是将我们聊天记录存到数据库中，然后将其xxx小时的消息加载出来，然后想当前登录用户发送这里我使用的是历史12小时<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220908213511483.png" alt="image-20220908213511483"></p></li></ol><h3 id="收到消息之后处理逻辑">收到消息之后处理逻辑</h3><p>处理收到消息逻辑是handleTextMessage()方法里边有两个参数一个是发送消息的session，一个是包装的消息对象TextMessage，首先先带大家看一下TextMessage是个什么东西，我们在通过webSocketSession发送消息的时候可以发送多种对象<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220908214150426.png" alt="image-20220908214150426"></p><p>这里我使用了TextMessage，所以就讲一下这里我们在创建TextMessage对象的时候传入参数通过源码可以知道我可以传入一个可读的char值序列然后会将其转换成字符串调用抽象类的构造方法<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220908214411389.png" alt="image-20220908214411389"></p><p>第二个参数的意义是这是否是作为一系列部分消息发送的消息的最后一部分。到这里可以知道我们发送的消息就是抽象类AbstractWebSocketMessage中的payload属性，所以在这里我买可以通过这个入参拿到数据，然后根据其数据的第一个参数，也就是当前的类型去进行对应的逻辑处理，这里就没什么难点了</p><h3 id="连接关闭">连接关闭</h3><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220908214928823.png" alt="image-20220908214928823"></p><p>连接关闭的时候讲当前的用户session从map中remove掉就好如需扩展请自己进行逻辑的修改</p><h3 id="源码">源码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zang.blogz.handler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.date.DateUtil;</span><br><span class="line"><span class="keyword">import</span> cn.hutool.json.JSONUtil;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.zang.blogz.dto.ChatRecordDTO;</span><br><span class="line"><span class="keyword">import</span> com.zang.blogz.dto.RecallMessageDTO;</span><br><span class="line"><span class="keyword">import</span> com.zang.blogz.dto.WebsocketMessageDTO;</span><br><span class="line"><span class="keyword">import</span> com.zang.blogz.enmus.ChatTypeEnum;</span><br><span class="line"><span class="keyword">import</span> com.zang.blogz.enmus.FilePathEnum;</span><br><span class="line"><span class="keyword">import</span> com.zang.blogz.entity.ChatRecord;</span><br><span class="line"><span class="keyword">import</span> com.zang.blogz.entity.UserInfo;</span><br><span class="line"><span class="keyword">import</span> com.zang.blogz.model.input.ro.VoiceRO;</span><br><span class="line"><span class="keyword">import</span> com.zang.blogz.service.ChatRecordService;</span><br><span class="line"><span class="keyword">import</span> com.zang.blogz.service.UserInfoService;</span><br><span class="line"><span class="keyword">import</span> com.zang.blogz.steam.optional.Opp;</span><br><span class="line"><span class="keyword">import</span> com.zang.blogz.strategy.context.UploadStrategyContext;</span><br><span class="line"><span class="keyword">import</span> com.zang.blogz.utils.BeanCopyUtils;</span><br><span class="line"><span class="keyword">import</span> com.zang.blogz.utils.IpUtil;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.socket.CloseStatus;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.socket.TextMessage;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.socket.WebSocketSession;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.socket.handler.TextWebSocketHandler;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.websocket.server.ServerEndpoint;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.util.Collection;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ConcurrentHashMap;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: websocket服务</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/9/6 14:03</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@ServerEndpoint(value = &quot;/ws-connect&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZVerifyWebSocketHandler</span> <span class="keyword">extends</span> <span class="title class_">TextWebSocketHandler</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ChatRecordService chatRecordService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setChatRecordDao</span><span class="params">(ChatRecordService chatRecordService)</span> &#123;</span><br><span class="line">        ZVerifyWebSocketHandler.chatRecordService = chatRecordService;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> UserInfoService userInfoService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUserInfoService</span><span class="params">(UserInfoService userInfoService)</span> &#123;</span><br><span class="line">        ZVerifyWebSocketHandler.userInfoService = userInfoService;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> UploadStrategyContext uploadStrategyContext;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUploadStrategyContext</span><span class="params">(UploadStrategyContext uploadStrategyContext)</span> &#123;</span><br><span class="line">        ZVerifyWebSocketHandler.uploadStrategyContext = uploadStrategyContext;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 固定前缀</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">HEADER_NAME</span> <span class="operator">=</span> <span class="string">&quot;X-Real-IP&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 存放Session集合，方便推送消息</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> ConcurrentHashMap&lt;String, WebSocketSession&gt; webSocketSessionMaps = <span class="keyword">new</span> <span class="title class_">ConcurrentHashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听：连接开启</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterConnectionEstablished</span><span class="params">(WebSocketSession session)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// put到集合，方便后续操作</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">userId</span> <span class="operator">=</span> session.getAttributes().get(<span class="string">&quot;userId&quot;</span>).toString();</span><br><span class="line">        webSocketSessionMaps.put(HEADER_NAME + userId, session);</span><br><span class="line">        <span class="comment">// 更新在线人数</span></span><br><span class="line">        updateOnlineCount();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 加载历史聊天记录</span></span><br><span class="line">        <span class="type">ChatRecordDTO</span> <span class="variable">chatRecordDTO</span> <span class="operator">=</span> listChartRecords(session);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 发送消息</span></span><br><span class="line">        <span class="type">WebsocketMessageDTO</span> <span class="variable">messageDTO</span> <span class="operator">=</span> WebsocketMessageDTO.builder()</span><br><span class="line">                .type(ChatTypeEnum.HISTORY_RECORD.getType())</span><br><span class="line">                .data(chatRecordDTO)</span><br><span class="line">                .build();</span><br><span class="line">        <span class="keyword">synchronized</span> (session) &#123;</span><br><span class="line">            session.sendMessage(<span class="keyword">new</span> <span class="title class_">TextMessage</span>(JSON.toJSONString(messageDTO)));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 给个提示</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">tips</span> <span class="operator">=</span> <span class="string">&quot;Web-Socket 连接成功，sid=&quot;</span> + session.getId() + <span class="string">&quot;，userId=&quot;</span> + userId;</span><br><span class="line">        System.out.println(tips);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 加载历史聊天记录</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> session session</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 加载历史聊天记录</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> ChatRecordDTO <span class="title function_">listChartRecords</span><span class="params">(WebSocketSession session)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">ipAddress</span> <span class="operator">=</span> session.getAcceptedProtocol();</span><br><span class="line"></span><br><span class="line">        LambdaQueryWrapper&lt;ChatRecord&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">LambdaQueryWrapper</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        queryWrapper.ge(ChatRecord::getCreateTime, DateUtil.offsetHour(<span class="keyword">new</span> <span class="title class_">Date</span>(), -<span class="number">12</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> ChatRecordDTO.builder()</span><br><span class="line">                .chatRecordList(chatRecordService.list(queryWrapper))</span><br><span class="line">                .ipAddress(ipAddress)</span><br><span class="line">                .ipSource(IpUtil.getIpSource(ipAddress))</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">updateOnlineCount</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取当前在线人数</span></span><br><span class="line">        <span class="type">WebsocketMessageDTO</span> <span class="variable">messageDTO</span> <span class="operator">=</span> WebsocketMessageDTO.builder()</span><br><span class="line">                .type(ChatTypeEnum.ONLINE_COUNT.getType())</span><br><span class="line">                .data(webSocketSessionMaps.size())</span><br><span class="line">                .build();</span><br><span class="line">        <span class="comment">// 广播消息</span></span><br><span class="line">        broadcastMessage(messageDTO);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 监听：连接关闭</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">afterConnectionClosed</span><span class="params">(WebSocketSession session, CloseStatus status)</span>&#123;</span><br><span class="line">        <span class="comment">// 从集合移除</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">userId</span> <span class="operator">=</span> session.getAttributes().get(<span class="string">&quot;userId&quot;</span>).toString();</span><br><span class="line">        webSocketSessionMaps.remove(HEADER_NAME + userId);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 收到消息</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handleTextMessage</span><span class="params">(WebSocketSession session, TextMessage message)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">ipAddress</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="type">WebsocketMessageDTO</span> <span class="variable">messageDTO</span> <span class="operator">=</span> JSONUtil.toBean(message.getPayload(), WebsocketMessageDTO.class, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">switch</span> (Objects.requireNonNull(ChatTypeEnum.getChatType(messageDTO.getType()))) &#123;</span><br><span class="line">            <span class="keyword">case</span> SEND_MESSAGE:</span><br><span class="line"></span><br><span class="line">                <span class="type">String</span> <span class="variable">data</span> <span class="operator">=</span> String.valueOf(messageDTO.getData()) ;</span><br><span class="line">                <span class="type">InetAddress</span> <span class="variable">address</span> <span class="operator">=</span> Objects.requireNonNull(session.getLocalAddress()).getAddress();</span><br><span class="line">                <span class="keyword">if</span> (Opp.of(address).isNonNull())&#123;</span><br><span class="line"></span><br><span class="line">                    ipAddress = address.getHostAddress();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="type">String</span> <span class="variable">userId</span> <span class="operator">=</span> session.getAttributes().get(<span class="string">&quot;userId&quot;</span>).toString();</span><br><span class="line">                <span class="type">UserInfo</span> <span class="variable">byId</span> <span class="operator">=</span> userInfoService.getById(Integer.valueOf(userId));</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 发送消息</span></span><br><span class="line">                <span class="type">ChatRecord</span> <span class="variable">chatRecord</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChatRecord</span>();</span><br><span class="line"></span><br><span class="line">                chatRecord.setContent(data);</span><br><span class="line">                chatRecord.setType(messageDTO.getType());</span><br><span class="line">                chatRecord.setAvatar(byId.getAvatar());</span><br><span class="line">                chatRecord.setNickname(byId.getNickname());</span><br><span class="line">                chatRecord.setUserId(byId.getId());</span><br><span class="line">                chatRecord.setIpAddress(ipAddress);</span><br><span class="line">                <span class="type">String</span> <span class="variable">ipSource</span> <span class="operator">=</span> IpUtil.getIpSource(ipAddress);</span><br><span class="line">                chatRecord.setIpSource(ipSource);</span><br><span class="line">                chatRecordService.save(chatRecord);</span><br><span class="line"></span><br><span class="line">                messageDTO.setData(chatRecord);</span><br><span class="line">                <span class="comment">// 广播消息</span></span><br><span class="line">                broadcastMessage(messageDTO);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> RECALL_MESSAGE:</span><br><span class="line">                <span class="comment">// 撤回消息</span></span><br><span class="line">                <span class="type">RecallMessageDTO</span> <span class="variable">recallMessage</span> <span class="operator">=</span> JSON.parseObject(JSON.toJSONString(messageDTO.getData()), RecallMessageDTO.class);</span><br><span class="line">                <span class="comment">// 删除记录</span></span><br><span class="line">                chatRecordService.removeById(recallMessage.getId());</span><br><span class="line">                <span class="comment">// 广播消息</span></span><br><span class="line">                broadcastMessage(messageDTO);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> HEART_BEAT:</span><br><span class="line">                <span class="comment">// 心跳消息</span></span><br><span class="line">                messageDTO.setData(<span class="string">&quot;pong&quot;</span>);</span><br><span class="line">                session.sendMessage(<span class="keyword">new</span> <span class="title class_">TextMessage</span>((JSON.toJSONString(messageDTO))));</span><br><span class="line"></span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// -----------</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 向指定客户端推送消息</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sendMessage</span><span class="params">(WebSocketSession session, String message)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;向sid为：&quot;</span> + session.getId() + <span class="string">&quot;，发送：&quot;</span> + message);</span><br><span class="line">            session.sendMessage(<span class="keyword">new</span> <span class="title class_">TextMessage</span>(message));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 向指定用户推送消息</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">sendMessage</span><span class="params">(<span class="type">long</span> userId, String message)</span> &#123;</span><br><span class="line">        <span class="type">WebSocketSession</span> <span class="variable">session</span> <span class="operator">=</span> webSocketSessionMaps.get(HEADER_NAME + userId);</span><br><span class="line">        <span class="keyword">if</span>(session != <span class="literal">null</span>) &#123;</span><br><span class="line">            sendMessage(session, message);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 广播消息</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> messageDTO 消息dto</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException io异常</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">broadcastMessage</span><span class="params">(WebsocketMessageDTO messageDTO)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        Collection&lt;WebSocketSession&gt; sessions = webSocketSessionMaps.values();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (WebSocketSession webSocketService : sessions) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (webSocketService)&#123;</span><br><span class="line">                <span class="type">TextMessage</span> <span class="variable">textMessage</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TextMessage</span>(JSON.toJSONString(messageDTO));</span><br><span class="line">                webSocketService.sendMessage(textMessage);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 发送语音</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> voiceRO 语音路径</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendVoice</span><span class="params">(VoiceRO voiceRO)</span> &#123;</span><br><span class="line">        <span class="comment">// 上传语音文件</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> uploadStrategyContext.executeUploadStrategy(voiceRO.getFile(), FilePathEnum.VOICE.getPath());</span><br><span class="line">        voiceRO.setContent(content);</span><br><span class="line">        <span class="comment">// 保存记录</span></span><br><span class="line">        <span class="type">ChatRecord</span> <span class="variable">chatRecord</span> <span class="operator">=</span> BeanCopyUtils.copyObject(voiceRO, ChatRecord.class);</span><br><span class="line">        chatRecordService.save(chatRecord);</span><br><span class="line">        <span class="comment">// 发送消息</span></span><br><span class="line">        <span class="type">WebsocketMessageDTO</span> <span class="variable">messageDTO</span> <span class="operator">=</span> WebsocketMessageDTO.builder()</span><br><span class="line">                .type(ChatTypeEnum.VOICE_MESSAGE.getType())</span><br><span class="line">                .data(chatRecord)</span><br><span class="line">                .build();</span><br><span class="line">        <span class="comment">// 广播消息</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            broadcastMessage(messageDTO);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WebSocket </category>
          
      </categories>
      
      
        <tags>
            
            <tag> spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>动态生成初始化条件构造器</title>
      <link href="/posts/f87972ce.html"/>
      <url>/posts/f87972ce.html</url>
      
        <content type="html"><![CDATA[<p>在我没日没夜的写大量的增删改查的过程中意识到了一个问题，那就是我们在分页查询或者批量查寻的时候，通常会根据不同的场景去构造不同的<code>QueryWrapper</code>那就有一个问题，<br>对于我们后端很不友好，每次都是查询，只不过前端传过来的条件可能不一样，所以我就想有没有一种办法可以动态的去构造<code>QueryWrapper</code>这时候我就尝试造一个轮子</p><p>下面注释写的很详细，不过要使用这个构造器就要遵守我自己定的规范那么就是在RO对象上所有的属性添加<code>ApiModelProperty</code>注解并且其<code>value</code>值必须要为其数据库中对应的字段名</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: 初始化查询条件构造</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/9/4 16:41</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SearchQueryInit</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span>  &lt;T&gt; QueryWrapper&lt;T&gt; <span class="title function_">getQueryWrapper</span><span class="params">(Object entity,Class&lt;T&gt; clazz)</span>&#123;</span><br><span class="line"></span><br><span class="line">        QueryWrapper&lt;T&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取所有属性</span></span><br><span class="line">        <span class="keyword">for</span>(Field f : entity.getClass().getDeclaredFields()) &#123;</span><br><span class="line">            <span class="comment">// 得到私有属性</span></span><br><span class="line">            f.setAccessible(<span class="literal">true</span>);</span><br><span class="line">            </span><br><span class="line">            Opp.ofTry(() -&gt; &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (f.get(entity) != <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="comment">// 得到属性上的注解</span></span><br><span class="line">                    <span class="type">ApiModelProperty</span> <span class="variable">field</span> <span class="operator">=</span> f.getAnnotation(ApiModelProperty.class);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 在其不为空的情况下</span></span><br><span class="line">                    Opp.ofStr(field.value()).ifPresent(fQ-&gt;&#123;</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            </span><br><span class="line">                            <span class="comment">// 如果是字符串类型的字段单独处理，过滤掉字符串为&quot;&quot;or&quot;    &quot;的,然后进行构造</span></span><br><span class="line">                            Opp&lt;Object&gt; opp = Opp.of(f.get(entity)).typeOfPeek((String s) -&gt; Opp.ofStr(s).ifPresent(Fq -&gt; queryWrapper.like(fQ, Fq)));</span><br><span class="line"></span><br><span class="line">                            <span class="comment">// 如果不是字符传则正常处理</span></span><br><span class="line">                            <span class="keyword">if</span> (opp.isNull())&#123;</span><br><span class="line"></span><br><span class="line">                                queryWrapper.like(fQ, f.get(entity));</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(ResultConstant.InitializationMessage.SEARCH_STRUCTURE);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> queryWrapper;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> orm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>模板模式+策略模式优美的实现上传文件</title>
      <link href="/posts/8dda91f7.html"/>
      <url>/posts/8dda91f7.html</url>
      
        <content type="html"><![CDATA[<h2 id="前提">前提</h2><p>首先你在阅读我这篇文字的时候可能不是很懂模板模式和策略模式，你可以先去网上看一些文章也可以直接看我写的这篇，仔细看我相信你会明白的。这是一篇有关于实战的文字，我会尽可能说的详细一点，我写这篇文字的初衷，</p><ol><li>自己总结一下昨天干了些什么</li><li>巩固一下设计模式</li><li>给需要的小伙伴分享一下</li></ol><h2 id="正文部分">正文部分</h2><h3 id="准备">准备</h3><p>首先在yml配置文件中配置一下上传策略</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 上传策略 可选 oss或local,如需自行扩展请创建impl并继承AbstractUploadStrategyImpl类</span></span><br><span class="line"><span class="attr">upload:</span></span><br><span class="line">  <span class="attr">mode:</span> <span class="string">oss</span></span><br><span class="line">  <span class="attr">local:</span></span><br><span class="line">    <span class="comment"># nginx映射本地文件路径，无域名则为 ip:83</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">http://你的文件上传子域名/</span></span><br><span class="line">    <span class="comment"># 本地文件存储路径</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">/usr/local/upload/</span></span><br><span class="line">   <span class="comment">## 阿里云oss配置</span></span><br><span class="line">  <span class="attr">oss:</span></span><br><span class="line">    <span class="comment">## Region信息，就是你选择的地步分布，如：上海、杭州</span></span><br><span class="line">    <span class="attr">endpoint:</span> <span class="string">&#x27;xxxxx&#x27;</span></span><br><span class="line">    <span class="comment">## 阿里云账号AccessKey拥有所有API的访问权限，风险很高。强烈建议您创建并使用RAM用户进行API访问或日常运维，请登录RAM控制台创建RAM用户。</span></span><br><span class="line">    <span class="attr">accessKeyId:</span> <span class="string">&#x27;xxxxxx&#x27;</span></span><br><span class="line">    <span class="attr">accessKeySecret:</span> <span class="string">&#x27;xxxxxxx&#x27;</span></span><br><span class="line">    <span class="comment">## 填写Bucket名称，例如examplebucket。</span></span><br><span class="line">    <span class="attr">bucketName:</span> <span class="string">&#x27;xxxxxxx&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="创建一个策略的枚举类">创建一个策略的枚举类</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.zang.blogz.enmus;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.util.StrUtil;</span><br><span class="line"><span class="keyword">import</span> com.zang.blogz.steam.stream.Steam;</span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.function.Predicate;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO 上传策略枚举类</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/8/31 17:20</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">UploadStrategyEnum</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * oss</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    OSS(<span class="string">&quot;oss&quot;</span>, <span class="string">&quot;ossUploadStrategyImpl&quot;</span>),</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 本地</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    LOCAL(<span class="string">&quot;local&quot;</span>, <span class="string">&quot;localUploadStrategyImpl&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 模式</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String mode;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 策略</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String strategy;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取策略</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> mode 模式</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> String&#125; 搜索策略</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">getStrategy</span><span class="params">(String mode)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Steam.of(UploadStrategyEnum.values()).findFirst(strategy(mode)).orElse(OSS).getStrategy();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Predicate&lt;? <span class="built_in">super</span> UploadStrategyEnum&gt; strategy(String mode)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> val-&gt;  StrUtil.equals(val.getMode(), mode);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>到时候我们可以通过调用的方法在这里匹配到我们要选择的策略的服务名称，默认为OSS上传服务</p></blockquote><h3 id="创建一个UploadStrategy接口">创建一个UploadStrategy接口</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO 上传策略</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/8/31 18:49</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UploadStrategy</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 上传文件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> file 文件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> path 文件路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> String&#125; 文件地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    String <span class="title function_">uploadFile</span><span class="params">(MultipartFile file, String path)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>我们的策略都会去实现这个接口，因为我们也使用了模板模式到时候只需要抽象模板去实现这个接口就可以了</p></blockquote><h3 id="上传策略上下文">上传策略上下文</h3><p>这个类用于我们去进行策略的选择</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO 上传策略上下文</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/8/31 18:42</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UploadStrategyContext</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 上传模式</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;upload.mode&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String uploadMode;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, UploadStrategy&gt; uploadStrategyMap;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 上传文件</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> file 文件</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> path 路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> String&#125; 文件地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">executeUploadStrategy</span><span class="params">(MultipartFile file, String path)</span> &#123;</span><br><span class="line"></span><br><span class="line">        Opp&lt;String&gt; ofTry = Opp.ofTry(() -&gt; uploadStrategyMap.get(UploadStrategyEnum.getStrategy(uploadMode))</span><br><span class="line">                .uploadFile(file, path), NullPointerException.class);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (Opp.of(ofTry.getException()).isNonNull()) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BizException</span>(<span class="string">&quot;抱歉,请检查配置文件,当前没有你所选择的策略&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ofTry.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>首先从配置文件读到当前选择的上传模式，然后调用我们策略的枚举类里边的方法得到当前使用的策略的服务名称然后从map中通过服务名称拿到服务的实体去执行uploadFile(file, path)方法现在已经选择好了我们的策略了到了我们的抽象模板了</p><h3 id="抽象模板">抽象模板</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO 抽象上传模板</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/8/31 18:55</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">AbstractUploadStrategyImpl</span> <span class="keyword">implements</span> <span class="title class_">UploadStrategy</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">uploadFile</span><span class="params">(MultipartFile file, String path)</span> &#123;</span><br><span class="line"></span><br><span class="line">        Opp&lt;String&gt; uploadOpp = Opp.ofTry(() -&gt; &#123;</span><br><span class="line">            <span class="comment">// 获取文件md5值</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">md5</span> <span class="operator">=</span> FileUtils.getMd5(file.getInputStream());</span><br><span class="line">            <span class="comment">// 获取文件扩展名</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">extName</span> <span class="operator">=</span> FileUtils.getExtName(file.getOriginalFilename());</span><br><span class="line">            <span class="comment">// 重新生成文件名</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">fileName</span> <span class="operator">=</span> md5 + extName;</span><br><span class="line">            <span class="comment">// 判断文件是否已存在</span></span><br><span class="line">            <span class="keyword">if</span> (!exists(path + fileName)) &#123;</span><br><span class="line">                <span class="comment">// 不存在则继续上传</span></span><br><span class="line">                upload(path, fileName, file.getInputStream());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 返回文件访问路径</span></span><br><span class="line">            <span class="keyword">return</span> getFileAccessUrl(path + fileName);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (Opp.of(uploadOpp.getException()).isNonNull()) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BizException</span>(<span class="string">&quot;文件上传失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> uploadOpp.get();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 判断文件是否存在</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> filePath 文件路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> Boolean&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> Boolean <span class="title function_">exists</span><span class="params">(String filePath)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 上传</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> path        路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fileName    文件名</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputStream 输入流</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException io异常</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title function_">upload</span><span class="params">(String path, String fileName, InputStream inputStream)</span> <span class="keyword">throws</span> IOException;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取文件访问url</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> filePath 文件路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> &#123;<span class="doctag">@link</span> String&#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> String <span class="title function_">getFileAccessUrl</span><span class="params">(String filePath)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在抽象模板中去实现UploadStrategy，重写其uploadFile，然后声明三个抽象方法，因为我们的上传总体流程是一样的但是其内部的实现是不一样的，所以这就是我们的模板，我们策略的具体实现只需要继承抽象类并重写这三个方法就可以了</p><h3 id="oss上传具体实现">oss上传具体实现</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO oss上传策略</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/8/31 19:52</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="meta">@Service(&quot;ossUploadStrategyImpl&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OssUploadStrategyImpl</span> <span class="keyword">extends</span> <span class="title class_">AbstractUploadStrategyImpl</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OssConfigProperties ossConfigProperties;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;upload.oss.bucketName&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String P;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;upload.oss.endpoint&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String I;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">exists</span><span class="params">(String filePath)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> getOssClient().doesObjectExist(ossConfigProperties.getBucketName(), filePath);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">upload</span><span class="params">(String path, String fileName, InputStream inputStream)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        getOssClient().putObject(ossConfigProperties.getBucketName(), path + fileName, inputStream);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getFileAccessUrl</span><span class="params">(String filePath)</span> &#123;</span><br><span class="line"></span><br><span class="line">       <span class="type">String</span> <span class="variable">URL</span> <span class="operator">=</span> <span class="string">&quot;https://&quot;</span> + P + <span class="string">&quot;.&quot;</span> + I + <span class="string">&quot;/&quot;</span>;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> URL + filePath;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> OSS <span class="title function_">getOssClient</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">OSSClientBuilder</span>().build(ossConfigProperties.getEndpoint(), ossConfigProperties.getAccessKeyId(), ossConfigProperties.getAccessKeySecret());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="local上传实现">local上传实现</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service(&quot;localUploadStrategyImpl&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LocalUploadStrategyImpl</span> <span class="keyword">extends</span> <span class="title class_">AbstractUploadStrategyImpl</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 本地路径</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;upload.local.path&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String localPath;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 访问url</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;upload.local.url&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String localUrl;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Boolean <span class="title function_">exists</span><span class="params">(String filePath)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">File</span>(localPath + filePath).exists();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">upload</span><span class="params">(String path, String fileName, InputStream inputStream)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 判断目录是否存在</span></span><br><span class="line">        <span class="type">File</span> <span class="variable">directory</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(localPath + path);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!directory.exists()) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!directory.mkdirs()) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BizException</span>(<span class="string">&quot;创建目录失败&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 写入文件</span></span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(localPath + path + fileName);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (file.createNewFile()) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">BufferedInputStream</span> <span class="variable">bis</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedInputStream</span>(inputStream);</span><br><span class="line">            <span class="type">BufferedOutputStream</span> <span class="variable">bos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedOutputStream</span>(Files.newOutputStream(file.toPath()));</span><br><span class="line"></span><br><span class="line">            <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">1024</span>];</span><br><span class="line">            <span class="type">int</span> length;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> ((length = bis.read(bytes)) != -<span class="number">1</span>) &#123;</span><br><span class="line"></span><br><span class="line">                bos.write(bytes, <span class="number">0</span>, length);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            bos.flush();</span><br><span class="line">            inputStream.close();</span><br><span class="line">            bis.close();</span><br><span class="line">            bos.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getFileAccessUrl</span><span class="params">(String filePath)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> localUrl + filePath;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 设计模式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 模板模式 </tag>
            
            <tag> 策略模式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>代理模式</title>
      <link href="/posts/7b510e10.html"/>
      <url>/posts/7b510e10.html</url>
      
        <content type="html"><![CDATA[<h2 id="定义">定义</h2><p>代理模式又叫委托模式，是为某个对象提供一个代理对象，并且由代理对象控制对原对象的访问。代理模式通俗来讲就是我们生活中常见的中介。<br>代理模式可以提供非常好的访问控制，应用比较广泛。<br>举个例子来说明：假如说我现在想买一辆二手车，虽然我可以自己去找车源，做质量检测等一系列的车辆过户流程，但是这确实太浪费我得时间和精力了。我只是想买一辆车而已为什么我还要额外做这么多事呢？于是我就通过中介公司来买车，他们来给我找车源，帮我办理车辆过户流程，我只是负责选择自己喜欢的车，然后付钱就可以了。</p><h2 id="角色">角色</h2><p>抽象主题角色：可以是抽象类，也可以是接口。抽象主题是一个普通的业务类型，无特殊要求。</p><p>具体主题角色：也叫做被委托角色或被代理角色，是业务逻辑的具体执行者。</p><p>代理主题角色：也叫做委托类或代理类。它负责对真实角色的应用，把所有抽象主题类定义的方法限制委托给真实主题角色实现，并且在具体主题角色处理完毕前后做预处理和善后处理工作。</p><h2 id="静态代理">静态代理</h2><p>静态代理中，我们对目标对象的每个方法的增强都是手动完成的（后面会具体演示代码），非常不灵活（比如接口一旦新增加方法，目标对象和代理对象都要进行修改）且麻烦(需要对每个目标类都单独写一个代理类）。 实际应用场景非常非常少，日常开发几乎看不到使用静态代理的场景。</p><p>静态代理实现步骤:</p><ol><li>定义一个接口及其实现类；</li><li>创建一个代理类同样实现这个接口</li><li>将目标对象注入进代理类，然后在代理类的对应方法调用目标类中的对应方法。这样的话，我们就可以通过代理类屏蔽对目标对象的访问，并且可以在目标方法执行前后做一些自己想做的事情。</li></ol><p>下面我写一个结婚的案例方便理解静态代理</p><p>定义一个结婚的接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/8/30 22:49</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MarryService</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">marry</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>具体对象去实现接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/8/30 22:50</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Zverify</span> <span class="keyword">implements</span> <span class="title class_">MarryService</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">marry</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;抽空结个婚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代理类同样去实现接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/8/30 22:53</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ZverifyMarryProxy</span> <span class="keyword">implements</span> <span class="title class_">MarryService</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> MarryService marryService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ZverifyMarryProxy</span><span class="params">(MarryService marryService)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.marryService = marryService;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">marry</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;我是婚庆主持我来主持&quot;</span>);</span><br><span class="line"></span><br><span class="line">        marryService.marry();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;我是打扫卫生的，婚礼结束我来打扫&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>测试</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220830225814257.png" alt="image-20220830225814257"></p><h2 id="动态代理">动态代理</h2><p>相比于静态代理来说，动态代理更加灵活。我们不需要针对每个目标类都单独创建一个代理类，并且也不需要我们必须实现接口，我们可以直接代理实现类( CGLIB 动态代理机制)。</p><p>从 JVM 角度来说，动态代理是在运行时动态生成类字节码，并加载到 JVM 中的。</p><p>说到动态代理，Spring AOP、RPC 框架应该是两个不得不提的，它们的实现都依赖了动态代理。</p><p>动态代理在我们日常开发中使用的相对较少，但是在框架中的几乎是必用的一门技术。学会了动态代理之后，对于我们理解和学习各种框架的原理也非常有帮助。</p><p>就 Java 来说，动态代理的实现方式有很多种，比如 JDK 动态代理、CGLIB 动态代理等等。</p><h3 id="JDK动态代理">JDK动态代理</h3><p><code>在Java动态代理的机制中InvocationHandler接口和Proxy类是核心</code><br>Proxy 类中使用频率最高的方法是：newProxyInstance() ，这个方法主要用来生成一个代理对象。<br>这个方法一共有三个参数：</p><ol><li>loader：类加载器用于加载代理对象</li><li>interfaces：被代理类实现的一些接口</li><li>h：实现了InvocationHandler接口的invoke方法来调用</li></ol><p>所以我们第三个参数需要一个自定义的类去实现InvocationHandler接口并实现invoke方法这里因为这个接口就一个方法我们直接使用lambda表达式写一下就不去创建类了</p><p>invoke() 方法有下面三个参数：</p><p>proxy :动态生成的代理类<br>method : 与代理类对象调用的方法相对应<br>args : 当前 method 方法的参数<br>也就是说：你通过Proxy 类的 newProxyInstance() 创建的代理对象在调用方法的时候，实际会调用到实现InvocationHandler 接口的类的 invoke()方法。 你可以在 invoke() 方法中自定义处理逻辑，比如在方法执行前后做什么事情。</p><p>JDK 动态代理类使用步骤<br>定义一个接口及其实现类；<br>自定义 InvocationHandler 并重写invoke方法，在 invoke 方法中我们会调用原生方法（被代理类的方法）并自定义一些处理逻辑；<br>通过 Proxy.newProxyInstance(ClassLoader loader,Class&lt;?&gt;[] interfaces,InvocationHandler h) 方法创建代理对象；</p><p>抽象接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MarryService</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">marry</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>具体被代理类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Zverify</span> <span class="keyword">implements</span> <span class="title class_">MarryService</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">marry</span><span class="params">()</span> &#123;</span><br><span class="line">        </span><br><span class="line">        System.out.println(<span class="string">&quot;抽空结个婚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>产生代理对象的工厂</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> MarryService <span class="title function_">getMarryProxy</span><span class="params">(MarryService marryService)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (MarryService) Proxy.newProxyInstance(marryService.getClass().getClassLoader(), marryService.getClass().getInterfaces(),</span><br><span class="line">                (proxy, method, args)-&gt;&#123;</span><br><span class="line"></span><br><span class="line">                    System.out.println(<span class="string">&quot;我帮你主持婚礼&quot;</span>);</span><br><span class="line">                    <span class="type">Object</span> <span class="variable">invoke</span> <span class="operator">=</span> method.invoke(marryService, args);</span><br><span class="line">                    System.out.println(<span class="string">&quot;我帮你打扫卫生&quot;</span>);</span><br><span class="line">                    <span class="keyword">return</span> invoke;</span><br><span class="line">                &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>测试</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ProxyTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">MarryService</span> <span class="variable">marryProxy</span> <span class="operator">=</span> ProxyFactory.getMarryProxy(<span class="keyword">new</span> <span class="title class_">Zverify</span>());</span><br><span class="line"></span><br><span class="line">        marryProxy.marry();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行结果如下<br><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220831092221066.png" alt="image-20220831092221066"></p><h3 id="CGLIB动态代理">CGLIB动态代理</h3><p>介绍<br>JDK动态代理有一个最致命的问题就是他只能代理实现了接口的类<br>为了解决这个问题，我们可以使用CGLIB动态代理机制来避免</p><p>CGLIB(Code Generation Library)是一个基于ASM的字节码生成库，它允许我们在运行时对字节码进行修改和动态生成。CGLIB 通过继承方式实现代理。很多知名的开源框架都使用到了CGLIB， 例如 Spring 中的 AOP 模块中：如果目标对象实现了接口，则默认采用 JDK 动态代理，否则采用 CGLIB 动态代理。</p><p>在 CGLIB 动态代理机制中 MethodInterceptor 接口和 Enhancer 类是核心。</p><p>你需要自定义 MethodInterceptor 并重写 intercept 方法，intercept 用于拦截增强被代理类的方法。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MethodInterceptor</span></span><br><span class="line"><span class="keyword">extends</span> <span class="title class_">Callback</span>&#123;</span><br><span class="line">    <span class="comment">// 拦截被代理类中的方法,参数基本和之前的一样见名知意</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">intercept</span><span class="params">(Object obj, java.lang.reflect.Method method, Object[] args,MethodProxy proxy)</span> <span class="keyword">throws</span> Throwable;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>你可以通过 Enhancer类来动态获取被代理类，当代理类调用方法的时候，实际调用的是 MethodInterceptor 中的 intercept 方法</p><p>CGLIB 动态代理类使用步骤</p><ol><li>定义一个类；</li><li>自定义 MethodInterceptor 并重写 intercept 方法，intercept 用于拦截增强被代理类的方法，和 JDK 动态代理中的 invoke 方法类似；</li><li>通过 Enhancer 类的 create()创建代理类；</li></ol><p>不同于 JDK 动态代理不需要额外的依赖。CGLIB(Code Generation Library) 实际是属于一个开源项目，如果你要使用它的话，需要手动添加相关依赖。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cglib<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>创建一个能够结婚的类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/8/31 10:20</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MarryService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">marry</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;抽空结个婚&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这次我们就不用lambda了，分开写一下，自定义一个拦截器实现MethodInterceptor接口重写intercept</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/8/31 10:25</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MarryInterceptor</span> <span class="keyword">implements</span> <span class="title class_">MethodInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> o           代理对象（增强的对象）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> method      被拦截的方法（需要增强的方法）</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> objects        方法入参</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> methodProxy 用于调用原始方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">intercept</span><span class="params">(Object o, Method method, Object[] objects, MethodProxy methodProxy)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;我帮助你主持婚礼&quot;</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">invokeSuper</span> <span class="operator">=</span> methodProxy.invokeSuper(o, objects);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;我帮你打扫卫生&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> invokeSuper;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>获取代理类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Author</span>: ZVerify</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Description</span>: TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@DateTime</span>: 2022/8/31 10:34</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CglibProxyFactory</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;A&gt; A <span class="title function_">getProxy</span><span class="params">(Class&lt;A&gt; clazz)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Enhancer</span> <span class="variable">enhancer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Enhancer</span>();</span><br><span class="line"></span><br><span class="line">        enhancer.setClassLoader(clazz.getClassLoader());</span><br><span class="line"></span><br><span class="line">        enhancer.setSuperclass(clazz);</span><br><span class="line"></span><br><span class="line">        enhancer.setCallback(<span class="keyword">new</span> <span class="title class_">MarryInterceptor</span>());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (A) enhancer.create();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>测试<br><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220831105319785.png" alt="image-20220831105319785"></p><h3 id="JDK-动态代理和-CGLIB-动态代理对比">JDK 动态代理和 CGLIB 动态代理对比</h3><p>JDK 动态代理只能代理实现了接口的类或者直接代理接口，而 CGLIB 可以代理未实现任何接口的类。 另外， CGLIB 动态代理是通过生成一个被代理类的子类来拦截被代理类的方法调用，因此不能代理声明为 final 类型的类和方法。<br>就二者的效率来说，大部分情况都是 JDK 动态代理更优秀，随着 JDK 版本的升级，这个优势更加明显。</p><h2 id="静态代理和动态代理的对比">静态代理和动态代理的对比</h2><p>灵活性 ：动态代理更加灵活，不需要必须实现接口，可以直接代理实现类，并且可以不需要针对每个目标类都创建一个代理类。另外，静态代理中，接口一旦新增加方法，目标对象和代理对象都要进行修改，这是非常麻烦的！<br>JVM 层面 ：静态代理在编译时就将接口、实现类、代理类这些都变成了一个个实际的 class 文件。而动态代理是在运行时动态生成类字节码，并加载到 JVM 中的。</p>]]></content>
      
      
      <categories>
          
          <category> 设计模式 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 代理模式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Redis设置小key过期时间</title>
      <link href="/posts/8486078e.html"/>
      <url>/posts/8486078e.html</url>
      
        <content type="html"><![CDATA[<h2 id="场景">场景</h2><p>首先是一个这样的业务场景，我们要做一个注册的功能，我们会通过用户输入的邮箱进行发送一个验证码，并且验证码有效期是3分钟，但是我们要去使用redis保存验证码，但是又不想用string去做。用hash去怎么实现呢</p><h2 id="做法">做法</h2><h3 id="保存">保存</h3><p>在我们redis中可以通过hash做，但是呢redis只提供了hash类型的大key的过期时间，这个时候问题就来了，我就想使用一个大key，然后每个邮箱的地址小key，验证码为value，这个时候我们只需要在验证码之后拼接一个时间</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220706161815789.png" alt="image-20220706161815789"></p><p>此时就是获取我们的当前时间然后偏移三分钟转换为字符串之后拼接到验证码之后</p><h3 id="验证">验证</h3><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220706163004834.png" alt="image-20220706163004834"></p><p>我们这样的话取出来的时候就可以先把我们保存的过期时间取出来，然后获得当前时间进行比较如果当前时间在过期时间之后就代表我们的验证码已经过期了，如果没有的话就说明还没有过期，进行下边的思路</p>]]></content>
      
      
      <categories>
          
          <category> 技巧 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Lambda表达式也能写递归吗</title>
      <link href="/posts/43424dfc.html"/>
      <url>/posts/43424dfc.html</url>
      
        <content type="html"><![CDATA[<h2 id="🍑当你点进这篇文章的时候可能会有些疑问，什么Lambda表达式也能写递归？">🍑当你点进这篇文章的时候可能会有些疑问，什么Lambda表达式也能写递归？</h2><p>没错是这样的，我们在很多时候会用到递归树但是如果在数据库去写递归的SQL对数据库的压力就太大了，通常我们会一次性的都查出来在Java去进行递归的操作，我们这个操作要写好多代码而且思想基本都差不多，所以我们的Steam提供了这样一个方法toTree()，他可以定制的去进行集合转换为树的操作。<br>这里我感觉lambda能写递归感到这个思想很好玩所以这里给大家讲一下我写的源码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 将集合转换为树，自定义树顶部的判断条件，内置一个小递归(没错，lambda可以写递归)</span></span><br><span class="line"><span class="comment"> * 因为需要在当前传入数据里查找，所以这是一个结束操作</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> idGetter        id的getter对应的lambda，可以写作 &#123;<span class="doctag">@code</span> Student::getId&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> pIdGetter       parentId的getter对应的lambda，可以写作 &#123;<span class="doctag">@code</span> Student::getParentId&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> childrenSetter  children的setter对应的lambda，可以写作 &#123;<span class="doctag">@code</span> Student::setChildren&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> parentPredicate 树顶部的判断条件，可以写作 &#123;<span class="doctag">@code</span> s -&gt; Objects.equals(s.getParentId(),0L) &#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;R&gt;             此处是id、parentId的泛型限制</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> list 组装好的树</span></span><br><span class="line"><span class="comment"> * eg:</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@code</span> List studentTree = Steam.of(students).toTree(Student::getId, Student::getParentId, Student::setChildren, Student::getMatchParent) &#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> &lt;R <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;R&gt;&gt; List&lt;T&gt; <span class="title function_">toTree</span><span class="params">(Function&lt;T, R&gt; idGetter,</span></span><br><span class="line"><span class="params">                                                Function&lt;T, R&gt; pIdGetter,</span></span><br><span class="line"><span class="params">                                                BiConsumer&lt;T, List&lt;T&gt;&gt; childrenSetter,</span></span><br><span class="line"><span class="params">                                                Predicate&lt;T&gt; parentPredicate)</span> &#123;</span><br><span class="line">    List&lt;T&gt; list = toList();</span><br><span class="line">    List&lt;T&gt; parents = Steam.of(list).filter(e -&gt; Opp.of(e).is(parentPredicate)).toList();</span><br><span class="line">    <span class="keyword">return</span> getChildrenFromMapByPidAndSet(idGetter, childrenSetter, Steam.of(list).group(pIdGetter), parents);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * toTree的内联函数，内置一个小递归(没错，lambda可以写递归)</span></span><br><span class="line"><span class="comment"> * 因为需要在当前传入数据里查找，所以这是一个结束操作</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> idGetter       id的getter对应的lambda，可以写作 &#123;<span class="doctag">@code</span> Student::getId&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> childrenSetter children的setter对应的lambda，可以写作 &#123;<span class="doctag">@code</span> Student::setChildren&#125;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> pIdValuesMap   parentId和值组成的map，用来降低复杂度</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> parents        顶部数据</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &lt;R&gt;            此处是id的泛型限制</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> list 组装好的树</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> &lt;R <span class="keyword">extends</span> <span class="title class_">Comparable</span>&lt;R&gt;&gt; List&lt;T&gt; <span class="title function_">getChildrenFromMapByPidAndSet</span><span class="params">(Function&lt;T, R&gt; idGetter,</span></span><br><span class="line"><span class="params">        BiConsumer&lt;T, List&lt;T&gt;&gt; childrenSetter,</span></span><br><span class="line"><span class="params">        Map&lt;R, List&lt;T&gt;&gt; pIdValuesMap,</span></span><br><span class="line"><span class="params">        List&lt;T&gt; parents)</span> &#123;</span><br><span class="line">        AtomicReference&lt;Consumer&lt;List&lt;T&gt;&gt;&gt; recursiveRef = <span class="keyword">new</span> <span class="title class_">AtomicReference</span>&lt;&gt;();</span><br><span class="line">        Consumer&lt;List&lt;T&gt;&gt; recursive = values -&gt; Steam.of(values).forEach(value -&gt; &#123;</span><br><span class="line">        List&lt;T&gt; children = pIdValuesMap.get(idGetter.apply(value));</span><br><span class="line">        childrenSetter.accept(value, children);</span><br><span class="line">        recursiveRef.get().accept(children);</span><br><span class="line">        &#125;);</span><br><span class="line">        recursiveRef.set(recursive);</span><br><span class="line">        recursive.accept(parents);</span><br><span class="line">        <span class="keyword">return</span> parents;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure><p>这里主要讲解一下getChildrenFromMapByPidAndSet()这个私有方法，因为递归主要是在这里做的</p><p>造一些数据debug一下更好理解</p><p>我们测试用这些数据</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Student&gt; studentTree = Steam</span><br><span class="line">                    .of(</span><br><span class="line">                            Student.builder().id(<span class="number">1L</span>).name(<span class="string">&quot;dromara&quot;</span>).build(),</span><br><span class="line">                            Student.builder().id(<span class="number">2L</span>).name(<span class="string">&quot;baomidou&quot;</span>).build(),</span><br><span class="line">                            Student.builder().id(<span class="number">3L</span>).name(<span class="string">&quot;hutool&quot;</span>).parentId(<span class="number">1L</span>).build(),</span><br><span class="line">                            Student.builder().id(<span class="number">4L</span>).name(<span class="string">&quot;sa-token&quot;</span>).parentId(<span class="number">1L</span>).build(),</span><br><span class="line">                            Student.builder().id(<span class="number">5L</span>).name(<span class="string">&quot;mybatis-plus&quot;</span>).parentId(<span class="number">2L</span>).build(),</span><br><span class="line">                            Student.builder().id(<span class="number">6L</span>).name(<span class="string">&quot;looly&quot;</span>).parentId(<span class="number">3L</span>).build(),</span><br><span class="line">                            Student.builder().id(<span class="number">7L</span>).name(<span class="string">&quot;click33&quot;</span>).parentId(<span class="number">4L</span>).build(),</span><br><span class="line">                            Student.builder().id(<span class="number">8L</span>).name(<span class="string">&quot;jobob&quot;</span>).parentId(<span class="number">5L</span>).build()</span><br><span class="line">                    )</span><br><span class="line">                    <span class="comment">// just 3 lambda,top parentId is null</span></span><br><span class="line">                    .toTree(Student::getId, Student::getParentId, Student::setChildren);</span><br></pre></td></tr></table></figure><p>我们测试使用的顶部数据是parentId为null的</p><p>当进去方法之后我买会根据parentId去进行分组存到map中方便后续使用</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220826223948668.png" alt="image-20220826223948668"></p><p>进入getChildrenFromMapByPidAndSet()方法中这里就不对参数做说明了上边源码中解释的很清楚</p><p>我们创建一个原子引用类存放一个Consumer是对list类型的操作</p><p>然后写一下这个consumer所进行的操作，具体操作后边说</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220826224729454.png" alt="image-20220826224729454"></p><p>到这里的时候会将这个consumer对象存放到recursiveRef中然后下面对其进行操作就进如这个consumer的操作了</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220826225057371.png" alt="image-20220826225057371"></p><p>此时我们要操作的是顶部数据</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220826225412081.png" alt="image-20220826225412081"></p><p>上边这步意思是通过我们现在的顶部id取出parentId为我们顶部数据id的对象然后对其进行我们传入的set操作将其放入顶部数据的子节点中然后最妙的地方出现了我们此时还没有到第二个根节点，此时从recursiveRef中取出来将刚刚保存的子节点取进行consumer操作也就是看看齐有没有子节点有的话继续进行操作，其实如果有一些基础的话我讲到这应该已经知道这个使用的思想是dfs(深度优先遍历)，此时看一下<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220826230254127.png" alt="image-20220826230254127"></p><p>下一次进行操作的是name为hutool的这个对象，很明显证实了我的话</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/image-20220826230406005.png" alt="image-20220826230406005"></p><p>第三次就是name为looly这个对象。说到这应该已经很清楚了。</p><blockquote><p>这个递归的操作最妙的就是使用一个AtomicReference去存放我买的消费操作然后在每一次操作的时候从原子类中取出来再次进行消费。</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 开源 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Steam </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MVCC底层原理</title>
      <link href="/posts/11dc0777.html"/>
      <url>/posts/11dc0777.html</url>
      
        <content type="html"><![CDATA[<h2 id="MVCC底层原理">MVCC底层原理</h2><p>假设现在有一个index表，只有一条数据</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/dedf4345b7282d7a872b2bd1a11fa3c9.png" alt="dedf4345b7282d7a872b2bd1a11fa3c9"></p><p>此时他是有两个隐藏列的，一个是trxid(事务id)，一个是roll pointer(回滚指针)</p><p>此时新建三个会话，每个会话创建一个事务，我这里创建了</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/faca570a9ce125e0d6fd35096271340b.png" alt="faca570a9ce125e0d6fd35096271340b"></p><p>这三个依次进行一次更新操作，因为只有更新操作的时候才会生成事务id</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/9deada5bbd1abd1e869fcf02f352380a.png" alt="9deada5bbd1abd1e869fcf02f352380a"></p><p>所以要先去操作别的表一下以便生成事务id</p><p>我们在进行第三个事务的时候更新了一条数据在数据库底层会帮我们做这样一件事情</p><p>创建一条新数据然后将我们的旧数据放到回滚日志里边，并且将回滚指针指向它</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/a9b16bbf2819b3caa58f540ab6548d85.png" alt="a9b16bbf2819b3caa58f540ab6548d85"></p><p>此时我们进行一个查询会生成一个快照，他由指向查询时所有未提交事务id数组，和已创建事务id组成，查询数据需要跟read-view作对比从而得到快照结果</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/88dbc40a19db9f4ca587ed5c88333502.png" alt="88dbc40a19db9f4ca587ed5c88333502"></p><p>很明显此时查询结果为臧臧，这里就不做讲解</p><p>此时事务id为100的一次进行了3条更新操作</p><p>还会生成版本链</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/a7858897faa9d5b53cc2e07411e43749.png" alt="a7858897faa9d5b53cc2e07411e43749"></p><p>此时橙色的为最新数据，而黄色的为在版本日志里的数据</p><p>下面进行一个新的查询</p><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/3a352c2543f4b65816a9dc0aa58a223e.png" alt="3a352c2543f4b65816a9dc0aa58a223e"></p><p>因为我们研究的是可重复读的情况所以会沿用上一次生成的快照</p><p>此时查询出来的数据还会是臧臧，那么这是为什么呢，分析一下</p><p>先说一些readview比对规则</p><blockquote><p>当执行查询sql时会生成一致性视图read-view，它由执行查询时所有未提交事务id数组(数组里最小的id为min_id)和已创建的最大事务id(max_id) 组成，查询的数据结构需要跟read-view做对比从而得到快照结果</p><p>版本链对比规则：</p><ol><li>如果在绿色部分(trx_id&lt;min_id),表示这个版本是已经提交的事务生成的，这个数据是可见的；</li><li>如果落在红色部分(trx_id&gt;max_id),表示这个版本是有将来启动的事务生成的，是肯定不可见的</li><li>如果落在黄色部分(min_id&lt;trx_id&lt;max_id)那就包括两个情况</li><li>若row的trx_id在数组中，表示这个版本是由还没提交的事务生成的，不可见，当然了，自己肯定是可见的</li><li>若row的trx_id不在数组中说明，这个版本是已经提交了的事务生成了的，可见</li></ol><p>对于删除的情况可以认为是update的特殊情况，会将版本链上最新的数据复制一份，然后将trx_id修改成删除操作的trx_id，同时在该条记录的头信息(record header)里的deleted_flag标记位写上true，来表示当前的记录已经被删除了，在查询时按照上边的规则查到对应记录如果delete_flag标记位true，意味当前记录已被删除，则不返回数据</p></blockquote><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/30c4cf79c88b157b2bd97608a34d9f1b.png" alt="30c4cf79c88b157b2bd97608a34d9f1b"></p><ol><li><p>因为此时的readview是第一次生成的readview所以会进行比对事务id此时的事务id为100进行对比等于min_id(数组中最小事务id)，所以不可见，根据回滚指针去undolog里边找连续两个都是100，当到事务id为300的时候，符合第三个条件，然后进行判断不在未提交事务的数组中，所以可见，我们查到的数据为姓名为臧臧的数据，</p></li><li><p>我们现在按顺序进行以下操作<img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/9c98cba895b6eaf36cf50c31d7f35641.png" alt="9c98cba895b6eaf36cf50c31d7f35641"></p><p>此时再次进行查询，因为是可重复读状态依旧会使用上次生成的快照，进行对比此时版本链是这样的</p></li></ol><p><img src="https://zangzang.oss-cn-beijing.aliyuncs.com/img/f1bb3f5f8618c8ee0078b0b8d5d136a9.png" alt="f1bb3f5f8618c8ee0078b0b8d5d136a9"></p><ol start="3"><li><p>进行对比200在范围内，但是在未提交数组中所以不可见，以此类推，查出来的还是name=臧臧，</p></li><li><p>此时我们进行这样的操作新建一个会话，然后进行同样的查询操作，这个时候生成的read-view是[200]，300.因为我们此时生成快照的时间在100和300都提交的时刻所以read-view是这样的继续对比200在范围内，并且在未提交数组中不可见，上边一样，一直到100的时候，小于min_id属于已提交的所有能读出name=朵橙</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> MySQL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 锁 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Markdown语法与外挂标签写法汇总</title>
      <link href="/posts/2013454d.html"/>
      <url>/posts/2013454d.html</url>
      
        <content type="html"><![CDATA[<h1>1.Markdown语法自带格式</h1><div class="note info flat"><p>参考：<a href="https://blog.csdn.net/u014061630/article/details/81359144">Markdown语法图文全面详解(10分钟学会)</a></p></div><div class="note warning flat"><p>注意：此页面偶尔会存在CSS冲突问题!</p></div><h2 id="1-1-代码块">1.1 代码块</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">\```shell</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VSCode终端</span></span><br><span class="line">hexo clean; hexo s</span><br><span class="line">hexo clean; hexo g; hexo d</span><br><span class="line">git add .; git commit -m &quot;npm publish&quot;; npm version patch; </span><br><span class="line">git push</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cmder终端</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br><span class="line">git add . &amp;&amp; git commit -m &quot;npm publish&quot; &amp;&amp; npm version patch</span><br><span class="line">git push</span><br><span class="line">\```</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">VSCode终端</span></span><br><span class="line">hexo clean; hexo s</span><br><span class="line">hexo clean; hexo g; hexo d</span><br><span class="line">git add .; git commit -m &quot;npm publish&quot;; npm version patch; </span><br><span class="line">git push</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Cmder终端</span></span><br><span class="line">hexo clean &amp;&amp; hexo s</span><br><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br><span class="line">git add . &amp;&amp; git commit -m &quot;npm publish&quot; &amp;&amp; npm version patch</span><br><span class="line">git push</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-2-多级标题">1.2 多级标题</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># H1</span></span><br><span class="line"><span class="section">## H2</span></span><br><span class="line"><span class="section">### H3</span></span><br><span class="line"><span class="section">#### H4</span></span><br><span class="line"><span class="section">##### H5</span></span><br><span class="line"><span class="section">###### H6</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p>见本文章标题!</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-3-文字样式">1.3 文字样式</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">u</span>&gt;</span></span>下划线演示<span class="language-xml"><span class="tag">&lt;/<span class="name">u</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">文字<span class="strong">**加粗**</span>演示</span><br><span class="line"></span><br><span class="line">文字<span class="emphasis">*斜体*</span>演示</span><br><span class="line"></span><br><span class="line">文本<span class="code">`高亮`</span>演示</span><br><span class="line"></span><br><span class="line">文本~~删除~~线演示</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">size</span> = <span class="string">5</span>&gt;</span></span>5号字<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">face</span>=<span class="string">&quot;黑体&quot;</span>&gt;</span></span>黑体<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">font</span> <span class="attr">color</span>=<span class="string">blue</span>&gt;</span></span>蓝色<span class="language-xml"><span class="tag">&lt;/<span class="name">font</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">td</span> <span class="attr">bgcolor</span>=<span class="string">MistyRose</span>&gt;</span></span>这里的背景色是：MistyRosen，此处输入任意想输入的内容<span class="language-xml"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p><u>下划线演示</u></p><p>文字<strong>加粗</strong>演示</p><p>文字<em>斜体</em>演示</p><p>文本<code>高亮</code>演示</p><p>文本<s>删除</s>线演示</p><p><font size = 5>5号字</font><br><font face="黑体">黑体</font><br><font color=blue>蓝色</font></p><table><tr><td bgcolor=MistyRose>这里的背景色是：MistyRosen，此处输入任意想输入的内容</td></tr></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><div class="note info flat"><p>上述要点可参考:<a href="https://blog.csdn.net/qq_43732429/article/details/108034518">【Markdown语法】字体颜色大小及文字底色设置</a></p></div><h2 id="1-4-引用">1.4 引用</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="quote">&gt;  Java</span></span><br><span class="line"><span class="quote">&gt; 二级引用演示</span></span><br><span class="line"><span class="quote">&gt; MySQL</span></span><br><span class="line"><span class="quote">&gt; &gt;外键</span></span><br><span class="line"><span class="quote">&gt; &gt;</span></span><br><span class="line"><span class="quote">&gt; &gt;事务</span></span><br><span class="line"><span class="quote">&gt; &gt;</span></span><br><span class="line"><span class="quote">&gt; &gt;<span class="strong">**行级锁**</span>(引用内部一样可以用格式)</span></span><br><span class="line"><span class="quote">&gt; </span></span><br><span class="line"><span class="quote">&gt; ....</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><blockquote><p>Java<br>二级引用演示<br>MySQL</p><blockquote><p>外键</p><p>事务</p><p><strong>行级锁</strong>(引用内部一样可以用格式)</p></blockquote><p>…</p></blockquote><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-5-分割线">1.5 分割线</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="strong">**<span class="emphasis">*</span></span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><hr><hr><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-6-列表-跟空格都可以">1.6 列表(*,+,-跟空格都可以)</h2><h3 id="1-6-1-无序列表">1.6.1 无序列表</h3><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">*</span> Java</span><br><span class="line"><span class="bullet">*</span> Python</span><br><span class="line"><span class="bullet">*</span> ...</span><br><span class="line"></span><br><span class="line"><span class="bullet">+</span> Java</span><br><span class="line"><span class="bullet">+</span> Python</span><br><span class="line"><span class="bullet">+</span> ...</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> Java</span><br><span class="line"><span class="bullet">-</span> Python</span><br><span class="line"><span class="bullet">-</span> ...</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ul><li>Java</li><li>Python</li><li>…</li></ul><ul><li>Java</li><li>Python</li><li>…</li></ul><ul><li>Java</li><li>Python</li><li>…</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h3 id="1-6-2-有序列表">1.6.2 有序列表</h3><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 注意后面有空格</span></span><br><span class="line"><span class="bullet">1.</span> </span><br><span class="line"><span class="bullet">2.</span> </span><br><span class="line"><span class="bullet">3.</span> </span><br><span class="line"><span class="bullet">4.</span> </span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li></li><li></li><li></li><li></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-7-图片">1.7 图片</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 本地图片</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;/assets/pusheencode.webp&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;示例图片&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:50%;&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="section"># 在线图片</span></span><br><span class="line">![<span class="string">code</span>](<span class="link">https://cdn.jsdelivr.net/gh/fomalhaut1998/markdown_pic/img/code.png</span>)</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p>本地图片:<br><img src="/assets/pusheencode.webp" alt="示例图片" style="zoom:50%;" /><br>在线图片:<br><img src="https://cdn.jsdelivr.net/gh/fomalhaut1998/markdown_pic/img/code.png" alt="code"></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-8-表格">1.8 表格</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| 项目标号 | 资金     | 备注 |</span><br><span class="line">| -------- | -------- | ---- |</span><br><span class="line">| 1        | 100，000 | 无   |</span><br><span class="line">| 2        | 200，000 | 无   |</span><br><span class="line">| 3        | 300,600  | 重要 |</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><table><thead><tr><th>项目标号</th><th>资金</th><th>备注</th></tr></thead><tbody><tr><td>1</td><td>100，000</td><td>无</td></tr><tr><td>2</td><td>200，000</td><td>无</td></tr><tr><td>3</td><td>300,600</td><td>重要</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="1-9-公式">1.9 公式</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$$</span><br><span class="line">\Gamma(z)=\int<span class="emphasis">_0^\infty t^&#123;z-1&#125;e^&#123;-t&#125;dt.</span></span><br><span class="line"><span class="emphasis">$$</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p>$$<br>\Gamma(z)=\int_0^\infty t^{z-1}e^{-t}dt.<br>$$</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h1>2.Butterfly外挂标签</h1><div class="note info flat"><p>这部分参考安知鱼:<a href="https://anzhiy.cn/posts/7d58.html">基于Butterfly的外挂标签引入</a></p></div><h2 id="2-1-行内文本样式-text">2.1 行内文本样式 text</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% u 文本内容 %&#125;</span><br><span class="line">&#123;% emp 文本内容 %&#125;</span><br><span class="line">&#123;% wavy 文本内容 %&#125;</span><br><span class="line">&#123;% del 文本内容 %&#125;</span><br><span class="line">&#123;% kbd 文本内容 %&#125;</span><br><span class="line">&#123;% psw 文本内容 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">1.</span> 带 &#123;% u 下划线 %&#125; 的文本</span><br><span class="line"><span class="bullet">2.</span> 带 &#123;% emp 着重号 %&#125; 的文本</span><br><span class="line"><span class="bullet">3.</span> 带 &#123;% wavy 波浪线 %&#125; 的文本</span><br><span class="line"><span class="bullet">4.</span> 带 &#123;% del 删除线 %&#125; 的文本</span><br><span class="line"><span class="bullet">5.</span> 键盘样式的文本 &#123;% kbd command %&#125; + &#123;% kbd D %&#125;</span><br><span class="line"><span class="bullet">6.</span> 密码样式的文本：&#123;% psw 这里没有验证码 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><ol><li>带 <u>下划线</u> 的文本</li><li>带 <emp>着重号</emp> 的文本</li><li>带 <wavy>波浪线</wavy> 的文本</li><li>带 <del>删除线</del> 的文本</li><li>键盘样式的文本 <kbd>command</kbd> + <kbd>D</kbd></li><li>密码样式的文本：<psw>这里没有验证码</psw></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-2-行内文本-span">2.2 行内文本 span</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% span 样式参数(参数以空格划分), 文本内容 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>字体</code>: logo, code</li><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>大小</code>: small, h4, h3, h2, h1, large, huge, ultra</li><li><code>对齐方向</code>: left, center, right</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> 彩色文字</span><br><span class="line">在一段话中方便插入各种颜色的标签，包括：&#123;% span red, 红色 %&#125;、&#123;% span yellow, 黄色 %&#125;、&#123;% span green, 绿色 %&#125;、&#123;% span cyan, 青色 %&#125;、&#123;% span blue, 蓝色 %&#125;、&#123;% span gray, 灰色 %&#125;。</span><br><span class="line"><span class="bullet">-</span> 超大号文字</span><br><span class="line">文档「开始」页面中的标题部分就是超大号文字。</span><br><span class="line">&#123;% span center logo large, Volantis %&#125;</span><br><span class="line">&#123;% span center small, A Wonderful Theme for Hexo %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><ul><li>彩色文字<br>在一段话中方便插入各种颜色的标签，包括：<span class='p red'>红色</span>、<span class='p yellow'>黄色</span>、<span class='p green'>绿色</span>、<span class='p cyan'>青色</span>、<span class='p blue'>蓝色</span>、<span class='p gray'>灰色</span>。</li><li>超大号文字<br>文档「开始」页面中的标题部分就是超大号文字。<br><span class='p center logo large'>Volantis</span><br><span class='p center small'>A Wonderful Theme for Hexo</span></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-3-段落文本-p">2.3 段落文本 p</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% p 样式参数(参数以空格划分), 文本内容 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>字体</code>: logo, code</li><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>大小</code>: small, h4, h3, h2, h1, large, huge, ultra</li><li><code>对齐方向</code>: left, center, right</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> 彩色文字</span><br><span class="line">在一段话中方便插入各种颜色的标签，包括：&#123;% p red, 红色 %&#125;、&#123;% p yellow, 黄色 %&#125;、&#123;% p green, 绿色 %&#125;、&#123;% p cyan, 青色 %&#125;、&#123;% p blue, 蓝色 %&#125;、&#123;% p gray, 灰色 %&#125;。</span><br><span class="line"><span class="bullet">-</span> 超大号文字</span><br><span class="line">文档「开始」页面中的标题部分就是超大号文字。</span><br><span class="line">&#123;% p center logo large, Volantis %&#125;</span><br><span class="line">&#123;% p center small, A Wonderful Theme for Hexo %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><ul><li>彩色文字<br>在一段话中方便插入各种颜色的标签，包括：<p class='p red'>红色</p>、<p class='p yellow'>黄色</p>、<p class='p green'>绿色</p>、<p class='p cyan'>青色</p>、<p class='p blue'>蓝色</p>、<p class='p gray'>灰色</p>。</li><li>超大号文字<br>文档「开始」页面中的标题部分就是超大号文字。</li></ul><p class='p center logo large'>Volantis</p><p class='p center small'>A Wonderful Theme for Hexo</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-4-引用note">2.4 引用note</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">通用配置</button></li><li class="tab"><button type="button" data-href="#分栏-2">语法格式</button></li><li class="tab"><button type="button" data-href="#分栏-3">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-4">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-5">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">note:</span><br><span class="line">  # Note tag style values:</span><br><span class="line">  #  - simple    bs-callout old alert style. Default.</span><br><span class="line">  #  - modern    bs-callout new (v2-v3) alert style.</span><br><span class="line">  #  - flat      flat callout style with background, like on Mozilla or StackOverflow.</span><br><span class="line">  #  - disabled  disable all CSS styles import of note tag.</span><br><span class="line">  style: simple</span><br><span class="line">  icons: false</span><br><span class="line">  border<span class="emphasis">_radius: 3</span></span><br><span class="line"><span class="emphasis">  # Offset lighter of background in % for modern and flat styles (modern: -12 | 12; flat: -18 | 6).</span></span><br><span class="line"><span class="emphasis">  # Offset also applied to label tag variables. This option can work with disabled note tag.</span></span><br><span class="line"><span class="emphasis">  light_</span>bg<span class="emphasis">_offset: 0</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 自带icon</span></span><br><span class="line">&#123;% note [class] [no-icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br><span class="line"><span class="section"># 外部icon</span></span><br><span class="line">&#123;% note [color] [icon] [style] %&#125;</span><br><span class="line">Any content (support inline tags too.io).</span><br><span class="line">&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.自带icon</p><table><thead><tr><th>参数</th><th style="text-align:center">用法</th></tr></thead><tbody><tr><td>class</td><td style="text-align:center">【可选】标识，不同的标识有不同的配色 （ default / primary / success / info / warning / danger ）</td></tr><tr><td>no-icon</td><td style="text-align:center">【可选】不显示 icon</td></tr><tr><td>style</td><td style="text-align:center">【可选】可以覆盖配置中的 style （simple/modern/flat/disabled）</td></tr></tbody></table><p>2.外部icon</p><table><thead><tr><th>参数</th><th style="text-align:center">用法</th></tr></thead><tbody><tr><td>class</td><td style="text-align:center">【可选】标识，不同的标识有不同的配色 （ default / blue / pink / red / purple / orange / green ）</td></tr><tr><td>no-icon</td><td style="text-align:center">【可选】可配置自定义 icon (只支持 fontawesome 图标, 也可以配置 no-icon )</td></tr><tr><td>style</td><td style="text-align:center">【可选】可以覆盖配置中的 style （simple/modern/flat/disabled）</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><details class="folding-tag" blue><summary> 1.自带icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note simple %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default simple %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary simple %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success simple %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info simple %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning simple %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger simple %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>2.<code>modern</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note modern %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default modern %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary modern %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success modern %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info modern %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning modern %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger modern %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>3.<code>flat</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note flat %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default flat %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary flat %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success flat %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info flat %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning flat %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger flat %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>4.<code>disabled</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note disabled %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default disabled %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary disabled %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success disabled %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info disabled %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning disabled %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger disabled %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>5.<code>no-icon</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;默认 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note default no-icon %&#125;default 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note primary no-icon %&#125;primary 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note success no-icon %&#125;success 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note info no-icon %&#125;info 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note warning no-icon %&#125;warning 提示块标签&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note danger no-icon %&#125;danger 提示块标签&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><details class="folding-tag" blue><summary> 2.外部icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; simple %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; simple %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; simple %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; simple%&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; simple %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; simple %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; simple %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>2.<code>modern</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; modern %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; modern %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; modern%&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; modern %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; modern %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; modern %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>3.<code>flat</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; flat %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; flat %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; flat %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; flat%&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; flat %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; flat %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; flat %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>4.<code>disabled</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note &#x27;fab fa-cc-visa&#x27; disabled %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue &#x27;fas fa-bullhorn&#x27; disabled %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink &#x27;fas fa-car-crash&#x27; disabled %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red &#x27;fas fa-fan&#x27; disabled %&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange &#x27;fas fa-battery-half&#x27; disabled %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple &#x27;far fa-hand-scissors&#x27; disabled %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green &#x27;fab fa-internet-explorer&#x27; disabled %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure><p>5.<code>no-icon</code>样式</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% note no-icon %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note blue no-icon %&#125;2021年快到了....&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note pink no-icon %&#125;小心开车 安全至上&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note red no-icon %&#125;这是三片呢？还是四片？&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note orange no-icon %&#125;你是刷 Visa 还是 UnionPay&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note purple no-icon %&#125;剪刀石头布&#123;% endnote %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% note green no-icon %&#125;前端最讨厌的浏览器&#123;% endnote %&#125;</span><br></pre></td></tr></table></figure>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-5"><details class="folding-tag" blue><summary> 1.自带icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式</p><div class="note simple"><p>默认 提示块标签</p></div><div class="note default simple"><p>default 提示块标签</p></div><div class="note primary simple"><p>primary 提示块标签</p></div><div class="note success simple"><p>success 提示块标签</p></div><div class="note info simple"><p>info 提示块标签</p></div><div class="note warning simple"><p>warning 提示块标签</p></div><div class="note danger simple"><p>danger 提示块标签</p></div>2.`modern`样式<div class="note modern"><p>默认 提示块标签</p></div><div class="note default modern"><p>default 提示块标签</p></div><div class="note primary modern"><p>primary 提示块标签</p></div><div class="note success modern"><p>success 提示块标签</p></div><div class="note info modern"><p>info 提示块标签</p></div><div class="note warning modern"><p>warning 提示块标签</p></div><div class="note danger modern"><p>danger 提示块标签</p></div><p>3.<code>flat</code>样式</p><div class="note flat"><p>默认 提示块标签</p></div><div class="note default flat"><p>default 提示块标签</p></div><div class="note primary flat"><p>primary 提示块标签</p></div><div class="note success flat"><p>success 提示块标签</p></div><div class="note info flat"><p>info 提示块标签</p></div><div class="note warning flat"><p>warning 提示块标签</p></div><div class="note danger flat"><p>danger 提示块标签</p></div><p>4.<code>disabled</code>样式</p><div class="note disabled"><p>默认 提示块标签</p></div><div class="note default disabled"><p>default 提示块标签</p></div><div class="note primary disabled"><p>primary 提示块标签</p></div><div class="note success disabled"><p>success 提示块标签</p></div><div class="note info disabled"><p>info 提示块标签</p></div><div class="note warning disabled"><p>warning 提示块标签</p></div><div class="note danger disabled"><p>danger 提示块标签</p></div><p>5.<code>no-icon</code>样式</p><div class="note no-icon flat"><p>默认 提示块标签</p></div><div class="note default no-icon flat"><p>default 提示块标签</p></div><div class="note primary no-icon flat"><p>primary 提示块标签</p></div><div class="note success no-icon flat"><p>success 提示块标签</p></div><div class="note info no-icon flat"><p>info 提示块标签</p></div><div class="note warning no-icon flat"><p>warning 提示块标签</p></div><div class="note danger no-icon flat"><p>danger 提示块标签</p></div>              </div>            </details><details class="folding-tag" blue><summary> 2.外部icon </summary>              <div class='content'>              <p>1.<code>simple</code>样式</p><div class="note icon-padding simple"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding simple"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了…</p></div><div class="note pink icon-padding simple"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding simple"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding simple"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding simple"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding simple"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>2.<code>modern</code>样式</p><div class="note icon-padding modern"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了…</p></div><div class="note pink icon-padding modern"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding modern"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding modern"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding modern"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>3.<code>flat</code>样式</p><div class="note icon-padding flat"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding flat"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了…</p></div><div class="note pink icon-padding flat"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding flat"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding flat"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding flat"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding flat"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>4.<code>disabled</code>样式</p><div class="note icon-padding disabled"><i class="note-icon fab fa-cc-visa"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue icon-padding disabled"><i class="note-icon fas fa-bullhorn"></i><p>2021年快到了…</p></div><div class="note pink icon-padding disabled"><i class="note-icon fas fa-car-crash"></i><p>小心开车 安全至上</p></div><div class="note red icon-padding disabled"><i class="note-icon fas fa-fan"></i><p>这是三片呢？还是四片？</p></div><div class="note orange icon-padding disabled"><i class="note-icon fas fa-battery-half"></i><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple icon-padding disabled"><i class="note-icon far fa-hand-scissors"></i><p>剪刀石头布</p></div><div class="note green icon-padding disabled"><i class="note-icon fab fa-internet-explorer"></i><p>前端最讨厌的浏览器</p></div><p>5.<code>no-icon</code>样式</p><div class="note no-icon flat"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note blue no-icon flat"><p>2021年快到了…</p></div><div class="note pink no-icon flat"><p>小心开车 安全至上</p></div><div class="note red no-icon flat"><p>这是三片呢？还是四片？</p></div><div class="note orange no-icon flat"><p>你是刷 Visa 还是 UnionPay</p></div><div class="note purple no-icon flat"><p>剪刀石头布</p></div><div class="note green no-icon flat"><p>前端最讨厌的浏览器</p></div>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-5-上标标签-tip">2.5 上标标签 tip</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip [参数，可选] %&#125;文本内容&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>样式</code>: success,error,warning,bolt,ban,home,sync,cogs,key,bell</li><li><code>自定义图标</code>: 支持fontawesome。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip %&#125;default&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip info %&#125;info&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip success %&#125;success&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip error %&#125;error&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip warning %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bolt %&#125;bolt&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban %&#125;ban&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip home %&#125;home&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip sync %&#125;sync&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip cogs %&#125;cogs&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip key %&#125;key&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip bell %&#125;bell&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip fa-atom %&#125;自定义font awesome图标&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class="tip "><p>default</p></div><div class="tip info"><p>info</p></div><div class="tip success"><p>success</p></div><div class="tip error"><p>error</p></div><div class="tip warning"><p>warning</p></div><div class="tip bolt"><p>bolt</p></div><div class="tip ban"><p>ban</p></div><div class="tip home"><p>home</p></div><div class="tip sync"><p>sync</p></div><div class="tip cogs"><p>cogs</p></div><div class="tip key"><p>key</p></div><div class="tip bell"><p>bell</p></div><div class="tip fa-atom"><p>自定义font awesome图标</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-6-动态标签-anima">2.6 动态标签 anima</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip [参数，可选] %&#125;文本内容&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><div class="note info flat"><ol><li>将所需的CSS类添加到图标（或DOM中的任何元素）。</li><li>对于父级悬停样式，需要给目标元素添加指定CSS类，同时还要给目标元素的父级元素添加CSS类<code>faa-parent animated-hover</code>。（详情见示例及示例源码）<br>You can regulate the speed of the animation by adding the CSS class or . faa-fastfaa-slow</li><li>可以通过给目标元素添加CSS类<code>faa-fast</code>或<code>faa-slow</code>来控制动画快慢。</li></ol></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.On DOM load（当页面加载时显示动画）</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>2.调整动画速度</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated faa-fast %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated faa-slow %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>3.On hover（当鼠标悬停时显示动画）</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-horizontal animated-hover %&#125;warning&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-flash animated-hover %&#125;ban&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><p>4.On parent hover（当鼠标悬停在父级元素时显示动画）</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tip warning faa-parent animated-hover %&#125;<span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;faa-horizontal&quot;</span>&gt;</span></span>warning<span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>&#123;% endtip %&#125;</span><br><span class="line">&#123;% tip ban faa-parent animated-hover %&#125;<span class="language-xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;faa-flash&quot;</span>&gt;</span></span>ban<span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>&#123;% endtip %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.On DOM load（当页面加载时显示动画）</p><div class="tip warning faa-horizontal animated"><p>warning</p></div><div class="tip ban faa-flash animated"><p>ban</p></div>2.调整动画速度<div class="tip warning faa-horizontal animated faa-fast"><p>warning</p></div><div class="tip ban faa-flash animated faa-slow"><p>ban</p></div>3.On hover（当鼠标悬停时显示动画）<div class="tip warning faa-horizontal animated-hover"><p>warning</p></div><div class="tip ban faa-flash animated-hover"><p>ban</p></div>4.On parent hover（当鼠标悬停在父级元素时显示动画）<div class="tip warning faa-parent animated-hover"><p class="faa-horizontal">warning</p></div><div class="tip ban faa-parent animated-hover"><p class="faa-flash">ban</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-7-复选列表-checkbox">2.7 复选列表 checkbox</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% checkbox 样式参数（可选）, 文本（支持简单md） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>样式</code>: plus, minus, times</li><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>选中状态</code>: checked</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% checkbox 纯文本测试 %&#125;</span><br><span class="line">&#123;% checkbox checked, 支持简单的 [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) 语法 %&#125;</span><br><span class="line">&#123;% checkbox red, 支持自定义颜色 %&#125;</span><br><span class="line">&#123;% checkbox green checked, 绿色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox yellow checked, 黄色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox cyan checked, 青色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox blue checked, 蓝色 + 默认选中 %&#125;</span><br><span class="line">&#123;% checkbox plus green checked, 增加 %&#125;</span><br><span class="line">&#123;% checkbox minus yellow checked, 减少 %&#125;</span><br><span class="line">&#123;% checkbox times red checked, 叉 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class='checkbox'><input type="checkbox" />            <p>纯文本测试</p>            </div><div class='checkbox checked'><input type="checkbox" checked="checked"/>            <p>支持简单的 <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> 语法</p>            </div><div class='checkbox red'><input type="checkbox" />            <p>支持自定义颜色</p>            </div><div class='checkbox green checked'><input type="checkbox" checked="checked"/>            <p>绿色 + 默认选中</p>            </div><div class='checkbox yellow checked'><input type="checkbox" checked="checked"/>            <p>黄色 + 默认选中</p>            </div><div class='checkbox cyan checked'><input type="checkbox" checked="checked"/>            <p>青色 + 默认选中</p>            </div><div class='checkbox blue checked'><input type="checkbox" checked="checked"/>            <p>蓝色 + 默认选中</p>            </div><div class='checkbox plus green checked'><input type="checkbox" checked="checked"/>            <p>增加</p>            </div><div class='checkbox minus yellow checked'><input type="checkbox" checked="checked"/>            <p>减少</p>            </div><div class='checkbox times red checked'><input type="checkbox" checked="checked"/>            <p>叉</p>            </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-8-单选列表-radio">2.8 单选列表 radio</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% radio 样式参数（可选）, 文本（支持简单md） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>颜色</code>: red,yellow,green,cyan,blue,gray</li><li><code>选中状态</code>: checked</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% radio 纯文本测试 %&#125;</span><br><span class="line">&#123;% radio checked, 支持简单的 [<span class="string">markdown</span>](<span class="link">https://guides.github.com/features/mastering-markdown/</span>) 语法 %&#125;</span><br><span class="line">&#123;% radio red, 支持自定义颜色 %&#125;</span><br><span class="line">&#123;% radio green, 绿色 %&#125;</span><br><span class="line">&#123;% radio yellow, 黄色 %&#125;</span><br><span class="line">&#123;% radio cyan, 青色 %&#125;</span><br><span class="line">&#123;% radio blue, 蓝色 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class='checkbox'><input type="radio" />            <p>纯文本测试</p>            </div><div class='checkbox checked'><input type="radio" checked="checked"/>            <p>支持简单的 <a href="https://guides.github.com/features/mastering-markdown/">markdown</a> 语法</p>            </div><div class='checkbox red'><input type="radio" />            <p>支持自定义颜色</p>            </div><div class='checkbox green'><input type="radio" />            <p>绿色</p>            </div><div class='checkbox yellow'><input type="radio" />            <p>黄色</p>            </div><div class='checkbox cyan'><input type="radio" />            <p>青色</p>            </div><div class='checkbox blue'><input type="radio" />            <p>蓝色</p>            </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-9-时间轴-timeline">2.9 时间轴 timeline</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 时间线标题（可选）[,color] %&#125;</span><br><span class="line">&lt;!-- timeline 时间节点（标题） --&gt;</span><br><span class="line">正文内容</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&lt;!-- timeline 时间节点（标题） --&gt;</span><br><span class="line">正文内容</span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>title</code>:标题/时间线</li><li><code>color</code>:<code>timeline</code>颜色:default(留空) / blue / pink / red / purple / orange / green</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% timeline 时间轴样式,blue %&#125;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-07-24 [<span class="string">2.6.6 -&gt; 3.0</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases</span>) --&gt;</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> 如果有 <span class="code">`hexo-lazyload-image`</span> 插件，需要删除并重新安装最新版本，设置 <span class="code">`lazyload.isSPA: true`</span>。</span><br><span class="line"><span class="bullet">2.</span> 2.x 版本的 css 和 js 不适用于 3.x 版本，如果使用了 <span class="code">`use_cdn: true`</span> 则需要删除。</span><br><span class="line"><span class="bullet">3.</span> 2.x 版本的 fancybox 标签在 3.x 版本中被重命名为 gallery 。</span><br><span class="line"><span class="bullet">4.</span> 2.x 版本的置顶 <span class="code">`top: true`</span> 改为了 <span class="code">`pin: true`</span>，并且同样适用于 <span class="code">`layout: page`</span> 的页面。</span><br><span class="line"><span class="bullet">5.</span> 如果使用了 <span class="code">`hexo-offline`</span> 插件，建议卸载，3.0 版本默认开启了 pjax 服务。</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-05-15 [<span class="string">2.6.3 -&gt; 2.6.6</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6</span>) --&gt;</span><br><span class="line"></span><br><span class="line">不需要额外处理。</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- timeline 2020-04-20 [<span class="string">2.6.2 -&gt; 2.6.3</span>](<span class="link">https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3</span>) --&gt;</span><br><span class="line"></span><br><span class="line"><span class="bullet">1.</span> 全局搜索 <span class="code">`seotitle`</span> 并替换为 <span class="code">`seo_title`</span>。</span><br><span class="line"><span class="bullet">2.</span> group 组件的索引规则有变，使用 group 组件的文章内，<span class="code">`group: group_name`</span> 对应的组件名必须是 <span class="code">`group_name`</span>。</span><br><span class="line"><span class="bullet">2.</span> group 组件的列表名优先显示文章的 <span class="code">`short_title`</span> 其次是 <span class="code">`title`</span>。</span><br><span class="line"></span><br><span class="line">&lt;!-- endtimeline --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endtimeline %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class="timeline blue"><div class='timeline-item headline'><div class='timeline-item-title'><div class='item-circle'><p>时间轴样式</p></div></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-07-24 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases">2.6.6 -&gt; 3.0</a></p></div></div><div class='timeline-item-content'><ol><li>如果有 <code>hexo-lazyload-image</code> 插件，需要删除并重新安装最新版本，设置 <code>lazyload.isSPA: true</code>。</li><li>2.x 版本的 css 和 js 不适用于 3.x 版本，如果使用了 <code>use_cdn: true</code> 则需要删除。</li><li>2.x 版本的 fancybox 标签在 3.x 版本中被重命名为 gallery 。</li><li>2.x 版本的置顶 <code>top: true</code> 改为了 <code>pin: true</code>，并且同样适用于 <code>layout: page</code> 的页面。</li><li>如果使用了 <code>hexo-offline</code> 插件，建议卸载，3.0 版本默认开启了 pjax 服务。</li></ol></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-05-15 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.6">2.6.3 -&gt; 2.6.6</a></p></div></div><div class='timeline-item-content'><p>不需要额外处理。</p></div></div><div class='timeline-item'><div class='timeline-item-title'><div class='item-circle'><p>2020-04-20 <a href="https://github.com/volantis-x/hexo-theme-volantis/releases/tag/2.6.3">2.6.2 -&gt; 2.6.3</a></p></div></div><div class='timeline-item-content'><ol><li>全局搜索 <code>seotitle</code> 并替换为 <code>seo_title</code>。</li><li>group 组件的索引规则有变，使用 group 组件的文章内，<code>group: group_name</code> 对应的组件名必须是 <code>group_name</code>。</li><li>group 组件的列表名优先显示文章的 <code>short_title</code> 其次是 <code>title</code>。</li></ol></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-10-链接卡片-link">2.10 链接卡片 link</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% link 标题, 链接, 图片链接（可选） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% link 糖果屋教程贴, https://akilar.top/posts/615e2dec/, https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><div class="tag link"><a class="link-card" title="糖果屋教程贴" href="https://akilar.top/posts/615e2dec/"><div class="left"><img src="https://cdn.cbd.int/akilar-candyassets@1.0.36/image/siteicon/favicon.ico"/></div><div class="right"><p class="text">糖果屋教程贴</p><p class="url">https://akilar.top/posts/615e2dec/</p></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-11-按钮-btns">2.11 按钮 btns</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns 样式参数 %&#125;</span><br><span class="line">&#123;% cell 标题, 链接, 图片或者图标 %&#125;</span><br><span class="line">&#123;% cell 标题, 链接, 图片或者图标 %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li>圆角样式：rounded, circle</li><li>增加文字样式：可以在容器内增加 <code>&lt;b&gt;</code>标题<code>&lt;/b&gt;</code>和<code>&lt;p&gt;</code>描述文字<code>&lt;/p&gt;</code></li><li>布局方式：<br>默认为自动宽度，适合视野内只有一两个的情况。</li></ol><table><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>wide</td><td>宽一点的按钮</td></tr><tr><td>fill</td><td>填充布局，自动铺满至少一行，多了会换行</td></tr><tr><td>center</td><td>居中，按钮之间是固定间距</td></tr><tr><td>around</td><td>居中分散</td></tr><tr><td>grid2</td><td>等宽最多2列，屏幕变窄会适当减少列数</td></tr><tr><td>grid3</td><td>等宽最多3列，屏幕变窄会适当减少列数</td></tr><tr><td>grid4</td><td>等宽最多4列，屏幕变窄会适当减少列数</td></tr><tr><td>grid5</td><td>等宽最多5列，屏幕变窄会适当减少列数</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.如果需要显示类似「团队成员」之类的一组含有头像的链接</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns circle grid5 %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% cell xaoxuu, https://xaoxuu.com, https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><p>2.或者含有图标的按钮</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns rounded grid5 %&#125;</span><br><span class="line">&#123;% cell 下载源码, /, fas fa-download %&#125;</span><br><span class="line">&#123;% cell 查看文档, /, fas fa-book-open %&#125;</span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><p>3.圆形图标 + 标题 + 描述 + 图片 + 网格5列 + 居中</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;% btns circle center grid5 %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1&#x27;</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&#x27;fab fa-apple&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>心率管家<span class="language-xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">  &#123;% p red, 专业版 %&#125;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_pro.png&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1&#x27;</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&#x27;fab fa-apple&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">b</span>&gt;</span></span>心率管家<span class="language-xml"><span class="tag">&lt;/<span class="name">b</span>&gt;</span></span></span><br><span class="line">  &#123;% p green, 免费版 %&#125;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_lite.png&#x27;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line">&#123;% endbtns %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.如果需要显示类似「团队成员」之类的一组含有头像的链接</p><div class="btns circle grid5">            <a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a><a class="button" href='https://xaoxuu.com' title='xaoxuu'><img src='https://cdn.jsdelivr.net/gh/xaoxuu/cdn-assets/avatar/avatar.png'>xaoxuu</a>          </div>2.或者含有图标的按钮<div class="btns rounded grid5">            <a class="button" href='/' title='下载源码'><i class='fas fa-download'></i>下载源码</a><a class="button" href='/' title='查看文档'><i class='fas fa-book-open'></i>查看文档</a>          </div>3.圆形图标 + 标题 + 描述 + 图片 + 网格5列 + 居中<div class="btns circle center grid5">            <a href='https://apps.apple.com/cn/app/heart-mate-pro-hrm-utility/id1463348922?ls=1'>  <i class='fab fa-apple'></i>  <b>心率管家</b>  <p class='p red'>专业版</p>  <img src='https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_pro.png'></a><a href='https://apps.apple.com/cn/app/heart-mate-lite-hrm-utility/id1475747930?ls=1'>  <i class='fab fa-apple'></i>  <b>心率管家</b>  <p class='p green'>免费版</p>  <img src='https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/qrcode/heartmate_lite.png'></a>          </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-12-github卡片-ghcard">2.12 github卡片 ghcard</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% ghcard 用户名, 其它参数（可选） %&#125;</span><br><span class="line">&#123;% ghcard 用户名/仓库, 其它参数（可选） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><p>使用<code>,</code>分割各个参数。写法为：<code>参数名=参数值</code><br>以下只写几个常用参数值。</p><table><thead><tr><th><strong>参数名</strong></th><th>取值</th><th>释义</th></tr></thead><tbody><tr><td>hide</td><td>stars,commits,prs,issues,contribs</td><td>隐藏指定统计</td></tr><tr><td>count_private</td><td>true</td><td>将私人项目贡献添加到总提交计数中</td></tr><tr><td>show_icons</td><td>true</td><td>显示图标</td></tr><tr><td>theme</td><td>查阅:<a href="https://github.com/anuraghazra/github-readme-stats/blob/master/themes/README.md">Available Themes</a></td><td>主题</td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.用户信息卡片</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| &#123;% ghcard fomalhaut1998 %&#125; | &#123;% ghcard fomalhaut1998, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=buefy %&#125; | &#123;% ghcard fomalhaut1998, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=onedark %&#125; | &#123;% ghcard fomalhaut1998, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard fomalhaut1998, theme=algolia %&#125; | &#123;% ghcard fomalhaut1998, theme=calm %&#125; |</span><br></pre></td></tr></table></figure><p>2.仓库信息卡片</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=vue %&#125; |</span><br><span class="line">| -- | -- |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=buefy %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-light %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=onedark %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=solarized-dark %&#125; |</span><br><span class="line">| &#123;% ghcard volantis-x/hexo-theme-volantis, theme=algolia %&#125; | &#123;% ghcard volantis-x/hexo-theme-volantis, theme=calm %&#125; |</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.用户信息卡片</p><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/fomalhaut1998"><img src="https://github-readme-stats.vercel.app/api/?username=fomalhaut1998&theme=calm&show_owner=true"/></a></td></tr></tbody></table><p>2.仓库信息卡片</p><table><thead><tr><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&show_owner=true"/></a></th><th><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=vue&show_owner=true"/></a></th></tr></thead><tbody><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=buefy&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-light&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=onedark&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=solarized-dark&show_owner=true"/></a></td></tr><tr><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=algolia&show_owner=true"/></a></td><td><a class="ghcard" rel="external nofollow noopener noreferrer" href="https://github.com/volantis-x/hexo-theme-volantis"><img src="https://github-readme-stats.vercel.app/api/pin/?username=volantis-x&repo=hexo-theme-volantis&theme=calm&show_owner=true"/></a></td></tr></tbody></table><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-13-github徽标-ghbdage">2.13 github徽标 ghbdage</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage [right],[left],[logo]||[color],[link],[title]||[option] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>left</code>：徽标左边的信息，必选参数。</li><li><code>right</code>: 徽标右边的信息，必选参数，</li><li><code>logo</code>：徽标图标，图标名称详见<a href="https://simpleicons.org/">simpleicons</a>，可选参数。</li><li><code>color</code>：徽标右边的颜色，可选参数。</li><li><code>link</code>：指向的链接，可选参数。</li><li><code>title</code>：徽标的额外信息，可选参数。主要用于优化SEO，但<code>object</code>标签不会像<code>a</code>标签一样在鼠标悬停显示<code>title</code>信息。</li><li><code>option</code>：自定义参数，支持<a href="https://shields.io/">shields.io</a>的全部API参数支持，具体参数可以参看上文中的拓展写法示例。形式为<code>name1=value2&amp;name2=value2</code>。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.基本参数,定义徽标左右文字和图标</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage Theme,Butterfly %&#125;</span><br><span class="line">&#123;% bdage Frame,Hexo,hexo %&#125;</span><br></pre></td></tr></table></figure><p>2.信息参数，定义徽标右侧内容背景色，指向链接</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage CDN,JsDelivr,jsDelivr||abcdef,https://metroui.org.ua/index.html,本站使用JsDelivr为静态资源提供CDN加速 %&#125;</span><br><span class="line">//如果是跨顺序省略可选参数，仍然需要写个逗号,用作分割</span><br><span class="line">&#123;% bdage Source,GitHub,GitHub||,https://github.com/ %&#125;</span><br></pre></td></tr></table></figure><p>3.拓展参数，支持shields的API的全部参数内容</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bdage Hosted,Vercel,Vercel||brightgreen,https://vercel.com/,本站采用双线部署，默认线路托管于Vercel||style=social&amp;logoWidth=20 %&#125;</span><br><span class="line">//如果是跨顺序省略可选参数组，仍然需要写双竖线||用作分割</span><br><span class="line">&#123;% bdage Hosted,Vercel,Vercel||||style=social&amp;logoWidth=20&amp;logoColor=violet %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.基本参数,定义徽标左右文字和图标</p><p><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Butterfly-Theme-orange?logo=&color=orange&link=&"></object><br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Hexo-Frame-orange?logo=hexo&color=orange&link=&"></object></p><p>2.信息参数，定义徽标右侧内容背景色，指向链接</p><p><object class="ghbdage" style="margin-inline:5px" title="本站使用JsDelivr为静态资源提供CDN加速" standby="loading..." data="https://img.shields.io/badge/JsDelivr-CDN-orange?logo=jsDelivr&color=abcdef&link=https://metroui.org.ua/index.html&"></object><br>//如果是跨顺序省略可选参数，仍然需要写个逗号,用作分割<br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/GitHub-Source-orange?logo=GitHub&color=orange&link=https://github.com/&"></object></p><p>3.拓展参数，支持shields的API的全部参数内容</p><p><object class="ghbdage" style="margin-inline:5px" title="本站采用双线部署，默认线路托管于Vercel" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=brightgreen&link=https://vercel.com/&style=social&logoWidth=20"></object><br>//如果是跨顺序省略可选参数组，仍然需要写双竖线||用作分割<br><object class="ghbdage" style="margin-inline:5px" title="" standby="loading..." data="https://img.shields.io/badge/Vercel-Hosted-orange?logo=Vercel&color=orange&link=&style=social&logoWidth=20&logoColor=violet"></object></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-14-网站卡片-sites">2.14 网站卡片 sites</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% sitegroup %&#125;</span><br><span class="line">&#123;% site 标题, url=链接, screenshot=截图链接, avatar=头像链接（可选）, description=描述（可选） %&#125;</span><br><span class="line">&#123;% site 标题, url=链接, screenshot=截图链接, avatar=头像链接（可选）, description=描述（可选） %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;% sitegroup %&#125;</span><br><span class="line">&#123;% site xaoxuu, url=https://xaoxuu.com, screenshot=https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg, avatar=https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/avatar/avatar.png, description=简约风格 %&#125;</span><br><span class="line">&#123;% site inkss, url=https://inkss.cn, screenshot=https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg, avatar=https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% site MHuiG, url=https://blog.mhuig.top, screenshot=https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png, avatar=https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% site Colsrch, url=https://colsrch.top, screenshot=https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png, avatar=https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% site Linhk1606, url=https://linhk1606.github.io, screenshot=https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png, avatar=https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png, description=这是一段关于这个网站的描述文字 %&#125;</span><br><span class="line">&#123;% endsitegroup %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><div class="site-card-group"><a class="site-card" href="https://fomalhaut1998.com"><div class="img"><img src="https://i.loli.net/2020/08/21/VuSwWZ1xAeUHEBC.jpg"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/fomalhaut1998/cdn-assets/avatar/avatar.png"/><span class="title">fomalhaut1998</span><span class="desc">简约风格</span></div></a><a class="site-card" href="https://inkss.cn"><div class="img"><img src="https://i.loli.net/2020/08/21/Vzbu3i8fXs6Nh5Y.jpg"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/inkss/common@master/static/web/avatar.jpg"/><span class="title">inkss</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a><a class="site-card" href="https://blog.mhuig.top"><div class="img"><img src="https://i.loli.net/2020/08/22/d24zpPlhLYWX6D1.png"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/MHuiG/imgbed@master/data/p.png"/><span class="title">MHuiG</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a><a class="site-card" href="https://colsrch.top"><div class="img"><img src="https://i.loli.net/2020/08/22/dFRWXm52OVu8qfK.png"/></div><div class="info"><img src="https://cdn.jsdelivr.net/gh/Colsrch/images/Colsrch/avatar.jpg"/><span class="title">Colsrch</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a><a class="site-card" href="https://linhk1606.github.io"><div class="img"><img src="https://i.loli.net/2020/08/21/3PmGLCKicnfow1x.png"/></div><div class="info"><img src="https://i.loli.net/2020/02/09/PN7I5RJfFtA93r2.png"/><span class="title">Linhk1606</span><span class="desc">这是一段关于这个网站的描述文字</span></div></a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-15-行内图片-inlineimage">2.15 行内图片 inlineimage</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% inlineimage 图片链接, height=高度（可选） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>高度</code>：height=20px</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">这是 &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif %&#125; 一段话。</span><br><span class="line"></span><br><span class="line">这又是 &#123;% inlineimage https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif, height=40px %&#125; 一段话。</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>这是 <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/0000.gif" style="height:1.5em"/> 一段话。</p><p>这又是 <img no-lazy class="inline" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/aru-l/5150.gif" style="height:40px;"/> 一段话。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-16-单张图片-image">2.16 单张图片 image</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image 链接, width=宽度（可选）, height=高度（可选）, alt=描述（可选）, bg=占位颜色（可选） %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li>图片宽度高度：width=300px, height=32px</li><li>图片描述：alt=图片描述（butterfly需要在主题配置文件中开启图片描述）</li><li>占位背景色：bg=#f2f2f2</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.添加描述：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, alt=每天下课回宿舍的路，没有什么故事。 %&#125;</span><br></pre></td></tr></table></figure><p>2.指定宽度</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px %&#125;</span><br></pre></td></tr></table></figure><p>3.指定宽度并添加描述：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, alt=每天下课回宿舍的路，没有什么故事。 %&#125;</span><br></pre></td></tr></table></figure><p>4.设置占位背景色：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% image https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg, width=400px, bg=#1D0C04, alt=优化不同宽度浏览的观感 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.添加描述：</p><div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="每天下课回宿舍的路，没有什么故事。"/></div><span class="image-caption">每天下课回宿舍的路，没有什么故事。</span></div>2..指定宽度<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" style="width:400px;"/></div></div>3.指定宽度并添加描述：<div class="img-wrap"><div class="img-bg"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="每天下课回宿舍的路，没有什么故事。" style="width:400px;"/></div><span class="image-caption">每天下课回宿舍的路，没有什么故事。</span></div>4.设置占位背景色：<div class="img-wrap"><div class="img-bg" style="background:#1D0C04"><img class="img" src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper-minimalist/2020/025.jpg" alt="优化不同宽度浏览的观感" style="width:400px;"/></div><span class="image-caption">优化不同宽度浏览的观感</span></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-17-音频-audio">2.17 音频 audio</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% audio 音频链接 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% audio https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><div class="audio"><audio controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/Lumia1020.mp3' type='audio/mp3'>Your browser does not support the audio tag.</audio></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-18-视频-video">2.18 视频 video</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% video 视频链接 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>对齐方向</code>：left, center, right</li><li><code>列数</code>：逗号后面直接写列数，支持 1 ～ 4 列。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.100%宽度</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br></pre></td></tr></table></figure><p>2.50%宽度</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% videos, 2 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br></pre></td></tr></table></figure><p>3.25%宽度</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% videos, 4 %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG<span class="emphasis">_0341.mov %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% video https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_</span>0341.mov %&#125;</span><br><span class="line">&#123;% endvideos %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.100%宽度</p><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div>2.50%宽度<div class="videos" col='2'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div>3.25%宽度<div class="videos" col='4'><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div><div class="video"><video controls preload><source src='https://github.com/volantis-x/volantis-docs/releases/download/assets/IMG_0341.mov' type='video/mp4'>Your browser does not support the video tag.</video></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-19-相册-gallery">2.19 相册 gallery</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>1.gallerygroup 相册图库</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line">&#123;% galleryGroup name description link img-url %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>2.gallery 相册</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">markdown 圖片格式</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ul><li>gallerygroup 相册图库</li></ul><table><thead><tr><th>参数名</th><th>释义</th></tr></thead><tbody><tr><td>name</td><td>图库名字</td></tr><tr><td>description</td><td>图库描述</td></tr><tr><td>link</td><td>链接到对应相册的地址</td></tr><tr><td>img-url</td><td>图库封面</td></tr></tbody></table><ul><li><p>gallery 相册</p><p>区别于旧版的Gallery相册,新的Gallery相册会自动根据图片长度进行排版，书写也更加方便，与markdown格式一样。可根据需要插入到相应的md。无需再自己配置长宽。<strong>建议在粘贴时故意使用长短、大小、横竖不一的图片</strong>，会有更好的效果。（尺寸完全相同的图片只会平铺输出，效果很糟糕）</p></li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.gallerygroup 相册图库</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;gallery-group-main&quot;</span>&gt;</span></span></span><br><span class="line">&#123;% galleryGroup MC 在Rikkaの六花服务器里留下的足迹 &#x27;/gallery/MC/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/1.jpg %&#125;</span><br><span class="line">&#123;% galleryGroup Gundam 哦咧哇gundam哒！ &#x27;/gallery/Gundam/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907110508327.png %&#125;</span><br><span class="line">&#123;% galleryGroup I-am-Akilar 某种意义上也算自拍吧 &#x27;/gallery/I-am-Akilar/&#x27; https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907113116651.png %&#125;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>2.gallery 相册</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% gallery %&#125;</span><br><span class="line">![](<span class="link">https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg</span>)</span><br><span class="line">![](<span class="link">https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg</span>)</span><br><span class="line">&#123;% endgallery %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.gallerygroup 相册图库</p><div class="gallery-group-main">  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/1.jpg' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">MC</div>  <p>在Rikkaの六花服务器里留下的足迹</p>  <a href='/gallery/MC/'></a>  </figcaption>  </figure>  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907110508327.png' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">Gundam</div>  <p>哦咧哇gundam哒！</p>  <a href='/gallery/Gundam/'></a>  </figcaption>  </figure>  <figure class="gallery-group">  <img class="gallery-group-img no-lightbox" src='https://cdn.cbd.int/akilar-candyassets@1.0.36/image/20200907113116651.png' alt="Group Image Gallery">  <figcaption>  <div class="gallery-group-name">I-am-Akilar</div>  <p>某种意义上也算自拍吧</p>  <a href='/gallery/I-am-Akilar/'></a>  </figcaption>  </figure></div>2.gallery 相册<div class="fj-gallery"><p><img src="https://i.loli.net/2019/12/25/Fze9jchtnyJXMHN.jpg" alt=""><br><img src="https://i.loli.net/2019/12/25/ryLVePaqkYm4TEK.jpg" alt=""></p>          </div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-20-折叠框-folding">2.20 折叠框 folding</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><p>1.gallerygroup 相册图库</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% folding 参数（可选）, 标题 %&#125;</span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg</span>)</span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><!-- tab 参数配置 --><ol><li><p><code>颜色</code>：blue, cyan, green, yellow, red</p></li><li><p><code>状态</code>：状态填写 open 代表默认打开。</p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&#123;% folding 查看图片测试 %&#125;</span><br><span class="line"></span><br><span class="line">![](<span class="link">https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg</span>)</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding cyan open, 查看默认打开的折叠框 %&#125;</span><br><span class="line"></span><br><span class="line">这是一个默认打开的折叠框。</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding green, 查看代码测试 %&#125;</span><br><span class="line">假装这里有代码块（代码块没法嵌套代码块）</span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding yellow, 查看列表测试 %&#125;</span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> haha</span><br><span class="line"><span class="bullet">-</span> hehe</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding red, 查看嵌套测试 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding blue, 查看嵌套测试2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% folding 查看嵌套测试3 %&#125;</span><br><span class="line"></span><br><span class="line">hahaha <span class="language-xml"><span class="tag">&lt;<span class="name">span</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png&#x27;</span> <span class="attr">style</span>=<span class="string">&#x27;height:24px&#x27;</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% endfolding %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><details class="folding-tag" ><summary> 查看图片测试 </summary>              <div class='content'>              <p><img src="https://cdn.jsdelivr.net/gh/volantis-x/cdn-wallpaper/abstract/41F215B9-261F-48B4-80B5-4E86E165259E.jpeg" alt=""></p>              </div>            </details><details class="folding-tag" cyan open><summary> 查看默认打开的折叠框 </summary>              <div class='content'>              <p>这是一个默认打开的折叠框。</p>              </div>            </details><details class="folding-tag" green><summary> 查看代码测试 </summary>              <div class='content'>              <p>假装这里有代码块（代码块没法嵌套代码块）</p>              </div>            </details><details class="folding-tag" yellow><summary> 查看列表测试 </summary>              <div class='content'>              <ul><li>haha</li><li>hehe</li></ul>              </div>            </details><details class="folding-tag" red><summary> 查看嵌套测试 </summary>              <div class='content'>              <details class="folding-tag" blue><summary> 查看嵌套测试2 </summary>              <div class='content'>              <details class="folding-tag" ><summary> 查看嵌套测试3 </summary>              <div class='content'>              <p>hahaha <span><img src='https://cdn.jsdelivr.net/gh/volantis-x/cdn-emoji/tieba/%E6%BB%91%E7%A8%BD.png' style='height:24px'></span></p>              </div>            </details>              </div>            </details>              </div>            </details><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-21-分栏-tab">2.21 分栏 tab</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">配置参数</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs Unique name, [index] %&#125;</span><br><span class="line">&lt;!-- tab [Tab caption] [@icon] --&gt;</span><br><span class="line">Any content (support inline tags too).</span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><p>Unique name :</p><ul><li><p>选项卡块标签的唯一名称，不带逗号。</p></li><li><p>将在#id中用作每个标签及其索引号的前缀。</p></li><li><p>如果名称中包含空格，则对于生成#id，所有空格将由破折号代替。</p></li><li><p>仅当前帖子/页面的URL必须是唯一的！</p></li></ul></li><li><p>[index]:</p><ul><li><p>活动选项卡的索引号。</p></li><li><p>如果未指定，将选择第一个标签（1）。</p></li><li><p>如果index为-1，则不会选择任何选项卡。</p></li><li><p>可选参数。</p></li></ul></li><li><p>[Tab caption]:</p><ul><li><p>当前选项卡的标题。</p></li><li><p>如果未指定标题，则带有制表符索引后缀的唯一名称将用作制表符的标题。</p></li><li><p>如果未指定标题，但指定了图标，则标题将为空。</p></li><li><p>可选参数。</p></li></ul></li><li><p>[@icon]:</p><ul><li><p>FontAwesome图标名称（全名，看起来像“ fas fa-font”）</p></li><li><p>可以指定带空格或不带空格；</p></li><li><p>例如’Tab caption @icon’ 和 ‘Tab caption@icon’.</p></li><li><p>可选参数。</p></li></ul></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.Demo 1 - 预设选择第一个【默认】</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test1 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>2.Demo 2 - 预设选择tabs</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test2, 3 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>3.Demo 3 - 没有预设值</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test3, -1 %&#125;</span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 1.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 2.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab --&gt;</span><br><span class="line"><span class="strong">**This is Tab 3.**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><p>4.Demo 4 - 自定义Tab名 + 只有icon + icon和Tab名</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% tabs test4 %&#125;</span><br><span class="line">&lt;!-- tab 第一个Tab --&gt;</span><br><span class="line"><span class="strong">**tab名字为第一个Tab**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab @fab fa-apple-pay --&gt;</span><br><span class="line"><span class="strong">**只有图标 没有Tab名字**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- tab 炸弹@fas fa-bomb --&gt;</span><br><span class="line"><span class="strong">**名字+icon**</span></span><br><span class="line">&lt;!-- endtab --&gt;</span><br><span class="line">&#123;% endtabs %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.Demo 1 - 预设选择第一个【默认】</p><div class="tabs" id="test1"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test1-1">test1 1</button></li><li class="tab"><button type="button" data-href="#test1-2">test1 2</button></li><li class="tab"><button type="button" data-href="#test1-3">test1 3</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test1-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test1-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>2.Demo 2 - 预设选择tabs</p><div class="tabs" id="test2"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#test2-1">test2 1</button></li><li class="tab"><button type="button" data-href="#test2-2">test2 2</button></li><li class="tab active"><button type="button" data-href="#test2-3">test2 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test2-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test2-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content active" id="test2-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>3.Demo 3 - 没有预设值</p><div class="tabs" id="test3"><ul class="nav-tabs"><li class="tab"><button type="button" data-href="#test3-1">test3 1</button></li><li class="tab"><button type="button" data-href="#test3-2">test3 2</button></li><li class="tab"><button type="button" data-href="#test3-3">test3 3</button></li></ul><div class="tab-contents"><div class="tab-item-content" id="test3-1"><p><strong>This is Tab 1.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-2"><p><strong>This is Tab 2.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test3-3"><p><strong>This is Tab 3.</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>4.Demo 4 - 自定义Tab名 + 只有icon + icon和Tab名</p><div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test4-1">第一个Tab</button></li><li class="tab"><button type="button" data-href="#test4-2"><i class="fab fa-apple-pay" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#test4-3"><i class="fas fa-bomb"></i>炸弹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><p><strong>tab名字为第一个Tab</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-2"><p><strong>只有图标 没有Tab名字</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-3"><p><strong>名字+icon</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-22-诗词标签-poem">2.22 诗词标签 poem</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-2">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-3">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><ol><li><code>title</code>：诗词标题</li><li><code>author</code>：作者，可以不写</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;% poem 水调歌头,苏轼 %&#125;</span><br><span class="line">丙辰中秋，欢饮达旦，大醉，作此篇，兼怀子由。</span><br><span class="line">明月几时有？把酒问青天。</span><br><span class="line">不知天上宫阙，今夕是何年？</span><br><span class="line">我欲乘风归去，又恐琼楼玉宇，高处不胜寒。</span><br><span class="line">起舞弄清影，何似在人间？</span><br><span class="line"></span><br><span class="line">转朱阁，低绮户，照无眠。</span><br><span class="line">不应有恨，何事长向别时圆？</span><br><span class="line">人有悲欢离合，月有阴晴圆缺，此事古难全。</span><br><span class="line">但愿人长久，千里共婵娟。</span><br><span class="line">&#123;% endpoem %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><div class='poem'><div class='poem-title'>水调歌头</div><div class='poem-author'>苏轼</div><p>丙辰中秋，欢饮达旦，大醉，作此篇，兼怀子由。<br>明月几时有？把酒问青天。<br>不知天上宫阙，今夕是何年？<br>我欲乘风归去，又恐琼楼玉宇，高处不胜寒。<br>起舞弄清影，何似在人间？</p><p>转朱阁，低绮户，照无眠。<br>不应有恨，何事长向别时圆？<br>人有悲欢离合，月有阴晴圆缺，此事古难全。<br>但愿人长久，千里共婵娟。</p></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-23-阿里图标-icon">2.23 阿里图标 icon</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% icon [icon-xxxx],[font-size] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>icon-xxxx</code>：表示图标<code>font-class</code>,可以在自己的阿里矢量图标库项目的<code>font-class</code>引用方案内查询并复制。</li><li><code>font-size</code>：表示图标大小，直接填写数字即可，单位为<code>em</code>。图标大小默认值为<code>1em</code>。</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;% icon icon-rat<span class="emphasis">_zi %&#125;&#123;% icon icon-rat,2 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-ox_</span>chou,3 %&#125;&#123;% icon icon-ox,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-tiger<span class="emphasis">_yin,5 %&#125;&#123;% icon icon-tiger,6 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-rabbit_</span>mao,1 %&#125;&#123;% icon icon-rabbit,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dragon<span class="emphasis">_chen,3 %&#125;&#123;% icon icon-dragon,4 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-snake_</span>si,5 %&#125;&#123;% icon icon-snake,6 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-horse<span class="emphasis">_wu %&#125;&#123;% icon icon-horse,2 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-goat_</span>wei,3 %&#125;&#123;% icon icon-goat,4 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-monkey<span class="emphasis">_shen,5 %&#125;&#123;% icon icon-monkey,6 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-rooster_</span>you %&#125;&#123;% icon icon-rooster,2 %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% icon icon-dog<span class="emphasis">_xu,3 %&#125;&#123;% icon icon-dog,4 %&#125;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">&#123;% icon icon-boar_</span>hai,5 %&#125;&#123;% icon icon-boar,6 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rat_zi"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rat"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-ox_chou"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-ox"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-tiger_yin"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-tiger"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rabbit_mao"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rabbit"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-dragon_chen"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-dragon"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-snake_si"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-snake"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-horse_wu"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-horse"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-goat_wei"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-goat"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-monkey_shen"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-monkey"></use></svg></p><p><svg class="icon" style="width:1em; height:1em" aria-hidden="true"><use xlink:href="#icon-rooster_you"></use></svg><svg class="icon" style="width:2em; height:2em" aria-hidden="true"><use xlink:href="#icon-rooster"></use></svg></p><p><svg class="icon" style="width:3em; height:3em" aria-hidden="true"><use xlink:href="#icon-dog_xu"></use></svg><svg class="icon" style="width:4em; height:4em" aria-hidden="true"><use xlink:href="#icon-dog"></use></svg></p><p><svg class="icon" style="width:5em; height:5em" aria-hidden="true"><use xlink:href="#icon-boar_hai"></use></svg><svg class="icon" style="width:6em; height:6em" aria-hidden="true"><use xlink:href="#icon-boar"></use></svg></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-24-特效标签wow">2.24 特效标签wow</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-2">渲染演示</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow [animete],[duration],[delay],[offset],[iteration] %&#125;</span><br><span class="line">内容</span><br><span class="line">&#123;% endwow %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>animate</code>: 动画样式，效果详见<a href="https://animate.style/">animate.css参考文档</a></li><li><code>duration</code>: 选填项，动画持续时间，单位可以是<code>ms</code>也可以是<code>s</code>。例如<code>3s</code>，<code>700ms</code>。</li><li><code>delay</code>: 选填项，动画开始的延迟时间，单位可以是<code>ms</code>也可以是<code>s</code>。例如<code>3s</code>，<code>700ms</code>。</li><li><code>offset</code>: 选填项，开始动画的距离（相对浏览器底部）</li><li><code>iteration</code>: 选填项，动画重复的次数</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><p>1.flip动画效果。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__zoomIn,5s,5s,100,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`zoomIn`动画效果，持续`5s`，延时`5s`，离底部`100`距离时启动，重复`10`次</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>2.zoomIn动画效果，持续5s，延时5s，离底部100距离时启动，重复10次</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__zoomIn,5s,5s,100,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note blue &#x27;fas fa-bullhorn&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`zoomIn`动画效果，持续`5s`，延时`5s`，离底部`100`距离时启动，重复`10`次</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>3.slideInRight动画效果，持续5s，延时5s</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__slideInRight,5s,5s %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note orange &#x27;fas fa-car&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`slideInRight`动画效果，持续`5s`，延时`5s`。</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><p>4.heartBeat动画效果，延时5s，重复10次。此处注意不用的参数位置要留空，用逗号间隔。</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;% wow animate<span class="strong">__heartBeat,,5s,,10 %&#125;</span></span><br><span class="line"><span class="strong">&#123;% note red &#x27;fas fa-battery-half&#x27; modern%&#125;</span></span><br><span class="line"><span class="strong">`heartBeat`动画效果，延时`5s`，重复`10`次。</span></span><br><span class="line"><span class="strong">&#123;% endnote %&#125;</span></span><br><span class="line"><span class="strong">&#123;% endwow %&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>1.flip动画效果。</p><div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><code>zoomIn</code>动画效果，持续<code>5s</code>，延时<code>5s</code>，离底部<code>100</code>距离时启动，重复<code>10</code>次</p></div></div><p>2.zoomIn动画效果，持续5s，延时5s，离底部100距离时启动，重复10次</p><div class='wow animate__zoomIn' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset='100'  data-wow-iteration='10' ><div class="note blue icon-padding modern"><i class="note-icon fas fa-bullhorn"></i><p><code>zoomIn</code>动画效果，持续<code>5s</code>，延时<code>5s</code>，离底部<code>100</code>距离时启动，重复<code>10</code>次</p></div></div><p>3.slideInRight动画效果，持续5s，延时5s</p><div class='wow animate__slideInRight' data-wow-duration='5s' data-wow-delay='5s' data-wow-offset=''  data-wow-iteration='' ><div class="note orange icon-padding modern"><i class="note-icon fas fa-car"></i><p><code>slideInRight</code>动画效果，持续<code>5s</code>，延时<code>5s</code>。</p></div></div><p>4.heartBeat动画效果，延时5s，重复10次。此处注意不用的参数位置要留空，用逗号间隔。</p><div class='wow animate__heartBeat' data-wow-duration='' data-wow-delay='5s' data-wow-offset=''  data-wow-iteration='10' ><div class="note red icon-padding modern"><i class="note-icon fas fa-battery-half"></i><p><code>heartBeat</code>动画效果，延时<code>5s</code>，重复<code>10</code>次。</p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-25-进度条-progress">2.25  进度条 progress</h2><div class="note info flat"><p>进度条标签参考<a href="https://rongbuqiu.com/jdt.html">沂佰孜猫-给HEXO文章添加彩色进度条</a>。<br>源样式提取自<a href="https://zwying0814.gitbook.io/cuteen/">Cuteen</a>主题。</p></div><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-2">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% progress [width] [color] [text] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>width</code>: 0到100的阿拉伯数字</li><li><code>color</code>: 颜色，取值有red,yellow,green,cyan,blue,gray</li><li><code>text</code>:进度条上的文字内容</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;% progress 10 red 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 30 yellow 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 50 green 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 70 cyan 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 90 blue 进度条样式预览 %&#125;</span><br><span class="line">&#123;% progress 100 gray 进度条样式预览 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-red"  style="width: 10%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-yellow"  style="width: 30%" aria-valuenow="30" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-green"  style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-cyan"  style="width: 70%" aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-blue"  style="width: 90%" aria-valuenow="90" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><div class="progress"><div class="progress-bar-animated progress-bar progress-bar-striped bg-gray"  style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"><p>进度条样式预览</p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-26-注释-notation">2.26 注释 notation</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% nota [label] , [text] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><p><code>label</code>: 注释词汇</p></li><li><p><code>text</code>: 悬停显示的注解内容</p></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% nota 把鼠标移动到我上面试试 ,可以看到注解内容出现在顶栏 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p><span class='nota' data-nota='可以看到注解内容出现在顶栏'>把鼠标移动到我上面试试</span></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-27-气泡注释-bubble">2.27 气泡注释 bubble</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% bubble [content] , [notation] ,[background-color] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>content</code>: 注释词汇</li><li><code>notation</code>: 悬停显示的注解内容</li><li><code>background-color</code>: 可选，气泡背景色。默认为“#71a4e3”</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">最近我学到了不少新玩意儿（虽然对很多大佬来说这些已经是旧技术了），比如CSS的&#123;% bubble 兄弟相邻选择器,&quot;例如 h1 + p &#123;margin-top:50px;&#125;&quot; %&#125;，&#123;% bubble flex布局,&quot;Flex 是 Flexible Box 的缩写，意为&quot;弹性布局&quot;，用来为盒状模型提供最大的灵活性&quot;,&quot;#ec5830&quot; %&#125;，&#123;% bubble transform变换,&quot;transform 属性向元素应用 2D 或 3D 转换。该属性允许我们对元素进行旋转、缩放、移动或倾斜。&quot;,&quot;#1db675&quot; %&#125;，animation的&#123;% bubble 贝塞尔速度曲线,&quot;贝塞尔曲线(Bézier curve)，又称贝兹曲线或贝济埃曲线，是应用于二维图形应用程序的数学曲线。一般的矢量图形软件通过它来精确画出曲线，贝兹曲线由线段与节点组成，节点是可拖动的支点，线段像可伸缩的皮筋&quot;,&quot;#de4489&quot; %&#125;写法，还有今天刚看到的&#123;% bubble clip-path,&quot;clip-path属性使用裁剪方式创建元素的可显示区域。区域内的部分显示，区域外的隐藏。&quot;,&quot;#868fd7&quot; %&#125;属性。这些对我来说很新颖的概念狠狠的冲击着我以前积累起来的设计思路。</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>最近我学到了不少新玩意儿（虽然对很多大佬来说这些已经是旧技术了），比如CSS的<span class="bubble-content">兄弟相邻选择器</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#71a4e3;">例如 h1 + p {margin-top:50px;}</span></span>，<span class="bubble-content">flex布局</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#ec5830;">Flex 是 Flexible Box 的缩写，意为弹性布局&quot;，用来为盒状模型提供最大的灵活性&quot;</span></span>，<span class="bubble-content">transform变换</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#1db675;">transform 属性向元素应用 2D 或 3D 转换。该属性允许我们对元素进行旋转、缩放、移动或倾斜。</span></span>，animation的<span class="bubble-content">贝塞尔速度曲线</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#de4489;">贝塞尔曲线(Bézier curve)，又称贝兹曲线或贝济埃曲线，是应用于二维图形应用程序的数学曲线。一般的矢量图形软件通过它来精确画出曲线，贝兹曲线由线段与节点组成，节点是可拖动的支点，线段像可伸缩的皮筋</span></span>写法，还有今天刚看到的<span class="bubble-content">clip-path</span><span class="bubble-notation"><span class="bubble-item" style="background-color:#868fd7;">clip-path属性使用裁剪方式创建元素的可显示区域。区域内的部分显示，区域外的隐藏。</span></span>属性。这些对我来说很新颖的概念狠狠的冲击着我以前积累起来的设计思路。</p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-28-引用文献-reference">2.28 引用文献 reference</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;% referto [id] , [literature] %&#125;</span><br><span class="line">&#123;% referfrom [id] , [literature] , [url] %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><p>referto 引用上标</p><ul><li><p><code>id</code>: 上标序号内容，需与referfrom标签的id对应才能实现跳转</p></li><li><p><code>literature</code>: 引用的参考文献名称</p></li></ul></li><li><p>referfrom 引用出处</p><ul><li><p><code>id</code>: 序号内容，需与referto标签的id对应才能实现 跳转</p></li><li><p><code>literature</code>: 引用的参考文献名称</p></li><li><p><code>url</code>: 引用的参考文献链接，可省略</p></li></ul></li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Akilarの糖果屋(akilar.top)是一个私人性质的博客&#123;% referto &#x27;[1]&#x27;,&#x27;Akilarの糖果屋群聊简介&#x27; %&#125;，从各类教程至生活点滴，无话不谈。建群的目的是提供一个闲聊的场所。博客采用Hexo框架&#123;% referto &#x27;[2]&#x27;,&#x27;Hexo中文文档&#x27; %&#125;，Butterfly主题&#123;% referto &#x27;[3]&#x27;,&#x27;Butterfly 安装文档(一) 快速开始&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">本项目参考了Volantis&#123;% referto &#x27;[4]&#x27;,&#x27;hexo-theme-volantis 标签插件&#x27; %&#125;的标签样式。引入<span class="code">`[tag].js`</span>，并针对<span class="code">`butterfly`</span>主题修改了相应的<span class="code">`[tag].styl`</span>。在此鸣谢<span class="code">`Volantis`</span>主题众开发者。</span><br><span class="line">主要参考内容包括各个volantis的内置标签插件文档&#123;% referto &#x27;[5]&#x27;,&#x27;Volantis文档:内置标签插件&#x27; %&#125;</span><br><span class="line">Butterfly主题的各个衍生魔改&#123;% referto &#x27;[6]&#x27;,&#x27;Butterfly 安装文档:标签外挂（Tag Plugins&#x27; %&#125;&#123;% referto &#x27;[7]&#x27;,&#x27;小弋の生活馆全样式预览&#x27; %&#125;&#123;% referto &#x27;[8]&#x27;,&#x27;l-lin-font-awesome-animation&#x27; %&#125;&#123;% referto &#x27;[9]&#x27;,&#x27;小康的butterfly主题使用文档&#x27; %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% referfrom &#x27;[1]&#x27;,&#x27;Akilarの糖果屋群聊简介&#x27;,&#x27;https://jq.qq.com/?<span class="emphasis">_wv=1027&amp;k=pGLB2C0N&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[2]&#x27;,&#x27;Hexo中文文档&#x27;,&#x27;https://hexo.io/zh-cn/docs/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[3]&#x27;,&#x27;Butterfly 安装文档(一) 快速开始&#x27;,&#x27;https://butterfly.js.org/posts/21cfbf15/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[4]&#x27;,&#x27;hexo-theme-volantis 标签插件&#x27;,&#x27;https://volantis.js.org/v5/tag-plugins/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[5]&#x27;,&#x27;Volantis文档:内置标签插件&#x27;,&#x27;https://volantis.js.org/tag-plugins/&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[6]&#x27;,&#x27;Butterfly 安装文档:标签外挂（Tag Plugins&#x27;,&#x27;https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[7]&#x27;,&#x27;小弋の生活馆全样式预览&#x27;,&#x27;https://lovelijunyi.gitee.io/posts/c898.html&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[8]&#x27;,&#x27;l-lin-font-awesome-animation&#x27;,&#x27;https://github.com/l-lin/font-awesome-animation&#x27; %&#125;</span></span><br><span class="line"><span class="emphasis">&#123;% referfrom &#x27;[9]&#x27;,&#x27;小康的butterfly主题使用文档&#x27;,&#x27;https://www.antmoe.com/posts/3b43914f/&#x27; %&#125;</span></span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>Akilarの糖果屋(akilar.top)是一个私人性质的博客<span class="hidden-anchor" id="referto_[1]"></span><sup class="reference"><a href="#referfrom_[1]">[1]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Akilarの糖果屋群聊简介</span><span class="reference-title">参考资料</span></span></span>，从各类教程至生活点滴，无话不谈。建群的目的是提供一个闲聊的场所。博客采用Hexo框架<span class="hidden-anchor" id="referto_[2]"></span><sup class="reference"><a href="#referfrom_[2]">[2]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Hexo中文文档</span><span class="reference-title">参考资料</span></span></span>，Butterfly主题<span class="hidden-anchor" id="referto_[3]"></span><sup class="reference"><a href="#referfrom_[3]">[3]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Butterfly 安装文档(一) 快速开始</span><span class="reference-title">参考资料</span></span></span></p><p>本项目参考了Volantis<span class="hidden-anchor" id="referto_[4]"></span><sup class="reference"><a href="#referfrom_[4]">[4]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">hexo-theme-volantis 标签插件</span><span class="reference-title">参考资料</span></span></span>的标签样式。引入<code>[tag].js</code>，并针对<code>butterfly</code>主题修改了相应的<code>[tag].styl</code>。在此鸣谢<code>Volantis</code>主题众开发者。<br>主要参考内容包括各个volantis的内置标签插件文档<span class="hidden-anchor" id="referto_[5]"></span><sup class="reference"><a href="#referfrom_[5]">[5]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Volantis文档:内置标签插件</span><span class="reference-title">参考资料</span></span></span><br>Butterfly主题的各个衍生魔改<span class="hidden-anchor" id="referto_[6]"></span><sup class="reference"><a href="#referfrom_[6]">[6]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">Butterfly 安装文档:标签外挂（Tag Plugins</span><span class="reference-title">参考资料</span></span></span><span class="hidden-anchor" id="referto_[7]"></span><sup class="reference"><a href="#referfrom_[7]">[7]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">小弋の生活馆全样式预览</span><span class="reference-title">参考资料</span></span></span><span class="hidden-anchor" id="referto_[8]"></span><sup class="reference"><a href="#referfrom_[8]">[8]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">l-lin-font-awesome-animation</span><span class="reference-title">参考资料</span></span></span><span class="hidden-anchor" id="referto_[9]"></span><sup class="reference"><a href="#referfrom_[9]">[9]</a></sup><span class="reference-bubble"><span class="reference-item"><span class="reference-literature">小康的butterfly主题使用文档</span><span class="reference-title">参考资料</span></span></span></p><div class="reference-source"><span class="hidden-anchor" id="referfrom_[1]"></span><a class="reference-anchor" href="#referto_[1]">[1]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://jq.qq.com/?_wv=1027&k=pGLB2C0N">Akilarの糖果屋群聊简介</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[2]"></span><a class="reference-anchor" href="#referto_[2]">[2]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://hexo.io/zh-cn/docs/">Hexo中文文档</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[3]"></span><a class="reference-anchor" href="#referto_[3]">[3]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://butterfly.js.org/posts/21cfbf15/">Butterfly 安装文档(一) 快速开始</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[4]"></span><a class="reference-anchor" href="#referto_[4]">[4]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://volantis.js.org/v5/tag-plugins/">hexo-theme-volantis 标签插件</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[5]"></span><a class="reference-anchor" href="#referto_[5]">[5]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://volantis.js.org/tag-plugins/">Volantis文档:内置标签插件</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[6]"></span><a class="reference-anchor" href="#referto_[6]">[6]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://butterfly.js.org/posts/4aa8abbe/#%E6%A8%99%E7%B1%A4%E5%A4%96%E6%8E%9B%EF%BC%88Tag-Plugins%EF%BC%89">Butterfly 安装文档:标签外挂（Tag Plugins</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[7]"></span><a class="reference-anchor" href="#referto_[7]">[7]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://lovelijunyi.gitee.io/posts/c898.html">小弋の生活馆全样式预览</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[8]"></span><a class="reference-anchor" href="#referto_[8]">[8]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://github.com/l-lin/font-awesome-animation">l-lin-font-awesome-animation</a></div><div class="reference-source"><span class="hidden-anchor" id="referfrom_[9]"></span><a class="reference-anchor" href="#referto_[9]">[9]<div class="reference-anchor-up fa-solid fa-angles-up"></div></a><a class="reference-link" href="https://www.antmoe.com/posts/3b43914f/">小康的butterfly主题使用文档</a></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-29-PDF展示">2.29 PDF展示</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% pdf 文件路径 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li><code>文件路径</code>: 可以是相对路径或者是在线链接</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 1.本地文件:在md文件路径下创建一个同名文件夹，其内放pdf文件名为xxx.pdf的文件</span></span><br><span class="line">&#123;% pdf xxx.pdf %&#125;</span><br><span class="line"><span class="section"># 2.在线链接</span></span><br><span class="line">&#123;% pdf https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/pdf/小作文讲义.pdf %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><p>2.在线链接(要放到最外层才能起作用)</p><pre><code>&lt;div class=&quot;row&quot;&gt;&lt;embed src=&quot;https://cdn.jsdelivr.net/gh/Justlovesmile/CDN/pdf/小作文讲义.pdf&quot; width=&quot;100%&quot; height=&quot;550&quot; type=&quot;application/pdf&quot;&gt;&lt;/div&gt;</code></pre><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-30-Hexo-tag-map-插件">2.30 Hexo-tag-map 插件</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% + 标签值 + 经度 + 纬度 + 文本 + 缩放等级 + 宽 + 高 + 默认图层 + %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><table><thead><tr><th style="text-align:center">地图名</th><th style="text-align:center">标签值 &lt;必填&gt;</th><th style="text-align:center">宽 (默认 100%) / 高 (默认 360px)</th><th style="text-align:center">缩放等级 (默认 14)</th><th style="text-align:center">宽 (默认 100%) / 高 (默认 360px)</th><th style="text-align:center">默认图层 (默认 1)</th></tr></thead><tbody><tr><td style="text-align:center">混合地图</td><td style="text-align:center">map</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 3~18</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~7</td></tr><tr><td style="text-align:center">谷歌地图</td><td style="text-align:center">googleMap</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~20</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~3</td></tr><tr><td style="text-align:center">高德地图</td><td style="text-align:center">gaodeMap</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 3~18</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~3</td></tr><tr><td style="text-align:center">百度地图</td><td style="text-align:center">baiduMap</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 4~18</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~2</td></tr><tr><td style="text-align:center">Geoq 地图</td><td style="text-align:center">geoqMap</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~18</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~5</td></tr><tr><td style="text-align:center">openstreet 地图</td><td style="text-align:center">openstreetMap</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">取值 1~18</td><td style="text-align:center">百分数或具体值 (100% 或 360px)</td><td style="text-align:center">不支持此参数</td></tr></tbody></table><ol><li>参数之间，用英文逗号相隔</li><li>参数必须按上述事例顺序输入，不得为空</li><li>同一个页面，同一组经纬度值，只能插入一个相同标签值的地图 (若有需要，可以将第二个地图上，经度或纬度末尾删除一两个数)</li><li>参数取值必须在上述范围内</li><li>默认图层：即地图叠加层的值，默认常规地图还是卫星地图，可按地图显示顺序取值</li><li>缩放等级，数字越大，地图比例尺越小，显示的越精细</li><li>除标签值外，其他参数选填，但 每个参数的左边的参数必填</li><li>谷歌地图需要外网才能加载查看</li></ol><p>坐标获取：<a href="https://lbs.amap.com/tools/picker">高德地图坐标拾取系统</a> 、<a href="https://api.map.baidu.com/lbsapi/getpoint/index.html">百度地图坐标拾取系统</a></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% map 120.101101,30.239119 %&#125;</span><br><span class="line">&#123;% googleMap 120.101101,30.239119, 这里是西湖灵隐寺，据说求姻缘很灵验哦！ %&#125;</span><br><span class="line">&#123;% geoqMap 120.101101,30.239119, 这里是西湖灵隐寺，据说求姻缘很灵验哦！, 13, 90%, 320px, 3 %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div class="map-box" style="margin: 0.8rem 0 1.6rem 0;"><div id="map-120.101101-30.239119" style="max-width:100%; height:360px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div></div><script type="text/javascript">var normalm=L.tileLayer.chinaProvider('GaoDe.Normal.Map',{maxZoom:20,minZoom:1,attribution:'高德地图'});var imgm=L.tileLayer.chinaProvider('GaoDe.Satellite.Map',{maxZoom:20,minZoom:1,attribution:'高德地图'});var imga=L.tileLayer.chinaProvider('GaoDe.Satellite.Annotion',{maxZoom:20,minZoom:1,attribution:'高德地图'});var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:20,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'});routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:21,minZoom:1});var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:21,minZoom:1,attribution:'Google Maps'}),routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:21,minZoom:1,attribution:'Google Maps'});var normalm1=L.tileLayer.chinaProvider('Geoq.Normal.Map',{maxZoom:21,minZoom:1,attribution:'GeoQ'});var normal=L.layerGroup([normalm]),image=L.layerGroup([imgm,imga]);var baseLayers={"高德地图":normal,"智图地图":normalm1,"谷歌地图":normalMap,"高德卫星地图":imgm,"谷歌卫星地图":satelliteMap,"高德卫星标注":image,"谷歌卫星标注":routeMap};var mymap=L.map('map-120.101101-30.239119',{center:[30.239119,120.101101],zoom:14,layers:[normal],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'放大',zoomOutTitle:'缩小'}).addTo(mymap);</script><br><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div id="googleMap-120.101101-30.239119" style="max-width:100%; height:360px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div><script type="text/javascript">var normalMap=L.tileLayer.chinaProvider('Google.Normal.Map',{maxZoom:22,minZoom:1,attribution:'Google Maps'}),satelliteMap=L.tileLayer.chinaProvider('Google.Satellite.Map',{maxZoom:22,minZoom:1,attribution:'Google Maps'}),routeMap=L.tileLayer.chinaProvider('Google.Satellite.Annotion',{maxZoom:22,minZoom:1,attribution:'Google Maps'});var baseLayers={"谷歌地图":normalMap,"谷歌卫星图":satelliteMap,"谷歌卫星标注": routeMap};var overlayLayers={};var mymap=L.map("googleMap-120.101101-30.239119",{center:[30.239119,120.101101],zoom:14,layers:[normalMap],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'放大',zoomOutTitle:'缩小'}).addTo(mymap);var marker = L.marker(['30.239119','120.101101']).addTo(mymap);marker.bindPopup("这里是西湖灵隐寺，据说求姻缘很灵验哦！").openPopup();</script><br><link rel="stylesheet" href="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.css"><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet@1.7.1.js"></script><script data-pjax src="//unpkg.com/hexo-tag-map/lib/leaflet.ChineseTmsProviders@1.0.4.js"></script><div id="geoqMap-120.101101-30.239119" style="max-width:90%; height:320px;display: block;margin:0 auto;z-index:1;border-radius: 5px;"></div><script type="text/javascript">var normalm1=L.tileLayer.chinaProvider('Geoq.Normal.Map',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm2=L.tileLayer.chinaProvider('Geoq.Normal.PurplishBlue',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm3=L.tileLayer.chinaProvider('Geoq.Normal.Gray',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm4=L.tileLayer.chinaProvider('Geoq.Normal.Warm',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normalm5=L.tileLayer.chinaProvider('Geoq.Theme.Hydro',{maxZoom:20,minZoom:1,attribution:'GeoQ'});var normal=L.layerGroup([normalm1,normalm2,normalm3,normalm4,normalm5]);var baseLayers={"智图地图":normalm1,"午夜蓝":normalm2,"灰色":normalm3,"暖色":normalm4,"水系":normalm5};var mymap=L.map("geoqMap-120.101101-30.239119",{center:[30.239119,120.101101],zoom:13,layers:[normalm3],zoomControl:false});L.control.layers(baseLayers,null).addTo(mymap);L.control.zoom({zoomInTitle:'放大',zoomOutTitle:'缩小'}).addTo(mymap);var marker = L.marker(['30.239119','120.101101']).addTo(mymap);marker.bindPopup("这里是西湖灵隐寺，据说求姻缘很灵验哦！").openPopup();</script><br><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><h2 id="2-31-隐藏块">2.31 隐藏块</h2><div class="tabs" id="分栏"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#分栏-1">标签语法</button></li><li class="tab"><button type="button" data-href="#分栏-2">参数配置</button></li><li class="tab"><button type="button" data-href="#分栏-3">示例源码</button></li><li class="tab"><button type="button" data-href="#分栏-4">渲染演示</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="分栏-1"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideBlock display,bg,color %&#125;</span><br><span class="line">content</span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-2"><ol><li>content：要隐藏的内容</li><li>display：展示前按钮显示的文字（可选）</li><li>bg：按钮的背景颜色（可选）</li><li>color：按钮显示的文字的颜色（可选）</li></ol><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-3"><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% hideBlock 点我预览, blue %&#125;</span><br><span class="line">这里有张图片：</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://s1.vika.cn/space/2022/10/30/b35fce448bc9404a8d65c3ce1e6e46eb&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;image (1)&quot;</span> <span class="attr">style</span>=<span class="string">&quot;zoom:67%;&quot;</span> /&gt;</span></span></span><br><span class="line">&#123;% endhideBlock %&#125;</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="分栏-4"><div class="hide-block"><button type="button" class="hide-button" style="background-color:  blue;">点我预览    </button><div class="hide-content"><p>这里有张图片：<br><img src="https://s1.vika.cn/space/2022/10/30/b35fce448bc9404a8d65c3ce1e6e46eb" alt="image (1)" style="zoom:67%;" /></p></div></div><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> 演示 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Markdown </tag>
            
            <tag> 外挂标签 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
