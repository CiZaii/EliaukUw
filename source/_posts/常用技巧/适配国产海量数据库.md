---
title: 项目如何适配国产海量数据库
date: '2024/3/14 19:28'
swiper: false
cover: >-
  https://zang-1307996497.cos.ap-beijing.myqcloud.com/undefined20240314150030.png
img: >-
  https://zang-1307996497.cos.ap-beijing.myqcloud.com/undefined20240314150030.png
categories: 实用
tags:
  - Vastbase
top: true
sticky: 5
swiper_index: 5
abbrlink: 29bb76eb
---

## 1、当前使用ORM框架以及配置
1. 当前我使用的ORM框架是：Mybatis-Plus，然后进行了多租户的配置
2. 使用依赖如下：
```xml
    <dependencies>
        <dependency>
            <groupId>com.gitee.sunchenbin.mybatis.actable</groupId>
            <artifactId>mybatis-enhance-actable</artifactId>
            <version>1.5.0.RELEASE</version>
            <exclusions>
                <exclusion>
                    <groupId>com.baomidou</groupId>
                    <artifactId>mybatis-plus-annotation</artifactId>
                </exclusion>
            </exclusions>
        </dependency>
        <dependency>
            <groupId>com.baomidou</groupId>
            <artifactId>mybatis-plus-boot-starter</artifactId>
            <version>3.5.4</version>
        </dependency>
        <dependency>
            <groupId>com.github.yulichang</groupId>
            <artifactId>mybatis-plus-join-boot-starter</artifactId>
            <version>1.4.7</version>
        </dependency>
    </dependencies>
```

## 2、开始进行适配
### 2.1、配置文件修改
当前配置文件
```yml
mysql:
  default:
    url: jdbc:mysql://xxxxxxx:33306/ai_boot?useUnicode=true&characterEncoding=UTF-8&useSSL=true&autoReconnect=true
    username: 用户名
    password: 密码
    driverClassName: com.mysql.cj.jdbc.Driver
  tenant:
    prefix: ai_boot_
    host: ip地址
    port: 33306
    username: 用户名
    password: 密码
    driverClassName: com.mysql.cj.jdbc.Driver
```
> 只需要将url中的mysql改为postgresql即可
> 注意：postgresql的驱动类是：org.postgresql.Driver
> 要注意的是：postgresql的url中需要指定currentSchema=xxxx 这是一个默认访问的数据库，在多租户配置下需要注意


修改后的配置
```yaml
mysql:
  default:
    url: jdbc:postgresql://ip:5432/ai?useUnicode=true&characterEncoding=UTF-8&useSSL=true&autoReconnect=true&currentSchema=ai_boot
    username: 用户名
    password: 密码
    driverClassName: org.postgresql.Driver
  tenant:
    prefix: ai_boot_
    host: xxxxx
    port: 5432
    username: 用户名
    password: 密码
    driverClassName: org.postgresql.Driver
```
新引入依赖
```xml
    <dependencies>
        <!-- 引入postgresql驱动 -->
        <dependency>
            <groupId>org.postgresql</groupId>
            <artifactId>postgresql</artifactId>
        </dependency>
        <!-- 引入vastbase-jdbc -->
        <dependency>
            <groupId>cn.com.vastdata</groupId>
            <artifactId>vastbase-jdbc</artifactId>
            <version>2.8v</version>
        </dependency>
    </dependencies>
```

